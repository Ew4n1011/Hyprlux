/*! For license information please see background.js.LICENSE.txt */
(()=>{var e={9416:(e,t,r)=>{"use strict";t.browser=r(3150)},3150:function(e,t){var r,n;"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self&&self,r=function(e){"use strict";if("undefined"==typeof browser||Object.getPrototypeOf(browser)!==Object.prototype){const t="The message port closed before a response was received.",r="Returning a Promise is the preferred way to send a reply from an onMessage/onMessageExternal listener, as the sendResponse will be removed from the specs (See https://developer.mozilla.org/docs/Mozilla/Add-ons/WebExtensions/API/runtime/onMessage)",n=e=>{const n={alarms:{clear:{minArgs:0,maxArgs:1},clearAll:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getAll:{minArgs:0,maxArgs:0}},bookmarks:{create:{minArgs:1,maxArgs:1},get:{minArgs:1,maxArgs:1},getChildren:{minArgs:1,maxArgs:1},getRecent:{minArgs:1,maxArgs:1},getSubTree:{minArgs:1,maxArgs:1},getTree:{minArgs:0,maxArgs:0},move:{minArgs:2,maxArgs:2},remove:{minArgs:1,maxArgs:1},removeTree:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1},update:{minArgs:2,maxArgs:2}},browserAction:{disable:{minArgs:0,maxArgs:1,fallbackToNoCallback:!0},enable:{minArgs:0,maxArgs:1,fallbackToNoCallback:!0},getBadgeBackgroundColor:{minArgs:1,maxArgs:1},getBadgeText:{minArgs:1,maxArgs:1},getPopup:{minArgs:1,maxArgs:1},getTitle:{minArgs:1,maxArgs:1},openPopup:{minArgs:0,maxArgs:0},setBadgeBackgroundColor:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setBadgeText:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setIcon:{minArgs:1,maxArgs:1},setPopup:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setTitle:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},browsingData:{remove:{minArgs:2,maxArgs:2},removeCache:{minArgs:1,maxArgs:1},removeCookies:{minArgs:1,maxArgs:1},removeDownloads:{minArgs:1,maxArgs:1},removeFormData:{minArgs:1,maxArgs:1},removeHistory:{minArgs:1,maxArgs:1},removeLocalStorage:{minArgs:1,maxArgs:1},removePasswords:{minArgs:1,maxArgs:1},removePluginData:{minArgs:1,maxArgs:1},settings:{minArgs:0,maxArgs:0}},commands:{getAll:{minArgs:0,maxArgs:0}},contextMenus:{remove:{minArgs:1,maxArgs:1},removeAll:{minArgs:0,maxArgs:0},update:{minArgs:2,maxArgs:2}},cookies:{get:{minArgs:1,maxArgs:1},getAll:{minArgs:1,maxArgs:1},getAllCookieStores:{minArgs:0,maxArgs:0},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}},devtools:{inspectedWindow:{eval:{minArgs:1,maxArgs:2,singleCallbackArg:!1}},panels:{create:{minArgs:3,maxArgs:3,singleCallbackArg:!0},elements:{createSidebarPane:{minArgs:1,maxArgs:1}}}},downloads:{cancel:{minArgs:1,maxArgs:1},download:{minArgs:1,maxArgs:1},erase:{minArgs:1,maxArgs:1},getFileIcon:{minArgs:1,maxArgs:2},open:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},pause:{minArgs:1,maxArgs:1},removeFile:{minArgs:1,maxArgs:1},resume:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1},show:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},extension:{isAllowedFileSchemeAccess:{minArgs:0,maxArgs:0},isAllowedIncognitoAccess:{minArgs:0,maxArgs:0}},history:{addUrl:{minArgs:1,maxArgs:1},deleteAll:{minArgs:0,maxArgs:0},deleteRange:{minArgs:1,maxArgs:1},deleteUrl:{minArgs:1,maxArgs:1},getVisits:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1}},i18n:{detectLanguage:{minArgs:1,maxArgs:1},getAcceptLanguages:{minArgs:0,maxArgs:0}},identity:{launchWebAuthFlow:{minArgs:1,maxArgs:1}},idle:{queryState:{minArgs:1,maxArgs:1}},management:{get:{minArgs:1,maxArgs:1},getAll:{minArgs:0,maxArgs:0},getSelf:{minArgs:0,maxArgs:0},setEnabled:{minArgs:2,maxArgs:2},uninstallSelf:{minArgs:0,maxArgs:1}},notifications:{clear:{minArgs:1,maxArgs:1},create:{minArgs:1,maxArgs:2},getAll:{minArgs:0,maxArgs:0},getPermissionLevel:{minArgs:0,maxArgs:0},update:{minArgs:2,maxArgs:2}},pageAction:{getPopup:{minArgs:1,maxArgs:1},getTitle:{minArgs:1,maxArgs:1},hide:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setIcon:{minArgs:1,maxArgs:1},setPopup:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setTitle:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},show:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},permissions:{contains:{minArgs:1,maxArgs:1},getAll:{minArgs:0,maxArgs:0},remove:{minArgs:1,maxArgs:1},request:{minArgs:1,maxArgs:1}},runtime:{getBackgroundPage:{minArgs:0,maxArgs:0},getPlatformInfo:{minArgs:0,maxArgs:0},openOptionsPage:{minArgs:0,maxArgs:0},requestUpdateCheck:{minArgs:0,maxArgs:0},sendMessage:{minArgs:1,maxArgs:3},sendNativeMessage:{minArgs:2,maxArgs:2},setUninstallURL:{minArgs:1,maxArgs:1}},sessions:{getDevices:{minArgs:0,maxArgs:1},getRecentlyClosed:{minArgs:0,maxArgs:1},restore:{minArgs:0,maxArgs:1}},storage:{local:{clear:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}},managed:{get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1}},sync:{clear:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}}},tabs:{captureVisibleTab:{minArgs:0,maxArgs:2},create:{minArgs:1,maxArgs:1},detectLanguage:{minArgs:0,maxArgs:1},discard:{minArgs:0,maxArgs:1},duplicate:{minArgs:1,maxArgs:1},executeScript:{minArgs:1,maxArgs:2},get:{minArgs:1,maxArgs:1},getCurrent:{minArgs:0,maxArgs:0},getZoom:{minArgs:0,maxArgs:1},getZoomSettings:{minArgs:0,maxArgs:1},goBack:{minArgs:0,maxArgs:1},goForward:{minArgs:0,maxArgs:1},highlight:{minArgs:1,maxArgs:1},insertCSS:{minArgs:1,maxArgs:2},move:{minArgs:2,maxArgs:2},query:{minArgs:1,maxArgs:1},reload:{minArgs:0,maxArgs:2},remove:{minArgs:1,maxArgs:1},removeCSS:{minArgs:1,maxArgs:2},sendMessage:{minArgs:2,maxArgs:3},setZoom:{minArgs:1,maxArgs:2},setZoomSettings:{minArgs:1,maxArgs:2},update:{minArgs:1,maxArgs:2}},topSites:{get:{minArgs:0,maxArgs:0}},webNavigation:{getAllFrames:{minArgs:1,maxArgs:1},getFrame:{minArgs:1,maxArgs:1}},webRequest:{handlerBehaviorChanged:{minArgs:0,maxArgs:0}},windows:{create:{minArgs:0,maxArgs:1},get:{minArgs:1,maxArgs:2},getAll:{minArgs:0,maxArgs:1},getCurrent:{minArgs:0,maxArgs:1},getLastFocused:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},update:{minArgs:2,maxArgs:2}}};if(0===Object.keys(n).length)throw new Error("api-metadata.json has not been included in browser-polyfill");class o extends WeakMap{constructor(e,t=void 0){super(t),this.createItem=e}get(e){return this.has(e)||this.set(e,this.createItem(e)),super.get(e)}}const a=(t,r)=>(...n)=>{e.runtime.lastError?t.reject(new Error(e.runtime.lastError.message)):r.singleCallbackArg||n.length<=1&&!1!==r.singleCallbackArg?t.resolve(n[0]):t.resolve(n)},s=e=>1==e?"argument":"arguments",i=(e,t,r)=>new Proxy(t,{apply:(t,n,o)=>r.call(n,e,...o)});let c=Function.call.bind(Object.prototype.hasOwnProperty);const l=(e,t={},r={})=>{let n=Object.create(null),o={has:(t,r)=>r in e||r in n,get(o,u,g){if(u in n)return n[u];if(!(u in e))return;let d=e[u];if("function"==typeof d)if("function"==typeof t[u])d=i(e,e[u],t[u]);else if(c(r,u)){let t=((e,t)=>function(r,...n){if(n.length<t.minArgs)throw new Error(`Expected at least ${t.minArgs} ${s(t.minArgs)} for ${e}(), got ${n.length}`);if(n.length>t.maxArgs)throw new Error(`Expected at most ${t.maxArgs} ${s(t.maxArgs)} for ${e}(), got ${n.length}`);return new Promise(((o,s)=>{if(t.fallbackToNoCallback)try{r[e](...n,a({resolve:o,reject:s},t))}catch(a){console.warn(`${e} API method doesn't seem to support the callback parameter, falling back to call it without a callback: `,a),r[e](...n),t.fallbackToNoCallback=!1,t.noCallback=!0,o()}else t.noCallback?(r[e](...n),o()):r[e](...n,a({resolve:o,reject:s},t))}))})(u,r[u]);d=i(e,e[u],t)}else d=d.bind(e);else if("object"==typeof d&&null!==d&&(c(t,u)||c(r,u)))d=l(d,t[u],r[u]);else{if(!c(r,"*"))return Object.defineProperty(n,u,{configurable:!0,enumerable:!0,get:()=>e[u],set(t){e[u]=t}}),d;d=l(d,t[u],r["*"])}return n[u]=d,d},set:(t,r,o,a)=>(r in n?n[r]=o:e[r]=o,!0),defineProperty:(e,t,r)=>Reflect.defineProperty(n,t,r),deleteProperty:(e,t)=>Reflect.deleteProperty(n,t)},u=Object.create(e);return new Proxy(u,o)},u=e=>({addListener(t,r,...n){t.addListener(e.get(r),...n)},hasListener:(t,r)=>t.hasListener(e.get(r)),removeListener(t,r){t.removeListener(e.get(r))}}),g=new o((e=>"function"!=typeof e?e:function(t){const r=l(t,{},{getContent:{minArgs:0,maxArgs:0}});e(r)}));let d=!1;const m=new o((e=>"function"!=typeof e?e:function(t,n,o){let a,s,i=!1,c=new Promise((e=>{a=function(t){d||(console.warn(r,(new Error).stack),d=!0),i=!0,e(t)}}));try{s=e(t,n,a)}catch(e){s=Promise.reject(e)}const l=!0!==s&&((u=s)&&"object"==typeof u&&"function"==typeof u.then);var u;if(!0!==s&&!l&&!i)return!1;return(l?s:c).then((e=>{o(e)}),(e=>{let t;t=e&&(e instanceof Error||"string"==typeof e.message)?e.message:"An unexpected error occurred",o({__mozWebExtensionPolyfillReject__:!0,message:t})})).catch((e=>{console.error("Failed to send onMessage rejected reply",e)})),!0})),p=({reject:r,resolve:n},o)=>{e.runtime.lastError?e.runtime.lastError.message===t?n():r(new Error(e.runtime.lastError.message)):o&&o.__mozWebExtensionPolyfillReject__?r(new Error(o.message)):n(o)},f=(e,t,r,...n)=>{if(n.length<t.minArgs)throw new Error(`Expected at least ${t.minArgs} ${s(t.minArgs)} for ${e}(), got ${n.length}`);if(n.length>t.maxArgs)throw new Error(`Expected at most ${t.maxArgs} ${s(t.maxArgs)} for ${e}(), got ${n.length}`);return new Promise(((e,t)=>{const o=p.bind(null,{resolve:e,reject:t});n.push(o),r.sendMessage(...n)}))},h={devtools:{network:{onRequestFinished:u(g)}},runtime:{onMessage:u(m),onMessageExternal:u(m),sendMessage:f.bind(null,"sendMessage",{minArgs:1,maxArgs:3})},tabs:{sendMessage:f.bind(null,"sendMessage",{minArgs:2,maxArgs:3})}},A={clear:{minArgs:1,maxArgs:1},get:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}};return n.privacy={network:{"*":A},services:{"*":A},websites:{"*":A}},l(e,h,n)};if("object"!=typeof chrome||!chrome||!chrome.runtime||!chrome.runtime.id)throw new Error("This script should only be loaded in a browser extension.");e.exports=n(chrome)}else e.exports=browser},void 0===(n=r.apply(t,[e]))||(e.exports=n)},7061:(e,t,r)=>{var n=r(8698).default;function o(){"use strict";e.exports=o=function(){return t},e.exports.__esModule=!0,e.exports.default=e.exports;var t={},r=Object.prototype,a=r.hasOwnProperty,s=Object.defineProperty||function(e,t,r){e[t]=r.value},i="function"==typeof Symbol?Symbol:{},c=i.iterator||"@@iterator",l=i.asyncIterator||"@@asyncIterator",u=i.toStringTag||"@@toStringTag";function g(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{g({},"")}catch(e){g=function(e,t,r){return e[t]=r}}function d(e,t,r,n){var o=t&&t.prototype instanceof f?t:f,a=Object.create(o.prototype),i=new O(n||[]);return s(a,"_invoke",{value:k(e,r,i)}),a}function m(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=d;var p={};function f(){}function h(){}function A(){}var w={};g(w,c,(function(){return this}));var x=Object.getPrototypeOf,v=x&&x(x(L([])));v&&v!==r&&a.call(v,c)&&(w=v);var b=A.prototype=f.prototype=Object.create(w);function y(e){["next","throw","return"].forEach((function(t){g(e,t,(function(e){return this._invoke(t,e)}))}))}function _(e,t){function r(o,s,i,c){var l=m(e[o],e,s);if("throw"!==l.type){var u=l.arg,g=u.value;return g&&"object"==n(g)&&a.call(g,"__await")?t.resolve(g.__await).then((function(e){r("next",e,i,c)}),(function(e){r("throw",e,i,c)})):t.resolve(g).then((function(e){u.value=e,i(u)}),(function(e){return r("throw",e,i,c)}))}c(l.arg)}var o;s(this,"_invoke",{value:function(e,n){function a(){return new t((function(t,o){r(e,n,t,o)}))}return o=o?o.then(a,a):a()}})}function k(e,t,r){var n="suspendedStart";return function(o,a){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===o)throw a;return{value:void 0,done:!0}}for(r.method=o,r.arg=a;;){var s=r.delegate;if(s){var i=E(s,r);if(i){if(i===p)continue;return i}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var c=m(e,t,r);if("normal"===c.type){if(n=r.done?"completed":"suspendedYield",c.arg===p)continue;return{value:c.arg,done:r.done}}"throw"===c.type&&(n="completed",r.method="throw",r.arg=c.arg)}}}function E(e,t){var r=t.method,n=e.iterator[r];if(void 0===n)return t.delegate=null,"throw"===r&&e.iterator.return&&(t.method="return",t.arg=void 0,E(e,t),"throw"===t.method)||"return"!==r&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+r+"' method")),p;var o=m(n,e.iterator,t.arg);if("throw"===o.type)return t.method="throw",t.arg=o.arg,t.delegate=null,p;var a=o.arg;return a?a.done?(t[e.resultName]=a.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,p):a:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,p)}function S(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function I(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function O(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(S,this),this.reset(!0)}function L(e){if(e){var t=e[c];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,n=function t(){for(;++r<e.length;)if(a.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=void 0,t.done=!0,t};return n.next=n}}return{next:T}}function T(){return{value:void 0,done:!0}}return h.prototype=A,s(b,"constructor",{value:A,configurable:!0}),s(A,"constructor",{value:h,configurable:!0}),h.displayName=g(A,u,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===h||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,A):(e.__proto__=A,g(e,u,"GeneratorFunction")),e.prototype=Object.create(b),e},t.awrap=function(e){return{__await:e}},y(_.prototype),g(_.prototype,l,(function(){return this})),t.AsyncIterator=_,t.async=function(e,r,n,o,a){void 0===a&&(a=Promise);var s=new _(d(e,r,n,o),a);return t.isGeneratorFunction(r)?s:s.next().then((function(e){return e.done?e.value:s.next()}))},y(b),g(b,u,"Generator"),g(b,c,(function(){return this})),g(b,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},t.values=L,O.prototype={constructor:O,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(I),!e)for(var t in this)"t"===t.charAt(0)&&a.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function r(r,n){return s.type="throw",s.arg=e,t.next=r,n&&(t.method="next",t.arg=void 0),!!n}for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n],s=o.completion;if("root"===o.tryLoc)return r("end");if(o.tryLoc<=this.prev){var i=a.call(o,"catchLoc"),c=a.call(o,"finallyLoc");if(i&&c){if(this.prev<o.catchLoc)return r(o.catchLoc,!0);if(this.prev<o.finallyLoc)return r(o.finallyLoc)}else if(i){if(this.prev<o.catchLoc)return r(o.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return r(o.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&a.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var o=n;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var s=o?o.completion:{};return s.type=e,s.arg=t,o?(this.method="next",this.next=o.finallyLoc,p):this.complete(s)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),p},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),I(r),p}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var o=n.arg;I(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,r){return this.delegate={iterator:L(e),resultName:t,nextLoc:r},"next"===this.method&&(this.arg=void 0),p}},t}e.exports=o,e.exports.__esModule=!0,e.exports.default=e.exports},8698:e=>{function t(r){return e.exports=t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e.exports.__esModule=!0,e.exports.default=e.exports,t(r)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports},4687:(e,t,r)=>{var n=r(7061)();e.exports=n;try{regeneratorRuntime=n}catch(e){"object"==typeof globalThis?globalThis.regeneratorRuntime=n:Function("r","regeneratorRuntime = r")(n)}}},t={};function r(n){var o=t[n];if(void 0!==o)return o.exports;var a=t[n]={exports:{}};return e[n].call(a.exports,a,a.exports,r),a.exports}r.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return r.d(t,{a:t}),t},r.d=(e,t)=>{for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{"use strict";function e(e,t,r,n,o,a,s){try{var i=e[a](s),c=i.value}catch(e){return void r(e)}i.done?t(c):Promise.resolve(c).then(n,o)}function t(t){return function(){var r=this,n=arguments;return new Promise((function(o,a){var s=t.apply(r,n);function i(t){e(s,o,a,i,c,"next",t)}function c(t){e(s,o,a,i,c,"throw",t)}i(void 0)}))}}function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}function o(e,t,r){return(t=function(e){var t=function(e,t){if("object"!==n(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,"string");if("object"!==n(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===n(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var a,s=r(4687),i=r.n(s),c=r(9416),l={pl:{ALLEGRO:["https://allegro.pl/koszyk"],ALIEXPRESS:["https://www.aliexpress.com/p/shoppingcart/index.html"],"MEDIA EXPERT":["https://www.mediaexpert.pl/koszyk/lista"],"BOOKING.COM":["https://secure.booking.com/book.html"],ENEBA:["https://www.eneba.com/checkout","https://www.eneba.com/pl/checkout"],PYSZNE:["https://www.pyszne.pl/menu/xxxxxxxxx#kasa","https://www.pyszne.pl/en/menu/xxxxxxxxx#checkout","https://www.pyszne.pl/nl/menu/xxxxxxxxx#afrekenen","https://www.pyszne.pl/de/speisekarte/xxxxxxxxx#bezahlen","https://www.pyszne.pl/fr/menu/xxxxxxxxx#payer","https://www.pyszne.pl/da/menu/xxxxxxxxx#gå-til-kassen","https://www.pyszne.pl/bg/menu/xxxxxxxxx#плащане","https://www.pyszne.pl/it/menu/xxxxxxxxx#pagamento"],KINGUIN:["https://www.kinguin.net/new-checkout/review"],EMPIK:["https://www.empik.com/cart/"],"RTV EURO AGD":["https://www.euro.com.pl/cart.bhtml"],EOBUWIE:["https://eobuwie.com.pl/checkout/cart"],ZOOPLUS:["https://www.zooplus.pl/checkout/cart","https://www.zooplus.pl/checkout/overview"],SINSAY:["https://www.sinsay.com/pl/pl/checkout/cart/","https://www.sinsay.com/pl/uk/checkout/cart/"],DECATHLON:["https://www.decathlon.pl/checkout/cart"],"LOUNGE BY ZALANDO":["https://www.zalando-lounge.pl/checkout/address","https://www.zalando-lounge.pl/checkout/address/","https://www.zalando-lounge.pl/checkout/payment/show","https://www.zalando-lounge.pl/checkout/payment/show/","https://www.zalando-lounge.pl/checkout","https://www.zalando-lounge.pl/checkout/"],"MEDIA MARKT":["https://mediamarkt.pl/koszyk/lista"],GLOBKURIER:["https://www.globkurier.pl/order"],UDEMY:["https://www.udemy.com/cart/"],NIKE:["https://www.nike.com/pl/cart"]},de:{EBAY:["https://cart.payments.ebay.de/"],ALIEXPRESS:["https://www.aliexpress.com/p/shoppingcart/index.html"],LIEFERANDO:["https://www.lieferando.de/speisekarte/xxxxxxxxx#bezahlen","https://www.lieferando.de/en/menu/xxxxxxxxx#checkout","https://www.lieferando.de/nl/menu/xxxxxxxxx#afrekenen","https://www.lieferando.de/speisekarte/xxxxxxxxx#bezahlen","https://www.lieferando.de/fr/menu/xxxxxxxxx#payer","https://www.lieferando.de/da/menu/xxxxxxxxx#gå-til-kassen","https://www.lieferando.de/bg/menu/xxxxxxxxx#плащане","https://www.lieferando.de/it/menu/xxxxxxxxx#pagamento"],BITIBA:["https://www.bitiba.de/checkout/cart"],"BOOKING.COM":["https://secure.booking.com/book.html"],ZOOPLUS:["https://www.zooplus.de/checkout/cart","https://www.zooplus.de/checkout/overview"],LIDL:["https://www.lidl.de/otc/cart","https://www.lidl.de/otc/checkout/"],ENEBA:["https://www.eneba.com/checkout","https://www.eneba.com/de/checkout"],SHEIN:["https://de.shein.com/cart"],DOCMORRIS:["https://www.docmorris.de/purchase"],MEDPEX:["https://www.medpex.de/cart.do"],MOMOXFASHION:["https://www.momoxfashion.com/de/cart/show"],"NETTO MARKEN-DISCOUNT ":["https://www.netto-online.de/INTERSHOP/web/WFS/Plus-NettoDE-Site/de_DE/-/EUR/ViewData-Start/1122280297?JumpTarget=ViewMMPCart-View"],UDEMY:["https://www.udemy.com/cart/"],"SHOP APOTHEKE":["https://www.shop-apotheke.com/nx/cart/"],APODISCOUNTER:["https://www.apodiscounter.de/shopping_cart.php"],KFZTEILE24:["https://www.kfzteile24.de/warenkorb"],FRESSNAPF:["https://www.fressnapf.de/cart/"],EMP:["https://www.emp.de/cart"]}},u=function(e,t){return l[t]?l[t][e.toUpperCase()]:[]},g=new Set(["alerabat.com","backit.me","bonusway.pl","cashgoback.pl","ceneo.pl","chollometro.com","couponplatz.de","coupons.de","de.igraal.com","es.beruby.com","es.igraal.com","joinhoney.com","getmore.de","goodie.pl","kuplio.de","letyshops.com","megabonus.com","meliuz.com.br","moneta.ua","mydealz.de","myworld.com","net-pocket.com","payback.de","payback.pl","payback.ua","pepper.pl","picodi.com","pl.plente.com","quidco.com","rakuten.com","rakuten.de","rakuten.es","refunder.pl","shoop.de","shopbuddies.de","shopmate.eu","smarty.sale","tipli.pl","topcashback.co.uk","topcashback.com","topcashback.de"]),d=c.browser.runtime.getManifest().version,m=void 0,p={5:2e3,4:4e3,3:8e3,2:16e3,1:32e3},f=function(e){return new Promise((function(t){return setTimeout(t,e)}))},h=!1,A=function(e,t){return{avgPaymentTime:e.others.avgPaymentTime,avgTransactionRecognitionTime:0,cashbackTerms:e.texts.cashbackTerms,categories:e.others.categories||[],disableAssistant:e.others.disableBadge,categoryRates:e.rates.categoryRates||[],domains:e.basic.domains||[],isFeatured:e.others.isFeatured,maxCashbackNormal:e.others.maxCashbackNormal,previousMaxCashbackNormal:e.others.previousMaxCashbackNormal,floatRateNormal:e.others.floatRateNormal,merchantLogoUrl:e.basic.merchantLogoUrl,merchantLogoId:e.basic.merchantLogoId,merchantName:e.texts.merchantName,offerCountry:e.targeting.countries.toString(),offerId:e.offerId,offerLongDesc:e.texts.offerLongDesc,priority:e.targeting.priority,searchPhrase:e.texts.searchPhrase,showAsAction:e.others.showAsAction,socialProof:e.others.socialProof,validToTimestamp:e.others.validToTimestamp,activationAvailableThroughTheSiteOnly:void 0!==e.others.activationAvailableThroughTheSiteOnly&&e.others.activationAvailableThroughTheSiteOnly,activeIconVisitingShopSite:void 0===e.others.activeIconVisitingShopSite||e.others.activeIconVisitingShopSite,allowedSubdomains:void 0===e.others.allowedSubdomains?[]:e.others.allowedSubdomains,forbiddenSubdomains:void 0===e.others.forbiddenSubdomains?[]:e.others.forbiddenSubdomains,showInShopList:void 0===e.others.showInShopList||e.others.showInShopList,showPopupActivateCb:void 0===e.others.showPopupActivateCb||e.others.showPopupActivateCb,showPopupCbActivated:void 0===e.others.showPopupCbActivated||e.others.showPopupCbActivated,checkoutPageDomains:u(e.texts.merchantName,t)||[]}},w=function(){var e=t(i().mark((function e(){var r,n=arguments;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=n.length>0&&void 0!==n[0]?n[0]:5,!a){e.next=5;break}return e.abrupt("return",a);case 5:return a=fetch("".concat(h?"https://cashback-api-staging.operacdn.com/api/public/v8":"https://cashback-api-production.operacdn.com/api/public/v8","/offers?size=2000&country=").concat(localStorage.country,"&lang=").concat(localStorage.language,"&source=ext.").concat(d)).then((function(e){return e.json()})).then((function(e){a=null;var t=e.content;return m=t.map((function(e){return A(e,localStorage.country)}))})).catch(t(i().mark((function e(){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(r>0)){e.next=7;break}return e.next=3,f(p[r]);case 3:return a=null,e.abrupt("return",w(r-1));case 7:return e.abrupt("return",m||[]);case 8:case"end":return e.stop()}}),e)})))),e.abrupt("return",a);case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),x=function(){var e=t(i().mark((function e(){var t,r=arguments;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=r.length>1&&void 0!==r[1]&&r[1],h=r.length>0&&void 0!==r[0]&&r[0],void 0!==m&&!t){e.next=6;break}return e.next=6,w();case 6:return e.abrupt("return",m);case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();setInterval(w,144e5);var v=function(e){return e.DONT_OPEN_AGAIN="dont_open_again",e.DONT_OPEN_AGAIN_TODAY="dont_open_again_today",e.DONT_OPEN_ALL_SHOPS="dont_open_all_shops",e}({}),b=function(e){return e.ACTIVATE_CASHBACK="ACTIVATE_CASHBACK",e.FETCH_OFFER_DATA="FETCH_OFFER_DATA",e.OFFER_DATA="OFFER_DATA",e.SEND_STATS="SEND_STATS",e.GET_SETTINGS_FOR_PAGE="GET_SETTINGS_FOR_PAGE",e.SETTINGS_FOR_PAGE="SETTINGS_FOR_PAGE",e.SET_SETTINGS_FOR_PAGE="SET_SETTINGS_FOR_PAGE",e.GET_VERSION="GET_VERSION",e.VERSION="VERSION",e.IS_LOGGED="IS_LOGGED",e.SET_LANGUAGE="SET_LANGUAGE",e.SET_STAGING="SET_STAGING",e}({});const y=36e5;var _=!1;c.browser.storage.local.get().then((function(e){_=e.staging}));var k,E,S=function(){return _},I=function(){return _?"https://cashback.op-test.net/":"https://cashback.opera.com/"};function O(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function L(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a,s,i=[],c=!0,l=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=a.call(r)).done)&&(i.push(n.value),i.length!==t);c=!0);}catch(e){l=!0,o=e}finally{try{if(!c&&null!=r.return&&(s=r.return(),Object(s)!==s))return}finally{if(l)throw o}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return O(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?O(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var T,P=window.opr,N=!(null===(k=window.opr)||void 0===k||null===(E=k.cashbackPrivate)||void 0===E||!E.onCashbackButtonPressed),C=(new URL(window.location.toString()).searchParams.get("id"),function(){return window.matchMedia("(prefers-color-scheme: dark)").matches});c.browser.storage.local.get().then((function(e){(T=e.uniqueID)||(T=(1e7.toString()+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,(function(e){return(+e^crypto.getRandomValues(new Uint8Array(1))[0]&15>>+e/4).toString(16)})),c.browser.storage.local.set({uniqueID:T}),Z({category:"impression",action:"assistant_installed"}),!N&&c.browser.tabs.create({url:"".concat(I(),"?extensionInstalled=1&cid=").concat(encodeURIComponent(T))}))}));var R,D,j,G,B,U,F,M,V,z,q,H,$,W,Y,K,Z=function(e){var t=e.category,r=e.action,n=e.label,o=e.value,a=e.badge_state,s=new XMLHttpRequest,i=Object.entries({v:1,tid:"UA-4118503-44",cid:T||"489017553.1621508293",ds:"assistant",t:"event",ec:t,ea:r,el:n,ev:o}).filter((function(e){return void 0!==e[1]})).map((function(e){return e[0]+"="+encodeURIComponent(e[1])})).join("&");if(s.open("POST","https://www.google-analytics.com/collect",!0),s.send(i),P&&P.statsPrivate){var c=JSON.stringify({action:r.replace(/ |\(|\)/g,"_"),details:{source:"assistant",category:t,label:n,value:o,badge_state:a}});console.log("%c Reporting stats: feature_events.event_cashback ".concat(c),"color: #88f"),P.statsPrivate.recordSessionEvent("feature_events.event_cashback",c,P.statsPrivate.Priority.NORMAL)}};function X(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function J(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?X(Object(r),!0).forEach((function(t){o(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):X(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var Q,ee,te,re=function(e){return e.NEUTRAL="Neutral",e.AVAILABLE="Available",e.AVAILABLE_RED="Available_Red",e.AVAILABLE_YELLOW="Available_Yellow",e.ACTIVE="Active",e}(re||{}),ne=(o(K={},re.NEUTRAL,null===(R=window.opr)||void 0===R||null===(D=R.cashbackPrivate)||void 0===D||null===(j=D.BadgeState)||void 0===j?void 0:j.DISABLED),o(K,re.AVAILABLE,null===(G=window.opr)||void 0===G||null===(B=G.cashbackPrivate)||void 0===B||null===(U=B.BadgeState)||void 0===U?void 0:U.WARNING),o(K,re.AVAILABLE_RED,null===(F=window.opr)||void 0===F||null===(M=F.cashbackPrivate)||void 0===M||null===(V=M.BadgeState)||void 0===V?void 0:V.WARNING),o(K,re.AVAILABLE_YELLOW,null===(z=window.opr)||void 0===z||null===(q=z.cashbackPrivate)||void 0===q||null===(H=q.BadgeState)||void 0===H?void 0:H.IDLE),o(K,re.ACTIVE,null===($=window.opr)||void 0===$||null===(W=$.cashbackPrivate)||void 0===W||null===(Y=W.BadgeState)||void 0===Y?void 0:Y.ACTIVE),K),oe=0,ae=0,se=!1,ie=!1,ce=!1,le=!1,ue=!1,ge=!1,de={},me=function(e,t,r){var n=new URL(t).hostname.split(".").slice(-e.split(".").length).join(".")===e;return r.forEach((function(e){return n=n&&-1===t.indexOf(e)})),n},pe=function(){var e=t(i().mark((function e(t){var r,n;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,x(S());case 2:return r=e.sent,n=(null==r?void 0:r.filter((function(e){return e.domains.map((function(r){return me(r,t,e.forbiddenSubdomains||[])})).reduce((function(e,t){return t||e}))})))||[],e.abrupt("return",{offers:n,allOffers:r,url:t});case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),fe=function(e,t){t=chrome.i18n.getUILanguage(),-1===["de","en","en","es","es","pl","pt","ru","uk"].indexOf(t)&&(t="en"),localStorage.country===e&&localStorage.language===t||(localStorage.country=e,localStorage.language=t,x(S(),!0))},he=function(){var e=t(i().mark((function e(t,r,n){var o,a,s,l,u=arguments;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=u.length>3&&void 0!==u[3]?u[3]:-1,s=u.length>4?u[4]:void 0,clearTimeout(te),r===re.AVAILABLE&&(n.length&&(N&&n[0].disableAssistant||!N&&!n[0].activeIconVisitingShopSite)?r=re.NEUTRAL:ue?(a=9,r=re.AVAILABLE_RED):r=re.AVAILABLE_YELLOW),!N){e.next=8;break}return s?l=Promise.resolve(s):(r!==re.NEUTRAL&&Z({action:"badge_displayed",category:"impression",badge_state:ne[r].toLowerCase()}),l=new Promise((function(e){c.browser.tabs.query({active:!0}).then((function(r){var n;e(null===(n=r.find((function(e){return e.id===t})))||void 0===n?void 0:n.windowId)}))}))),e.next=8,l.then((function(e){var t;e&&(s=e,null===(t=window.opr)||void 0===t||t.cashbackPrivate.setCashbackBadgeState(Number(s),ne[r]))}));case 8:!N&&(null===(o=c.browser.pageAction)||void 0===o||o.setIcon({tabId:t,path:{32:"icons/32/Icon_".concat(C()?"Dark":"Light","_").concat(r,".png")}}).catch(console.log)),a>-1&&(te=setTimeout((function(){return he(t,r===re.AVAILABLE_RED?re.AVAILABLE_YELLOW:re.AVAILABLE_RED,n,a-1,s)}),350));case 10:case"end":return e.stop()}}),e)})));return function(t,r,n){return e.apply(this,arguments)}}(),Ae=function(){var e=t(i().mark((function e(t){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",c.browser.tabs.executeScript(t,{code:"[window.____dify_cashback_injected,window.____dify_cashback_injected=true]"}).then((function(e){return e&&e[0]&&e[0][0]})).catch(console.log));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),we=function(){var e=t(i().mark((function e(t,r){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",c.browser.tabs.executeScript(t,{code:'[window.____dify_cashback_injected_url,window.____dify_cashback_injected_url="'.concat(r.href,'"]')}).then((function(e){return e&&e[0]&&e[0][0]?{injected:e[0][0]===r.href,shouldSendStats:!1}:{injected:!1,shouldSendStats:!0}})).catch(console.log));case 1:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}(),xe=function(e,t){if(t&&t.startsWith("http")){var r=new URL(t);r.hostname.indexOf("cashback.opera.com")>-1||r.hostname.indexOf("localhost")>-1?(Ae(e).then((function(t){t||c.browser.tabs.executeScript(e,{runAt:"document_start",file:"./content_getdify.js"}).catch(console.log)})),he(e,re.NEUTRAL,[])):pe(t).then((function(n){var o,a,s,i=n.offers,l=n.allOffers;if(s=Date.now(),o=function(e){return e.expire<s},a=!1,Object.keys(Q).forEach((function(e){o(Q[e])&&(a=!0,delete Q[e])})),a&&c.browser.storage.local.set({visitedCashbackList:Q}),ce=!i.length&&!le&&function(e){for(var t=e.host.split("."),r=t.length;r>1;r--)if(g.has(t.slice(-r).join(".")))return!0;return!1}(r),i.length||ce){var u=!1;i.forEach((function(e){var t=Q[e.offerId];t&&t.expire>Date.now()&&(u=!0,Q[e.offerId].first_visited=!0)})),u=ue&&u;var d=function(){he(e,u?re.ACTIVE:re.AVAILABLE,i)};P&&P.cashbackPrivate&&!N?c.browser.tabs.query({active:!0}).then((function(t){var r=t.find((function(t){return t.id===e}));r&&P.cashbackPrivate.getCashbackBadgeState(r.windowId,(function(t){var r=!0;switch(t){case P.cashbackPrivate.BadgeState.IDLE:case P.cashbackPrivate.BadgeState.WARNING:r=!1;case P.cashbackPrivate.BadgeState.ACTIVE:he(e,r?re.ACTIVE:re.AVAILABLE,i);break;case P.cashbackPrivate.BadgeState.DISABLED:d()}}))})):d(),N?we(e,r).then((function(n){if(n&&!n.injected&&l){n.shouldSendStats&&Z({action:ce?"competitor_page_visited":"supported_page_visited",category:"impression"});var o=i.reduce((function(e,t){return e||function(e,t,r){var n=!1;return t.checkoutPageDomains.forEach((function(o){var a,s=new URL(o);s.host===e.host&&(s.pathname===e.pathname||""!==s.hash&&s.hash===e.hash||""!==s.search&&s.search===e.search)&&((null===(a=r[t.offerId])||void 0===a?void 0:a.checkout_shown_expire)+y||0)<Date.now()&&(r[t.offerId]=J(J({},r[t.offerId]),{},{checkout_shown_expire:Date.now()+y}),n=!0)})),n}(r,t,Q)}),!1);c.browser.tabs.query({}).then((function(r){var n=r.find((function(t){return t.id===e})),a=n&&_e(i,l,t,e,n.windowId.toString());(o||function(e){var t;if(!N){var r=new URL(e.url),n=r.search.substr(1).split("&"),o=/cjevent/i,a=!1;if(n.forEach((function(e){var t=L(e.split("="),2),r=t[0],n=t[1];(o.test(r)||o.test(n))&&(a=!0)})),a&&!e.isActivated)return!1;if("ebay"===function(e){return e.split(".").splice(-2,1)[0].toLowerCase()}(r.host)){var s=!1,i=!1;if([e.url].concat(e.redirs).forEach((function(e){new URL(e).search.substr(1).split("&").forEach((function(e){var t=L(e.split("="),2),r=t[0],n=t[1];["mkevt","mkcid","campid"].includes(r)&&(i=!0),"campid"===r&&["5338944028","5338944027","5338930307","5338838092","5338837356","5338787428"].includes(n)&&(s=!0)}))})),i&&!s)return!1}}return Date.now()>(e.activated&&e.activated.closed_till||0)&&!(e.settingsForPage&&(e.settingsForPage[v.DONT_OPEN_ALL_SHOPS]||e.settingsForPage[v.DONT_OPEN_AGAIN]||e.settingsForPage[v.DONT_OPEN_AGAIN_TODAY]&&e.settingsForPage[v.DONT_OPEN_AGAIN_TODAY]>Date.now()))&&(N?!e.offer.disableAssistant:e.isActivated&&e.offer.showPopupCbActivated||!e.isActivated&&(null===(t=e.offer)||void 0===t?void 0:t.showPopupActivateCb))}(null==a?void 0:a.data))&&Ee(n.windowId,!1,o)}))}})):Ae(e).then((function(t){!t&&l&&(Z({action:ce?"competitor_page_visited":"supported_page_visited",category:"impression"}),c.browser.tabs.executeScript(e,{runAt:"document_start",code:'window.____dify_cashback_language="'.concat(localStorage.language,'";window.____dify_cashback_country="').concat(localStorage.country,'"')}).catch(console.log),c.browser.tabs.executeScript(e,{runAt:"document_start",file:"./content.js"}).catch(console.log))}))}else he(e,re.NEUTRAL,[])}))}else he(e,re.NEUTRAL,[])},ve=function(e,t){void 0!==t?c.browser.tabs.sendMessage(t,e).catch(console.log):c.browser.runtime.sendMessage(e).catch(console.log)},be=function(e){return(Q[e.offerId]||{expire:0}).expire},ye=function(e,r){void 0!==e?c.browser.tabs.get(e).then((function(t){pe(t.url).then((function(t){var r=t.offers,n=t.allOffers,o=t.url;ke(r,o,n||[],e)}))})):c.browser.tabs.query({active:!0}).then(function(){var e=t(i().mark((function e(t){var n,o,a;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=t[0].workspaceId,!N||!o){e.next=8;break}return e.next=4,new Promise((function(e){return opr.workspacesPrivate.getActiveWorkspaceId(Number(r),e)}));case 4:a=e.sent,n=t.find((function(e){return e.workspaceId===a.toString()&&e.windowId.toString()===r})),e.next=9;break;case 8:n=t[0];case 9:n&&pe(n.url).then((function(e){var t=e.offers,r=e.allOffers,o=e.url;ke(t,o,r||[],void 0,n.windowId.toString())}));case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())},_e=function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:void 0,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:void 0,a=e.length&&e.sort((function(e,t){return be(e)<be(t)?1:-1})).find((function(e){return Q[e.offerId]})),s=n&&de[n]?de[n].urls:[],i={type:b.OFFER_DATA,data:{offer:e.length&&e[0],allOffers:t,theme:C()?"dark":"light",activated:Object.assign({expire:0,closed_till:0,tabId:n,domains:[r]},a&&Q[a.offerId]),settingsForPage:Object.assign({dont_open_again:!1,dont_open_again_today:0,dont_open_all_shops:ge},e.length&&ee[e[0].offerId]),isActivated:ue&&!!a&&Q[a.offerId].expire>Date.now(),url:r,staging:S(),redirs:s,isUserLogged:ue,isUserLoggedBefore:le,manualPopup:se,checkoutPopup:ie,competitorPopup:ce,windowId:o}};return e.length&&le&&(Q[e[0].offerId]=J(J({},Q[e[0].offerId]||{}),{},{closed_till:Date.now()+36e5}),c.browser.storage.local.set({visitedCashbackList:Q})),i},ke=function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:void 0;ve(_e(e,r,t,n,arguments.length>4&&void 0!==arguments[4]?arguments[4]:void 0),n)},Ee=function(e){if(ie=arguments.length>2&&void 0!==arguments[2]&&arguments[2],!(se=!(arguments.length>1&&void 0!==arguments[1])||arguments[1])&&!le)if(ce){if(!(ae+864e5<Date.now()))return!1;ae=Date.now()}else{if(!(oe+864e5<Date.now()))return!1;oe=Date.now()}opr.cashbackPrivate.showPopup(e,le?40:280)},Se=function(){Z({category:"impression",action:"popup_closed"})},Ie=function(e,t){x(S()).then((function(r){var n=Q[e],o=null==r?void 0:r.find((function(t){return t.offerId===e}));Q[e]=J(J({},n||{}),{},{expire:Date.now()+36e5,domains:null==o?void 0:o.domains,tabId:t,closed_till:void 0,first_visited:!1}),c.browser.storage.local.set({visitedCashbackList:Q})}))},Oe=function(){var e=t(i().mark((function e(){var t,r,n,o,a,s,l;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(localStorage.country){e.next=14;break}if(a=["de","gb","us","es","mx","pl","br","ua"],s="pl",!N){e.next=9;break}return e.next=6,new Promise((function(e){opr.cashbackPrivate.getCountry(e)}));case 6:e.t0=e.sent.toLowerCase(),e.next=10;break;case 9:e.t0=s;case 10:l=e.t0,fe(a.indexOf(l)>-1?l:s,"en"),e.next=15;break;case 14:fe(localStorage.country,localStorage.language);case 15:x(S()),c.browser.runtime.onMessage.addListener((function(e,t){var r,n,o,a,s,i,l,u;switch(e.type){case b.FETCH_OFFER_DATA:ye(null===(r=t.tab)||void 0===r?void 0:r.id,null===(n=e.data)||void 0===n?void 0:n.windowId);break;case b.SET_STAGING:u=e.data.value,_=u,c.browser.storage.local.set({staging:u}),location.reload();break;case b.ACTIVATE_CASHBACK:Ie(e.data.offerId,null===(o=t.tab)||void 0===o?void 0:o.id);break;case b.GET_SETTINGS_FOR_PAGE:ve({type:b.SETTINGS_FOR_PAGE,data:Object.assign({dont_open_again:!1,dont_open_again_today:0,dont_open_all_shops:ge},ee[e.data.offerId])},null===(a=t.tab)||void 0===a?void 0:a.id);break;case b.SET_SETTINGS_FOR_PAGE:var g=e.data;for(var m in g.offerId&&(ee[g.offerId]=ee[g.offerId]||{}),g)switch(m){case v.DONT_OPEN_AGAIN_TODAY:ee[g.offerId][m]=(g.dont_open_again_today||0)>0?Date.now()+864e5:void 0;break;case v.DONT_OPEN_AGAIN:ee[g.offerId][m]=g[m];break;case v.DONT_OPEN_ALL_SHOPS:ge=!!g[m],c.browser.storage.local.set({disableAllPopups:ge})}c.browser.storage.local.set({pageSettings:ee}),ye(null===(s=t.tab)||void 0===s?void 0:s.id,g.windowId);break;case b.IS_LOGGED:l=!!e.data.logged,ue=l,c.browser.storage.local.set({isUserLogged:ue}),!le&&l&&(le=!0,c.browser.storage.local.set({isUserLoggedBefore:le}));break;case b.SEND_STATS:Z(J({},e.data));break;case b.GET_VERSION:ve({type:b.VERSION,data:{version:d}},null===(i=t.tab)||void 0===i?void 0:i.id);break;case b.SET_LANGUAGE:var p=e.data;fe(p.country,p.language)}})),c.browser.tabs.onCreated.addListener((function(e){var t;e.id&&(!N&&(null===(t=c.browser.pageAction)||void 0===t||t.show(e.id)),xe(e.id,e.url))})),N&&(null===(t=window.opr.cashbackPrivate)||void 0===t||null===(r=t.onCashbackButtonPressed)||void 0===r||r.addListener(Ee)),N&&(null===(n=window.opr.cashbackPrivate)||void 0===n||null===(o=n.onCashbackPopupClosed)||void 0===o||o.addListener(Se)),c.browser.tabs.onUpdated.addListener((function(e,t,r){var n;"complete"===t.status&&(!N&&(null===(n=c.browser.pageAction)||void 0===n||n.show(e)),xe(e,r.url))})),c.browser.tabs.onActivated.addListener((function(e){var t;!N&&(null===(t=c.browser.pageAction)||void 0===t||t.show(e.tabId)),c.browser.tabs.get(e.tabId).then((function(t){xe(e.tabId,t.url)}))})),!N&&c.browser.runtime.setUninstallURL("".concat(I(),"?extensionUninstalled=1&cid=").concat(encodeURIComponent(T))),c.browser.tabs.query({}).then((function(e){N||e.forEach((function(e){var t;return null===(t=c.browser.pageAction)||void 0===t?void 0:t.show(e.id)}))})),c.browser.webRequest.onHeadersReceived.addListener((function(e){if(de[e.tabId]&&de[e.tabId].requestId===e.requestId){de[e.tabId].urls.push(e.url);var t=new URL(de[e.tabId].urls[0]),r=new URL(e.url),n=t.searchParams.get("offerId"),o=I();0===o.indexOf(t.origin)&&0!==o.indexOf(r.origin)&&n&&Ie(n)}else de[e.tabId]={urls:[e.url],requestId:e.requestId}}),{urls:["*://*/*"],types:["main_frame"]});case 25:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();c.browser.storage.local.get().then((function(e){Q=e.visitedCashbackList||{},ee=e.pageSettings||{},ue=e.isUserLogged,le=e.isUserLoggedBefore,ge=e.disableAllPopups,Oe()}))})()})();