/*! For license information please see content-script.js.LICENSE.txt */
(()=>{var e={2262:(e,t,n)=>{"use strict";n.d(t,{Bj:()=>r,Fl:()=>Pe,IU:()=>ke,Jd:()=>w,PG:()=>ve,Um:()=>fe,WL:()=>Ce,X$:()=>x,X3:()=>we,Xl:()=>Se,dq:()=>$e,iH:()=>Ne,j:()=>S,lk:()=>k,nZ:()=>a,qj:()=>me,qq:()=>y,yT:()=>_e});var i=n(3577);let s;class r{constructor(e=!1){this.detached=e,this._active=!0,this.effects=[],this.cleanups=[],this.parent=s,!e&&s&&(this.index=(s.scopes||(s.scopes=[])).push(this)-1)}get active(){return this._active}run(e){if(this._active){const t=s;try{return s=this,e()}finally{s=t}}}on(){s=this}off(){s=this.parent}stop(e){if(this._active){let t,n;for(t=0,n=this.effects.length;t<n;t++)this.effects[t].stop();for(t=0,n=this.cleanups.length;t<n;t++)this.cleanups[t]();if(this.scopes)for(t=0,n=this.scopes.length;t<n;t++)this.scopes[t].stop(!0);if(!this.detached&&this.parent&&!e){const e=this.parent.scopes.pop();e&&e!==this&&(this.parent.scopes[this.index]=e,e.index=this.index)}this.parent=void 0,this._active=!1}}}function a(){return s}const o=e=>{const t=new Set(e);return t.w=0,t.n=0,t},l=e=>(e.w&d)>0,c=e=>(e.n&d)>0,u=new WeakMap;let h=0,d=1;const p=30;let m;const f=Symbol(""),g=Symbol("");class y{constructor(e,t=null,n){this.fn=e,this.scheduler=t,this.active=!0,this.deps=[],this.parent=void 0,function(e,t=s){t&&t.active&&t.effects.push(e)}(this,n)}run(){if(!this.active)return this.fn();let e=m,t=b;for(;e;){if(e===this)return;e=e.parent}try{return this.parent=m,m=this,b=!0,d=1<<++h,h<=p?(({deps:e})=>{if(e.length)for(let t=0;t<e.length;t++)e[t].w|=d})(this):v(this),this.fn()}finally{h<=p&&(e=>{const{deps:t}=e;if(t.length){let n=0;for(let i=0;i<t.length;i++){const s=t[i];l(s)&&!c(s)?s.delete(e):t[n++]=s,s.w&=~d,s.n&=~d}t.length=n}})(this),d=1<<--h,m=this.parent,b=t,this.parent=void 0,this.deferStop&&this.stop()}}stop(){m===this?this.deferStop=!0:this.active&&(v(this),this.onStop&&this.onStop(),this.active=!1)}}function v(e){const{deps:t}=e;if(t.length){for(let n=0;n<t.length;n++)t[n].delete(e);t.length=0}}let b=!0;const _=[];function w(){_.push(b),b=!1}function k(){const e=_.pop();b=void 0===e||e}function S(e,t,n){if(b&&m){let t=u.get(e);t||u.set(e,t=new Map);let i=t.get(n);i||t.set(n,i=o()),E(i)}}function E(e,t){let n=!1;h<=p?c(e)||(e.n|=d,n=!l(e)):n=!e.has(m),n&&(e.add(m),m.deps.push(e))}function x(e,t,n,s,r,a){const l=u.get(e);if(!l)return;let c=[];if("clear"===t)c=[...l.values()];else if("length"===n&&(0,i.kJ)(e)){const e=Number(s);l.forEach(((t,n)=>{("length"===n||n>=e)&&c.push(t)}))}else switch(void 0!==n&&c.push(l.get(n)),t){case"add":(0,i.kJ)(e)?(0,i.S0)(n)&&c.push(l.get("length")):(c.push(l.get(f)),(0,i._N)(e)&&c.push(l.get(g)));break;case"delete":(0,i.kJ)(e)||(c.push(l.get(f)),(0,i._N)(e)&&c.push(l.get(g)));break;case"set":(0,i._N)(e)&&c.push(l.get(f))}if(1===c.length)c[0]&&I(c[0]);else{const e=[];for(const t of c)t&&e.push(...t);I(o(e))}}function I(e,t){const n=(0,i.kJ)(e)?e:[...e];for(const e of n)e.computed&&T(e);for(const e of n)e.computed||T(e)}function T(e,t){(e!==m||e.allowRecurse)&&(e.scheduler?e.scheduler():e.run())}const $=(0,i.fY)("__proto__,__v_isRef,__isVue"),N=new Set(Object.getOwnPropertyNames(Symbol).filter((e=>"arguments"!==e&&"caller"!==e)).map((e=>Symbol[e])).filter(i.yk)),O=M(),L=M(!1,!0),C=M(!0),A=P();function P(){const e={};return["includes","indexOf","lastIndexOf"].forEach((t=>{e[t]=function(...e){const n=ke(this);for(let e=0,t=this.length;e<t;e++)S(n,0,e+"");const i=n[t](...e);return-1===i||!1===i?n[t](...e.map(ke)):i}})),["push","pop","shift","unshift","splice"].forEach((t=>{e[t]=function(...e){w();const n=ke(this)[t].apply(this,e);return k(),n}})),e}function R(e){const t=ke(this);return S(t,0,e),t.hasOwnProperty(e)}function M(e=!1,t=!1){return function(n,s,r){if("__v_isReactive"===s)return!e;if("__v_isReadonly"===s)return e;if("__v_isShallow"===s)return t;if("__v_raw"===s&&r===(e?t?pe:de:t?he:ue).get(n))return n;const a=(0,i.kJ)(n);if(!e){if(a&&(0,i.RI)(A,s))return Reflect.get(A,s,r);if("hasOwnProperty"===s)return R}const o=Reflect.get(n,s,r);return((0,i.yk)(s)?N.has(s):$(s))?o:(e||S(n,0,s),t?o:$e(o)?a&&(0,i.S0)(s)?o:o.value:(0,i.Kn)(o)?e?ge(o):me(o):o)}}const U=D(),j=D(!0);function D(e=!1){return function(t,n,s,r){let a=t[n];if(be(a)&&$e(a)&&!$e(s))return!1;if(!e&&(_e(s)||be(s)||(a=ke(a),s=ke(s)),!(0,i.kJ)(t)&&$e(a)&&!$e(s)))return a.value=s,!0;const o=(0,i.kJ)(t)&&(0,i.S0)(n)?Number(n)<t.length:(0,i.RI)(t,n),l=Reflect.set(t,n,s,r);return t===ke(r)&&(o?(0,i.aU)(s,a)&&x(t,"set",n,s):x(t,"add",n,s)),l}}const F={get:O,set:U,deleteProperty:function(e,t){const n=(0,i.RI)(e,t),s=(e[t],Reflect.deleteProperty(e,t));return s&&n&&x(e,"delete",t,void 0),s},has:function(e,t){const n=Reflect.has(e,t);return(0,i.yk)(t)&&N.has(t)||S(e,0,t),n},ownKeys:function(e){return S(e,0,(0,i.kJ)(e)?"length":f),Reflect.ownKeys(e)}},V={get:C,set:(e,t)=>!0,deleteProperty:(e,t)=>!0},z=(0,i.l7)({},F,{get:L,set:j}),H=e=>e,B=e=>Reflect.getPrototypeOf(e);function W(e,t,n=!1,i=!1){const s=ke(e=e.__v_raw),r=ke(t);n||(t!==r&&S(s,0,t),S(s,0,r));const{has:a}=B(s),o=i?H:n?xe:Ee;return a.call(s,t)?o(e.get(t)):a.call(s,r)?o(e.get(r)):void(e!==s&&e.get(t))}function K(e,t=!1){const n=this.__v_raw,i=ke(n),s=ke(e);return t||(e!==s&&S(i,0,e),S(i,0,s)),e===s?n.has(e):n.has(e)||n.has(s)}function G(e,t=!1){return e=e.__v_raw,!t&&S(ke(e),0,f),Reflect.get(e,"size",e)}function q(e){e=ke(e);const t=ke(this);return B(t).has.call(t,e)||(t.add(e),x(t,"add",e,e)),this}function J(e,t){t=ke(t);const n=ke(this),{has:s,get:r}=B(n);let a=s.call(n,e);a||(e=ke(e),a=s.call(n,e));const o=r.call(n,e);return n.set(e,t),a?(0,i.aU)(t,o)&&x(n,"set",e,t):x(n,"add",e,t),this}function X(e){const t=ke(this),{has:n,get:i}=B(t);let s=n.call(t,e);s||(e=ke(e),s=n.call(t,e)),i&&i.call(t,e);const r=t.delete(e);return s&&x(t,"delete",e,void 0),r}function Y(){const e=ke(this),t=0!==e.size,n=e.clear();return t&&x(e,"clear",void 0,void 0),n}function Z(e,t){return function(n,i){const s=this,r=s.__v_raw,a=ke(r),o=t?H:e?xe:Ee;return!e&&S(a,0,f),r.forEach(((e,t)=>n.call(i,o(e),o(t),s)))}}function Q(e,t,n){return function(...s){const r=this.__v_raw,a=ke(r),o=(0,i._N)(a),l="entries"===e||e===Symbol.iterator&&o,c="keys"===e&&o,u=r[e](...s),h=n?H:t?xe:Ee;return!t&&S(a,0,c?g:f),{next(){const{value:e,done:t}=u.next();return t?{value:e,done:t}:{value:l?[h(e[0]),h(e[1])]:h(e),done:t}},[Symbol.iterator](){return this}}}}function ee(e){return function(...t){return"delete"!==e&&this}}function te(){const e={get(e){return W(this,e)},get size(){return G(this)},has:K,add:q,set:J,delete:X,clear:Y,forEach:Z(!1,!1)},t={get(e){return W(this,e,!1,!0)},get size(){return G(this)},has:K,add:q,set:J,delete:X,clear:Y,forEach:Z(!1,!0)},n={get(e){return W(this,e,!0)},get size(){return G(this,!0)},has(e){return K.call(this,e,!0)},add:ee("add"),set:ee("set"),delete:ee("delete"),clear:ee("clear"),forEach:Z(!0,!1)},i={get(e){return W(this,e,!0,!0)},get size(){return G(this,!0)},has(e){return K.call(this,e,!0)},add:ee("add"),set:ee("set"),delete:ee("delete"),clear:ee("clear"),forEach:Z(!0,!0)};return["keys","values","entries",Symbol.iterator].forEach((s=>{e[s]=Q(s,!1,!1),n[s]=Q(s,!0,!1),t[s]=Q(s,!1,!0),i[s]=Q(s,!0,!0)})),[e,n,t,i]}const[ne,ie,se,re]=te();function ae(e,t){const n=t?e?re:se:e?ie:ne;return(t,s,r)=>"__v_isReactive"===s?!e:"__v_isReadonly"===s?e:"__v_raw"===s?t:Reflect.get((0,i.RI)(n,s)&&s in t?n:t,s,r)}const oe={get:ae(!1,!1)},le={get:ae(!1,!0)},ce={get:ae(!0,!1)},ue=new WeakMap,he=new WeakMap,de=new WeakMap,pe=new WeakMap;function me(e){return be(e)?e:ye(e,!1,F,oe,ue)}function fe(e){return ye(e,!1,z,le,he)}function ge(e){return ye(e,!0,V,ce,de)}function ye(e,t,n,s,r){if(!(0,i.Kn)(e))return e;if(e.__v_raw&&(!t||!e.__v_isReactive))return e;const a=r.get(e);if(a)return a;const o=function(e){return e.__v_skip||!Object.isExtensible(e)?0:function(e){switch(e){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}((0,i.W7)(e))}(e);if(0===o)return e;const l=new Proxy(e,2===o?s:n);return r.set(e,l),l}function ve(e){return be(e)?ve(e.__v_raw):!(!e||!e.__v_isReactive)}function be(e){return!(!e||!e.__v_isReadonly)}function _e(e){return!(!e||!e.__v_isShallow)}function we(e){return ve(e)||be(e)}function ke(e){const t=e&&e.__v_raw;return t?ke(t):e}function Se(e){return(0,i.Nj)(e,"__v_skip",!0),e}const Ee=e=>(0,i.Kn)(e)?me(e):e,xe=e=>(0,i.Kn)(e)?ge(e):e;function Ie(e){b&&m&&E((e=ke(e)).dep||(e.dep=o()))}function Te(e,t){const n=(e=ke(e)).dep;n&&I(n)}function $e(e){return!(!e||!0!==e.__v_isRef)}function Ne(e){return n=!1,$e(t=e)?t:new Oe(t,n);var t,n}class Oe{constructor(e,t){this.__v_isShallow=t,this.dep=void 0,this.__v_isRef=!0,this._rawValue=t?e:ke(e),this._value=t?e:Ee(e)}get value(){return Ie(this),this._value}set value(e){const t=this.__v_isShallow||_e(e)||be(e);e=t?e:ke(e),(0,i.aU)(e,this._rawValue)&&(this._rawValue=e,this._value=t?e:Ee(e),Te(this))}}const Le={get:(e,t,n)=>{return $e(i=Reflect.get(e,t,n))?i.value:i;var i},set:(e,t,n,i)=>{const s=e[t];return $e(s)&&!$e(n)?(s.value=n,!0):Reflect.set(e,t,n,i)}};function Ce(e){return ve(e)?e:new Proxy(e,Le)}class Ae{constructor(e,t,n,i){this._setter=t,this.dep=void 0,this.__v_isRef=!0,this.__v_isReadonly=!1,this._dirty=!0,this.effect=new y(e,(()=>{this._dirty||(this._dirty=!0,Te(this))})),this.effect.computed=this,this.effect.active=this._cacheable=!i,this.__v_isReadonly=n}get value(){const e=ke(this);return Ie(e),!e._dirty&&e._cacheable||(e._dirty=!1,e._value=e.effect.run()),e._value}set value(e){this._setter(e)}}function Pe(e,t,n=!1){let s,r;const a=(0,i.mf)(e);return a?(s=e,r=i.dG):(s=e.get,r=e.set),new Ae(s,r,a||!r,n)}},3577:(e,t,n)=>{"use strict";function i(e,t){const n=Object.create(null),i=e.split(",");for(let e=0;e<i.length;e++)n[i[e]]=!0;return t?e=>!!n[e.toLowerCase()]:e=>!!n[e]}n.d(t,{C_:()=>Y,DM:()=>y,E9:()=>B,F7:()=>c,Gg:()=>O,HD:()=>w,He:()=>z,Kj:()=>b,Kn:()=>S,NO:()=>o,Nj:()=>F,Od:()=>d,PO:()=>$,Pq:()=>Z,RI:()=>m,S0:()=>N,W7:()=>T,WV:()=>ee,Z6:()=>r,_A:()=>A,_N:()=>g,aU:()=>j,dG:()=>a,e1:()=>W,fY:()=>i,h5:()=>V,hR:()=>U,hq:()=>te,ir:()=>D,j5:()=>K,kC:()=>M,kJ:()=>f,kT:()=>s,l7:()=>h,mf:()=>_,rs:()=>R,tI:()=>E,tR:()=>u,yA:()=>Q,yk:()=>k,zw:()=>ne});const s={},r=[],a=()=>{},o=()=>!1,l=/^on[^a-z]/,c=e=>l.test(e),u=e=>e.startsWith("onUpdate:"),h=Object.assign,d=(e,t)=>{const n=e.indexOf(t);n>-1&&e.splice(n,1)},p=Object.prototype.hasOwnProperty,m=(e,t)=>p.call(e,t),f=Array.isArray,g=e=>"[object Map]"===I(e),y=e=>"[object Set]"===I(e),v=e=>"[object Date]"===I(e),b=e=>"[object RegExp]"===I(e),_=e=>"function"==typeof e,w=e=>"string"==typeof e,k=e=>"symbol"==typeof e,S=e=>null!==e&&"object"==typeof e,E=e=>S(e)&&_(e.then)&&_(e.catch),x=Object.prototype.toString,I=e=>x.call(e),T=e=>I(e).slice(8,-1),$=e=>"[object Object]"===I(e),N=e=>w(e)&&"NaN"!==e&&"-"!==e[0]&&""+parseInt(e,10)===e,O=i(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),L=e=>{const t=Object.create(null);return n=>t[n]||(t[n]=e(n))},C=/-(\w)/g,A=L((e=>e.replace(C,((e,t)=>t?t.toUpperCase():"")))),P=/\B([A-Z])/g,R=L((e=>e.replace(P,"-$1").toLowerCase())),M=L((e=>e.charAt(0).toUpperCase()+e.slice(1))),U=L((e=>e?`on${M(e)}`:"")),j=(e,t)=>!Object.is(e,t),D=(e,t)=>{for(let n=0;n<e.length;n++)e[n](t)},F=(e,t,n)=>{Object.defineProperty(e,t,{configurable:!0,enumerable:!1,value:n})},V=e=>{const t=parseFloat(e);return isNaN(t)?e:t},z=e=>{const t=w(e)?Number(e):NaN;return isNaN(t)?e:t};let H;const B=()=>H||(H="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==n.g?n.g:{}),W=i("Infinity,undefined,NaN,isFinite,isNaN,parseFloat,parseInt,decodeURI,decodeURIComponent,encodeURI,encodeURIComponent,Math,Number,Date,Array,Object,Boolean,String,RegExp,Map,Set,JSON,Intl,BigInt,console");function K(e){if(f(e)){const t={};for(let n=0;n<e.length;n++){const i=e[n],s=w(i)?X(i):K(i);if(s)for(const e in s)t[e]=s[e]}return t}return w(e)||S(e)?e:void 0}const G=/;(?![^(]*\))/g,q=/:([^]+)/,J=/\/\*[^]*?\*\//g;function X(e){const t={};return e.replace(J,"").split(G).forEach((e=>{if(e){const n=e.split(q);n.length>1&&(t[n[0].trim()]=n[1].trim())}})),t}function Y(e){let t="";if(w(e))t=e;else if(f(e))for(let n=0;n<e.length;n++){const i=Y(e[n]);i&&(t+=i+" ")}else if(S(e))for(const n in e)e[n]&&(t+=n+" ");return t.trim()}const Z=i("itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly");function Q(e){return!!e||""===e}function ee(e,t){if(e===t)return!0;let n=v(e),i=v(t);if(n||i)return!(!n||!i)&&e.getTime()===t.getTime();if(n=k(e),i=k(t),n||i)return e===t;if(n=f(e),i=f(t),n||i)return!(!n||!i)&&function(e,t){if(e.length!==t.length)return!1;let n=!0;for(let i=0;n&&i<e.length;i++)n=ee(e[i],t[i]);return n}(e,t);if(n=S(e),i=S(t),n||i){if(!n||!i)return!1;if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const n in e){const i=e.hasOwnProperty(n),s=t.hasOwnProperty(n);if(i&&!s||!i&&s||!ee(e[n],t[n]))return!1}}return String(e)===String(t)}function te(e,t){return e.findIndex((e=>ee(e,t)))}const ne=e=>w(e)?e:null==e?"":f(e)||S(e)&&(e.toString===x||!_(e.toString))?JSON.stringify(e,ie,2):String(e),ie=(e,t)=>t&&t.__v_isRef?ie(e,t.value):g(t)?{[`Map(${t.size})`]:[...t.entries()].reduce(((e,[t,n])=>(e[`${t} =>`]=n,e)),{})}:y(t)?{[`Set(${t.size})`]:[...t.values()]}:!S(t)||f(t)||$(t)?t:String(t)},27856:function(e){e.exports=function(){"use strict";const{entries:e,setPrototypeOf:t,isFrozen:n,getPrototypeOf:i,getOwnPropertyDescriptor:s}=Object;let{freeze:r,seal:a,create:o}=Object,{apply:l,construct:c}="undefined"!=typeof Reflect&&Reflect;l||(l=function(e,t,n){return e.apply(t,n)}),r||(r=function(e){return e}),a||(a=function(e){return e}),c||(c=function(e,t){return new e(...t)});const u=k(Array.prototype.forEach),h=k(Array.prototype.pop),d=k(Array.prototype.push),p=k(String.prototype.toLowerCase),m=k(String.prototype.toString),f=k(String.prototype.match),g=k(String.prototype.replace),y=k(String.prototype.indexOf),v=k(String.prototype.trim),b=k(RegExp.prototype.test),_=(w=TypeError,function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return c(w,t)});var w;function k(e){return function(t){for(var n=arguments.length,i=new Array(n>1?n-1:0),s=1;s<n;s++)i[s-1]=arguments[s];return l(e,t,i)}}function S(e,i,s){var r;s=null!==(r=s)&&void 0!==r?r:p,t&&t(e,null);let a=i.length;for(;a--;){let t=i[a];if("string"==typeof t){const e=s(t);e!==t&&(n(i)||(i[a]=e),t=e)}e[t]=!0}return e}function E(t){const n=o(null);for(const[i,s]of e(t))n[i]=s;return n}function x(e,t){for(;null!==e;){const n=s(e,t);if(n){if(n.get)return k(n.get);if("function"==typeof n.value)return k(n.value)}e=i(e)}return function(e){return console.warn("fallback value for",e),null}}const I=r(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),T=r(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),$=r(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),N=r(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),O=r(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),L=r(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),C=r(["#text"]),A=r(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns","slot"]),P=r(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),R=r(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),M=r(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),U=a(/\{\{[\w\W]*|[\w\W]*\}\}/gm),j=a(/<%[\w\W]*|[\w\W]*%>/gm),D=a(/\${[\w\W]*}/gm),F=a(/^data-[\-\w.\u00B7-\uFFFF]/),V=a(/^aria-[\-\w]+$/),z=a(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),H=a(/^(?:\w+script|data):/i),B=a(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),W=a(/^html$/i);var K=Object.freeze({__proto__:null,MUSTACHE_EXPR:U,ERB_EXPR:j,TMPLIT_EXPR:D,DATA_ATTR:F,ARIA_ATTR:V,IS_ALLOWED_URI:z,IS_SCRIPT_OR_DATA:H,ATTR_WHITESPACE:B,DOCTYPE_NAME:W});const G=()=>"undefined"==typeof window?null:window;return function t(){let n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:G();const i=e=>t(e);if(i.version="3.0.3",i.removed=[],!n||!n.document||9!==n.document.nodeType)return i.isSupported=!1,i;const s=n.document,a=s.currentScript;let{document:o}=n;const{DocumentFragment:l,HTMLTemplateElement:c,Node:w,Element:k,NodeFilter:U,NamedNodeMap:j=n.NamedNodeMap||n.MozNamedAttrMap,HTMLFormElement:D,DOMParser:F,trustedTypes:V}=n,H=k.prototype,B=x(H,"cloneNode"),q=x(H,"nextSibling"),J=x(H,"childNodes"),X=x(H,"parentNode");if("function"==typeof c){const e=o.createElement("template");e.content&&e.content.ownerDocument&&(o=e.content.ownerDocument)}let Y,Z="";const{implementation:Q,createNodeIterator:ee,createDocumentFragment:te,getElementsByTagName:ne}=o,{importNode:ie}=s;let se={};i.isSupported="function"==typeof e&&"function"==typeof X&&Q&&void 0!==Q.createHTMLDocument;const{MUSTACHE_EXPR:re,ERB_EXPR:ae,TMPLIT_EXPR:oe,DATA_ATTR:le,ARIA_ATTR:ce,IS_SCRIPT_OR_DATA:ue,ATTR_WHITESPACE:he}=K;let{IS_ALLOWED_URI:de}=K,pe=null;const me=S({},[...I,...T,...$,...O,...C]);let fe=null;const ge=S({},[...A,...P,...R,...M]);let ye=Object.seal(Object.create(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),ve=null,be=null,_e=!0,we=!0,ke=!1,Se=!0,Ee=!1,xe=!1,Ie=!1,Te=!1,$e=!1,Ne=!1,Oe=!1,Le=!0,Ce=!1,Ae=!0,Pe=!1,Re={},Me=null;const Ue=S({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let je=null;const De=S({},["audio","video","img","source","image","track"]);let Fe=null;const Ve=S({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),ze="http://www.w3.org/1998/Math/MathML",He="http://www.w3.org/2000/svg",Be="http://www.w3.org/1999/xhtml";let We=Be,Ke=!1,Ge=null;const qe=S({},[ze,He,Be],m);let Je;const Xe=["application/xhtml+xml","text/html"];let Ye,Ze=null;const Qe=o.createElement("form"),et=function(e){return e instanceof RegExp||e instanceof Function},tt=function(e){if(!Ze||Ze!==e){if(e&&"object"==typeof e||(e={}),e=E(e),Je=Je=-1===Xe.indexOf(e.PARSER_MEDIA_TYPE)?"text/html":e.PARSER_MEDIA_TYPE,Ye="application/xhtml+xml"===Je?m:p,pe="ALLOWED_TAGS"in e?S({},e.ALLOWED_TAGS,Ye):me,fe="ALLOWED_ATTR"in e?S({},e.ALLOWED_ATTR,Ye):ge,Ge="ALLOWED_NAMESPACES"in e?S({},e.ALLOWED_NAMESPACES,m):qe,Fe="ADD_URI_SAFE_ATTR"in e?S(E(Ve),e.ADD_URI_SAFE_ATTR,Ye):Ve,je="ADD_DATA_URI_TAGS"in e?S(E(De),e.ADD_DATA_URI_TAGS,Ye):De,Me="FORBID_CONTENTS"in e?S({},e.FORBID_CONTENTS,Ye):Ue,ve="FORBID_TAGS"in e?S({},e.FORBID_TAGS,Ye):{},be="FORBID_ATTR"in e?S({},e.FORBID_ATTR,Ye):{},Re="USE_PROFILES"in e&&e.USE_PROFILES,_e=!1!==e.ALLOW_ARIA_ATTR,we=!1!==e.ALLOW_DATA_ATTR,ke=e.ALLOW_UNKNOWN_PROTOCOLS||!1,Se=!1!==e.ALLOW_SELF_CLOSE_IN_ATTR,Ee=e.SAFE_FOR_TEMPLATES||!1,xe=e.WHOLE_DOCUMENT||!1,$e=e.RETURN_DOM||!1,Ne=e.RETURN_DOM_FRAGMENT||!1,Oe=e.RETURN_TRUSTED_TYPE||!1,Te=e.FORCE_BODY||!1,Le=!1!==e.SANITIZE_DOM,Ce=e.SANITIZE_NAMED_PROPS||!1,Ae=!1!==e.KEEP_CONTENT,Pe=e.IN_PLACE||!1,de=e.ALLOWED_URI_REGEXP||z,We=e.NAMESPACE||Be,ye=e.CUSTOM_ELEMENT_HANDLING||{},e.CUSTOM_ELEMENT_HANDLING&&et(e.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(ye.tagNameCheck=e.CUSTOM_ELEMENT_HANDLING.tagNameCheck),e.CUSTOM_ELEMENT_HANDLING&&et(e.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(ye.attributeNameCheck=e.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),e.CUSTOM_ELEMENT_HANDLING&&"boolean"==typeof e.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements&&(ye.allowCustomizedBuiltInElements=e.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),Ee&&(we=!1),Ne&&($e=!0),Re&&(pe=S({},[...C]),fe=[],!0===Re.html&&(S(pe,I),S(fe,A)),!0===Re.svg&&(S(pe,T),S(fe,P),S(fe,M)),!0===Re.svgFilters&&(S(pe,$),S(fe,P),S(fe,M)),!0===Re.mathMl&&(S(pe,O),S(fe,R),S(fe,M))),e.ADD_TAGS&&(pe===me&&(pe=E(pe)),S(pe,e.ADD_TAGS,Ye)),e.ADD_ATTR&&(fe===ge&&(fe=E(fe)),S(fe,e.ADD_ATTR,Ye)),e.ADD_URI_SAFE_ATTR&&S(Fe,e.ADD_URI_SAFE_ATTR,Ye),e.FORBID_CONTENTS&&(Me===Ue&&(Me=E(Me)),S(Me,e.FORBID_CONTENTS,Ye)),Ae&&(pe["#text"]=!0),xe&&S(pe,["html","head","body"]),pe.table&&(S(pe,["tbody"]),delete ve.tbody),e.TRUSTED_TYPES_POLICY){if("function"!=typeof e.TRUSTED_TYPES_POLICY.createHTML)throw _('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if("function"!=typeof e.TRUSTED_TYPES_POLICY.createScriptURL)throw _('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');Y=e.TRUSTED_TYPES_POLICY,Z=Y.createHTML("")}else void 0===Y&&(Y=function(e,t){if("object"!=typeof e||"function"!=typeof e.createPolicy)return null;let n=null;const i="data-tt-policy-suffix";t&&t.hasAttribute(i)&&(n=t.getAttribute(i));const s="dompurify"+(n?"#"+n:"");try{return e.createPolicy(s,{createHTML:e=>e,createScriptURL:e=>e})}catch(e){return console.warn("TrustedTypes policy "+s+" could not be created."),null}}(V,a)),null!==Y&&"string"==typeof Z&&(Z=Y.createHTML(""));r&&r(e),Ze=e}},nt=S({},["mi","mo","mn","ms","mtext"]),it=S({},["foreignobject","desc","title","annotation-xml"]),st=S({},["title","style","font","a","script"]),rt=S({},T);S(rt,$),S(rt,N);const at=S({},O);S(at,L);const ot=function(e){d(i.removed,{element:e});try{e.parentNode.removeChild(e)}catch(t){e.remove()}},lt=function(e,t){try{d(i.removed,{attribute:t.getAttributeNode(e),from:t})}catch(e){d(i.removed,{attribute:null,from:t})}if(t.removeAttribute(e),"is"===e&&!fe[e])if($e||Ne)try{ot(t)}catch(e){}else try{t.setAttribute(e,"")}catch(e){}},ct=function(e){let t,n;if(Te)e="<remove></remove>"+e;else{const t=f(e,/^[\r\n\t ]+/);n=t&&t[0]}"application/xhtml+xml"===Je&&We===Be&&(e='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+e+"</body></html>");const i=Y?Y.createHTML(e):e;if(We===Be)try{t=(new F).parseFromString(i,Je)}catch(e){}if(!t||!t.documentElement){t=Q.createDocument(We,"template",null);try{t.documentElement.innerHTML=Ke?Z:i}catch(e){}}const s=t.body||t.documentElement;return e&&n&&s.insertBefore(o.createTextNode(n),s.childNodes[0]||null),We===Be?ne.call(t,xe?"html":"body")[0]:xe?t.documentElement:s},ut=function(e){return ee.call(e.ownerDocument||e,e,U.SHOW_ELEMENT|U.SHOW_COMMENT|U.SHOW_TEXT,null,!1)},ht=function(e){return"object"==typeof w?e instanceof w:e&&"object"==typeof e&&"number"==typeof e.nodeType&&"string"==typeof e.nodeName},dt=function(e,t,n){se[e]&&u(se[e],(e=>{e.call(i,t,n,Ze)}))},pt=function(e){let t;if(dt("beforeSanitizeElements",e,null),(n=e)instanceof D&&("string"!=typeof n.nodeName||"string"!=typeof n.textContent||"function"!=typeof n.removeChild||!(n.attributes instanceof j)||"function"!=typeof n.removeAttribute||"function"!=typeof n.setAttribute||"string"!=typeof n.namespaceURI||"function"!=typeof n.insertBefore||"function"!=typeof n.hasChildNodes))return ot(e),!0;var n;const s=Ye(e.nodeName);if(dt("uponSanitizeElement",e,{tagName:s,allowedTags:pe}),e.hasChildNodes()&&!ht(e.firstElementChild)&&(!ht(e.content)||!ht(e.content.firstElementChild))&&b(/<[/\w]/g,e.innerHTML)&&b(/<[/\w]/g,e.textContent))return ot(e),!0;if(!pe[s]||ve[s]){if(!ve[s]&&ft(s)){if(ye.tagNameCheck instanceof RegExp&&b(ye.tagNameCheck,s))return!1;if(ye.tagNameCheck instanceof Function&&ye.tagNameCheck(s))return!1}if(Ae&&!Me[s]){const t=X(e)||e.parentNode,n=J(e)||e.childNodes;if(n&&t)for(let i=n.length-1;i>=0;--i)t.insertBefore(B(n[i],!0),q(e))}return ot(e),!0}return e instanceof k&&!function(e){let t=X(e);t&&t.tagName||(t={namespaceURI:We,tagName:"template"});const n=p(e.tagName),i=p(t.tagName);return!!Ge[e.namespaceURI]&&(e.namespaceURI===He?t.namespaceURI===Be?"svg"===n:t.namespaceURI===ze?"svg"===n&&("annotation-xml"===i||nt[i]):Boolean(rt[n]):e.namespaceURI===ze?t.namespaceURI===Be?"math"===n:t.namespaceURI===He?"math"===n&&it[i]:Boolean(at[n]):e.namespaceURI===Be?!(t.namespaceURI===He&&!it[i])&&!(t.namespaceURI===ze&&!nt[i])&&!at[n]&&(st[n]||!rt[n]):!("application/xhtml+xml"!==Je||!Ge[e.namespaceURI]))}(e)?(ot(e),!0):"noscript"!==s&&"noembed"!==s||!b(/<\/no(script|embed)/i,e.innerHTML)?(Ee&&3===e.nodeType&&(t=e.textContent,t=g(t,re," "),t=g(t,ae," "),t=g(t,oe," "),e.textContent!==t&&(d(i.removed,{element:e.cloneNode()}),e.textContent=t)),dt("afterSanitizeElements",e,null),!1):(ot(e),!0)},mt=function(e,t,n){if(Le&&("id"===t||"name"===t)&&(n in o||n in Qe))return!1;if(we&&!be[t]&&b(le,t));else if(_e&&b(ce,t));else if(!fe[t]||be[t]){if(!(ft(e)&&(ye.tagNameCheck instanceof RegExp&&b(ye.tagNameCheck,e)||ye.tagNameCheck instanceof Function&&ye.tagNameCheck(e))&&(ye.attributeNameCheck instanceof RegExp&&b(ye.attributeNameCheck,t)||ye.attributeNameCheck instanceof Function&&ye.attributeNameCheck(t))||"is"===t&&ye.allowCustomizedBuiltInElements&&(ye.tagNameCheck instanceof RegExp&&b(ye.tagNameCheck,n)||ye.tagNameCheck instanceof Function&&ye.tagNameCheck(n))))return!1}else if(Fe[t]);else if(b(de,g(n,he,"")));else if("src"!==t&&"xlink:href"!==t&&"href"!==t||"script"===e||0!==y(n,"data:")||!je[e])if(ke&&!b(ue,g(n,he,"")));else if(n)return!1;return!0},ft=function(e){return e.indexOf("-")>0},gt=function(e){let t,n,s,r;dt("beforeSanitizeAttributes",e,null);const{attributes:a}=e;if(!a)return;const o={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:fe};for(r=a.length;r--;){t=a[r];const{name:l,namespaceURI:c}=t;if(n="value"===l?t.value:v(t.value),s=Ye(l),o.attrName=s,o.attrValue=n,o.keepAttr=!0,o.forceKeepAttr=void 0,dt("uponSanitizeAttribute",e,o),n=o.attrValue,o.forceKeepAttr)continue;if(lt(l,e),!o.keepAttr)continue;if(!Se&&b(/\/>/i,n)){lt(l,e);continue}Ee&&(n=g(n,re," "),n=g(n,ae," "),n=g(n,oe," "));const u=Ye(e.nodeName);if(mt(u,s,n)){if(!Ce||"id"!==s&&"name"!==s||(lt(l,e),n="user-content-"+n),Y&&"object"==typeof V&&"function"==typeof V.getAttributeType)if(c);else switch(V.getAttributeType(u,s)){case"TrustedHTML":n=Y.createHTML(n);break;case"TrustedScriptURL":n=Y.createScriptURL(n)}try{c?e.setAttributeNS(c,l,n):e.setAttribute(l,n),h(i.removed)}catch(e){}}}dt("afterSanitizeAttributes",e,null)},yt=function e(t){let n;const i=ut(t);for(dt("beforeSanitizeShadowDOM",t,null);n=i.nextNode();)dt("uponSanitizeShadowNode",n,null),pt(n)||(n.content instanceof l&&e(n.content),gt(n));dt("afterSanitizeShadowDOM",t,null)};return i.sanitize=function(e){let t,n,r,a,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(Ke=!e,Ke&&(e="\x3c!--\x3e"),"string"!=typeof e&&!ht(e)){if("function"!=typeof e.toString)throw _("toString is not a function");if("string"!=typeof(e=e.toString()))throw _("dirty is not a string, aborting")}if(!i.isSupported)return e;if(Ie||tt(o),i.removed=[],"string"==typeof e&&(Pe=!1),Pe){if(e.nodeName){const t=Ye(e.nodeName);if(!pe[t]||ve[t])throw _("root node is forbidden and cannot be sanitized in-place")}}else if(e instanceof w)t=ct("\x3c!----\x3e"),n=t.ownerDocument.importNode(e,!0),1===n.nodeType&&"BODY"===n.nodeName||"HTML"===n.nodeName?t=n:t.appendChild(n);else{if(!$e&&!Ee&&!xe&&-1===e.indexOf("<"))return Y&&Oe?Y.createHTML(e):e;if(t=ct(e),!t)return $e?null:Oe?Z:""}t&&Te&&ot(t.firstChild);const c=ut(Pe?e:t);for(;r=c.nextNode();)pt(r)||(r.content instanceof l&&yt(r.content),gt(r));if(Pe)return e;if($e){if(Ne)for(a=te.call(t.ownerDocument);t.firstChild;)a.appendChild(t.firstChild);else a=t;return(fe.shadowroot||fe.shadowrootmod)&&(a=ie.call(s,a,!0)),a}let u=xe?t.outerHTML:t.innerHTML;return xe&&pe["!doctype"]&&t.ownerDocument&&t.ownerDocument.doctype&&t.ownerDocument.doctype.name&&b(W,t.ownerDocument.doctype.name)&&(u="<!DOCTYPE "+t.ownerDocument.doctype.name+">\n"+u),Ee&&(u=g(u,re," "),u=g(u,ae," "),u=g(u,oe," ")),Y&&Oe?Y.createHTML(u):u},i.setConfig=function(e){tt(e),Ie=!0},i.clearConfig=function(){Ze=null,Ie=!1},i.isValidAttribute=function(e,t,n){Ze||tt({});const i=Ye(e),s=Ye(t);return mt(i,s,n)},i.addHook=function(e,t){"function"==typeof t&&(se[e]=se[e]||[],d(se[e],t))},i.removeHook=function(e){if(se[e])return h(se[e])},i.removeHooks=function(e){se[e]&&(se[e]=[])},i.removeAllHooks=function(){se={}},i}()}()},56387:(e,t,n)=>{var i;!function(s){var r=Object.hasOwnProperty,a=Array.isArray?Array.isArray:function(e){return"[object Array]"===Object.prototype.toString.call(e)},o="object"==typeof process&&"function"==typeof process.nextTick,l="function"==typeof Symbol,c="object"==typeof Reflect,u="function"==typeof setImmediate?setImmediate:setTimeout,h=l?c&&"function"==typeof Reflect.ownKeys?Reflect.ownKeys:function(e){var t=Object.getOwnPropertyNames(e);return t.push.apply(t,Object.getOwnPropertySymbols(e)),t}:Object.keys;function d(){this._events={},this._conf&&p.call(this,this._conf)}function p(e){e&&(this._conf=e,e.delimiter&&(this.delimiter=e.delimiter),e.maxListeners!==s&&(this._maxListeners=e.maxListeners),e.wildcard&&(this.wildcard=e.wildcard),e.newListener&&(this._newListener=e.newListener),e.removeListener&&(this._removeListener=e.removeListener),e.verboseMemoryLeak&&(this.verboseMemoryLeak=e.verboseMemoryLeak),e.ignoreErrors&&(this.ignoreErrors=e.ignoreErrors),this.wildcard&&(this.listenerTree={}))}function m(e,t){var n="(node) warning: possible EventEmitter memory leak detected. "+e+" listeners added. Use emitter.setMaxListeners() to increase limit.";if(this.verboseMemoryLeak&&(n+=" Event name: "+t+"."),"undefined"!=typeof process&&process.emitWarning){var i=new Error(n);i.name="MaxListenersExceededWarning",i.emitter=this,i.count=e,process.emitWarning(i)}else console.error(n),console.trace&&console.trace()}var f=function(e,t,n){var i=arguments.length;switch(i){case 0:return[];case 1:return[e];case 2:return[e,t];case 3:return[e,t,n];default:for(var s=new Array(i);i--;)s[i]=arguments[i];return s}};function g(e,t){for(var n={},i=e.length,r=t?value.length:0,a=0;a<i;a++)n[e[a]]=a<r?t[a]:s;return n}function y(e,t,n){var i,s;if(this._emitter=e,this._target=t,this._listeners={},this._listenersCount=0,(n.on||n.off)&&(i=n.on,s=n.off),t.addEventListener?(i=t.addEventListener,s=t.removeEventListener):t.addListener?(i=t.addListener,s=t.removeListener):t.on&&(i=t.on,s=t.off),!i&&!s)throw Error("target does not implement any known event API");if("function"!=typeof i)throw TypeError("on method must be a function");if("function"!=typeof s)throw TypeError("off method must be a function");this._on=i,this._off=s;var r=e._observers;r?r.push(this):e._observers=[this]}function v(e,t,n,i){var a=Object.assign({},t);if(!e)return a;if("object"!=typeof e)throw TypeError("options must be an object");var o,l,c,u=Object.keys(e),h=u.length;function d(e){throw Error('Invalid "'+o+'" option value'+(e?". Reason: "+e:""))}for(var p=0;p<h;p++){if(o=u[p],!i&&!r.call(t,o))throw Error('Unknown "'+o+'" option');(l=e[o])!==s&&(c=n[o],a[o]=c?c(l,d):l)}return a}function b(e,t){return"function"==typeof e&&e.hasOwnProperty("prototype")||t("value must be a constructor"),e}function _(e){var t="value must be type of "+e.join("|"),n=e.length,i=e[0],s=e[1];return 1===n?function(e,n){if(typeof e===i)return e;n(t)}:2===n?function(e,n){var r=typeof e;if(r===i||r===s)return e;n(t)}:function(i,s){for(var r=typeof i,a=n;a-- >0;)if(r===e[a])return i;s(t)}}Object.assign(y.prototype,{subscribe:function(e,t,n){var i=this,s=this._target,r=this._emitter,a=this._listeners,o=function(){var i=f.apply(null,arguments),a={data:i,name:t,original:e};n?!1!==n.call(s,a)&&r.emit.apply(r,[a.name].concat(i)):r.emit.apply(r,[t].concat(i))};if(a[e])throw Error("Event '"+e+"' is already listening");this._listenersCount++,r._newListener&&r._removeListener&&!i._onNewListener?(this._onNewListener=function(n){n===t&&null===a[e]&&(a[e]=o,i._on.call(s,e,o))},r.on("newListener",this._onNewListener),this._onRemoveListener=function(n){n===t&&!r.hasListeners(n)&&a[e]&&(a[e]=null,i._off.call(s,e,o))},a[e]=null,r.on("removeListener",this._onRemoveListener)):(a[e]=o,i._on.call(s,e,o))},unsubscribe:function(e){var t,n,i,s=this,r=this._listeners,a=this._emitter,o=this._off,l=this._target;if(e&&"string"!=typeof e)throw TypeError("event must be a string");function c(){s._onNewListener&&(a.off("newListener",s._onNewListener),a.off("removeListener",s._onRemoveListener),s._onNewListener=null,s._onRemoveListener=null);var e=E.call(a,s);a._observers.splice(e,1)}if(e){if(!(t=r[e]))return;o.call(l,e,t),delete r[e],--this._listenersCount||c()}else{for(i=(n=h(r)).length;i-- >0;)e=n[i],o.call(l,e,r[e]);this._listeners={},this._listenersCount=0,c()}}});var w=_(["function"]),k=_(["object","function"]);function S(e,t,n){var i,s,r,a=0,o=new e((function(l,c,u){function h(){s&&(s=null),a&&(clearTimeout(a),a=0)}n=v(n,{timeout:0,overload:!1},{timeout:function(e,t){return("number"!=typeof(e*=1)||e<0||!Number.isFinite(e))&&t("timeout must be a positive number"),e}}),i=!n.overload&&"function"==typeof e.prototype.cancel&&"function"==typeof u;var d=function(e){h(),l(e)},p=function(e){h(),c(e)};i?t(d,p,u):(s=[function(e){p(e||Error("canceled"))}],t(d,p,(function(e){if(r)throw Error("Unable to subscribe on cancel event asynchronously");if("function"!=typeof e)throw TypeError("onCancel callback must be a function");s.push(e)})),r=!0),n.timeout>0&&(a=setTimeout((function(){var e=Error("timeout");e.code="ETIMEDOUT",a=0,o.cancel(e),c(e)}),n.timeout))}));return i||(o.cancel=function(e){if(s){for(var t=s.length,n=1;n<t;n++)s[n](e);s[0](e),s=null}}),o}function E(e){var t=this._observers;if(!t)return-1;for(var n=t.length,i=0;i<n;i++)if(t[i]._target===e)return i;return-1}function x(e,t,n,i,s){if(!n)return null;if(0===i){var r=typeof t;if("string"===r){var a,o,l=0,c=0,u=this.delimiter,d=u.length;if(-1!==(o=t.indexOf(u))){a=new Array(5);do{a[l++]=t.slice(c,o),c=o+d}while(-1!==(o=t.indexOf(u,c)));a[l++]=t.slice(c),t=a,s=l}else t=[t],s=1}else"object"===r?s=t.length:(t=[t],s=1)}var p,m,f,g,y,v,b,_=null,w=t[i],k=t[i+1];if(i===s)n._listeners&&("function"==typeof n._listeners?(e&&e.push(n._listeners),_=[n]):(e&&e.push.apply(e,n._listeners),_=[n]));else{if("*"===w){for(o=(v=h(n)).length;o-- >0;)"_listeners"!==(p=v[o])&&(b=x(e,t,n[p],i+1,s))&&(_?_.push.apply(_,b):_=b);return _}if("**"===w){for((y=i+1===s||i+2===s&&"*"===k)&&n._listeners&&(_=x(e,t,n,s,s)),o=(v=h(n)).length;o-- >0;)"_listeners"!==(p=v[o])&&("*"===p||"**"===p?(n[p]._listeners&&!y&&(b=x(e,t,n[p],s,s))&&(_?_.push.apply(_,b):_=b),b=x(e,t,n[p],i,s)):b=x(e,t,n[p],p===k?i+2:i,s),b&&(_?_.push.apply(_,b):_=b));return _}n[w]&&(_=x(e,t,n[w],i+1,s))}if((m=n["*"])&&x(e,t,m,i+1,s),f=n["**"])if(i<s)for(f._listeners&&x(e,t,f,s,s),o=(v=h(f)).length;o-- >0;)"_listeners"!==(p=v[o])&&(p===k?x(e,t,f[p],i+2,s):p===w?x(e,t,f[p],i+1,s):((g={})[p]=f[p],x(e,t,{"**":g},i+1,s)));else f._listeners?x(e,t,f,s,s):f["*"]&&f["*"]._listeners&&x(e,t,f["*"],s,s);return _}function I(e,t,n){var i,s,r=0,a=0,o=this.delimiter,l=o.length;if("string"==typeof e)if(-1!==(i=e.indexOf(o))){s=new Array(5);do{s[r++]=e.slice(a,i),a=i+l}while(-1!==(i=e.indexOf(o,a)));s[r++]=e.slice(a)}else s=[e],r=1;else s=e,r=e.length;if(r>1)for(i=0;i+1<r;i++)if("**"===s[i]&&"**"===s[i+1])return;var c,u=this.listenerTree;for(i=0;i<r;i++)if(u=u[c=s[i]]||(u[c]={}),i===r-1)return u._listeners?("function"==typeof u._listeners&&(u._listeners=[u._listeners]),n?u._listeners.unshift(t):u._listeners.push(t),!u._listeners.warned&&this._maxListeners>0&&u._listeners.length>this._maxListeners&&(u._listeners.warned=!0,m.call(this,u._listeners.length,c))):u._listeners=t,!0;return!0}function T(e,t,n,i){for(var s,r,a,o,l=h(e),c=l.length,u=e._listeners;c-- >0;)s=e[r=l[c]],a="_listeners"===r?n:n?n.concat(r):[r],o=i||"symbol"==typeof r,u&&t.push(o?a:a.join(this.delimiter)),"object"==typeof s&&T.call(this,s,t,a,o);return t}function $(e){for(var t,n,i,s=h(e),r=s.length;r-- >0;)(t=e[n=s[r]])&&(i=!0,"_listeners"===n||$(t)||delete e[n]);return i}function N(e,t,n){this.emitter=e,this.event=t,this.listener=n}function O(e,t,n){if(!0===n)r=!0;else if(!1===n)i=!0;else{if(!n||"object"!=typeof n)throw TypeError("options should be an object or true");var i=n.async,r=n.promisify,a=n.nextTick,l=n.objectify}if(i||a||r){var c=t,h=t._origin||t;if(a&&!o)throw Error("process.nextTick is not supported");r===s&&(r="AsyncFunction"===t.constructor.name),t=function(){var e=arguments,t=this,n=this.event;return r?a?Promise.resolve():new Promise((function(e){u(e)})).then((function(){return t.event=n,c.apply(t,e)})):(a?process.nextTick:u)((function(){t.event=n,c.apply(t,e)}))},t._async=!0,t._origin=h}return[t,l?new N(this,e,t):this]}function L(e){this._events={},this._newListener=!1,this._removeListener=!1,this.verboseMemoryLeak=!1,p.call(this,e)}N.prototype.off=function(){return this.emitter.off(this.event,this.listener),this},L.EventEmitter2=L,L.prototype.listenTo=function(e,t,n){if("object"!=typeof e)throw TypeError("target musts be an object");var i=this;function r(t){if("object"!=typeof t)throw TypeError("events must be an object");var s,r=n.reducers,a=E.call(i,e);s=-1===a?new y(i,e,n):i._observers[a];for(var o,l=h(t),c=l.length,u="function"==typeof r,d=0;d<c;d++)o=l[d],s.subscribe(o,t[o]||o,u?r:r&&r[o])}return n=v(n,{on:s,off:s,reducers:s},{on:w,off:w,reducers:k}),a(t)?r(g(t)):r("string"==typeof t?g(t.split(/\s+/)):t),this},L.prototype.stopListeningTo=function(e,t){var n=this._observers;if(!n)return!1;var i,s=n.length,r=!1;if(e&&"object"!=typeof e)throw TypeError("target should be an object");for(;s-- >0;)i=n[s],e&&i._target!==e||(i.unsubscribe(t),r=!0);return r},L.prototype.delimiter=".",L.prototype.setMaxListeners=function(e){e!==s&&(this._maxListeners=e,this._conf||(this._conf={}),this._conf.maxListeners=e)},L.prototype.getMaxListeners=function(){return this._maxListeners},L.prototype.event="",L.prototype.once=function(e,t,n){return this._once(e,t,!1,n)},L.prototype.prependOnceListener=function(e,t,n){return this._once(e,t,!0,n)},L.prototype._once=function(e,t,n,i){return this._many(e,1,t,n,i)},L.prototype.many=function(e,t,n,i){return this._many(e,t,n,!1,i)},L.prototype.prependMany=function(e,t,n,i){return this._many(e,t,n,!0,i)},L.prototype._many=function(e,t,n,i,s){var r=this;if("function"!=typeof n)throw new Error("many only accepts instances of Function");function a(){return 0==--t&&r.off(e,a),n.apply(this,arguments)}return a._origin=n,this._on(e,a,i,s)},L.prototype.emit=function(){if(!this._events&&!this._all)return!1;this._events||d.call(this);var e,t,n,i,s,r,a=arguments[0],o=this.wildcard;if("newListener"===a&&!this._newListener&&!this._events.newListener)return!1;if(o&&(e=a,"newListener"!==a&&"removeListener"!==a&&"object"==typeof a)){if(n=a.length,l)for(i=0;i<n;i++)if("symbol"==typeof a[i]){r=!0;break}r||(a=a.join(this.delimiter))}var c,u=arguments.length;if(this._all&&this._all.length)for(i=0,n=(c=this._all.slice()).length;i<n;i++)switch(this.event=a,u){case 1:c[i].call(this,a);break;case 2:c[i].call(this,a,arguments[1]);break;case 3:c[i].call(this,a,arguments[1],arguments[2]);break;default:c[i].apply(this,arguments)}if(o)c=[],x.call(this,c,e,this.listenerTree,0,n);else{if("function"==typeof(c=this._events[a])){switch(this.event=a,u){case 1:c.call(this);break;case 2:c.call(this,arguments[1]);break;case 3:c.call(this,arguments[1],arguments[2]);break;default:for(t=new Array(u-1),s=1;s<u;s++)t[s-1]=arguments[s];c.apply(this,t)}return!0}c&&(c=c.slice())}if(c&&c.length){if(u>3)for(t=new Array(u-1),s=1;s<u;s++)t[s-1]=arguments[s];for(i=0,n=c.length;i<n;i++)switch(this.event=a,u){case 1:c[i].call(this);break;case 2:c[i].call(this,arguments[1]);break;case 3:c[i].call(this,arguments[1],arguments[2]);break;default:c[i].apply(this,t)}return!0}if(!this.ignoreErrors&&!this._all&&"error"===a)throw arguments[1]instanceof Error?arguments[1]:new Error("Uncaught, unspecified 'error' event.");return!!this._all},L.prototype.emitAsync=function(){if(!this._events&&!this._all)return!1;this._events||d.call(this);var e,t,n,i,s,r,a=arguments[0],o=this.wildcard;if("newListener"===a&&!this._newListener&&!this._events.newListener)return Promise.resolve([!1]);if(o&&(e=a,"newListener"!==a&&"removeListener"!==a&&"object"==typeof a)){if(i=a.length,l)for(s=0;s<i;s++)if("symbol"==typeof a[s]){t=!0;break}t||(a=a.join(this.delimiter))}var c,u=[],h=arguments.length;if(this._all)for(s=0,i=this._all.length;s<i;s++)switch(this.event=a,h){case 1:u.push(this._all[s].call(this,a));break;case 2:u.push(this._all[s].call(this,a,arguments[1]));break;case 3:u.push(this._all[s].call(this,a,arguments[1],arguments[2]));break;default:u.push(this._all[s].apply(this,arguments))}if(o?(c=[],x.call(this,c,e,this.listenerTree,0)):c=this._events[a],"function"==typeof c)switch(this.event=a,h){case 1:u.push(c.call(this));break;case 2:u.push(c.call(this,arguments[1]));break;case 3:u.push(c.call(this,arguments[1],arguments[2]));break;default:for(n=new Array(h-1),r=1;r<h;r++)n[r-1]=arguments[r];u.push(c.apply(this,n))}else if(c&&c.length){if(c=c.slice(),h>3)for(n=new Array(h-1),r=1;r<h;r++)n[r-1]=arguments[r];for(s=0,i=c.length;s<i;s++)switch(this.event=a,h){case 1:u.push(c[s].call(this));break;case 2:u.push(c[s].call(this,arguments[1]));break;case 3:u.push(c[s].call(this,arguments[1],arguments[2]));break;default:u.push(c[s].apply(this,n))}}else if(!this.ignoreErrors&&!this._all&&"error"===a)return arguments[1]instanceof Error?Promise.reject(arguments[1]):Promise.reject("Uncaught, unspecified 'error' event.");return Promise.all(u)},L.prototype.on=function(e,t,n){return this._on(e,t,!1,n)},L.prototype.prependListener=function(e,t,n){return this._on(e,t,!0,n)},L.prototype.onAny=function(e){return this._onAny(e,!1)},L.prototype.prependAny=function(e){return this._onAny(e,!0)},L.prototype.addListener=L.prototype.on,L.prototype._onAny=function(e,t){if("function"!=typeof e)throw new Error("onAny only accepts instances of Function");return this._all||(this._all=[]),t?this._all.unshift(e):this._all.push(e),this},L.prototype._on=function(e,t,n,i){if("function"==typeof e)return this._onAny(e,t),this;if("function"!=typeof t)throw new Error("on only accepts instances of Function");this._events||d.call(this);var r,a=this;return i!==s&&(t=(r=O.call(this,e,t,i))[0],a=r[1]),this._newListener&&this.emit("newListener",e,t),this.wildcard?(I.call(this,e,t,n),a):(this._events[e]?("function"==typeof this._events[e]&&(this._events[e]=[this._events[e]]),n?this._events[e].unshift(t):this._events[e].push(t),!this._events[e].warned&&this._maxListeners>0&&this._events[e].length>this._maxListeners&&(this._events[e].warned=!0,m.call(this,this._events[e].length,e))):this._events[e]=t,a)},L.prototype.off=function(e,t){if("function"!=typeof t)throw new Error("removeListener only takes instances of Function");var n,i=[];if(this.wildcard){var s="string"==typeof e?e.split(this.delimiter):e.slice();if(!(i=x.call(this,null,s,this.listenerTree,0)))return this}else{if(!this._events[e])return this;n=this._events[e],i.push({_listeners:n})}for(var r=0;r<i.length;r++){var o=i[r];if(n=o._listeners,a(n)){for(var l=-1,c=0,u=n.length;c<u;c++)if(n[c]===t||n[c].listener&&n[c].listener===t||n[c]._origin&&n[c]._origin===t){l=c;break}if(l<0)continue;return this.wildcard?o._listeners.splice(l,1):this._events[e].splice(l,1),0===n.length&&(this.wildcard?delete o._listeners:delete this._events[e]),this._removeListener&&this.emit("removeListener",e,t),this}(n===t||n.listener&&n.listener===t||n._origin&&n._origin===t)&&(this.wildcard?delete o._listeners:delete this._events[e],this._removeListener&&this.emit("removeListener",e,t))}return this.listenerTree&&$(this.listenerTree),this},L.prototype.offAny=function(e){var t,n=0,i=0;if(e&&this._all&&this._all.length>0){for(n=0,i=(t=this._all).length;n<i;n++)if(e===t[n])return t.splice(n,1),this._removeListener&&this.emit("removeListenerAny",e),this}else{if(t=this._all,this._removeListener)for(n=0,i=t.length;n<i;n++)this.emit("removeListenerAny",t[n]);this._all=[]}return this},L.prototype.removeListener=L.prototype.off,L.prototype.removeAllListeners=function(e){if(e===s)return!this._events||d.call(this),this;if(this.wildcard){var t,n=x.call(this,null,e,this.listenerTree,0);if(!n)return this;for(t=0;t<n.length;t++)n[t]._listeners=null;this.listenerTree&&$(this.listenerTree)}else this._events&&(this._events[e]=null);return this},L.prototype.listeners=function(e){var t,n,i,r,a,o=this._events;if(e===s){if(this.wildcard)throw Error("event name required for wildcard emitter");if(!o)return[];for(r=(t=h(o)).length,i=[];r-- >0;)"function"==typeof(n=o[t[r]])?i.push(n):i.push.apply(i,n);return i}if(this.wildcard){if(!(a=this.listenerTree))return[];var l=[],c="string"==typeof e?e.split(this.delimiter):e.slice();return x.call(this,l,c,a,0),l}return o&&(n=o[e])?"function"==typeof n?[n]:n:[]},L.prototype.eventNames=function(e){var t=this._events;return this.wildcard?T.call(this,this.listenerTree,[],null,e):t?h(t):[]},L.prototype.listenerCount=function(e){return this.listeners(e).length},L.prototype.hasListeners=function(e){if(this.wildcard){var t=[],n="string"==typeof e?e.split(this.delimiter):e.slice();return x.call(this,t,n,this.listenerTree,0),t.length>0}var i=this._events,r=this._all;return!!(r&&r.length||i&&(e===s?h(i).length:i[e]))},L.prototype.listenersAny=function(){return this._all?this._all:[]},L.prototype.waitFor=function(e,t){var n=this,i=typeof t;return"number"===i?t={timeout:t}:"function"===i&&(t={filter:t}),S((t=v(t,{timeout:0,filter:s,handleError:!1,Promise,overload:!1},{filter:w,Promise:b})).Promise,(function(i,s,r){function a(){var r=t.filter;if(!r||r.apply(n,arguments))if(n.off(e,a),t.handleError){var o=arguments[0];o?s(o):i(f.apply(null,arguments).slice(1))}else i(f.apply(null,arguments))}r((function(){n.off(e,a)})),n._on(e,a,!1)}),{timeout:t.timeout,overload:t.overload})};var C=L.prototype;Object.defineProperties(L,{defaultMaxListeners:{get:function(){return C._maxListeners},set:function(e){if("number"!=typeof e||e<0||Number.isNaN(e))throw TypeError("n must be a non-negative number");C._maxListeners=e},enumerable:!0},once:{value:function(e,t,n){return S((n=v(n,{Promise,timeout:0,overload:!1},{Promise:b})).Promise,(function(n,i,s){var r;if("function"==typeof e.addEventListener)return r=function(){n(f.apply(null,arguments))},s((function(){e.removeEventListener(t,r)})),void e.addEventListener(t,r,{once:!0});var a,o=function(){a&&e.removeListener("error",a),n(f.apply(null,arguments))};"error"!==t&&(a=function(n){e.removeListener(t,o),i(n)},e.once("error",a)),s((function(){a&&e.removeListener("error",a),e.removeListener(t,o)})),e.once(t,o)}),{timeout:n.timeout,overload:n.overload})},writable:!0,configurable:!0}}),Object.defineProperties(C,{_maxListeners:{value:10,writable:!0,configurable:!0},_observers:{value:null,writable:!0,configurable:!0}}),(i=function(){return L}.call(t,n,t,e))===s||(e.exports=i)}()},26376:(e,t,n)=>{const i=n(74225),{MAX_LENGTH:s,MAX_SAFE_INTEGER:r}=n(83295),{safeRe:a,t:o}=n(55765),l=n(12893),{compareIdentifiers:c}=n(86742);class u{constructor(e,t){if(t=l(t),e instanceof u){if(e.loose===!!t.loose&&e.includePrerelease===!!t.includePrerelease)return e;e=e.version}else if("string"!=typeof e)throw new TypeError(`Invalid version. Must be a string. Got type "${typeof e}".`);if(e.length>s)throw new TypeError(`version is longer than ${s} characters`);i("SemVer",e,t),this.options=t,this.loose=!!t.loose,this.includePrerelease=!!t.includePrerelease;const n=e.trim().match(t.loose?a[o.LOOSE]:a[o.FULL]);if(!n)throw new TypeError(`Invalid Version: ${e}`);if(this.raw=e,this.major=+n[1],this.minor=+n[2],this.patch=+n[3],this.major>r||this.major<0)throw new TypeError("Invalid major version");if(this.minor>r||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>r||this.patch<0)throw new TypeError("Invalid patch version");n[4]?this.prerelease=n[4].split(".").map((e=>{if(/^[0-9]+$/.test(e)){const t=+e;if(t>=0&&t<r)return t}return e})):this.prerelease=[],this.build=n[5]?n[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+=`-${this.prerelease.join(".")}`),this.version}toString(){return this.version}compare(e){if(i("SemVer.compare",this.version,this.options,e),!(e instanceof u)){if("string"==typeof e&&e===this.version)return 0;e=new u(e,this.options)}return e.version===this.version?0:this.compareMain(e)||this.comparePre(e)}compareMain(e){return e instanceof u||(e=new u(e,this.options)),c(this.major,e.major)||c(this.minor,e.minor)||c(this.patch,e.patch)}comparePre(e){if(e instanceof u||(e=new u(e,this.options)),this.prerelease.length&&!e.prerelease.length)return-1;if(!this.prerelease.length&&e.prerelease.length)return 1;if(!this.prerelease.length&&!e.prerelease.length)return 0;let t=0;do{const n=this.prerelease[t],s=e.prerelease[t];if(i("prerelease compare",t,n,s),void 0===n&&void 0===s)return 0;if(void 0===s)return 1;if(void 0===n)return-1;if(n!==s)return c(n,s)}while(++t)}compareBuild(e){e instanceof u||(e=new u(e,this.options));let t=0;do{const n=this.build[t],s=e.build[t];if(i("prerelease compare",t,n,s),void 0===n&&void 0===s)return 0;if(void 0===s)return 1;if(void 0===n)return-1;if(n!==s)return c(n,s)}while(++t)}inc(e,t,n){switch(e){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",t,n);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",t,n);break;case"prepatch":this.prerelease.length=0,this.inc("patch",t,n),this.inc("pre",t,n);break;case"prerelease":0===this.prerelease.length&&this.inc("patch",t,n),this.inc("pre",t,n);break;case"major":0===this.minor&&0===this.patch&&0!==this.prerelease.length||this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":0===this.patch&&0!==this.prerelease.length||this.minor++,this.patch=0,this.prerelease=[];break;case"patch":0===this.prerelease.length&&this.patch++,this.prerelease=[];break;case"pre":{const e=Number(n)?1:0;if(!t&&!1===n)throw new Error("invalid increment argument: identifier is empty");if(0===this.prerelease.length)this.prerelease=[e];else{let i=this.prerelease.length;for(;--i>=0;)"number"==typeof this.prerelease[i]&&(this.prerelease[i]++,i=-2);if(-1===i){if(t===this.prerelease.join(".")&&!1===n)throw new Error("invalid increment argument: identifier already exists");this.prerelease.push(e)}}if(t){let i=[t,e];!1===n&&(i=[t]),0===c(this.prerelease[0],t)?isNaN(this.prerelease[1])&&(this.prerelease=i):this.prerelease=i}break}default:throw new Error(`invalid increment argument: ${e}`)}return this.raw=this.format(),this.build.length&&(this.raw+=`+${this.build.join(".")}`),this}}e.exports=u},46269:(e,t,n)=>{const i=n(26376);e.exports=(e,t,n)=>new i(e,n).compare(new i(t,n))},25903:(e,t,n)=>{const i=n(46269);e.exports=(e,t,n)=>i(e,t,n)>=0},83295:e=>{const t=Number.MAX_SAFE_INTEGER||9007199254740991;e.exports={MAX_LENGTH:256,MAX_SAFE_COMPONENT_LENGTH:16,MAX_SAFE_BUILD_LENGTH:250,MAX_SAFE_INTEGER:t,RELEASE_TYPES:["major","premajor","minor","preminor","patch","prepatch","prerelease"],SEMVER_SPEC_VERSION:"2.0.0",FLAG_INCLUDE_PRERELEASE:1,FLAG_LOOSE:2}},74225:e=>{const t="object"==typeof process&&process.env&&process.env.NODE_DEBUG&&/\bsemver\b/i.test(process.env.NODE_DEBUG)?(...e)=>console.error("SEMVER",...e):()=>{};e.exports=t},86742:e=>{const t=/^[0-9]+$/,n=(e,n)=>{const i=t.test(e),s=t.test(n);return i&&s&&(e=+e,n=+n),e===n?0:i&&!s?-1:s&&!i?1:e<n?-1:1};e.exports={compareIdentifiers:n,rcompareIdentifiers:(e,t)=>n(t,e)}},12893:e=>{const t=Object.freeze({loose:!0}),n=Object.freeze({});e.exports=e=>e?"object"!=typeof e?t:e:n},55765:(e,t,n)=>{const{MAX_SAFE_COMPONENT_LENGTH:i,MAX_SAFE_BUILD_LENGTH:s}=n(83295),r=n(74225),a=(t=e.exports={}).re=[],o=t.safeRe=[],l=t.src=[],c=t.t={};let u=0;const h="[a-zA-Z0-9-]",d=[["\\s",1],["\\d",i],[h,s]],p=(e,t,n)=>{const i=(e=>{for(const[t,n]of d)e=e.split(`${t}*`).join(`${t}{0,${n}}`).split(`${t}+`).join(`${t}{1,${n}}`);return e})(t),s=u++;r(e,s,t),c[e]=s,l[s]=t,a[s]=new RegExp(t,n?"g":void 0),o[s]=new RegExp(i,n?"g":void 0)};p("NUMERICIDENTIFIER","0|[1-9]\\d*"),p("NUMERICIDENTIFIERLOOSE","\\d+"),p("NONNUMERICIDENTIFIER",`\\d*[a-zA-Z-]${h}*`),p("MAINVERSION",`(${l[c.NUMERICIDENTIFIER]})\\.(${l[c.NUMERICIDENTIFIER]})\\.(${l[c.NUMERICIDENTIFIER]})`),p("MAINVERSIONLOOSE",`(${l[c.NUMERICIDENTIFIERLOOSE]})\\.(${l[c.NUMERICIDENTIFIERLOOSE]})\\.(${l[c.NUMERICIDENTIFIERLOOSE]})`),p("PRERELEASEIDENTIFIER",`(?:${l[c.NUMERICIDENTIFIER]}|${l[c.NONNUMERICIDENTIFIER]})`),p("PRERELEASEIDENTIFIERLOOSE",`(?:${l[c.NUMERICIDENTIFIERLOOSE]}|${l[c.NONNUMERICIDENTIFIER]})`),p("PRERELEASE",`(?:-(${l[c.PRERELEASEIDENTIFIER]}(?:\\.${l[c.PRERELEASEIDENTIFIER]})*))`),p("PRERELEASELOOSE",`(?:-?(${l[c.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${l[c.PRERELEASEIDENTIFIERLOOSE]})*))`),p("BUILDIDENTIFIER",`${h}+`),p("BUILD",`(?:\\+(${l[c.BUILDIDENTIFIER]}(?:\\.${l[c.BUILDIDENTIFIER]})*))`),p("FULLPLAIN",`v?${l[c.MAINVERSION]}${l[c.PRERELEASE]}?${l[c.BUILD]}?`),p("FULL",`^${l[c.FULLPLAIN]}$`),p("LOOSEPLAIN",`[v=\\s]*${l[c.MAINVERSIONLOOSE]}${l[c.PRERELEASELOOSE]}?${l[c.BUILD]}?`),p("LOOSE",`^${l[c.LOOSEPLAIN]}$`),p("GTLT","((?:<|>)?=?)"),p("XRANGEIDENTIFIERLOOSE",`${l[c.NUMERICIDENTIFIERLOOSE]}|x|X|\\*`),p("XRANGEIDENTIFIER",`${l[c.NUMERICIDENTIFIER]}|x|X|\\*`),p("XRANGEPLAIN",`[v=\\s]*(${l[c.XRANGEIDENTIFIER]})(?:\\.(${l[c.XRANGEIDENTIFIER]})(?:\\.(${l[c.XRANGEIDENTIFIER]})(?:${l[c.PRERELEASE]})?${l[c.BUILD]}?)?)?`),p("XRANGEPLAINLOOSE",`[v=\\s]*(${l[c.XRANGEIDENTIFIERLOOSE]})(?:\\.(${l[c.XRANGEIDENTIFIERLOOSE]})(?:\\.(${l[c.XRANGEIDENTIFIERLOOSE]})(?:${l[c.PRERELEASELOOSE]})?${l[c.BUILD]}?)?)?`),p("XRANGE",`^${l[c.GTLT]}\\s*${l[c.XRANGEPLAIN]}$`),p("XRANGELOOSE",`^${l[c.GTLT]}\\s*${l[c.XRANGEPLAINLOOSE]}$`),p("COERCE",`(^|[^\\d])(\\d{1,${i}})(?:\\.(\\d{1,${i}}))?(?:\\.(\\d{1,${i}}))?(?:$|[^\\d])`),p("COERCERTL",l[c.COERCE],!0),p("LONETILDE","(?:~>?)"),p("TILDETRIM",`(\\s*)${l[c.LONETILDE]}\\s+`,!0),t.tildeTrimReplace="$1~",p("TILDE",`^${l[c.LONETILDE]}${l[c.XRANGEPLAIN]}$`),p("TILDELOOSE",`^${l[c.LONETILDE]}${l[c.XRANGEPLAINLOOSE]}$`),p("LONECARET","(?:\\^)"),p("CARETTRIM",`(\\s*)${l[c.LONECARET]}\\s+`,!0),t.caretTrimReplace="$1^",p("CARET",`^${l[c.LONECARET]}${l[c.XRANGEPLAIN]}$`),p("CARETLOOSE",`^${l[c.LONECARET]}${l[c.XRANGEPLAINLOOSE]}$`),p("COMPARATORLOOSE",`^${l[c.GTLT]}\\s*(${l[c.LOOSEPLAIN]})$|^$`),p("COMPARATOR",`^${l[c.GTLT]}\\s*(${l[c.FULLPLAIN]})$|^$`),p("COMPARATORTRIM",`(\\s*)${l[c.GTLT]}\\s*(${l[c.LOOSEPLAIN]}|${l[c.XRANGEPLAIN]})`,!0),t.comparatorTrimReplace="$1$2$3",p("HYPHENRANGE",`^\\s*(${l[c.XRANGEPLAIN]})\\s+-\\s+(${l[c.XRANGEPLAIN]})\\s*$`),p("HYPHENRANGELOOSE",`^\\s*(${l[c.XRANGEPLAINLOOSE]})\\s+-\\s+(${l[c.XRANGEPLAINLOOSE]})\\s*$`),p("STAR","(<|>)?=?\\s*\\*"),p("GTE0","^\\s*>=\\s*0\\.0\\.0\\s*$"),p("GTE0PRE","^\\s*>=\\s*0\\.0\\.0-0\\s*$")},15386:e=>{function t(e,t){if((e=e.replace(/\s+/g,""))===(t=t.replace(/\s+/g,"")))return 1;if(e.length<2||t.length<2)return 0;let n=new Map;for(let t=0;t<e.length-1;t++){const i=e.substring(t,t+2),s=n.has(i)?n.get(i)+1:1;n.set(i,s)}let i=0;for(let e=0;e<t.length-1;e++){const s=t.substring(e,e+2),r=n.has(s)?n.get(s):0;r>0&&(n.set(s,r-1),i++)}return 2*i/(e.length+t.length-2)}e.exports={compareTwoStrings:t,findBestMatch:function(e,n){if(!function(e,t){return"string"==typeof e&&!!Array.isArray(t)&&!!t.length&&!t.find((function(e){return"string"!=typeof e}))}(e,n))throw new Error("Bad arguments: First argument should be a string, second should be an array of strings");const i=[];let s=0;for(let r=0;r<n.length;r++){const a=n[r],o=t(e,a);i.push({target:a,rating:o}),o>i[s].rating&&(s=r)}return{ratings:i,bestMatch:i[s],bestMatchIndex:s}}}},58339:(e,t,n)=>{"use strict";n.r(t),n.d(t,{request:()=>y,settings:()=>v,storage:()=>g,type:()=>b});var i=n(58339),s=n(9375),r=function(e,t,n,i){return new(n||(n=Promise))((function(s,r){function a(e){try{l(i.next(e))}catch(e){r(e)}}function o(e){try{l(i.throw(e))}catch(e){r(e)}}function l(e){e.done?s(e.value):function(e){return e instanceof n?e:new n((function(t){t(e)}))}(e.value).then(a,o)}l((i=i.apply(e,t||[])).next())}))};const a={set(e,t){return r(this,void 0,void 0,(function*(){const n={};return n[e]=t,new Promise(((t,i)=>{o(e).set(n,(function(){chrome.runtime.lastError?i(chrome.runtime.lastError):t()}))}))}))},get(e){return r(this,void 0,void 0,(function*(){return new Promise(((t,n)=>{o(e).get(e,(function(i){chrome.runtime.lastError?n(chrome.runtime.lastError):t(i[e])}))}))}))},remove(e){return r(this,void 0,void 0,(function*(){return new Promise(((t,n)=>{o(e).remove(e,(function(){chrome.runtime.lastError?n(chrome.runtime.lastError):t()}))}))}))},list(e="local"){return r(this,void 0,void 0,(function*(){return new Promise(((t,n)=>{"local"===e?chrome.storage.local.get(null,(function(e){t(e)})):chrome.storage.sync.get(null,(function(e){t(e)}))}))}))},addStyle(e){return r(this,void 0,void 0,(function*(){try{const t=document.createElement("style");t.textContent=e,(document.head||document.body||document.documentElement||document).appendChild(t)}catch(e){console.log(`Could not add css:${e}`)}}))},version:()=>chrome.runtime.getManifest().version,lang(e,t){if(i.settings.get("forceEn")&&"undefined"!=typeof i18n){let n=i18n[e];if(void 0!==t)for(let e=0;e<t.length;e++)n=n.replace(`$${e+1}`,t[e]);return n}return chrome.i18n.getMessage(e,t)},assetUrl:e=>chrome.extension.getURL(`assets/${e}`),injectCssResource(e,t){alert("injectCssResource not supported in webextension")},injectjsResource(e,t){const n=document.createElement("script");n.src=chrome.extension.getURL(`vendor/${e}`),n.onload=function(){this.remove()},t.get(0).appendChild(n)},updateDom(e){const t=document.createElement("script");t.text="\n        document.getElementsByTagName('head')[0].onclick = function(e){\n          try{\n            componentHandler.upgradeDom();\n          }catch(e){\n            console.log(e);\n            setTimeout(function(){\n              componentHandler.upgradeDom();\n            },500);\n          }\n        }",t.onload=function(){this.remove()},e.get(0).appendChild(t)},storageOnChanged(e){chrome.storage.onChanged.addListener(e)}};function o(e){return s.syncRegex.test(e)?chrome.storage.sync:chrome.storage.local}var l=function(e,t,n,i){return new(n||(n=Promise))((function(s,r){function a(e){try{l(i.next(e))}catch(e){r(e)}}function o(e){try{l(i.throw(e))}catch(e){r(e)}}function l(e){e.done?s(e.value):function(e){return e instanceof n?e:new n((function(t){t(e)}))}(e.value).then(a,o)}l((i=i.apply(e,t||[])).next())}))};const c={xhr(e,t){return l(this,void 0,void 0,(function*(){if(void 0!==c.sendMessage)return c.sendMessage({name:"xhr",method:e,url:t}).then((e=>{if(429===e.status)throw"Rate limit Timeout";return e}));throw"Could not send xhr"}))},sendMessage(e){return l(this,void 0,void 0,(function*(){return new Promise(((t,n)=>{chrome.runtime.sendMessage(e,(function(e){t(e)}))}))}))},notification(e){this.sendMessage({name:"notification",options:e})},database(e,t){return this.sendMessage({name:"database",options:{call:e,param:t}})}};var u=n(2262),h=n(58339),d=n(9e4),p=n(9375),m=function(e,t,n,i){return new(n||(n=Promise))((function(s,r){function a(e){try{l(i.next(e))}catch(e){r(e)}}function o(e){try{l(i.throw(e))}catch(e){r(e)}}function l(e){e.done?s(e.value):function(e){return e instanceof n?e:new n((function(t){t(e)}))}(e.value).then(a,o)}l((i=i.apply(e,t||[])).next())}))};const f={options:(0,u.qj)({autoTrackingModeanime:"video",readerTracking:!0,autoTrackingModemanga:"instant",enablePages:{},forceEn:!1,rpc:!0,presenceLargeImage:"cover",presenceShowButtons:!0,presenceShowMalsync:!1,userscriptModeButton:!1,syncMode:"MAL",syncModeSimkl:"MAL",localSync:!0,delay:0,videoDuration:85,malTags:!1,malContinue:!0,malResume:!0,usedPage:!0,epPredictions:!0,theme:"auto",themeSidebars:!0,themeColor:"#000000",themeOpacity:100,themeImage:"",minimalWindow:!1,posLeft:"left",miniMALonMal:!1,floatButtonStealth:!1,minimizeBigPopup:!1,floatButtonCorrection:!0,floatButtonHide:!1,autoCloseMinimal:!1,outWay:!0,miniMalWidth:"550px",miniMalHeight:"90%",malThumbnail:100,friendScore:!0,loadPTWForProgress:!1,quicklinks:["9anime","Crunchyroll","Gogoanime","Mangadex","MangaNato","MangaFox","MangaSee","MangaFire","YugenAnime","Zoro","Funimation","Hulu","Netflix","Hidive","Vrv","VIZ","MangaPlus","MangaReader","marin","ComicK"],quicklinksPosition:"default",autofull:!1,autoresume:!1,autoNextEp:!1,highlightAllEp:!1,checkForFiller:!0,crashReport:!0,introSkip:85,introSkipFwd:[17,39],introSkipBwd:[17,37],nextEpShort:[],correctionShort:[67],syncShort:[],progressInterval:120,progressIntervalDefaultAnime:"en/sub",progressIntervalDefaultManga:"en/sub",progressNotificationsAnime:!0,progressNotificationsManga:!0,bookMarksList:!1,customDomains:[],anilistUpdateUi:!0,anilistToken:"",anilistOptions:{displayAdultContent:!0,scoreFormat:"POINT_10"},kitsuToken:"",kitsuOptions:{titleLanguagePreference:"canonical",sfwFilter:!1,ratingSystem:"regular"},simklToken:"",malToken:"",malRefresh:"",shikiToken:"",shikiOptions:{locale:"ru"}}),debounceArray:{},isInit:(0,u.iH)(!1),init(){return m(this,void 0,void 0,(function*(){const e=[];for(const t in this.options){const n=yield h.storage.get(`settings/${t}`);void 0!==n&&(this.options[t]=n,e[t]=/(token|refresh)/i.test(t)&&n?"********":n)}let t;return d.log("Settings",e),h.storage.storageOnChanged(((e,n)=>{if("sync"===n)for(const t in e){const n=e[t];/^settings\//i.test(t)&&(this.options[t.replace("settings/","")]=n.newValue,d.info(`Update ${t} option to ${n.newValue}`))}if("local"===n&&e.rateLimit)try{clearTimeout(t),e.rateLimit.newValue?(d.log("Rate limited"),$(".type-rate").length||p.flashm("Rate limited. Retrying in a moment",{error:!0,type:"rate",permanent:!0})):t=setTimeout((()=>{d.log("No Rate limited"),$(".type-rate").remove()}),5e3)}catch(e){d.error(e)}})),this.isInit.value=!0,this}))},get(e){if(!this.isInit.value)throw"Settings not initialized";return this.options[e]},set(e,t){if(!Object.prototype.hasOwnProperty.call(this.options,e)){const t=Error(`${e} is not a defined option`);throw d.error(t),t}return this.options[e]=t,h.storage.set(`settings/${e}`,t)},setDebounce(e,t){this.options[e]=t,clearTimeout(this.debounceArray[e]),this.debounceArray[e]=setTimeout((()=>{this.set(e,t),delete this.debounceArray[e]}),1e3)},getAsync(e){return m(this,void 0,void 0,(function*(){const t=yield h.storage.get(`settings/${e}`);return void 0===t&&void 0!==this.options[e]?this.options[e]:t}))}},g=a,y=c,v=f,b="webextension"},9e4:(e,t,n)=>{"use strict";n.r(t),n.d(t,{debug:()=>a,error:()=>s,info:()=>r,log:()=>i,m:()=>o});const i=Function.prototype.bind.call(console.log,console,"%cMAL-Sync","background-color: #2e51a2; color: white; padding: 2px 10px; border-radius: 3px;"),s=Function.prototype.bind.call(console.error,console,"%cMAL-Sync","background-color: #8f0000; color: white; padding: 2px 10px; border-radius: 3px;"),r=Function.prototype.bind.call(console.info,console,"%cMAL-Sync","background-color: wheat; color: black; padding: 2px 10px; border-radius: 3px;"),a=Function.prototype.bind.call(console.debug,console,"%cMAL-Sync","background-color: steelblue; color: black; padding: 2px 10px; border-radius: 3px;"),o=(e,t="",n=[])=>{let i="white";t||(t=function(e){if(!e)return"#ffffff";e=String(e);let t=0;for(let n=0;n<e.length;n++)t=e.charCodeAt(n)+((t<<5)-t);let n="#";for(let e=0;e<3;e++)n+=`00${(t>>8*e&255).toString(16)}`.substr(-2);return n}(e)),"#"===t[0]&&(i=parseInt(t.replace("#",""),16)>8388607.5?"#000":"#fff");const s=`background-color: ${t}; color: ${i}; padding: 2px 10px; border-radius: 3px; margin-left: -5px; border-left: 1px solid white;`;n.push({name:e,style:s});const r={m:(e,t="")=>o(e,t,[...n])},a=n.reduce(((e,t)=>`${e}%c${t.name}`),""),l=n.map((e=>e.style));return r.log=Function.prototype.bind.call(console.log,console,`%cM ${a}`,"background-color: #2e51a2; color: white; padding: 2px 10px; border-radius: 3px;",...l),r.error=Function.prototype.bind.call(console.error,console,`%cM ${a}`,"background-color: #8f0000; color: white; padding: 2px 10px; border-radius: 3px;",...l),r.info=Function.prototype.bind.call(console.info,console,`%cM ${a}`,"background-color: wheat; color: black; padding: 2px 10px; border-radius: 3px;",...l),r.debug=Function.prototype.bind.call(console.debug,console,`%cM ${a}`,"background-color: steelblue; color: black; padding: 2px 10px; border-radius: 3px;",...l),r}},9375:(e,t,n)=>{"use strict";n.r(t),n.d(t,{absoluteLink:()=>w,canHideTabs:()=>z,changeDetect:()=>x,checkDoubleExecution:()=>O,clearCache:()=>ae,elementInViewport:()=>Z,episode:()=>g,favicon:()=>p,flashConfirm:()=>q,flashm:()=>G,fullUrlChangeDetect:()=>E,generateUniqueID:()=>d,getAsyncWaitUntilTrue:()=>T,getBaseText:()=>h,getContinueWaching:()=>M,getEntrySettings:()=>j,getResumeWaching:()=>P,getStatusText:()=>B,getTooltip:()=>F,getUrlFromTags:()=>L,getselect:()=>_,handleMalImages:()=>D,htmlDecode:()=>ne,isDomainMatching:()=>le,isFirefox:()=>ie,lazyload:()=>Y,makeDomainCompatible:()=>re,notifications:()=>W,pageUrl:()=>ee,parseHtml:()=>k,planTo:()=>f,rateLimitExclude:()=>v,returnYYYYMMDD:()=>te,setContinueWaching:()=>R,setEntrySettings:()=>U,setResumeWaching:()=>A,setUrlInTags:()=>C,sortAlphabetically:()=>oe,status:()=>b,statusTag:()=>H,syncRegex:()=>y,timeCache:()=>K,timeDiffToText:()=>V,upperCaseFirstLetter:()=>ce,urlChangeDetect:()=>S,urlParam:()=>u,urlPart:()=>l,urlStrip:()=>c,wait:()=>Q,waitForPageToBeVisible:()=>se,waitUntilTrue:()=>I,watching:()=>m});var i=n(19947),s=n(58339),r=n(9e4),a=n(9375),o=function(e,t,n,i){return new(n||(n=Promise))((function(s,r){function a(e){try{l(i.next(e))}catch(e){r(e)}}function o(e){try{l(i.throw(e))}catch(e){r(e)}}function l(e){e.done?s(e.value):function(e){return e instanceof n?e:new n((function(t){t(e)}))}(e.value).then(a,o)}l((i=i.apply(e,t||[])).next())}))};function l(e,t){if(!e)return"";const n=e.split("/");return n[t]?n[t].replace(/[#?].*/,""):""}function c(e){return e.replace(/[#?].*/,"")}function u(e,t){const n=new RegExp(`[?&]${t}=([^&#]*)`).exec(e);return null===n?null:decodeURI(n[1])||0}function h(e){let t=e.text();return e.children().each((function(){t=t.replace(i.$(this).text(),"")})),t}function d(e=10){const t=new Uint32Array(e);return window.crypto.getRandomValues(t),Array.from(t,(e=>e.toString(16))).join("")}function p(e){if(!e)return"";const t=e.match(/^(https?:\/\/)?[^/]+/);return t&&(e=t[0]),`https://favicon.malsync.moe/?domain=${e}`}function m(e){return"manga"===e?"Reading":"Watching"}function f(e){return"manga"===e?"Plan to Read":"Plan to Watch"}function g(e){return"manga"===e?s.storage.lang("UI_Chapter"):s.storage.lang("UI_Episode")}const y=/(^settings\/.*|^updateCheckTime$|^tempVersion$|^local:\/\/|^list-tagSettings$)/,v=/^https:\/\/api.malsync.moe\/(shark|mal\/|nc\/mal\/.*\/progress$)/i;var b;function _(e,t){let n=e.split(`name="${t}"`)[1].split("</select>")[0];if(n.indexOf('selected="selected"')>-1){n=n.split("<option");for(let e=0;e<n.length;++e)if(n[e].indexOf('selected="selected"')>-1)return n[e].split('value="')[1].split('"')[0]}return""}function w(e,t){return void 0===e||e.startsWith("http")||("/"!==e.charAt(0)&&(e=`/${e}`),e=t+e),e}function k(e){return(new DOMParser).parseFromString(`<!doctype html><body>${e}`,"text/html").body.textContent}function S(e){let t=window.location.href;return setInterval((function(){t!==window.location.href&&(t=window.location.href,e())}),100)}function E(e,t=!1){let n="";const i=setInterval((function(){const i=t?c(window.location.href):window.location.href;n!==i&&(n=i,e())}),100);return Number(i)}function x(e,t,n=!1){let i=t();const s=setInterval((function(){const n=t();void 0!==n&&i!==n&&(i=t(),e())}),500);return n&&e(),Number(s)}function I(e,t,n=100){const i=setInterval((function(){e()&&(clearInterval(i),t())}),n);return i}function T(e,t=100){let n,i;const s=()=>{clearTimeout(n),i&&i("AsyncWait stopped")};return{asyncWaitUntilTrue:()=>(s(),new Promise(((s,r)=>{i=r,n=I(e,(()=>s()),t)}))),reset:s}}!function(e){e[e.watching=1]="watching",e[e.completed=2]="completed",e[e.onhold=3]="onhold",e[e.dropped=4]="dropped",e[e.planToWatch=6]="planToWatch"}(b||(b={}));const N=Math.random();function O(){$(".mal-sync-double-detect").length&&$(".mal-sync-double-detect").each((function(e){$(this).text()!==N.toString()&&alert("Double execution detected! Please run MAL-Sync once only.")})),$("body").after(i.html(`<div class="mal-sync-double-detect" style="display: none;">${N.toString()}</div>`))}function L(e){return/malSync::[\d\D]+::/.test(e)?t(e.split("malSync::")[1].split("::")[0]):/last::[\d\D]+::/.test(e)?t(e.split("last::")[1].split("::")[0]):void 0;function t(e){try{return atob(e)}catch(t){return e}}}function C(e,t){if(""===e)return t.replace(/,?(malSync|last)::[^ \n]+?::/,"");if(!s.settings.get("malTags"))return t;const n=`malSync::${btoa(e)}::`;return/(last|malSync)::[\d\D]+::/.test(t)?t.replace(/(last|malSync)::[^^]*?::/,n):`${t},${n}`}function A(e,t,n,i){return o(this,void 0,void 0,(function*(){return s.storage.set(`resume/${n}/${i}`,{url:e,ep:t})}))}function P(e,t){return o(this,void 0,void 0,(function*(){if(s.settings.get("malResume"))return s.storage.get(`resume/${e}/${t}`)}))}function R(e,t,n,i){return o(this,void 0,void 0,(function*(){return s.storage.set(`continue/${n}/${i}`,{url:e,ep:t})}))}function M(e,t){return o(this,void 0,void 0,(function*(){if(s.settings.get("malContinue"))return s.storage.get(`continue/${e}/${t}`)}))}function U(e,t,n,i=""){return o(this,void 0,void 0,(function*(){const r={};if(n){for(const e in n)switch(e){case"u":case"p":r[e]=n[e]}s.settings.get("malTags")?i=C(JSON.stringify(r),i):yield s.storage.set(`tagSettings/${e}/${t}`,JSON.stringify(r))}return Object.values(r).find((e=>Boolean(e)))||(i=C("",i),s.settings.get("malTags")||(yield s.storage.remove(`tagSettings/${e}/${t}`))),i}))}function j(e,t,n=""){return o(this,void 0,void 0,(function*(){const i={u:null,c:null,r:null,p:""};if(s.settings.get("malTags")){const e=L(n);if(e)if("{"===e[0])try{const t=JSON.parse(e);for(const e in i)t[e]&&(i[e]=t[e])}catch(e){r.error(e)}else i.u=e}else{let n=yield s.storage.get(`tagSettings/${e}/${t}`);if(n){n=JSON.parse(n);for(const e in i)n[e]&&(i[e]=n[e])}}const a=yield M(e,t);a&&(i.c=a);const o=yield P(e,t);return o&&(i.r=o),s.settings.get("usedPage")||(i.u=null),i}))}function D(e){return-1!==e.indexOf("questionmark")?s.storage.assetUrl("questionmark.gif"):e}function F(e,t="",n="top"){const i=Math.floor(1e3*Math.random()+1);return`<div id="tt${i}" class="icon material-icons" style="font-size:16px; line-height: 0; color: #7f7f7f; padding-bottom: 20px; padding-left: 3px; ${t}">contact_support</div>  <div class="mdl-tooltip mdl-tooltip--${n} mdl-tooltip--large" for="tt${i}">${e}</div>`}function V(e){let t="";e/=1e3;const n=Math.floor(e/31536e3);e-=31536e3*n,n&&(t+=`${n}y `);const i=Math.floor(e/86400);e-=86400*i,i&&(t+=`${i}d `);const s=Math.floor(e/3600)%24;e-=3600*s,s&&i<2&&(t+=`${s}h `);const r=Math.floor(e/60)%60;return e-=60*r,r&&!i&&s<3&&(t+=`${r}min `),t}function z(){return"undefined"!=typeof browser&&void 0!==browser.tabs.hide}function H(e,t,n){const i={anime:{1:{class:"watching",text:"CW",title:s.storage.lang(`UI_Status_watching_${t}`)},2:{class:"completed",text:"CMPL",title:s.storage.lang("UI_Status_Completed")},3:{class:"on-hold",text:"HOLD",title:s.storage.lang("UI_Status_OnHold")},4:{class:"dropped",text:"DROP",title:s.storage.lang("UI_Status_Dropped")},6:{class:"plantowatch",text:"PTW",title:s.storage.lang(`UI_Status_planTo_${t}`)},23:{class:"rewatching",text:"RE",title:s.storage.lang(`UI_Status_Rewatching_${t}`)}},manga:{1:{class:"reading",text:"CR",title:s.storage.lang(`UI_Status_watching_${t}`)},2:{class:"completed",text:"CMPL",title:s.storage.lang("UI_Status_Completed")},3:{class:"on-hold",text:"HOLD",title:s.storage.lang("UI_Status_OnHold")},4:{class:"dropped",text:"DROP",title:s.storage.lang("UI_Status_Dropped")},6:{class:"plantoread",text:"PTR",title:s.storage.lang(`UI_Status_planTo_${t}`)},23:{class:"rewatching",text:"RE",title:s.storage.lang(`UI_Status_Rewatching_${t}`)}}};if($.each([1,2,3,4,6,23],(function(e,t){i.anime[i.anime[t].title]=i.anime[t],i.manga[i.manga[t].title]=i.manga[t]})),e&&i[t][e]){const s=i[t][e];return` <a href="https://myanimelist.net/ownlist/${t}/${n}/edit?hideLayout=1" title="${s.title}" class="Lightbox_AddEdit button_edit ${s.class}">${s.text}</a>`}return!1}function B(e,t){switch(t){case 1:return s.storage.lang(`UI_Status_watching_${e}`);case 2:return s.storage.lang("UI_Status_Completed");case 3:return s.storage.lang("UI_Status_OnHold");case 4:return s.storage.lang("UI_Status_Dropped");case 6:return s.storage.lang(`UI_Status_planTo_${e}`);case 7:return s.storage.lang("UI_Status_All");case 23:return s.storage.lang(`UI_Status_Rewatching_${e}`);default:return""}}function W(e,t,n,i=""){const a={type:"basic",title:t,message:n,iconUrl:i};r.log("Notification",e,a),s.storage.get("notificationHistory").then((t=>{void 0===t&&(t=[]),"object"==typeof t&&(t.length>=10&&t.shift(),t.push({url:e,title:a.title,message:a.message,iconUrl:a.iconUrl,timestamp:Date.now()}),s.storage.set("notificationHistory",t))}));try{return chrome.notifications.create(e,a)}catch(e){r.error(e)}}function K(e,t,n){return o(this,void 0,void 0,(function*(){const i=yield s.storage.get(e);if("object"==typeof i&&(new Date).getTime()<i.timestamp)return i.data;const r=yield t();return s.storage.set(e,{data:r,timestamp:(new Date).getTime()+n}).then((()=>r))}))}function G(e,t){i.$("#flash-div-top").length||function(){s.storage.addStyle('.flashinfo{\n                    transition: max-height 2s, opacity 2s 2s;\n                 }\n                 .mini-stealth .flashinfo{\n                    opacity: 0;\n                 }\n                  #flashinfo-div.hover.mini-stealth .flashinfo.type-update{\n                    opacity: 0.7;\n                 }\n                 #flashinfo-div.hover .flashinfo{\n                    opacity: 1;\n                 }\n                 .flashinfo:hover{\n                    max-height:5000px !important;\n                    z-index: 2147483647;\n                    opacity: 1;\n                    transition: max-height 2s;\n                 }\n                 .flashinfo .synopsis{\n                    transition: max-height 2s, max-width 2s ease 2s;\n                 }\n                 .flashinfo:hover .synopsis{\n                    max-height:9999px !important;\n                    max-width: 500px !important;\n                    transition: max-height 2s;\n                 }\n                 #flashinfo-div{\n                  z-index: 2;\n                  transition: 2s;\n                 }\n                 #flashinfo-div:hover, #flashinfo-div.hover{\n                  z-index: 2147483647;\n                 }\n                 #flashinfo-div.player-error {\n                   z-index: 2147483647;\n                 }\n                 #flashinfo-div.player-error .type-update{\n                  overflow: visible !important;\n                  opacity: 1 !important;\n                 }\n                 #flashinfo-div.player-error .player-error{\n                  display: block !important\n                 }\n                 #flashinfo-div.player-error-missing-permissions .player-error-missing-permissions{\n                  display: block !important\n                 }\n                 #flashinfo-div.player-error-missing-permissions .player-error-default{\n                  display: none !important\n                 }\n\n                 #flash-div-top, #flash-div-bottom, #flashinfo-div{\n                    font-family: "Helvetica","Arial",sans-serif;\n                    color: white;\n                    font-size: 14px;\n                    font-weight: 400;\n                    line-height: 17px;\n                 }\n                 #flash-div-top h2, #flash-div-bottom h2, #flashinfo-div h2{\n                    font-family: "Helvetica","Arial",sans-serif;\n                    color: white;\n                    font-size: 14px;\n                    font-weight: 700;\n                    line-height: 17px;\n                    padding: 0;\n                    margin: 0;\n                 }\n                 #flash-div-top a, #flash-div-bottom a, #flashinfo-div a{\n                    color: #DF6300;\n                 }');let e="";s.settings.get("floatButtonStealth")&&(e="mini-stealth"),i.$("body").after(i.html(`<div id="flash-div-top" style="text-align: center;pointer-events: none;position: fixed;top:-5px;width:100%;z-index: 2147483647;left: 0;"></div>        <div id="flash-div-bottom" style="text-align: center;pointer-events: none;position: fixed;bottom:0px;width:100%;z-index: 2147483647;left: 0;"><div id="flash" style="display:none;  background-color: red;padding: 20px; margin: 0 auto;max-width: 60%;          -webkit-border-radius: 20px;-moz-border-radius: 20px;border-radius: 20px;background:rgba(227,0,0,0.6);"></div></div>        <div id="flashinfo-div" class="${e}" style="text-align: center;pointer-events: none;position: fixed;bottom:0px;width:100%;left: 0;">`))}(),r.log("[Flash] Message:",e);let n="#323232";void 0!==t&&void 0!==t.error&&t.error&&(n="#3e0808");let a="#flash-div-bottom";void 0!==t&&void 0!==t.position&&t.position&&(a=`#flash-div-${t.position}`);let o="flash";if(void 0!==t&&void 0!==t.type&&t.type){const e=`type-${t.type}`;i.$(`${a} .${e}, #flashinfo-div .${e}`).removeClass(e).fadeOut({duration:1e3,queue:!1,complete(){i.$(this).remove()}}),o+=` ${e}`}let l,c=`<div class="${o}" style="display:none;">        <div style="display:table; pointer-events: all; padding: 14px 24px 14px 24px; margin: 0 auto; margin-top: 5px; max-width: 60%; -webkit-border-radius: 20px;-moz-border-radius: 20px;border-radius: 2px;color: white;background:${n}; ">          ${e}        </div>      </div>`;return void 0!==t&&void 0!==t.hoverInfo&&t.hoverInfo?(o+=" flashinfo",c=`<div class="${o}" style="display:none; max-height: 5000px; overflow: hidden;"><div style="display:table; pointer-events: all; margin: 0 auto; margin-top: -2px; max-width: 60%; -webkit-border-radius: 20px;-moz-border-radius: 20px;border-radius: 2px;color: white;background:${n}; position: relative;"><div style="max-height: 60vh; overflow-y: auto; padding: 14px 24px 14px 24px;">${e}</div></div></div>`,i.$("#flashinfo-div").addClass("hover"),l=i.$(i.html(c)).appendTo("#flashinfo-div"),void 0!==t&&void 0!==t.minimized&&t.minimized&&l.css("max-height","8px")):l=i.$(i.html(c)).appendTo(a),void 0!==t&&void 0!==t.permanent&&t.permanent?l.slideDown(800):void 0!==t&&void 0!==t.hoverInfo&&t.hoverInfo?l.slideDown(800).delay(4e3).queue((function(){i.$("#flashinfo-div").removeClass("hover"),l.css("max-height","8px")})):l.slideDown(800).delay(4e3).slideUp(800,(()=>{i.$(this).remove()})),l}function q(e,t,n=(()=>{}),r=(()=>{}),a=!1){return o(this,void 0,void 0,(function*(){return new Promise((function(o,l){let c=s.storage.lang("Ok"),u=s.storage.lang("Cancel");a&&(c=s.storage.lang("Yes"),u=s.storage.lang("No"));const h=G(e=`<div style="text-align: center;">${e}</div><div style="display: flex; justify-content: space-around;"><button class="Yes" style="background-color: transparent; border: none; color: rgb(255,64,129);margin-top: 10px; cursor:pointer;">${c}</button><button class="Cancel" style="background-color: transparent; border: none; color: rgb(255,64,129);margin-top: 10px; cursor:pointer;">${u}</button></div>`,{permanent:!0,position:"top",type:t});h.find(".Yes").click((function(e){o(!0),i.$(e.target).parentsUntil(".flash").fadeOut(300,(function(){i.$(this).remove()})),n()})),h.find(".Cancel").click((function(e){o(!1),i.$(e.target).parentsUntil(".flash").fadeOut(300,(function(){i.$(this).remove()})),r()}))}))}))}let J=!1,X=[];function Y(e,t=".mdl-layout__content"){function n(e,t){if(!i.$(e).is(":visible"))return!1;if(i.$(e).hasClass("lazyBack"))i.$(e).css("background-image",`url(${e.getAttribute("data-src")})`).removeClass("lazyBack");else{const n=new Image,i=e.getAttribute("data-src");n.onload=function(){e.parent?e.parent.replaceChild(n,e):e.src=i,t&&t()},n.src=i}}for(let e=0;e<X.length;e++)$(X[e]).addClass("init");X=[];const s=e.find("img.lazy.init, .lazyBack.init"),r=function(){for(let e=0;e<X.length;e++)a.elementInViewport(X[e],600)&&n(X[e],(function(){X.splice(e,e)})),$(X[e]).length||X.splice(e,e)};for(let e=0;e<s.length;e++)X.push(s[e]),$(s[e]).removeClass("init");r(),J||(J=!0,e.find(t).scroll((function(){r()})))}function Z(e,t=0){const n=e.getBoundingClientRect();return n.top>=0&&n.left>=0&&n.top-t<=(window.innerHeight||document.documentElement.clientHeight)}function Q(e){return new Promise((t=>{setTimeout(t,e)}))}function ee(e,t,n){switch(e){case"mal":return`https://myanimelist.net/${t}/${n}`;case"anilist":return`https://anilist.co/${t}/${n}`;case"kitsu":return`https://kitsu.io/${t}/${n}`;case"simkl":return`https://simkl.com/${t}/${n}`;default:throw`${e} not a valid page`}}function te(e=0){const t=new Date;t.setDate(t.getDate()+e);const n=t.getMonth()<9?`0${t.getMonth()+1}`:t.getMonth()+1,i=t.getDate()<10?`0${t.getDate()}`:t.getDate();return`${t.getFullYear()}-${n}-${i}`}function ne(e){return $("<textarea/>").html(i.html(e)).text()}function ie(){return Boolean("undefined"!=typeof browser&&"undefined"!=typeof chrome)}function se(){const e=()=>Boolean(!document.visibilityState||"visible"===document.visibilityState);if(e())return Promise.resolve();r.log("Page in background");const{asyncWaitUntilTrue:t}=T((()=>e()));return t().then((()=>{r.log("Page is visible")}))}function re(e){return e.split("/").length<4&&(e+="/"),e.replace(/\?.*/,"?")}function ae(){return o(this,void 0,void 0,(function*(){const e=yield s.storage.list();let t=0;i.$.each(e,(function(e,n){a.syncRegex.test(String(e))||/(^tagSettings\/.*)/.test(String(e))||(s.storage.remove(String(e)),t++)})),a.flashm(`Cache Cleared [${t}]`)}))}function oe(e,t){return e.toLowerCase()<t.toLowerCase()?-1:e.toLowerCase()>t.toLowerCase()?1:0}function le(e,t){const n=new URL(e),{host:i}=n;return i===t||i.endsWith(`.${t}`)}function ce(e){return!e||e.length<2?e:e.charAt(0).toUpperCase()+e.slice(1)}},19947:(e,t,n)=>{"use strict";n.r(t),n.d(t,{$:()=>s,html:()=>r});var i=n(27856);const s=jQuery;function r(e){return i.sanitize(e,{SAFE_FOR_JQUERY:!0,ALLOW_UNKNOWN_PROTOCOLS:!0,ADD_ATTR:["target"]})}},83744:(e,t)=>{"use strict";t.Z=(e,t)=>{const n=e.__vccOpts||e;for(const[e,i]of t)n[e]=i;return n}},16245:e=>{"use strict";e.exports=JSON.parse('[{"key":"nineAnime","name":"9anime","domain":"https://9anime.to","database":"9anime","search":{"anime":"https://9anime.to/filter?keyword={searchtermPlus}","manga":null}},{"key":"Crunchyroll","name":"Crunchyroll","domain":"https://www.crunchyroll.com","database":"Crunchyroll","search":{"anime":"https://www.crunchyroll.com/search?q={searchtermPlus}","manga":null}},{"key":"Vrv","name":"Vrv","domain":"https://vrv.co","database":"Vrv","search":{"anime":"https://vrv.co/?q={searchterm}","manga":null}},{"key":"Mangadex","name":"Mangadex","domain":"https://www.mangadex.org","database":"Mangadex","search":{"anime":null,"manga":"https://mangadex.org/titles?q={searchterm}"}},{"key":"Gogoanime","name":"Gogoanime","domain":"https://gogoanime.tv","database":"Gogoanime","search":{"anime":"https://www1.gogoanime.ai/search.html?keyword={searchterm}","manga":null}},{"key":"TurkAnime","name":"TurkAnime","domain":"https://www.turkanime.co","database":null,"search":{"anime":"home","manga":null}},{"key":"animepahe","name":"animepahe","domain":"https://animepahe.com","database":"animepahe","search":{"anime":"home","manga":null}},{"key":"Netflix","name":"Netflix","domain":"https://www.netflix.com","database":"Netflix","search":{"anime":"https://www.netflix.com/search?q={searchterm}","manga":null}},{"key":"Animeflv","name":"Animeflv","domain":"https://animeflv.net","database":null,"search":{"anime":"https://www3.animeflv.net/browse?q={searchtermPlus}","manga":null}},{"key":"Jkanime","name":"Jkanime","domain":"https://jkanime.net","database":null,"search":{"anime":"https://jkanime.net/buscar/{searchterm}","manga":null}},{"key":"Proxer","name":"Proxer","domain":"https://proxer.me","database":null,"search":{"anime":"https://proxer.me/search?s=search&name={searchterm}&typ=all-anime&tags=&notags=#top","manga":"https://proxer.me/search?s=search&name={searchterm}&typ=all-manga&tags=&notags=#top"}},{"key":"Wakanim","name":"Wakanim","domain":"https://www.wakanim.tv","database":null,"search":{"anime":"https://www.wakanim.tv/de/v2/catalogue/search?search={searchterm}","manga":null}},{"key":"Emby","name":"Emby","domain":"http://app.emby.media","database":null,"search":{"anime":"home","manga":null}},{"key":"Plex","name":"Plex","domain":"http://app.plex.tv","database":null,"search":{"anime":"home","manga":null}},{"key":"Aniflix","name":"Aniflix","domain":"https://www1.aniflix.tv","database":null,"search":{"anime":"home","manga":null}},{"key":"KickAssAnime","name":"KickAssAnime","domain":"https://kaas.am","database":null,"search":{"anime":"home","manga":null}},{"key":"Shinden","name":"Shinden","domain":"https://shinden.pl","database":null,"search":{"anime":"home","manga":null}},{"key":"Voiranime","name":"Voiranime","domain":"https://voiranime.com","database":null,"search":{"anime":"https://voiranime.com/?s={searchtermPlus}","manga":null}},{"key":"MangaNato","name":"MangaNato","domain":"https://manganato.com","database":"MangaNato","search":{"anime":null,"manga":"https://manganato.com/search/story/{searchterm(_)[noSpecial]}"}},{"key":"VIZ","name":"VIZ","domain":"https://www.viz.com","database":"VIZ","search":{"anime":null,"manga":"https://www.viz.com/search?search={searchtermPlus}"}},{"key":"NekoSama","name":"NekoSama","domain":"https://neko-sama.fr","database":null,"search":{"anime":"home","manga":null}},{"key":"AnimeOdcinki","name":"AnimeOdcinki","domain":"https://anime-odcinki.pl","database":null,"search":{"anime":"https://anime-odcinki.pl/szukaj/{searchtermPlus}","manga":null}},{"key":"AnimeZone","name":"AnimeZone","domain":"https://www.animezone.pl","database":null,"search":{"anime":"home","manga":null}},{"key":"serimanga","name":"serimanga","domain":"https://serimanga.com","database":null,"search":{"anime":null,"manga":"https://serimanga.com/mangalar?search={searchtermPlus}"}},{"key":"mangadenizi","name":"mangadenizi","domain":"https://mangadenizi.com","database":null,"search":{"anime":null,"manga":"home"}},{"key":"moeclip","name":"moeclip","domain":"https://moeclip.com","database":null,"search":{"anime":"https://moeclip.com/search/{searchtermPlus}","manga":null}},{"key":"mangalivre","name":"Mangá Livre","domain":"https://mangalivre.net","database":null,"search":{"anime":null,"manga":"home"}},{"key":"tmofans","name":"tmofans","domain":"https://lectortmo.com","database":null,"search":{"anime":null,"manga":"https://lectortmo.com/library?_pg=1&title={searchtermPlus}"}},{"key":"unionmangas","name":"Union Mangás","domain":"https://unionleitor.top","database":null,"search":{"anime":null,"manga":"home"}},{"key":"MangaPlus","name":"MangaPlus","domain":"https://mangaplus.shueisha.co.jp","database":"MangaPlus","search":{"anime":null,"manga":"https://mangaplus.shueisha.co.jp/search_result?keyword={searchterm}"}},{"key":"JapScan","name":"JapScan","domain":"https://www.japscan.ws","database":null,"search":{"anime":null,"manga":"home"}},{"key":"Hulu","name":"Hulu","domain":"https://www.hulu.com","database":"Hulu","search":{"anime":"home","manga":null}},{"key":"Hidive","name":"Hidive","domain":"https://www.hidive.com","database":"Hidive","search":{"anime":"https://www.hidive.com/search?q={searchtermPlus}","manga":null}},{"key":"FallenAngels","name":"FallenAngels","domain":"https://manga.fascans.com","database":null,"search":{"anime":null,"manga":"home"}},{"key":"PrimeVideo","name":"Amazon Prime Video","domain":"https://www.primevideo.com","database":null,"search":{"anime":"home","manga":null}},{"key":"MangaKatana","name":"MangaKatana","domain":"http://mangakatana.com","database":null,"search":{"anime":null,"manga":"http://mangakatana.com/?search={searchtermPlus}&search_by=book_name"}},{"key":"manga4life","name":"manga4life","domain":"https://manga4life.com","database":null,"search":{"anime":null,"manga":"https://manga4life.com/search/?name={searchterm}"}},{"key":"bato","name":"bato","domain":"https://bato.to","database":null,"search":{"anime":null,"manga":"https://bato.to/search?word={searchtermPlus}"}},{"key":"MangaPark","name":"MangaPark","domain":"https://mangapark.net","database":null,"search":{"anime":null,"manga":"https://mangapark.net/search?word={searchterm}"}},{"key":"AnimesHouse","name":"AnimesHouse","domain":"https://animeshouse.net","database":null,"search":{"anime":"home","manga":null}},{"key":"AnimeXin","name":"AnimeXin","domain":"https://animexinax.com","database":null,"search":{"anime":"https://animexinax.com/?s={searchtermPlus}","manga":null}},{"key":"MonosChinos","name":"MonosChinos","domain":"https://monoschinos2.com","database":null,"search":{"anime":"https://monoschinos2.com/buscar?q={searchtermPlus}","manga":null}},{"key":"AnimeFire","name":"AnimeFire","domain":"https://animefire.net","database":null,"search":{"anime":"home","manga":null}},{"key":"OtakuFR","name":"OtakuFR","domain":"https://otakufr.co","database":null,"search":{"anime":"https://otakufr.co/toute-la-liste-affiches/?q={searchtermPlus}","manga":null}},{"key":"Samehadaku","name":"Samehadaku","domain":"https://samehadaku.vip","database":null,"search":{"anime":"https://samehadaku.vip/?s={searchtermPlus}","manga":null}},{"key":"mangatx","name":"mangatx","domain":"https://mangatx.com","database":null,"search":{"anime":null,"manga":"https://mangatx.com/?s={searchtermPlus}&post_type=wp-manga&post_type=wp-manga"}},{"key":"manhuafast","name":"manhuafast","domain":"https://manhuafast.com","database":null,"search":{"anime":null,"manga":"https://manhuafast.com/?s={searchtermPlus}&post_type=wp-manga&post_type=wp-manga"}},{"key":"TRanimeizle","name":"TRanimeizle","domain":"https://www.tranimeizle.net/","database":null,"search":{"anime":"home","manga":null}},{"key":"AnimeStreamingFR","name":"AnimeStreamingFR","domain":"https://beta.animestreamingfr.fr","database":null,"search":{"anime":"https://beta.animestreamingfr.fr/catalogue/search?query={searchtermPlus}","manga":null}},{"key":"Furyosquad","name":"Furyosquad","domain":"https://furyosquad.com/","database":null,"search":{"anime":null,"manga":"home"}},{"key":"AnimeId","name":"AnimeId","domain":"https://www.animeid.tv","database":null,"search":{"anime":"home","manga":null}},{"key":"MyAnimeListVideo","name":"MyAnimeList","domain":"https://myanimelist.net","database":null,"search":{"anime":"https://myanimelist.net/anime.php?q={searchterm}","manga":"https://myanimelist.net/manga.php?q={searchterm}"}},{"key":"AnimeUnity","name":"AnimeUnity","domain":"https://animeunity.it","database":null,"search":{"anime":"home","manga":null}},{"key":"MangaHere","name":"MangaHere","domain":"http://www.mangahere.cc","database":null,"search":{"anime":null,"manga":"http://www.mangahere.cc/search?title={searchtermPlus}"}},{"key":"MangaFox","name":"MangaFox","domain":"http://fanfox.net","database":"MangaFox","search":{"anime":null,"manga":"http://fanfox.net/search?title={searchtermPlus}"}},{"key":"DesuOnline","name":"DesuOnline","domain":"https://desu-online.pl","database":null,"search":{"anime":"https://desu-online.pl/?s={searchtermPlus}","manga":null}},{"key":"WuxiaWorld","name":"WuxiaWorld","domain":"https://wuxiaworld.site","database":null,"search":{"anime":null,"manga":"https://wuxiaworld.site/?s={searchtermPlus}&post_type=wp-manga"}},{"key":"LeviatanScans","name":"LeviatanScans","domain":"https://en.leviatanscans.com","database":null,"search":{"anime":null,"manga":"https://en.leviatanscans.com/?s={searchtermPlus}"}},{"key":"ReaperScans","name":"ReaperScans","domain":"https://reaperscans.com","database":null,"search":{"anime":null,"manga":"home"}},{"key":"LynxScans","name":"LynxScans","domain":"https://lynxscans.com","database":null,"search":{"anime":null,"manga":"https://lynxscans.com/comics?query={searchtermPlus}"}},{"key":"SKScans","name":"SKScans","domain":"https://skscans.com","database":null,"search":{"anime":null,"manga":"https://skscans.com/?s={searchtermPlus}"}},{"key":"ZeroScans","name":"ZeroScans","domain":"https://zeroscans.com","database":null,"search":{"anime":null,"manga":"home"}},{"key":"DeathTollScans","name":"DeathTollScans","domain":"https://reader.deathtollscans.net","database":null,"search":{"anime":null,"manga":"home"}},{"key":"ManhuaPlus","name":"ManhuaPlus","domain":"https://manhuaplus.com","database":null,"search":{"anime":null,"manga":"https://manhuaplus.com/?s={searchtermPlus}&post_type=wp-manga"}},{"key":"Readm","name":"Readm","domain":"https://readm.org","database":null,"search":{"anime":null,"manga":"home"}},{"key":"tioanime","name":"tioanime","domain":"https://tioanime.com","database":null,"search":{"anime":"https://tioanime.com/directorio?q={searchtermPlus}","manga":null}},{"key":"YugenAnime","name":"YugenAnime","domain":"https://yugen.to","database":"YugenAnime","search":{"anime":"https://yugenanime.ro/search/?q={searchtermPlus}","manga":null}},{"key":"MangaSee","name":"MangaSee","domain":"https://mangasee123.com","database":"MangaSee","search":{"anime":null,"manga":"https://mangasee123.com/search/?name={searchterm}"}},{"key":"Okanime","name":"Okanime","domain":"https://okanime.tv","database":null,"search":{"anime":"https://okanime.tv/search?search={searchtermPlus}","manga":null}},{"key":"BSTO","name":"bs.to","domain":"https://bs.to","database":null,"search":{"anime":"home","manga":null}},{"key":"AsuraScans","name":"AsuraScans","domain":"https://asura.gg","database":null,"search":{"anime":null,"manga":"https://www.asurascans.com/?s={searchtermPlus}"}},{"key":"Jellyfin","name":"Jellyfin","domain":"https://jellyfin.org/","database":null,"search":{"anime":"home","manga":null}},{"key":"An1me","name":"An1me","domain":"https://an1me.nl","database":null,"search":{"anime":"https://an1me.nl/?s={searchtermPlus}&post_type=wp-manga","manga":null}},{"key":"MangaJar","name":"MangaJar","domain":"https://mangajar.com","database":null,"search":{"anime":null,"manga":"https://mangajar.com/search?q={searchtermPlus}"}},{"key":"AnimeDao","name":"AnimeDao","domain":"https://animedao.to","database":null,"search":{"anime":"https://animedao.to/search/?search={searchtermPlus}","manga":null}},{"key":"Otakustv","name":"Otakustv","domain":"https://www.otakustv.com","database":null,"search":{"anime":"https://www.otakustv.com/buscador.php?buscador={searchterm}","manga":null}},{"key":"Komga","name":"Komga","domain":"https://komga.org","database":null,"search":{"anime":null,"manga":"home"}},{"key":"AnimeWho","name":"AnimeWho","domain":"https://animewho.com","database":null,"search":{"anime":"home","manga":null}},{"key":"AnimeSuge","name":"AnimeSuge","domain":"https://animesuge.to","database":null,"search":{"anime":"home","manga":null}},{"key":"Toonily","name":"Toonily","domain":"https://toonily.net","database":null,"search":{"anime":null,"manga":"https://toonily.net/?s={searchtermPlus}&post_type=wp-manga"}},{"key":"Fumetsu","name":"Fumetsu","domain":"https://fumetsu.pl","database":null,"search":{"anime":"home","manga":null}},{"key":"FrixySubs","name":"FrixySubs","domain":"https://frixysubs.pl","database":null,"search":{"anime":"home","manga":null}},{"key":"Guya","name":"Guya & Cubari","domain":"https://guya.moe","database":null,"search":{"anime":null,"manga":"home"}},{"key":"MangaHub","name":"MangaHub","domain":"https://mangahub.io","database":null,"search":{"anime":null,"manga":"https://mangahub.io/search?q={searchterm}"}},{"key":"ComicK","name":"ComicK","domain":"https://comick.app","database":"Comick","search":{"anime":null,"manga":"https://comick.app/search?q={searchterm}"}},{"key":"Japanread","name":"Japanread","domain":"https://www.japanread.cc/","database":null,"search":{"anime":null,"manga":"https://www.japanread.cc/manga-list?q={searchterm}"}},{"key":"Bentomanga","name":"Bentomanga","domain":"https://www.bentomanga.com","database":null,"search":{"anime":null,"manga":"https://www.bentomanga.com/manga_list?search={searchterm}"}},{"key":"MangaSushi","name":"MangaSushi","domain":"https://mangasushi.net","database":null,"search":{"anime":null,"manga":"https://mangasushi.net/?s={searchtermPlus}&post_type=wp-manga"}},{"key":"HunlightScans","name":"HunlightScans","domain":"https://hunlight-scans.info/","database":null,"search":{"anime":null,"manga":"https://hunlight-scans.info/comics?query={searchtermPlus}"}},{"key":"TritiniaScans","name":"TritiniaScans","domain":"https://tritinia.com","database":null,"search":{"anime":null,"manga":"https://tritinia.com/?s={searchtermPlus}&post_type=wp-manga"}},{"key":"ReadManhua","name":"ReadManhua","domain":"https://readmanhua.net","database":null,"search":{"anime":null,"manga":"https://readmanhua.net/?s={searchtermPlus}&post_type=wp-manga"}},{"key":"FlameScans","name":"FlameScans","domain":"https://flamescans.org","database":null,"search":{"anime":null,"manga":"https://flamescans.org/?s={searchtermPlus}"}},{"key":"ImmortalUpdates","name":"ImmortalUpdates","domain":"https://immortalupdates.com","database":null,"search":{"anime":null,"manga":"https://immortalupdates.com/?s={searchtermPlus}&post_type=wp-manga"}},{"key":"Zoro","name":"Zoro","domain":"https://zoro.to","database":"Zoro","search":{"anime":"https://zoro.to/search?keyword={searchtermPlus}","manga":null}},{"key":"Funimation","name":"Funimation","domain":"https://www.funimation.com","database":"Funimation","search":{"anime":"https://www.funimation.com/search/?q={searchterm}","manga":null}},{"key":"Kitsune","name":"Kitsune","domain":"https://beta.kitsune.tv","database":null,"search":{"anime":"https://kitsune.tv/shows?q={searchterm}","manga":null}},{"key":"LHTranslation","name":"LHTranslation","domain":"https://lhtranslation.net","database":null,"search":{"anime":null,"manga":"https://lhtranslation.net/?s={searchtermPlus}&post_type=wp-manga"}},{"key":"MangasOrigines","name":"MangasOrigines","domain":"https://mangas-origines.fr/","database":null,"search":{"anime":null,"manga":"https://mangas-origines.fr/?s={searchtermPlus}&post_type=wp-manga"}},{"key":"BlueSolo","name":"BlueSolo","domain":"https://www.bluesolo.org","database":null,"search":{"anime":null,"manga":"home"}},{"key":"DisasterScans","name":"DisasterScans","domain":"https://disasterscans.com","database":null,"search":{"anime":null,"manga":"https://disasterscans.com/?s={searchtermPlus}&post_type=wp-manga"}},{"key":"DynastyScans","name":"DynastyScans","domain":"https://dynasty-scans.com","database":null,"search":{"anime":null,"manga":"https://dynasty-scans.com/search?q={searchtermPlus}"}},{"key":"Aniworld","name":"Aniworld","domain":"https://aniworld.to","database":null,"search":{"anime":"https://aniworld.to/search?q={searchterm}","manga":null}},{"key":"BetterAnime","name":"BetterAnime","domain":"https://betteranime.net","database":null,"search":{"anime":"https://betteranime.net/pesquisa?titulo={searchtermPlus}","manga":null}},{"key":"BilibiliComics","name":"BilibiliComics","domain":"https://www.bilibilicomics.com","database":null,"search":{"anime":null,"manga":"https://www.bilibilicomics.com/search?keyword={searchterm( )[noLowercase]}"}},{"key":"MangaReader","name":"MangaReader","domain":"https://mangareader.to","database":"MangaReader","search":{"anime":null,"manga":"https://mangareader.to/search?keyword={searchtermPlus}"}},{"key":"AnimeOnsen","name":"AnimeOnsen","domain":"https://animeonsen.xyz","database":null,"search":{"anime":"https://www.animeonsen.xyz/search/{searchterm}","manga":null}},{"key":"Puray","name":"Puray","domain":"https://puray.moe","database":null,"search":{"anime":"home","manga":null}},{"key":"Animetoast","name":"Animetoast","domain":"https://www.animetoast.cc","database":null,"search":{"anime":"https://www.animetoast.cc/?s={searchterm}","manga":null}},{"key":"MuitoManga","name":"MuitoMangá","domain":"https://muitomanga.com","database":null,"search":{"anime":null,"manga":"https://muitomanga.com/buscar?q={searchtermPlus}"}},{"key":"RealmScans","name":"RealmScans","domain":"https://realmscans.com","database":null,"search":{"anime":null,"manga":"https://realmscans.com/?s={searchtermPlus}"}},{"key":"LuminousScans","name":"LuminousScans","domain":"https://luminousscans.com","database":null,"search":{"anime":null,"manga":"https://luminousscans.com/?s={searchtermPlus}"}},{"key":"Animeworld","name":"Animeworld","domain":"https://www.animeworld.tv","database":null,"search":{"anime":"home","manga":null}},{"key":"MangaBuddy","name":"MangaBuddy","domain":"https://mangabuddy.com","database":null,"search":{"anime":null,"manga":"https://mangabuddy.com/search?q={searchtermPlus}"}},{"key":"Vostfree","name":"Vostfree","domain":"https://vostfree.cx","database":null,"search":{"anime":"https://vostfree.tv/index.php?do=search&subaction=search&story={searchterm}","manga":null}},{"key":"VoidScans","name":"VoidScans","domain":"https://void-scans.com","database":null,"search":{"anime":null,"manga":"https://void-scans.com/?s={searchtermPlus}"}},{"key":"ToonAnime","name":"ToonAnime","domain":"https://vvww.toonanime.cc","database":null,"search":{"anime":"https://vvww.toonanime.cc/?story={searchtermPlus}&do=search&subaction=search","manga":null}},{"key":"ADKami","name":"ADKami","domain":"https://www.adkami.com/","database":null,"search":{"anime":"https://www.adkami.com/video?search={searchtermPlus}","manga":null}},{"key":"Kaguya","name":"Kaguya","domain":"https://kaguya.app","database":null,"search":{"anime":"https://kaguya.app/browse?keyword={searchtermPlus}","manga":null}},{"key":"Hdrezka","name":"Hdrezka","domain":"https://hdrezka.ag","database":null,"search":{"anime":"https://hdrezka.ag/search/?do=search&subaction=search&q={searchterm}","manga":null}},{"key":"ADN","name":"ADN","domain":"https://animationdigitalnetwork.fr","database":null,"search":{"anime":"https://animationdigitalnetwork.fr/video?search={searchterm}","manga":null}},{"key":"Aniyan","name":"Aniyan","domain":"https://aniyan.net","database":"Aniyan","search":{"anime":"https://aniyan.net/?s={searchtermPlus}","manga":null}},{"key":"marin","name":"marin","domain":"https://marin.moe","database":"Marin","search":{"anime":"https://marin.moe/anime?search={searchterm}","manga":null}},{"key":"Isekaiscan","name":"Isekaiscan","domain":"https://isekaiscan.com","database":null,"search":{"anime":null,"manga":"https://isekaiscan.com/?s={searchtermPlus}&post_type=wp-manga"}},{"key":"Docchi","name":"Docchi","domain":"https://docchi.pl","database":null,"search":{"anime":"home","manga":null}},{"key":"FRAnime","name":"FRAnime","domain":"https://franime.fr","database":null,"search":{"anime":"https://franime.fr/recherche?search={searchtermPlus}","manga":null}},{"key":"FMTeam","name":"FMTeam","domain":"https://fmteam.fr/","database":null,"search":{"anime":null,"manga":"home"}},{"key":"Animelon","name":"Animelon","domain":"https://www.animelon.com","database":null,"search":{"anime":"https://www.animelon.com/search?searchTerm={searchTerm}","manga":null}},{"key":"AnimeSama","name":"AnimeSama","domain":"https://anime-sama.fr","database":null,"search":{"anime":"https://anime-sama.fr/catalogue/","manga":null}},{"key":"MangaFire","name":"MangaFire","domain":"https://mangafire.to","database":"MangaFire","search":{"anime":null,"manga":"https://mangafire.to/filter?keyword={searchtermPlus}"}},{"key":"Pactedanime","name":"Pactedanime","domain":"https://pactedanime.com","database":null,"search":{"anime":"https://pactedanime.com/?s={searchtermPlus}","manga":null}},{"key":"projectsuki","name":"projectsuki","domain":"https://projectsuki.com","database":null,"search":{"anime":null,"manga":"https://projectsuki.com/search?q={searchtermPlus}"}},{"key":"AnimeOnegai","name":"AnimeOnegai","domain":"https://www.animeonegai.com","database":null,"search":{"anime":"https://www.animeonegai.com/es/search?q={searchterm}","manga":null}},{"key":"FirstKiss","name":"1stKissManga","domain":"https://1stkissmanga.me","database":null,"search":{"anime":null,"manga":"https://1stkissmanga.me/?s={searchtermPlus}"}},{"key":"AnimeKO","name":"AnimeKO","domain":"https://animeko.co","database":null,"search":{"anime":"https://animeko.co/anime?search={searchtermPlus}","manga":null}},{"key":"Animeflix","name":"Animeflix","domain":"https://animeflix.live","database":null,"search":{"anime":"https://animeflix.live/search/{searchterm}","manga":null}}]')}},t={};function n(i){var s=t[i];if(void 0!==s)return s.exports;var r=t[i]={exports:{}};return e[i].call(r.exports,r,r.exports,n),r.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var i in t)n.o(t,i)&&!n.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{"use strict";var e=n(58339);function t(t=""){const n=e.settings.get("syncMode");return"SIMKL"!==n||"manga"!==t&&-1===t.indexOf("/manga/")?n:e.settings.get("syncModeSimkl")}var i=n(9e4);let s;if(function(){try{return localStorage.getItem("x"),!0}catch(e){return i.info("Local storage is not available",e),!1}}())s=localStorage;else{let e={};s={getItem:t=>t in e?e[t]:null,setItem(t,n){e[t]=n},removeItem(t){t in e&&delete e[t]},clear(){e={}}}}const r=s;var a,o,l,c=n(58339),u=function(e,t,n,i){return new(n||(n=Promise))((function(s,r){function a(e){try{l(i.next(e))}catch(e){r(e)}}function o(e){try{l(i.throw(e))}catch(e){r(e)}}function l(e){e.done?s(e.value):function(e){return e instanceof n?e:new n((function(t){t(e)}))}(e.value).then(a,o)}l((i=i.apply(e,t||[])).next())}))};class h{constructor(e,t,n=!0,i=0){return this.key=e,this.ttl=t,this.localStorage=n,this.refetchTtl=i,this}containsValue(e){return null!=e}valueValid(e,t){return!(!e||!e.timestamp)&&(new Date).getTime()<e.timestamp+t}ttlValid(e){return this.valueValid(e,this.ttl)}refetchTtlValid(e){return this.valueValid(e,this.refetchTtl)}hasValue(){return u(this,void 0,void 0,(function*(){const e=yield this.getStorage();return!(!this.containsValue(e)||!this.ttlValid(e))}))}hasValueAndIsNotEmpty(){return u(this,void 0,void 0,(function*(){const e=yield this.getStorage();return!!(this.containsValue(e)&&void 0!==e.data&&null!==e.data&&Object.keys(e.data).length&&this.ttlValid(e))}))}fullState(){return u(this,void 0,void 0,(function*(){const e=yield this.getStorage(),t=this.containsValue(e)&&this.refetchTtlValid(e),n=this.ttlValid(e);return{value:e,hasValue:t,isValid:n,refetch:t&&!n}}))}getValue(){return u(this,void 0,void 0,(function*(){return(yield this.getStorage()).data}))}setValue(e){return u(this,void 0,void 0,(function*(){const t={data:e,timestamp:(new Date).getTime()};return this.localStorage?r.setItem(this.key,JSON.stringify(t)):c.storage.set(this.key,t)}))}clearValue(){return u(this,void 0,void 0,(function*(){return this.localStorage?r.removeItem(this.key):c.storage.remove(this.key)}))}getStorage(){return u(this,void 0,void 0,(function*(){return this.localStorage?JSON.parse(r.getItem(this.key)):c.storage.get(this.key)}))}}(o=a||(a={}))[o.NoState=0]="NoState",o[o.Watching=1]="Watching",o[o.Completed=2]="Completed",o[o.Onhold=3]="Onhold",o[o.Dropped=4]="Dropped",o[o.PlanToWatch=6]="PlanToWatch",o[o.All=7]="All",o[o.Rewatching=23]="Rewatching",function(e){e[e.NoScore=0]="NoScore",e[e.R1=1]="R1",e[e.R2=2]="R2",e[e.R3=3]="R3",e[e.R4=4]="R4",e[e.R5=5]="R5",e[e.R6=6]="R6",e[e.R7=7]="R7",e[e.R8=8]="R8",e[e.R9=9]="R9",e[e.R10=10]="R10"}(l||(l={}));var d=n(56387),p=n(9e4),m=n(58339);const f=Math.floor(1e9*Math.random()),g=new d.EventEmitter2({wildcard:!0});function y(e,...t){p.m("Global").m("Emit").debug(e,...t),g.emit(`${e}`,...t),void 0!==m&&m&&"webextension"===m.type&&chrome.runtime.sendMessage({name:"emitter",item:{event:e,params:t,id:f}})}void 0!==m&&m&&"webextension"===m.type&&chrome.runtime.onMessage.addListener(((e,t,n)=>{e.name&&"emitter"===e.name&&(p.m("Global").m("Event").debug(e.item.id,e.item.event,e.item.params),e.item.id!==f&&g.emit(e.item.event,...e.item.params))}));var v=n(58339);class b extends Error{constructor(e){super(e),this.name="NotAutenticatedError"}}class _ extends Error{constructor(e){super(e),this.name="UrlNotSupportedError"}}class w extends Error{constructor(e){super(e),this.name="ServerOfflineError"}}class k extends Error{constructor(e){super(e),this.name="NotFoundError"}}class S extends Error{constructor(e){super(e),this.name="UnexpectedResponseError"}}function E(e){try{return JSON.parse(e)}catch(e){throw new S(e.message)}}n(58339),n(9e4),n(9375),Object.seal(g),n(19947),n(9375),n(58339);var x,I,T=n(58339),N=function(e,t,n,i){return new(n||(n=Promise))((function(s,r){function a(e){try{l(i.next(e))}catch(e){r(e)}}function o(e){try{l(i.throw(e))}catch(e){r(e)}}function l(e){e.done?s(e.value):function(e){return e instanceof n?e:new n((function(t){t(e)}))}(e.value).then(a,o)}l((i=i.apply(e,t||[])).next())}))};function O(e){return N(this,void 0,void 0,(function*(){let t="https://api.myanimelist.net/v2/"+e.path;e.fields&&e.fields.length&&(t+=t.includes("?")?"&":"?",t+=`fields=${e.fields.join(",")}`);const n={Authorization:`Bearer ${T.settings.get("malToken")}`,"Content-Type":"application/x-www-form-urlencoded"};let i="";if(e.dataObj){const t=[];for(const n in e.dataObj){const i=encodeURIComponent(n),s=encodeURIComponent(e.dataObj[n]);t.push(`${i}=${s}`)}i=t.join("&")}return T.request.xhr(e.type,{url:t,headers:n,data:i}).then((t=>N(this,void 0,void 0,(function*(){var n,i,s;if(t.status>499&&t.status<600||0===t.status)throw new w(`Server Offline status: ${t.status}`);let r;try{r=JSON.parse(t.responseText)}catch(e){if(L(t.responseText))throw new Error(T.storage.lang("Error_Blocked",["MyAnimeList"]));throw e}if(r&&r.error)switch(r.error){case"forbidden":case"invalid_token":if(yield function(e){return N(this,void 0,void 0,(function*(){const t=e.m("Refresh");t.log("Refresh Access Token");const n=T.settings.get("malRefresh");return!!n&&T.request.xhr("POST",{url:"https://myanimelist.net/v1/oauth2/token",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:`client_id=10093a3f9f0174b6b5577c40e9accdae&grant_type=refresh_token&refresh_token=${n}`}).then((e=>{try{return E(e.responseText)}catch(t){if(L(e.responseText))throw new Error(T.storage.lang("Error_Blocked",["MyAnimeList"]));throw t}})).then((e=>e&&e.refresh_token&&e.access_token?(T.settings.set("malToken",e.access_token),T.settings.set("malRefresh",e.refresh_token),!0):e&&e.error?(t.error(e.error,"|",e.message),T.settings.set("malRefresh",""),!1):(t.error("Something went wrong"),!1)))}))}(this.logger))return this.apiCall(e);throw new b(null!==(n=r.message)&&void 0!==n?n:r.error);case"not_found":throw new k(null!==(i=r.message)&&void 0!==i?i:r.error);case"invalid_content":throw new Error("This Entry is currently pending approval. It can´t be saved to mal for now");default:throw new Error(null!==(s=r.message)&&void 0!==s?s:r.error)}if(400===t.status)throw new Error("Invalid Parameters");return r}))))}))}function L(e){return Boolean(e.includes("Request blocked")||e.includes("your IP has been banned"))}!function(e){e[e.watching=a.Watching]="watching",e[e.completed=a.Completed]="completed",e[e.on_hold=a.Onhold]="on_hold",e[e.dropped=a.Dropped]="dropped",e[e.plan_to_watch=a.PlanToWatch]="plan_to_watch"}(x||(x={})),function(e){e[e.reading=a.Watching]="reading",e[e.completed=a.Completed]="completed",e[e.on_hold=a.Onhold]="on_hold",e[e.dropped=a.Dropped]="dropped",e[e.plan_to_read=a.PlanToWatch]="plan_to_read"}(I||(I={})),n(58339),n(9e4);var C=n(9e4),A=n(58339);const P=C.m("anilist","#3db4f2");var R;function M(e,t,n=!0){return i=this,s=void 0,a=function*(){if(n&&!A.settings.get("anilistToken"))throw new b("No token found");const i={"Content-Type":"application/json",Accept:"application/json"};return A.settings.get("anilistToken")&&(i.Authorization=`Bearer ${A.settings.get("anilistToken")}`),A.request.xhr("POST",{url:"https://graphql.anilist.co",headers:i,data:JSON.stringify({query:e,variables:t})}).then((i=>{if(i.status>499&&i.status<600||0===i.status)throw new w(`Server Offline status: ${i.status}`);if(403===i.status)throw new Error(A.storage.lang("Error_Blocked",["AniList"]));const s=E(i.responseText);if(void 0!==s.errors&&s.errors.length){P.error("[SINGLE]","Error",s.errors);const i=s.errors[0];switch(i.status){case 400:if("Invalid token"===i.message&&!n)return A.settings.set("anilistToken",null),M(e,t,n);if("validation"===i.message)throw new Error("Wrong request format");if(i.message.includes("invalid"))throw new Error("Wrong request format");throw new b(i.message);case 404:throw new k(i.message);default:throw new Error(i.message)}}return s}))},new((r=void 0)||(r=Promise))((function(e,t){function n(e){try{l(a.next(e))}catch(e){t(e)}}function o(e){try{l(a.throw(e))}catch(e){t(e)}}function l(t){t.done?e(t.value):function(e){return e instanceof r?e:new r((function(t){t(e)}))}(t.value).then(n,o)}l((a=a.apply(i,s||[])).next())}));var i,s,r,a}function U(e){return!e||e.endsWith("/default.jpg")?"":e}!function(e){e[e.CURRENT=a.Watching]="CURRENT",e[e.PLANNING=a.PlanToWatch]="PLANNING",e[e.COMPLETED=a.Completed]="COMPLETED",e[e.DROPPED=a.Dropped]="DROPPED",e[e.PAUSED=a.Onhold]="PAUSED",e[e.REPEATING=a.Rewatching]="REPEATING"}(R||(R={})),n(58339),n(9e4);var j=n(9e4),D=n(58339);const F=j.m("kitsu","#d65e43");function V(e,t=null){const n={current:1,planned:6,completed:2,dropped:4,on_hold:3};return null!==t?Object.keys(n).find((e=>n[e]===t)):n[e]}function z(e,t){let n;switch(D.settings.get("kitsuOptions").titleLanguagePreference){case"english":n=e.en;break;case"romanized":n=e.en_jp;break;default:n=t}if(void 0!==n&&n||(n=e.en),void 0!==n&&n||(n=e.en_jp),void 0!==n&&n||(n=e.ja_jp),void 0===n||!n){const t=Object.keys(e);if(!t.length)return"No Title";n=e[t[0]]}return n}function H(e,t,n={},i=!0){const s={"Content-Type":"application/vnd.api+json",Accept:"application/vnd.api+json"};return i&&(s.Authorization=`Bearer ${D.settings.get("kitsuToken")}`),D.request.xhr(e,{url:t,headers:s,data:JSON.stringify(n)}).then((e=>{if(e.status>499&&e.status<600||0===e.status)throw new w(`Server Offline status: ${e.status}`);if(204===e.status)return{};const t=E(e.responseText);if(void 0!==t.errors&&t.errors.length){F.error("[SINGLE]","Error",t.errors);const e=t.errors[0];switch(parseInt(e.status)){case 401:case 403:throw new b(e.detail);case 404:throw new k(e.detail);default:throw new Error(e.detail)}}return t}))}n(58339),n(9e4);var B=n(9e4),W=n(58339),K=function(e,t,n,i){return new(n||(n=Promise))((function(s,r){function a(e){try{l(i.next(e))}catch(e){r(e)}}function o(e){try{l(i.throw(e))}catch(e){r(e)}}function l(e){e.done?s(e.value):function(e){return e instanceof n?e:new n((function(t){t(e)}))}(e.value).then(a,o)}l((i=i.apply(e,t||[])).next())}))};const G="39e8640b6f1a60aaf60f3f3313475e830517badab8048a4e52ff2d10deb2b9b0";function q(e,t=null){const n={watching:1,plantowatch:6,completed:2,notinteresting:4,hold:3};return null!==t?Object.keys(n).find((e=>n[e]===t)):n[e]}function J(e){if("number"==typeof e)return e;if(e){const t=e.match(/e\d+/i);if(null!==t){const e=parseInt(t[0].replace(/\D/,""));return Number.isNaN(e)?0:e}}return 0}let X;function Y(e=!1){return K(this,void 0,void 0,(function*(){const t=B.m("Simkl","#9b7400").m("list");if(void 0===X)X=yield W.storage.get("simklList");else if(e)return X;const n=yield W.storage.get("simklLastCheck"),i=yield this.call("https://api.simkl.com/sync/activities");if(t.log("Activity",n,i.anime),n&&n.removed_from_list!==i.anime.removed_from_list){const e=yield this.call("https://api.simkl.com/sync/all-items/anime"),n={};if(e)for(let t=0;t<e.anime.length;t++){const i=e.anime[t];void 0!==X[i.show.ids.simkl]&&(n[i.show.ids.simkl]=X[i.show.ids.simkl])}X=n,t.log("remove",X)}let s="";if(n&&X&&(s=`date_from=${n.all}`,n.all===i.anime.all))return t.log("Up to date"),X;if(X||(X={}),n&&n.rated_at!==i.anime.rated_at){const e=yield this.call(`https://api.simkl.com/sync/ratings/anime?${s}`);if(t.log("ratedUpdate",e),e)for(let t=0;t<e.anime.length;t++){const n=e.anime[t];X[n.show.ids.simkl]=n}}const r=yield this.call(`https://api.simkl.com/sync/all-items/anime?${s}`);if(t.log("listUpdate",r),r)for(let e=0;e<r.anime.length;e++){const t=r.anime[e];X[t.show.ids.simkl]=t}return t.log("totalList",X),yield W.storage.set("simklList",X),yield W.storage.set("simklLastCheck",i.anime),X}))}function Z(e,t=!1){return K(this,void 0,void 0,(function*(){const n=yield this.syncList(t);if(e.simkl){if(void 0!==n[e.simkl])return n[e.simkl]}else{if(!e.mal)throw"No id passed";{const t=Object.values(n);for(let n=0;n<t.length;n++){const i=t[n];if(void 0!==i.show.ids.mal&&Number(i.show.ids.mal)===Number(e.mal))return i}}}return null}))}function Q(e,t={},n=!1,i="GET",s=!0){return K(this,void 0,void 0,(function*(){const r=B.m("Simkl","#9b7400").m("call");n&&(e+=`?${new URLSearchParams(Object.entries(t))}`,t=void 0),r.log(i,e,t);const a={"simkl-api-key":G,Accept:"application/vnd.api+json","Content-Type":"application/json"};return s?a.Authorization=`Bearer ${W.settings.get("simklToken")}`:r.log("No login"),W.request.xhr(i,{url:e,headers:a,data:t}).then((e=>K(this,void 0,void 0,(function*(){const t=E(e.responseText);return this.errorHandling(t,e.status),t}))))}))}function ee(e,t){if(t>499&&t<600||0===t)throw new w(`Server Offline status: ${t}`);if(e&&void 0!==e.error){this.logger.error("[SINGLE]","Error",e.error);const{error:t}=e;if(t.code)throw t.code,new Error(t.error);if("user_token_failed"===t)throw new b("user_token_failed");throw t}}n(58339),n(9e4);var te=n(58339),ne=function(e,t,n,i){return new(n||(n=Promise))((function(s,r){function a(e){try{l(i.next(e))}catch(e){r(e)}}function o(e){try{l(i.throw(e))}catch(e){r(e)}}function l(e){e.done?s(e.value):function(e){return e instanceof n?e:new n((function(t){t(e)}))}(e.value).then(a,o)}l((i=i.apply(e,t||[])).next())}))};const ie="z3NJ84kK9iy5NU6SnhdCDB38rr4-jFIJ67bMIUDzdoo",se=`https://shikimori.me/oauth/authorize?client_id=${ie}&redirect_uri=https%3A%2F%2Fmalsync.moe%2Fshikimori%2Foauth&response_type=code&scope=user_rates`,re="https://shikimori.me/api/",ae="https://shikimori.me";function oe(e){return ne(this,void 0,void 0,(function*(){const t=e.type||"GET",n=te.settings.get("shikiToken");if(!n&&!n.access_token&&!e.auth)throw new b("No token set");let i=re+e.path;if(e.parameter&&Object.keys(e.parameter).length){i+=i.includes("?")?"&":"?";const t=[];for(const n in e.parameter)t.push(`${n}=${e.parameter[n]}`);i+=t.join("&")}const s={Authorization:`Bearer ${n.access_token}`,"User-Agent":"MAL-Sync","Content-Type":"application/json"};let r="";return e.dataObj&&(r=JSON.stringify(e.dataObj)),e.auth&&(delete s.Authorization,i="https://shikimori.me/oauth/token"),te.request.xhr(t,{url:i,headers:s,data:r}).then((t=>ne(this,void 0,void 0,(function*(){var i,s,r,a;if(t.status>499&&t.status<600||0===t.status)throw new w(`Server Offline status: ${t.status}`);let o=null;if(t.responseText&&(o=JSON.parse(t.responseText)),401===t.status){if(e.auth)throw new b(null!==(i=o.message)&&void 0!==i?i:o.error);return yield le(n.refresh_token),oe(e)}if(o&&o.error)switch(o.error){case"forbidden":case"invalid_token":if(e.auth)throw new b(null!==(s=o.message)&&void 0!==s?s:o.error);return yield le(n.refresh_token),oe(e);case"not_found":throw new k(null!==(r=o.message)&&void 0!==r?r:o.error);default:throw new Error(null!==(a=o.message)&&void 0!==a?a:o.error)}if(400===t.status)throw new Error("Invalid Parameters");return o}))))}))}function le(e){return ne(this,void 0,void 0,(function*(){const t=yield function(e){const t={client_id:ie,client_secret:"6vkFaJN_wxQHmBoq23ac1z6tZKiAD7xqsXGudkkOqTg",redirect_uri:"https://malsync.moe/shikimori/oauth"};return"code"in e&&(t.code=e.code,t.grant_type="authorization_code"),"refresh_token"in e&&(t.refresh_token=e.refresh_token,t.grant_type="refresh_token"),oe({type:"POST",path:"oauth/token",auth:!0,dataObj:t})}({refresh_token:e}).catch((e=>{throw"invalid_request"===e.message&&te.settings.set("shikiToken",""),e}));yield te.settings.set("shikiToken",{access_token:t.access_token,refresh_token:t.refresh_token})}))}function ce(e,t,n=!1){const i=te.settings.get("shikiOptions");return"ru"===(i&&i.locale?i.locale:"ru")?e||t:n&&t&&e?`${t} / ${e}`:t||e}var ue;!function(e){e[e.watching=a.Watching]="watching",e[e.planned=a.PlanToWatch]="planned",e[e.completed=a.Completed]="completed",e[e.dropped=a.Dropped]="dropped",e[e.on_hold=a.Onhold]="on_hold",e[e.rewatching=a.Rewatching]="rewatching"}(ue||(ue={})),n(58339),n(9e4),n(58339),n(9e4),n(9375),n(58339);var he=n(58339),de=n(9e4),pe=n(9375),me=function(e,t,n,i){return new(n||(n=Promise))((function(s,r){function a(e){try{l(i.next(e))}catch(e){r(e)}}function o(e){try{l(i.throw(e))}catch(e){r(e)}}function l(e){e.done?s(e.value):function(e){return e instanceof n?e:new n((function(t){t(e)}))}(e.value).then(a,o)}l((i=i.apply(e,t||[])).next())}))};function fe(e,t){return me(this,void 0,void 0,(function*(){if(!t)return{};const n=yield he.request.xhr("GET",`https://api.malsync.moe/nc/mal/${e}/${t}/pr`);return JSON.parse(n.responseText)}))}var ge=n(58339);function ye(e,t=!0){if(!e)return"";const n=Date.now();let i,s;if(n>e?(s=!1,i=n-e):(s=!0,i=e-n),i<3e4)return ge.storage.lang("bookmarksItem_now");let r=function(e){let t="";return 1===e.y?t+=` ${e.y} ${ge.storage.lang("bookmarksItem_Year")}`:e.y>1&&(t+=` ${e.y} ${ge.storage.lang("bookmarksItem_Years")}`),1===e.d?t+=` ${e.d} ${ge.storage.lang("bookmarksItem_Day")}`:e.d>1&&(t+=` ${e.d} ${ge.storage.lang("bookmarksItem_Days")}`),1===e.h?t+=` ${e.h} ${ge.storage.lang("bookmarksItem_Hour")}`:e.h>1&&(t+=` ${e.h} ${ge.storage.lang("bookmarksItem_Hours")}`),1===e.m?t+=` ${e.m} ${ge.storage.lang("bookmarksItem_min")}`:e.m>1&&(t+=` ${e.m} ${ge.storage.lang("bookmarksItem_mins")}`),1===e.s?t+=` ${e.s} ${ge.storage.lang("bookmarksItem_sec")}`:e.s>1&&(t+=` ${e.s} ${ge.storage.lang("bookmarksItem_secs")}`),t.trim()}((a=function(e){let t,n,i,s;s=Math.floor(e/1e3),i=Math.floor(s/60),s%=60,n=Math.floor(i/60),i%=60,t=Math.floor(n/24),n%=24;const r=Math.floor(t/365);return t%=365,{y:r,d:t,h:n,m:i,s}}(i)).y>1?a.d>182?{y:a.y+1,d:0,h:0,m:0,s:0}:{y:a.y,d:0,h:0,m:0,s:0}:a.y?{y:a.y,d:a.d,h:0,m:0,s:0}:a.d>3?a.h>11?{y:0,d:a.d+1,h:0,m:0,s:0}:{y:0,d:a.d,h:0,m:0,s:0}:a.d?{y:0,d:a.d,h:a.h,m:0,s:0}:a.h>5?a.m>29?{y:0,d:0,h:a.h+1,m:0,s:0}:{y:0,d:0,h:a.h,m:0,s:0}:a.h?{y:0,d:0,h:a.h,m:a.m,s:0}:a.m>14?{y:0,d:0,h:0,m:a.m,s:0}:{y:0,d:0,h:0,m:a.m,s:a.s});var a;return!s&&t&&(r=ge.storage.lang("bookmarksItem_ago",[r])),r}var ve=n(9e4),be=n(58339),_e=function(e,t,n,i){return new(n||(n=Promise))((function(s,r){function a(e){try{l(i.next(e))}catch(e){r(e)}}function o(e){try{l(i.throw(e))}catch(e){r(e)}}function l(e){e.done?s(e.value):function(e){return e instanceof n?e:new n((function(t){t(e)}))}(e.value).then(a,o)}l((i=i.apply(e,t||[])).next())}))};class we{constructor(e,t){return this.cacheKey=e,this.type=t,this.releaseItem=void 0,this.logger=ve.m("progress").m(e.toString()),this}initReleaseProgress(e){return _e(this,void 0,void 0,(function*(){e&&(yield function(e,t,n="default",i=de.m("release")){return me(this,void 0,void 0,(function*(){if(n||(n="default"),(i=i.m(e.uid.toString())).log(e.title,e.cacheKey,e.apiCacheKey,`Mode: ${n}`),!e.apiCacheKey)return void i.log("No Api Cache Id");if(!he.settings.get("epPredictions"))return void i.log("epPredictions disabled");const s=yield he.storage.get(`release/${t}/${e.cacheKey}`);i.m("Load").log(s);let r,a=!1;if(s&&s.mode&&s.mode!==n&&(a=!0),s&&s.timestamp&&Date.now()-s.timestamp<12e4&&!a)return void i.log("Up to date");if(s&&s.finished&&s.timestamp&&Date.now()-s.timestamp<6048e5&&!a)return void i.log("Fininshed");if(s&&!s.value&&s.timestamp&&Date.now()-s.timestamp<864e5&&!a)return void i.log("Nulled");a&&i.log("Update forced"),"off"===n&&(i.log("Disabled"),e.xhr=[]),void 0!==e.xhr?r=e.xhr:(r=yield fe(t,e.apiCacheKey),yield pe.wait(500)),i.log(r);const o=function(e,t,n){const i={};if(!e.length)return null;let s;if("default"===t?(i.mainId="anime"===n?he.settings.get("progressIntervalDefaultAnime"):he.settings.get("progressIntervalDefaultManga"),i.fallback="en/sub"):i.mainId=t,i.fallbackPrediction="jp/dub",i.mainId){const t=e.find((e=>e.id===i.mainId));t&&(s=t)}if(i.fallback&&!s){const t=e.find((e=>e.id===i.fallback));t&&(s=t)}if(i.fallbackPrediction&&s&&!s.predicition&&s.lastEp&&s.lastEp.timestamp){const t=e.find((e=>e.id===i.fallbackPrediction)),n=s.lastEp.timestamp+6048e5;n&&t&&t.predicition&&(s.lastEp.total===t.lastEp.total?Math.abs(n-t.predicition.timestamp)<108e6&&(s.predicition={timestamp:n,probability:"medium"}):t.lastEp.total&&s.lastEp.total===t.lastEp.total-1&&Math.abs(n-(t.predicition.timestamp-6048e5))<108e6&&(s.predicition={timestamp:n,probability:"medium"}))}if(i.fallbackPrediction&&!s){const t=e.find((e=>e.id===i.fallbackPrediction));t&&t.lastEp&&t.predicition&&0===t.lastEp.total&&(s=t,s.predicition.probability="medium")}return s||null}(r,n,t);o||i.log("No value for the selected mode");let l=!1;o&&o.state&&"complete"===o.state&&(l=!0),i.m("Save").log(o),s&&s.value&&function(e,t,n,i){me(this,void 0,void 0,(function*(){try{if("anime"===i&&!he.settings.get("progressNotificationsAnime")||"manga"===i&&!he.settings.get("progressNotificationsManga"))return;if(e&&n&&n&&t.lastEp&&void 0!==t.lastEp.total&&n.lastEp&&n.lastEp.total&&t.lang===n.lang&&t.type===n.type&&t.lastEp.total<n.lastEp.total&&e.watchedEp+1===n.lastEp.total){let t;t=e.single?{title:e.title,text:he.storage.lang(`syncPage_malObj_nextEp_${i}`,[n.lastEp.total]),sticky:!0,image:yield e.single.getImage(),url:e.single.getStreamingUrl()?e.single.getStreamingUrl():e.single.getUrl()}:{title:e.title,text:he.storage.lang(`syncPage_malObj_nextEp_${i}`,[n.lastEp.total]),sticky:!0,image:e.image,url:e.options&&e.options.u?e.options.u:e.url},he.request.notification(t)}}catch(e){de.error("Could not check notification Progress",e)}}))}(e,s.value,o,t),yield he.storage.set(`release/${t}/${e.cacheKey}`,{timestamp:Date.now(),value:o,mode:n,finished:l})}))}(e,this.type,e.progressMode));const t=yield be.storage.get(`release/${this.type}/${this.cacheKey}`);this.logger.m("Init Release").log(t),t&&(function(e){if(e&&e.timestamp){const t=(new Date).getTime()-e.timestamp;if(e.finished&&t<6048e5)return!1;if(!e.value&&t<864e5)return!1;if(t<864e5)return!1}return!0}(t)?this.logger.log("Too old"):this.releaseItem=t)}))}getProgressCurrentEpisode(){const e=this.releaseItem;return e&&e.value&&e.value.lastEp&&e.value.lastEp.total?e.value.lastEp.total:null}isProgressFinished(){const e=this.releaseItem;return!(!e||!e.finished)}getProgressPrediction(){const e=this.releaseItem;return e&&e.value&&e.value.predicition&&e.value.predicition.timestamp?e.value.predicition.timestamp:null}getProgressLastTimestamp(){const e=this.releaseItem;return e&&e.value&&e.value.lastEp&&e.value.lastEp.timestamp?e.value.lastEp.timestamp:null}init(e=!1){return _e(this,void 0,void 0,(function*(){return yield Promise.all([this.initReleaseProgress(e)]),this}))}getCurrentEpisode(){return be.settings.get("epPredictions")?this.getProgressCurrentEpisode():null}isFinished(){return this.isProgressFinished()}isAiring(){return!this.isFinished()}getPredictionTimestamp(){return!this.getProgressPrediction()||(new Date).getTime()>this.getProgressPrediction()?NaN:this.getProgressPrediction()}getPrediction(){return ye(this.getPredictionTimestamp())}getPredictionText(){const e=this.getPrediction();return e?be.storage.lang(`prediction_Episode_${this.type}`,[e]):""}getLastTimestamp(){return this.getProgressLastTimestamp()}getLast(e=!0){return ye(this.getLastTimestamp(),e)}getLastText(){const e=this.getLast(!1);return e?be.storage.lang(`prediction_Last_${this.type}`,[e]):""}getAuto(){const e=this.getPrediction();if(e)return e;return this.getLast()||""}getAutoText(){const e=this.getPredictionText();if(e)return e;return this.getLastText()||""}getColor(){return"#f57c00"}getBars(e,t){const n=this.getCurrentEpisode(),i={totalWidth:100,epWidth:0,predWidth:0};if(!t)if(i.totalWidth=0,e&&(!n||e>=n))t=Math.ceil(1.2*e);else{if(!n||e&&!(e<n))return i;t=Math.ceil(1.2*n)}return e&&(i.epWidth=e/t*100,i.epWidth>100&&(i.epWidth=100)),n&&(i.predWidth=n/t*100,i.predWidth>100&&(i.predWidth=100)),i}}class ke extends Error{constructor(e){super(e),this.name="SafeError"}}var Se=n(58339);const Ee={ui:{module:"dropdown"},getOptions:()=>[{value:0,label:Se.storage.lang("UI_Score_Not_Rated")},{value:100,label:Se.storage.lang("UI_Score_Masterpiece")},{value:90,label:Se.storage.lang("UI_Score_Great")},{value:80,label:Se.storage.lang("UI_Score_VeryGood")},{value:70,label:Se.storage.lang("UI_Score_Good")},{value:60,label:Se.storage.lang("UI_Score_Fine")},{value:50,label:Se.storage.lang("UI_Score_Average")},{value:40,label:Se.storage.lang("UI_Score_Bad")},{value:30,label:Se.storage.lang("UI_Score_VeryBad")},{value:20,label:Se.storage.lang("UI_Score_Horrible")},{value:10,label:Se.storage.lang("UI_Score_Appalling")}],valueToOptionValue:e=>e?e<10?10:10*Math.round(e/10):0,optionValueToValue:e=>e?Number(e):0};var xe=n(9e4),Ie=n(58339),Te=n(9375),$e=n(19947),Ne=function(e,t,n,i){return new(n||(n=Promise))((function(s,r){function a(e){try{l(i.next(e))}catch(e){r(e)}}function o(e){try{l(i.throw(e))}catch(e){r(e)}}function l(e){e.done?s(e.value):function(e){return e instanceof n?e:new n((function(t){t(e)}))}(e.value).then(a,o)}l((i=i.apply(e,t||[])).next())}))};Object.seal(g);class Oe{constructor(e){return this.url=e,this.type=null,this.rewatchingSupport=!0,this.ids={mal:NaN,ani:NaN,kitsu:{id:NaN,slug:""},simkl:NaN},this.options=null,this.progress=!1,this.updateProgress=!1,this._onList=!1,this._authenticated=!1,this.handleUrl(e),this.logger=xe.m("[S]","#348fff"),this}getType(){return this.type}getUrl(){return this.url}supportsRewatching(){return this.rewatchingSupport}getApiCacheKey(){return this.getKey(["ANILIST"])}getRulesCacheKey(){return this.getKey(["ANILIST","KITSU"],!1)}setStatus(e){return e=Number(e),this._setStatus(e),this}getStatus(){return this.isOnList()?this._getStatus():a.NoState}getScoreMode(){return Ee}setScore(e){return(e=parseInt(`${e}`))||(e=0),this._setScore(e),this}getScore(){return this._getScore()||0}setAbsoluteScore(e){return e=parseInt(`${e}`),this._setAbsoluteScore(e),this}getAbsoluteScore(){return this._getAbsoluteScore()||0}setEpisode(e){return e=parseInt(`${e}`),this.getTotalEpisodes()&&e>this.getTotalEpisodes()&&(e=this.getTotalEpisodes()),this._setEpisode(e),this}getEpisode(){return this._getEpisode()}setVolume(e){return this._setVolume(e),this}getVolume(){return this._getVolume()}setStreamingUrl(e){return this.options&&(this.options.u=e),this}getStreamingUrl(){if(this.options&&this.options.u)return this.options.u}cleanTags(){this.options=null}initProgress(){return Ne(this,void 0,void 0,(function*(){const e=yield fe(this.getType(),this.getApiCacheKey());return new we(this.getCacheKey(),this.getType()).init({uid:this.getCacheKey(),apiCacheKey:this.getApiCacheKey(),title:this.getTitle(),cacheKey:this.getCacheKey(),progressMode:this.getProgressMode(),watchedEp:this.getEpisode(),single:this,xhr:e}).then((t=>{this.updateProgress=!1,this.progress=t,this.progressXhr=e}))}))}getProgress(){return!!this.progress&&this.progress}getProgressFormated(){const e=[],t=new Intl.DisplayNames("en",{type:"language"});return xe.log(this.progressXhr),this.progressXhr&&Object.keys(this.progressXhr).length&&this.progressXhr.forEach((n=>{e.push({type:n.type,key:n.id,state:n.state,label:t.of(n.lang.replace(/^jp$/,"ja"))||n.lang,dropped:"dropped"===n.state||"discontinued"===n.state,episode:n.lastEp&&n.lastEp.total?n.lastEp.total:0,lastEp:n.lastEp,predicition:n.prediction})})),e}getProgressOptions(){return this.getProgressFormated().filter((e=>"complete"!==e.state))}getProgressCompleted(){return this.getProgressFormated().filter((e=>"complete"===e.state))}getProgressMode(){return this.options&&this.options.p?this.options.p:""}setProgressMode(e){this.options&&(this.options.p=e,this.updateProgress=!0),Ie.settings.get("malTags")||Te.setEntrySettings(this.type,this.getCacheKey(),this.options,this._getTags()).then((()=>this.initProgress()))}getProgressKey(){let e=this.getProgressMode();if(e||(e="anime"===this.getType()?Ie.settings.get("progressIntervalDefaultAnime"):Ie.settings.get("progressIntervalDefaultManga")),!e)return null;const t=/^([^/]*)\/(.*)$/.exec(e);return t?{key:e,lang:t[1],type:t[2]}:null}getPageRelations(){const e=this.shortName,t=[];return this.ids.mal&&"MAL"!==e&&t.push({name:"MAL",icon:"https://cdn.myanimelist.net/images/favicon.ico",link:`https://myanimelist.net/${this.type}/${this.ids.mal}`}),this.ids.ani&&"AniList"!==e&&t.push({name:"AniList",icon:"https://anilist.co/img/icons/favicon-32x32.png",link:`https://anilist.co/${this.type}/${this.ids.ani}`}),this.ids.kitsu.id&&"Kitsu"!==e&&t.push({name:"Kitsu",icon:"https://kitsu.io/favicon-32x32-3e0ecb6fc5a6ae681e65dcbc2bdf1f17.png",link:`https://kitsu.io/${this.type}/${this.ids.kitsu.id}`}),this.ids.simkl&&"Simkl"!==e&&t.push({name:"Simkl",icon:"https://eu.simkl.in/img_favicon/v2/favicon-32x32.png",link:`https://simkl.com/${this.type}/${this.ids.simkl}`}),t}fillRelations(){return Promise.resolve()}update(){return this.logger.log("[SINGLE]","Update info",this.ids),this.lastError=null,this._update().catch((e=>{throw this.lastError=e,e})).then((()=>(this.persistanceState=this.getStateEl(),Te.getEntrySettings(this.type,this.getCacheKey(),this._getTags())))).then((e=>{this.options=e,this.registerEvent(),this.emitUpdate("state")}))}sync(){return Ne(this,void 0,void 0,(function*(){return this.logger.log("[SINGLE]","Sync",this.ids),this.lastError=null,this._setTags(yield Te.setEntrySettings(this.type,this.getCacheKey(),this.options,this._getTags())),this._sync().catch((e=>{throw this.lastError=e,e})).then((()=>{this.undoState=this.persistanceState,this.updateProgress&&this.initProgress(),this._onList=!0,this.emitUpdate()}))}))}emitUpdate(e="update"){y(`${e}.${this.getCacheKey()}`,{id:this.getPageId(),type:this.getType(),cacheKey:this.getCacheKey(),state:this.getStateEl(),meta:{title:this.getTitle(),image:this.getImage(),malId:this.getMalId(),totalEp:this.getTotalEpisodes(),url:this.getUrl()}})}delete(){return Ne(this,void 0,void 0,(function*(){return this._delete().then((()=>{this._onList=!1,y(`delete.${this.getCacheKey()}`,{id:this.getPageId(),type:this.getType(),cacheKey:this.getCacheKey()})}))}))}registerEvent(){this.globalUpdateEvent||(this.globalUpdateEvent=g.on(`update.${this.getCacheKey()}`,(e=>this.updateEvent(e))))}updateEvent(e){this.isDirty()?this.logger.log("Ignore event"):e&&e.state&&(this.setStateEl(e.state),this.persistanceState=this.getStateEl(),g.emit("syncPage_fillUi"))}isDirty(){return JSON.stringify(this.persistanceState)!==JSON.stringify(this.getStateEl())||this.updateProgress}undo(){if(this.logger.log("[SINGLE]","Undo",this.undoState),!this.undoState)throw new ke("No undo state found");if(!this.undoState.onList){if(void 0===this.delete)throw new Error("Deleting an entry is not supported");return this.delete().then((()=>{this.setStateEl(this.undoState),this.undoState=null}))}return this.setStateEl(this.undoState),this.sync().then((()=>{this.undoState=null}))}getTitle(e=!1){return this._getTitle(e)}getTotalEpisodes(){let e=this._getTotalEpisodes();return e||(e=0),e}getTotalVolumes(){return this._getTotalVolumes()}isOnList(){return this._onList}isAuthenticated(){return this._authenticated}getDisplayUrl(){return this._getDisplayUrl()}getMalUrl(){return Number.isNaN(this.ids.mal)?null:`https://myanimelist.net/${this.getType()}/${this.ids.mal}`}getMalId(){return Number.isNaN(this.ids.mal)?null:this.ids.mal}getIds(){return this.ids}getImage(){return this._getImage()}getRating(){return this._getRating().then((e=>e||"N/A"))}setResumeWatching(e,t){return Te.setResumeWaching(e,t,this.type,this.getCacheKey())}getResumeWatching(){return this.options&&this.options.r?this.options.r:null}setContinueWatching(e,t){return Te.setContinueWaching(e,t,this.type,this.getCacheKey())}getContinueWatching(){return this.options&&this.options.c?this.options.c:null}increaseRewatchCount(){}getStateEl(){return{onList:this.isOnList(),episode:this.getEpisode(),volume:this.getVolume(),status:this.getStatus(),score:this.getScore(),absoluteScore:this.getAbsoluteScore()}}setStateEl(e){this._onList=e.onList,this.setEpisode(e.episode),this.setVolume(e.volume),this.setStatus(e.status),this.setScore(e.score),e.absoluteScore&&this.setAbsoluteScore(e.absoluteScore)}getStateDiff(){const e=this.getStateEl();if(e&&this.undoState){const t={};for(const n in e)e[n]!==this.undoState[n]&&(t[n]=e[n]);return t}}checkSync(e,t){return Ne(this,void 0,void 0,(function*(){const n=this.getEpisode(),i=this.getStatus(),s=this.getVolume();return i===a.Completed?1===e&&this.startRewatchingMessage():!(n>=e&&!(void 0!==t&&(s||t>1||!e)&&t>s))&&(e&&e===this.getTotalEpisodes()?(i===a.Rewatching?yield this.finishRewatchingMessage():yield this.finishWatchingMessage(),!0):i===a.Watching||i===a.Rewatching||this.startWatchingMessage())}))}startWatchingMessage(){return Ne(this,void 0,void 0,(function*(){return Te.flashConfirm(Ie.storage.lang(`syncPage_flashConfirm_start_${this.getType()}`),"add").then((e=>(e&&this.setStatus(a.Watching),e)))}))}finishWatchingMessage(){return Ne(this,void 0,void 0,(function*(){const e=this.getScoreCheckboxValue();let t='<div><select id="finish_score" style="margin-top:5px; color:white; background-color:#4e4e4e; border: none;">';return this.getScoreCheckbox().forEach((n=>{t+=`<option value="${n.value}" ${e===n.value?"selected":""}>${n.label}</option>`})),t+="</select></div>",Te.flashConfirm(Ie.storage.lang("syncPage_flashConfirm_complete")+t,"complete").then((e=>(e&&(this.setStatus(a.Completed),Number($e.$("#finish_score").val())>0&&(this.logger.log(`finish_score: ${$e.$("#finish_score :selected").val()}`),this.handleScoreCheckbox($e.$("#finish_score :selected").val()))),e)))}))}startRewatchingMessage(){return Ne(this,void 0,void 0,(function*(){return Te.flashConfirm(Ie.storage.lang(`syncPage_flashConfirm_rewatch_start_${this.getType()}`),"add").then((e=>(e&&this.setStatus(a.Rewatching),e)))}))}finishRewatchingMessage(){return Ne(this,void 0,void 0,(function*(){return Te.flashConfirm(Ie.storage.lang(`syncPage_flashConfirm_rewatch_finish_${this.getType()}`),"complete").then((e=>(e&&(this.setStatus(a.Completed),this.increaseRewatchCount()),e)))}))}getScoreCheckbox(){return this.getScoreMode().getOptions()}getScoreCheckboxValue(){return this.getScoreMode().valueToOptionValue(this.getAbsoluteScore())}handleScoreCheckbox(e){this.setAbsoluteScore(this.getScoreMode().optionValueToValue(e))}getDisplayScoreCheckbox(){const e=this.getScoreCheckboxValue(),t=this.getScoreCheckbox().filter((t=>t.value===e));return t.length?t[0].label:""}getStatusCheckbox(){const e=[{value:"1",label:Ie.storage.lang(`UI_Status_watching_${this.getType()}`)},{value:"2",label:Ie.storage.lang("UI_Status_Completed")},{value:"3",label:Ie.storage.lang("UI_Status_OnHold")},{value:"4",label:Ie.storage.lang("UI_Status_Dropped")},{value:"6",label:Ie.storage.lang(`UI_Status_planTo_${this.getType()}`)}];return this.rewatchingSupport&&e.push({value:"23",label:Ie.storage.lang(`UI_Status_Rewatching_${this.getType()}`)}),e}handleStatusCheckbox(e){this.setStatus(e)}getStatusCheckboxValue(){return this.getStatus()}getKey(e,t=!0){return t&&this.ids.mal?this.ids.mal:this.ids.ani&&e.includes("ANILIST")?`anilist:${this.ids.ani}`:this.ids.kitsu.id&&e.includes("KITSU")?`kitsu:${this.ids.kitsu.id}`:this.ids.simkl&&e.includes("SIMKL")?`simkl:${this.ids.simkl}`:this.ids.mal}getLastError(){return this.lastError}getLastErrorMessage(){return this.errorMessage(this.getLastError())}flashmError(e){Te.flashm(this.errorMessage(e),{error:!0,type:"error"})}errorMessage(e){return function(e,t){return e instanceof b?v.storage.lang("Error_Authenticate",[t]):e instanceof w?"Server Offline":e instanceof _?`Incorrect url provided [${e.message}]`:e instanceof k?"Could not find this entry":e.message}(e,this.authenticationUrl)}}var Le=n(9375),Ce=n(9e4),Ae=n(9375),Pe=function(e,t,n,i){return new(n||(n=Promise))((function(s,r){function a(e){try{l(i.next(e))}catch(e){r(e)}}function o(e){try{l(i.throw(e))}catch(e){r(e)}}function l(e){e.done?s(e.value):function(e){return e instanceof n?e:new n((function(t){t(e)}))}(e.value).then(a,o)}l((i=i.apply(e,t||[])).next())}))};class Re extends Oe{constructor(e){return super(e),this.url=e,this.displayUrl="",this.pending=!1,this.shortName="MAL",this.authenticationUrl="https://malsync.moe/mal/oauth",this.apiCall=O,this.logger=Ce.m(this.shortName,"#2e51a2"),this}handleUrl(e){if(e.match(/myanimelist\.net\/(anime|manga)\/\d*/i))return this.type="anime"===Ae.urlPart(e,3)?"anime":"manga",void(this.ids.mal=Number(Ae.urlPart(e,4)));throw new _(e)}getCacheKey(){return this.ids.mal}getPageId(){return this.ids.mal}_getStatus(){let e;return e="manga"===this.type?parseInt(I[this.animeInfo.my_list_status.status]):parseInt(x[this.animeInfo.my_list_status.status]),this.getRewatching()&&2===e?23:e}_setStatus(e){23===e?(e=2,this.setRewatching(!0)):this.setRewatching(!1),"manga"!==this.type?this.animeInfo.my_list_status.status=x[e]:this.animeInfo.my_list_status.status=I[e]}increaseRewatchCount(){"manga"===this.type?this.animeInfo.my_list_status.num_times_reread++:this.animeInfo.my_list_status.num_times_rewatched++}_getScore(){return this.animeInfo.my_list_status.score}_setScore(e){this.animeInfo.my_list_status.score=e}_getAbsoluteScore(){return 10*this.getScore()}_setAbsoluteScore(e){e?e<10?this.setScore(1):this.setScore(Math.round(e/10)):this.setScore(0)}_getEpisode(){return"manga"===this.type?this.animeInfo.my_list_status.num_chapters_read:this.animeInfo.my_list_status.num_watched_episodes}_setEpisode(e){e||(e=0),"manga"!==this.type?this.animeInfo.my_list_status.num_watched_episodes=e:this.animeInfo.my_list_status.num_chapters_read=e}_getVolume(){return"manga"===this.type?this.animeInfo.my_list_status.num_volumes_read:0}_setVolume(e){"manga"===this.type&&(this.animeInfo.my_list_status.num_volumes_read=e)}_getTags(){return this.animeInfo.my_list_status.tags.length?this.animeInfo.my_list_status.tags.join(","):""}_setTags(e){e&&","!==e.trim()?this.animeInfo.my_list_status.tags=e.split(","):this.animeInfo.my_list_status.tags=[]}getRewatching(){return"manga"===this.type?this.animeInfo.my_list_status.is_rereading:this.animeInfo.my_list_status.is_rewatching}setRewatching(e){"manga"!==this.type?this.animeInfo.my_list_status.is_rewatching=e:this.animeInfo.my_list_status.is_rereading=e}_getTitle(){return this.animeInfo.title}_getTotalEpisodes(){return"manga"===this.type?this.animeInfo.num_chapters:this.animeInfo.num_episodes}_getTotalVolumes(){return"manga"===this.type?this.animeInfo.num_volumes:0}_getDisplayUrl(){return this.url}_getImage(){var e,t;return null!==(t=null===(e=this.animeInfo.main_picture)||void 0===e?void 0:e.medium)&&void 0!==t?t:""}_getRating(){return Promise.resolve(this.animeInfo.mean)}_update(){return Pe(this,void 0,void 0,(function*(){return this.apiCall({type:"GET",path:`${this.type}/${this.ids.mal}`,fields:["my_list_status{tags,is_rewatching,is_rereading,num_times_rewatched,num_times_reread,start_date,finish_date}","num_episodes","mean","num_chapters","num_volumes"]}).catch((e=>{throw e instanceof b&&(this._authenticated=!1),e})).then((e=>{this.logger.m("Api").log(e),this._authenticated=!0,this.animeInfo=e,this._onList=!0,this.animeInfo.my_list_status||(this._onList=!1,"manga"===this.type?this.animeInfo.my_list_status={is_rereading:!1,num_chapters_read:0,num_volumes_read:0,score:0,status:"plan_to_read",tags:[]}:this.animeInfo.my_list_status={is_rewatching:!1,num_watched_episodes:0,score:0,status:"plan_to_watch",tags:[]}),this.animeInfo.my_list_status&&void 0!==this.animeInfo.my_list_status.num_episodes_watched&&(this.animeInfo.my_list_status.num_watched_episodes=this.animeInfo.my_list_status.num_episodes_watched,delete this.animeInfo.my_list_status.num_episodes_watched)}))}))}_sync(){return Pe(this,void 0,void 0,(function*(){void 0===this.animeInfo.my_list_status.start_date&&1===this._getStatus()&&this._getEpisode()>0&&(this.animeInfo.my_list_status.start_date=(0,Le.returnYYYYMMDD)()),void 0===this.animeInfo.my_list_status.finish_date&&2===this._getStatus()&&(this.animeInfo.my_list_status.finish_date=(0,Le.returnYYYYMMDD)(),void 0===this.animeInfo.my_list_status.start_date&&(this.animeInfo.my_list_status.start_date=(0,Le.returnYYYYMMDD)()));const e={};for(const t in this.animeInfo.my_list_status)switch(t){case"priority":case"num_watched_episodes":case"num_volumes_read":case"num_chapters_read":case"score":case"is_rewatching":case"is_rereading":case"num_times_rewatched":case"num_times_reread":case"rewatch_value":case"reread_value":case"tags":case"comments":case"status":case"start_date":case"finish_date":e[t]=this.animeInfo.my_list_status[t]}return this.logger.m("Sync").log(this.ids.mal,e),this.apiCall({type:"PUT",path:`${this.type}/${this.ids.mal}/my_list_status`,dataObj:e}).then((e=>{this.logger.m("Sync").log("res",e)}))}))}_delete(){return this.apiCall({type:"DELETE",path:`${this.type}/${this.ids.mal}/my_list_status`})}fillRelations(){return Pe(this,void 0,void 0,(function*(){const e=new h(`fillRelations/${this.ids.mal}/${this.getType()}`,6048e5);return e.hasValueAndIsNotEmpty().then((t=>t?e.getValue().then((e=>{e&&e.da&&parseInt(e.da)&&(this.ids.ani=parseInt(e.da))})):function(e,t){const n={id:e,type:t.toUpperCase()};return A.request.xhr("POST",{url:"https://graphql.anilist.co",headers:{"Content-Type":"application/json",Accept:"application/json"},data:JSON.stringify({query:"\n  query ($id: Int, $type: MediaType) {\n    Media (idMal: $id, type: $type) {\n      id\n      idMal\n    }\n  }\n  ",variables:n})}).then((e=>{if(404===e.status)return NaN;const t=E(e.responseText);return C.log(t),t.data.Media.id}))}(this.ids.mal,this.getType()).then((t=>(t&&parseInt(t)&&(this.ids.ani=parseInt(t)),e.setValue({da:t}))))))}))}}const Me=Re;var Ue=n(58339);const je={ui:{module:"input",pattern:"^([0-9]{1,2}|100)$"},getOptions(){const e=[{value:0,label:Ue.storage.lang("UI_Score_Not_Rated")}];for(let t=1;t<101;t++)e.push({value:t,label:String(t)});return e},valueToOptionValue:e=>e?Number(e):0,optionValueToValue:e=>e?Number(e):0};var De=n(58339);const Fe={ui:{module:"click",type:"smiley"},getOptions:()=>[{value:0,label:De.storage.lang("UI_Score_Not_Rated")},{value:85,label:"🙂"},{value:60,label:"😐"},{value:35,label:"🙁"}],valueToOptionValue:e=>e?e>=73?85:e<=47?35:60:0,optionValueToValue:e=>e?Number(e):0};var Ve=n(58339);const ze={ui:{module:"click",type:"star"},getOptions:()=>[{value:0,label:Ve.storage.lang("UI_Score_Not_Rated")},{value:90,label:"★★★★★"},{value:70,label:"★★★★"},{value:50,label:"★★★"},{value:30,label:"★★"},{value:10,label:"★"}],valueToOptionValue:e=>e?e<20?10:e<40?30:e<60?50:e<80?70:90:0,optionValueToValue:e=>e?Number(e):0};var He=n(58339);const Be={ui:{module:"input",pattern:"^([0-9](\\.[0-9]?)?|10(.0)?)$"},getOptions(){const e=[{value:0,label:He.storage.lang("UI_Score_Not_Rated")}];for(let t=1;t<101;t++)e.push({value:t/10,label:(t/10).toFixed(1)});return e},valueToOptionValue:e=>e?Number(e/10):0,optionValueToValue:e=>e?Number(10*e):0};var We=n(9e4),Ke=n(9375),Ge=n(58339),qe=function(e,t,n,i){return new(n||(n=Promise))((function(s,r){function a(e){try{l(i.next(e))}catch(e){r(e)}}function o(e){try{l(i.throw(e))}catch(e){r(e)}}function l(e){e.done?s(e.value):function(e){return e instanceof n?e:new n((function(t){t(e)}))}(e.value).then(a,o)}l((i=i.apply(e,t||[])).next())}))};class Je extends Oe{constructor(e){return super(e),this.url=e,this.displayUrl="",this.shortName="AniList",this.authenticationUrl="https://anilist.co/api/v2/oauth/authorize?client_id=1487&response_type=token",this.logger=We.m(this.shortName,"#3db4f2"),this}handleUrl(e){if(e.match(/anilist\.co\/(anime|manga)\/\d*/i))return this.type="anime"===Ke.urlPart(e,3)?"anime":"manga",void(this.ids.ani=Number(Ke.urlPart(e,4)));if(e.match(/myanimelist\.net\/(anime|manga)\/\d*/i))return this.type="anime"===Ke.urlPart(e,3)?"anime":"manga",void(this.ids.mal=Number(Ke.urlPart(e,4)));throw new _(e)}getCacheKey(){return this.getKey(["ANILIST"])}getPageId(){return this.ids.ani}_getStatus(){return parseInt(R[this.animeInfo.mediaListEntry.status])}_setStatus(e){this.animeInfo.mediaListEntry.status=R[e]}_getScore(){if(0===Number(this.animeInfo.mediaListEntry.score))return 0;const e=Math.round(Number(this.animeInfo.mediaListEntry.score)/10);return 0===e?1:e}_setScore(e){this.animeInfo.mediaListEntry.score=10*e}_getAbsoluteScore(){return Number(this.animeInfo.mediaListEntry.score)}_setAbsoluteScore(e){this.animeInfo.mediaListEntry.score=Number(e)}_getEpisode(){return this.animeInfo.mediaListEntry.progress}_setEpisode(e){this.animeInfo.mediaListEntry.progress=parseInt(`${e}`)}_getVolume(){return this.animeInfo.mediaListEntry.progressVolumes}_setVolume(e){this.animeInfo.mediaListEntry.progressVolumes=e}_getTags(){let e=this.animeInfo.mediaListEntry.notes;return null!==e&&"null"!==e||(e=""),e}_setTags(e){this.animeInfo.mediaListEntry.notes=e}_getTitle(){return this.animeInfo.title.userPreferred}_getTotalEpisodes(){const e=this.animeInfo.episodes?this.animeInfo.episodes:this.animeInfo.chapters;return null===e?0:e}_getTotalVolumes(){return this.animeInfo.volumes||0}_getDisplayUrl(){return""!==this.displayUrl&&null!==this.displayUrl?this.displayUrl:this.url}_getImage(){return U(this.animeInfo.coverImage.large)}_getRating(){return Promise.resolve(this.animeInfo.averageScore)}_update(){return qe(this,void 0,void 0,(function*(){let e=this.ids.mal,t="idMal";Number.isNaN(this.ids.mal)&&(e=this.ids.ani,t="id");const n=`\n    query ($id: Int, $type: MediaType) {\n      Media (${t}: $id, type: $type) {\n        id\n        idMal\n        siteUrl\n        episodes\n        chapters\n        volumes\n        averageScore\n        coverImage{\n          large\n        }\n        title {\n          userPreferred\n        }\n        mediaListEntry {\n          id\n          status\n          progress\n          progressVolumes\n          score(format: POINT_100)\n          repeat\n          notes\n        }\n      }\n    }\n    `,i={id:e,type:this.type.toUpperCase()};return this._authenticated=!0,this.apiCall(n,i).catch((e=>{if(e instanceof b)return this._authenticated=!1,this.apiCall(n,i,!1);throw e})).then((e=>{if(this.logger.log("[SINGLE]","Data",e),this.animeInfo=e.data.Media,this.ids.ani=this.animeInfo.id,Number.isNaN(this.ids.mal)&&this.animeInfo.idMal&&(this.ids.mal=this.animeInfo.idMal),this.displayUrl=this.animeInfo.siteUrl,this._onList=!0,null===this.animeInfo.mediaListEntry&&(this._onList=!1,this.animeInfo.mediaListEntry={notes:"",progress:0,progressVolumes:0,repeat:0,score:0,status:"PLANNING"}),!this._authenticated)throw new b("Not Authenticated")}))}))}_sync(){return qe(this,void 0,void 0,(function*(){let e="\n      mutation ($mediaId: Int, $status: MediaListStatus, $progress: Int, $scoreRaw: Int, $notes: String) {\n        SaveMediaListEntry (mediaId: $mediaId, status: $status, progress: $progress, scoreRaw: $scoreRaw, notes: $notes) {\n          id\n          status\n          progress\n        }\n      }\n    ";const t={mediaId:this.ids.ani,status:this.animeInfo.mediaListEntry.status,progress:this.animeInfo.mediaListEntry.progress,scoreRaw:this.animeInfo.mediaListEntry.score,notes:this.animeInfo.mediaListEntry.notes,volumes:null};return"manga"===this.type&&(e="\n        mutation ($mediaId: Int, $status: MediaListStatus, $progress: Int, $scoreRaw: Int, $notes: String, $volumes: Int) {\n          SaveMediaListEntry (mediaId: $mediaId, status: $status, progress: $progress, scoreRaw: $scoreRaw, notes: $notes, progressVolumes: $volumes) {\n            id\n            status\n            progress\n            progressVolumes\n          }\n        }\n      ",t.volumes=this.animeInfo.mediaListEntry.progressVolumes),this.apiCall(e,t).then((e=>(e&&e.data&&e.data.SaveMediaListEntry&&e.data.SaveMediaListEntry.id&&(this.animeInfo.mediaListEntry.id=e.data.SaveMediaListEntry.id),e)))}))}apiCall(e,t,n=!0){return M(e,t,n)}getScoreMode(){switch(Ge.settings.get("anilistOptions").scoreFormat){case"POINT_100":return je;case"POINT_3":return Fe;case"POINT_5":return ze;case"POINT_10_DECIMAL":return Be;default:return Ee}}_delete(){const e={mediaId:this.animeInfo.mediaListEntry.id};return this.apiCall("\n      mutation ($mediaId: Int) {\n        DeleteMediaListEntry(id: $mediaId) {\n          deleted\n        }\n      }\n    ",e)}}var Xe=n(58339);const Ye={ui:{module:"dropdown"},getOptions(){const e=[{value:0,label:Xe.storage.lang("UI_Score_Not_Rated")}];for(let t=2;t<21;t++)e.push({value:5*t,label:(t/2).toFixed(1).toString()});return e},valueToOptionValue:e=>e?e<10?10:5*Math.round(Number(e)/5):0,optionValueToValue:e=>e?Number(e):0};var Ze=n(58339);const Qe={ui:{module:"click",type:"smiley"},getOptions:()=>[{value:0,label:Ze.storage.lang("UI_Score_Not_Rated")},{value:100,label:"😀"},{value:70,label:"🙂"},{value:40,label:"😐"},{value:10,label:"🙁"}],valueToOptionValue:e=>e?e<25?10:e<55?40:e<85?70:100:0,optionValueToValue:e=>e?Number(e):0};var et=n(58339);const tt={ui:{module:"dropdown"},getOptions(){const e=[{value:0,label:et.storage.lang("UI_Score_Not_Rated")}];for(let t=1;t<11;t++)e.push({value:10*t,label:(t/2).toFixed(1).toString()});return e},valueToOptionValue:e=>e?e<10?10:10*Math.round(e/10):0,optionValueToValue:e=>e?Number(e):0};var nt=n(9e4),it=n(9375),st=n(58339),rt=function(e,t,n,i){return new(n||(n=Promise))((function(s,r){function a(e){try{l(i.next(e))}catch(e){r(e)}}function o(e){try{l(i.throw(e))}catch(e){r(e)}}function l(e){e.done?s(e.value):function(e){return e instanceof n?e:new n((function(t){t(e)}))}(e.value).then(a,o)}l((i=i.apply(e,t||[])).next())}))};class at extends Oe{constructor(e){return super(e),this.url=e,this.shortName="Kitsu",this.authenticationUrl="https://kitsu.io/404?mal-sync=authentication",this.logger=nt.m(this.shortName,"#d65e43"),this}listI(){return this.animeInfo.data[0]}animeI(){return this.animeInfo.included[0]}handleUrl(e){if(e.match(/kitsu\.io\/(anime|manga)\/.*/i))return this.type="anime"===it.urlPart(e,3)?"anime":"manga",void(this.ids.kitsu.slug=it.urlPart(e,4));if(e.match(/myanimelist\.net\/(anime|manga)\/\d*/i))return this.type="anime"===it.urlPart(e,3)?"anime":"manga",void(this.ids.mal=Number(it.urlPart(e,4)));throw new _(e)}getCacheKey(){return this.getKey(["KITSU"])}getPageId(){return this.ids.kitsu.id}_getStatus(){return this.listI().attributes.reconsuming&&"current"===this.listI().attributes.status?23:parseInt(V(this.listI().attributes.status))}_setStatus(e){23===e?(e=1,this.listI().attributes.reconsuming=!0):this.listI().attributes.reconsuming=!1,this.listI().attributes.status=V(e,parseInt(e.toString()))}_getScore(){if(!this.listI().attributes.ratingHundred)return 0;const e=Math.round(this.listI().attributes.ratingHundred/10);return 0===e?1:e}_setScore(e){this.listI().attributes.ratingHundred=e?10*e:null}_getAbsoluteScore(){return Number(this.listI().attributes.ratingHundred)}_setAbsoluteScore(e){this.listI().attributes.ratingHundred=Number(e)}_getTwentyScore(){const e=this.listI().attributes.ratingHundred;return e?e<5?1:Math.round(e/5):null}_getEpisode(){return this.listI().attributes.progress}_setEpisode(e){this.listI().attributes.progress=parseInt(`${e}`)}_getVolume(){return this.listI().attributes.volumesOwned}_setVolume(e){this.listI().attributes.volumesOwned=e}_getTags(){let e=this.listI().attributes.notes;return null!==e&&"null"!==e||(e=""),e}_setTags(e){this.listI().attributes.notes=e}_getTitle(){try{return z(this.animeI().attributes.titles,this.animeI().attributes.canonicalTitle)}catch(e){return console.error("title",e),"Failed"}}_getTotalEpisodes(){const e=this.animeI().attributes.episodeCount?this.animeI().attributes.episodeCount:this.animeI().attributes.chapterCount;return null===e?0:e}_getTotalVolumes(){return this.animeI().attributes.volumeCount||0}_getDisplayUrl(){return`https://kitsu.io/${this.getType()}/${this.animeI().attributes.slug}`}_getImage(){return this.animeI().attributes.posterImage&&this.animeI().attributes.posterImage.large?this.animeI().attributes.posterImage.large:""}_getRating(){return null===this.animeI().attributes.averageRating?Promise.resolve(""):Promise.resolve(`${this.animeI().attributes.averageRating}%`)}_update(){return rt(this,void 0,void 0,(function*(){if(Number.isNaN(this.ids.mal)){var e=yield this.kitsuSlugtoKitsu(this.ids.kitsu.slug,this.getType());try{this.ids.kitsu.id=Number(e.res.data[0].id),this.ids.mal=Number(e.malId)}catch(e){throw this._authenticated=!0,new k("Not found")}}if(Number.isNaN(this.ids.kitsu.id)){var t=yield this.malToKitsu(this.ids.mal,this.getType());try{this.ids.kitsu.id=Number(t.data[0].relationships.item.data.id)}catch(e){throw this._authenticated=!0,new k("Not found")}}return this._authenticated=!0,this.userId().then((e=>this.apiCall("GET",`https://kitsu.io/api/edge/library-entries?filter[user_id]=${e}&filter[kind]=${this.getType()}&filter[${this.getType()}_id]=${this.ids.kitsu.id}&page[limit]=1&page[limit]=1&include=${this.getType()}&fields[${this.getType()}]=slug,titles,canonicalTitle,averageRating,posterImage,${"anime"===this.getType()?"episodeCount":"chapterCount,volumeCount"}`))).catch((e=>{if(e instanceof b)return this._authenticated=!1,{data:[],included:[]};throw e})).then((n=>rt(this,void 0,void 0,(function*(){const i=n;this._onList=!0,n.data.length||(this._onList=!1,i.data[0]={attributes:{notes:"",progress:0,volumesOwned:0,reconsuming:!1,reconsumeCount:!1,ratingTwenty:null,status:"planned"}},void 0!==t?i.included=t.included:e?i.included=e.res.data:(t=yield this.malToKitsu(this.ids.mal,this.getType()),i.included=t.included)),i.data[0].attributes.ratingHundred?i.data[0].attributes.ratingHundred=0:i.data[0].attributes.ratingHundred=Number(5*i.data[0].attributes.ratingTwenty),this.animeInfo=i;try{this.animeI()}catch(e){throw this.logger.error(e),new k("Not found")}if(!this._authenticated)throw new b("Not Authenticated")}))))}))}_sync(){return rt(this,void 0,void 0,(function*(){const e={data:{attributes:{notes:this.listI().attributes.notes,progress:this.listI().attributes.progress,volumesOwned:this.listI().attributes.volumesOwned,reconsuming:this.listI().attributes.reconsuming,reconsumeCount:this.listI().attributes.reconsumeCount,ratingTwenty:this._getTwentyScore(),status:this.listI().attributes.status},type:"library-entries"}},t=this.getType();if(!t)return Promise.resolve();let n,i;return this.isOnList()?(n=`https://kitsu.io/api/edge/library-entries/${this.listI().id}`,e.data.id=this.listI().id,i="PATCH"):(n="https://kitsu.io/api/edge/library-entries/",e.data.relationships={[t]:{data:{type:t,id:this.ids.kitsu.id}},user:{data:{type:"users",id:yield this.userId()}}},i="POST"),this.logger.log(i,e),this.apiCall(i,n,e).then((e=>(e&&e.data&&e.data.id&&(this.listI().id=e.data.id),e)))}))}apiCall(e,t,n={},i=!0){return H(e,t,n,i).catch((e=>{if(e instanceof b)throw new b(e.message);throw e}))}kitsuSlugtoKitsu(e,t){return this.apiCall("Get",`https://kitsu.io/api/edge/${t}?filter[slug]=${e}&page[limit]=1&include=mappings`,{}).catch((n=>{if(n instanceof b)return this._authenticated=!1,this.apiCall("Get",`https://kitsu.io/api/edge/${t}?filter[slug]=${e}&page[limit]=1&include=mappings`,{},!1);throw n})).then((e=>{let n=NaN;if(void 0!==e&&void 0!==e.included)for(let i=0;i<e.included.length;i++){const s=e.included[i];if("mappings"===s.type){if(s.attributes.externalSite===`myanimelist/${t}`){n=Number(s.attributes.externalId),e.included.splice(i,1);break}s.attributes.externalSite===`anilist/${t}`&&(this.ids.ani=Number(s.attributes.externalId))}}return{res:e,malId:n}}))}malToKitsu(e,t){return this.apiCall("Get",`https://kitsu.io/api/edge/mappings?filter[externalSite]=myanimelist/${t}&filter[externalId]=${e}&include=item&fields[item]=id`,{}).catch((n=>{if(n instanceof b)return this._authenticated=!1,this.apiCall("Get",`https://kitsu.io/api/edge/mappings?filter[externalSite]=myanimelist/${t}&filter[externalId]=${e}&include=item&fields[item]=id`,{},!1);throw n})).then((e=>e))}userId(){return rt(this,void 0,void 0,(function*(){const e=yield st.storage.get("kitsuUserId");return void 0!==e&&e?e:this.apiCall("Get","https://kitsu.io/api/edge/users?filter[self]=true").then((e=>{if(void 0===e.data||!e.data.length||void 0===e.data[0])throw new b("Not Authenticated");return st.storage.set("kitsuUserId",e.data[0].id),e.data[0].id}))}))}getScoreMode(){switch(st.settings.get("kitsuOptions").ratingSystem){case"simple":return Qe;case"regular":return tt;case"advanced":return Ye;default:return Ee}}_delete(){return this.apiCall("DELETE",`https://kitsu.io/api/edge/library-entries/${this.listI().id}`)}}var ot=n(9e4),lt=n(9375),ct=function(e,t,n,i){return new(n||(n=Promise))((function(s,r){function a(e){try{l(i.next(e))}catch(e){r(e)}}function o(e){try{l(i.throw(e))}catch(e){r(e)}}function l(e){e.done?s(e.value):function(e){return e instanceof n?e:new n((function(t){t(e)}))}(e.value).then(a,o)}l((i=i.apply(e,t||[])).next())}))};class ut extends Oe{constructor(e){return super(e),this.url=e,this.episodeUpdate=!1,this.statusUpdate=!1,this.ratingUpdate=!1,this.minWatchedEp=1,this.curWatchedEp=0,this.shortName="Simkl",this.authenticationUrl="https://simkl.com/oauth/authorize?response_type=code&client_id=39e8640b6f1a60aaf60f3f3313475e830517badab8048a4e52ff2d10deb2b9b0&redirect_uri=https://simkl.com/apps/chrome/mal-sync/connected/",this.rewatchingSupport=!1,this.syncList=Y,this.getSingle=Z,this.call=Q,this.errorHandling=ee,this.logger=ot.m(this.shortName,"#9b7400"),this}handleUrl(e){if(e.match(/simkl\.com\/(anime|manga)\/\d*/i)){if(this.type="anime"===lt.urlPart(e,3)?"anime":"manga",this.ids.simkl=parseInt(lt.urlPart(e,4)),"manga"===this.type)throw"Simkl has no manga support"}else{if(!e.match(/myanimelist\.net\/(anime|manga)\/\d*/i))throw new _(e);if(this.type="anime"===lt.urlPart(e,3)?"anime":"manga",this.ids.mal=Number(lt.urlPart(e,4)),"manga"===this.type)throw"Simkl has no manga support"}}getCacheKey(){return this.getKey(["SIMKL"])}getPageId(){return this.ids.simkl}_getStatus(){return parseInt(q(this.animeInfo.status))}_setStatus(e){23===e&&(e=1),(e=q(e,parseInt(e.toString())))!==this.animeInfo.status&&(this.statusUpdate=!0),this.animeInfo.status=e}_getScore(){const e=this.animeInfo.user_rating;return null===e?0:e}_setScore(e){0===e&&(e=null),e!==this.animeInfo.user_rating&&(this.ratingUpdate=!0),this.animeInfo.user_rating=e}_getAbsoluteScore(){return 10*this.getScore()}_setAbsoluteScore(e){e?e<10?this.setScore(1):this.setScore(Math.round(e/10)):this.setScore(0)}_getEpisode(){return 2===this._getStatus()?this._getTotalEpisodes():this.curWatchedEp}_setEpisode(e){e!==this.curWatchedEp&&(this.episodeUpdate=!0),this.curWatchedEp=e}_getVolume(){return 0}_setVolume(e){this.logger.error("You cant set Volumes for animes")}_getTags(){let e=this.animeInfo.private_memo;return null!==e&&"null"!==e||(e=""),e}_setTags(e){this.animeInfo.private_memo=e}_getTitle(){return this.animeInfo.show.title}_getTotalEpisodes(){const e=this.animeInfo.total_episodes_count;return null===e?0:e}_getTotalVolumes(){return 0}_getDisplayUrl(){return`https://simkl.com/${this.getType()}/${this.ids.simkl}`}_getImage(){return`https://simkl.in/posters/${this.animeInfo.show.poster}_ca.jpg`}_getRating(){return ct(this,void 0,void 0,(function*(){try{return(yield this.call("https://api.simkl.com/ratings",{simkl:this.ids.simkl},!0)).simkl.rating}catch(e){return this.logger.error(e),"N/A"}}))}_update(){return ct(this,void 0,void 0,(function*(){let e;return e=Number.isNaN(this.ids.mal)?{simkl:this.ids.simkl}:{mal:this.ids.mal},this._authenticated=!0,this.getSingle(e).catch((e=>{if(e instanceof b)return this._authenticated=!1,"";throw e})).then((t=>ct(this,void 0,void 0,(function*(){if(this.logger.log(t),this.episodeUpdate=!1,this.statusUpdate=!1,this.ratingUpdate=!1,this.animeInfo=t,this._onList=!0,!this.animeInfo){let t;if(this._onList=!1,e.simkl){if(t=yield this.call(`https://api.simkl.com/anime/${e.simkl}`,{extended:"full"},!0),!t)throw new k("Anime not found")}else{if(t=yield this.call("https://api.simkl.com/search/id",e,!0),!t)throw new k("Anime not found");if(t[0].mal&&t[0].mal.type&&"Special"===t[0].mal.type)throw new Error("Is a special");t=t[0]}this.animeInfo={last_watched:"",last_watched_at:"",next_to_watch:"",not_aired_episodes_count:0,private_memo:"",status:"plantowatch",total_episodes_count:0,user_rating:null,watched_episodes_count:0,show:t},this.logger.log("Add anime",this.animeInfo)}if(Number.isNaN(this.ids.simkl)&&(this.ids.simkl=parseInt(this.animeInfo.show.ids.simkl)),Number.isNaN(this.ids.mal)&&void 0!==this.animeInfo.show.ids.mal&&(this.ids.mal=this.animeInfo.show.ids.mal),this.curWatchedEp=J(this.animeInfo.last_watched),!this.curWatchedEp&&this.animeInfo.next_to_watch){const e=J(this.animeInfo.next_to_watch);e&&(this.curWatchedEp=e-1)}if(this.minWatchedEp=this.curWatchedEp+1,!this._authenticated)throw new b("Not Authenticated")}))))}))}_sync(){return ct(this,void 0,void 0,(function*(){if(this.logger.log("[SET] Object:",this.animeInfo,"status",this.statusUpdate,"episode",this.episodeUpdate,"rating",this.ratingUpdate,"minWatchedEp",this.minWatchedEp,"curWatchedEp",this.curWatchedEp),this.statusUpdate||!this.isOnList()){const e=yield this.call("https://api.simkl.com/sync/add-to-list",JSON.stringify({shows:[{to:this.animeInfo.status,ids:{simkl:this.ids.simkl}}]}),!1,"POST");this.logger.log("Status response",e)}if(this.episodeUpdate||!this.isOnList()){const e=this.curWatchedEp,t=[];if(this.minWatchedEp<=e){if(e){for(let n=this.minWatchedEp;n<=e;n++)t.push({number:n});const n=yield this.call("https://api.simkl.com/sync/history",JSON.stringify({shows:[{ids:{simkl:this.ids.simkl},private_memo:this.animeInfo.private_memo,seasons:[{number:1,episodes:t}]}]}),!1,"POST");this.logger.log("Episode response",n)}}else{for(let n=this.minWatchedEp-1;n>e;n-=1)t.push({number:n});const n=yield this.call("https://api.simkl.com/sync/history/remove",JSON.stringify({shows:[{ids:{simkl:this.ids.simkl},seasons:[{number:1,episodes:t}]}]}),!1,"POST");this.logger.log("Episode remove response",n)}this.minWatchedEp=e+1}if(this.ratingUpdate)if(this.animeInfo.user_rating){const e=yield this.call("https://api.simkl.com/sync/ratings",JSON.stringify({shows:[{rating:this.animeInfo.user_rating,ids:{simkl:this.ids.simkl}}]}),!1,"POST");this.logger.log("Rating response",e)}else{const e=yield this.call("https://api.simkl.com/sync/ratings/remove",JSON.stringify({shows:[{ids:{simkl:this.ids.simkl}}]}),!1,"POST");this.logger.log("Rating remove response",e)}this.episodeUpdate=!1,this.statusUpdate=!1,this.ratingUpdate=!1}))}_delete(){return this.call("https://api.simkl.com/sync/history/remove",JSON.stringify({shows:[{ids:{simkl:this.ids.simkl}}]}),!1,"POST")}}var ht=n(9e4),dt=n(9375),pt=function(e,t,n,i){return new(n||(n=Promise))((function(s,r){function a(e){try{l(i.next(e))}catch(e){r(e)}}function o(e){try{l(i.throw(e))}catch(e){r(e)}}function l(e){e.done?s(e.value):function(e){return e instanceof n?e:new n((function(t){t(e)}))}(e.value).then(a,o)}l((i=i.apply(e,t||[])).next())}))};class mt extends Oe{constructor(e){return super(e),this.url=e,this.shortName="Shiki",this.authenticationUrl=se,this.logger=ht.m(this.shortName,"#3db4f2"),this}handleUrl(e){if(e.match(/shikimori\.me\/(animes|mangas|ranobe)\/\D?\d+/i)){this.type="animes"===dt.urlPart(e,3)?"anime":"manga";const t=dt.urlPart(e,4).match(/^\D?(\d+)/);if(t&&t[1])return void(this.ids.mal=Number(t[1]))}if(e.match(/myanimelist\.net\/(anime|manga)\/\d*/i))return this.type="anime"===dt.urlPart(e,3)?"anime":"manga",void(this.ids.mal=Number(dt.urlPart(e,4)));throw new _(e)}getCacheKey(){return this.ids.mal}getPageId(){return this.ids.mal}_getStatus(){return ue[this.animeInfo.status]}_setStatus(e){this.animeInfo.status=ue[e]}_getScore(){return this.animeInfo.score}_setScore(e){this.animeInfo.score=e}_getAbsoluteScore(){return 10*this.getScore()}_setAbsoluteScore(e){e?e<10?this.setScore(1):this.setScore(Math.round(e/10)):this.setScore(0)}_getEpisode(){return"manga"===this.type?this.animeInfo.chapters:this.animeInfo.episodes}_setEpisode(e){"manga"!==this.type?this.animeInfo.episodes=parseInt(`${e}`):this.animeInfo.chapters=parseInt(`${e}`)}_getVolume(){return this.animeInfo.volumes}_setVolume(e){this.animeInfo.volumes=e}_getTags(){let e=this.animeInfo.text;return null!==e&&"null"!==e||(e=""),e}_setTags(e){this.animeInfo.text=e}_getTitle(){return ce(this.animeMeta.russian,this.animeMeta.name)}_getTotalEpisodes(){return("anime"===this.type?this.animeMeta.episodes:this.animeMeta.chapters)||0}_getTotalVolumes(){return this.animeMeta.volumes||0}_getDisplayUrl(){return this.animeMeta.url?`${ae}${this.animeMeta.url}`:this.url}_getImage(){return this.animeMeta.image.preview?`${ae}${this.animeMeta.image.preview}`:""}_getRating(){return Promise.resolve(this.animeMeta.score)}_update(){return pt(this,void 0,void 0,(function*(){const e=yield function(){return ne(this,void 0,void 0,(function*(){const e=new h("shiki/userId",144e5);if(yield e.hasValue())return e.getValue();const t=yield oe({type:"GET",path:"users/whoami"}).then((e=>(e.locale&&te.settings.set("shikiOptions",{locale:e.locale}),e)));return t.id&&e.setValue(t.id),t.id}))}(),t=yield oe({path:`${this.type}s/${this.ids.mal}`,type:"GET"});if(!t.id)throw new k(this.url);this.animeMeta=t;const n=yield oe({path:"v2/user_rates",type:"GET",parameter:{target_id:this.ids.mal,user_id:e,target_type:"anime"===this.type?"Anime":"Manga"}});return n.length?(this._onList=!0,[this.animeInfo]=n):(this._onList=!1,this.animeInfo={user_id:e,target_id:this.ids.mal,target_type:"anime"===this.type?"Anime":"Manga",score:0,status:"planned",rewatches:0,episodes:0,volumes:0,chapters:0,text:""}),this._authenticated=!0,Promise.resolve()}))}_sync(){return pt(this,void 0,void 0,(function*(){return oe({type:this._onList?"PUT":"POST",path:this._onList?`v2/user_rates/${this.animeInfo.id}`:"v2/user_rates",dataObj:{user_rate:this.animeInfo}})}))}getScoreMode(){return Ee}_delete(){return oe({type:"DELETE",path:`v2/user_rates/${this.animeInfo.id}`})}}var ft=n(9e4),gt=n(9375),yt=n(58339),vt=function(e,t,n,i){return new(n||(n=Promise))((function(s,r){function a(e){try{l(i.next(e))}catch(e){r(e)}}function o(e){try{l(i.throw(e))}catch(e){r(e)}}function l(e){e.done?s(e.value):function(e){return e instanceof n?e:new n((function(t){t(e)}))}(e.value).then(a,o)}l((i=i.apply(e,t||[])).next())}))};class bt extends Oe{constructor(e){return super(e),this.url=e,this.shortName="Local",this.authenticationUrl="",this.logger=ft.m(this.shortName,"black"),this}handleUrl(e){if(e.match(/local:\/\/.*/i))return this.id=gt.urlPart(e,4),this.type="anime"===gt.urlPart(e,3)?"anime":"manga",this.page=gt.urlPart(e,2),this.key=`local://${this.page}/${this.type}/${this.id}`,void(gt.urlPart(e,5)?this.title=decodeURIComponent(gt.urlPart(e,5)):this.title="Unknown");throw new _(e)}getCacheKey(){return`local:${this.id}:${this.page}`}getPageId(){return this.getCacheKey()}_getStatus(){return this.animeInfo.status}_setStatus(e){this.animeInfo.status=e}_getScore(){return this.animeInfo.score}_setScore(e){this.animeInfo.score=e}_getAbsoluteScore(){return 10*this.getScore()}_setAbsoluteScore(e){e?e<10?this.setScore(1):this.setScore(Math.round(e/10)):this.setScore(0)}_getEpisode(){return this.animeInfo.progress}_setEpisode(e){this.animeInfo.progress=parseInt(`${e}`)}_getVolume(){return this.animeInfo.volumeprogress}_setVolume(e){this.animeInfo.volumeprogress=e}_getTags(){let{tags:e}=this.animeInfo;return e||(e=""),e}_setTags(e){this.animeInfo.tags=e}_getTitle(e=!1){return e?this.animeInfo.name:`[L] ${this.animeInfo.name}`}_getTotalEpisodes(){return 0}_getTotalVolumes(){return 0}_getDisplayUrl(){return"https://github.com/MALSync/MALSync/wiki/Local-Sync"}_getImage(){return this.animeInfo&&this.animeInfo.image?this.animeInfo.image:""}setImage(e){this.animeInfo.image=e,this._onList&&this.sync()}_getRating(){return Promise.resolve("Local")}_update(){return vt(this,void 0,void 0,(function*(){this._authenticated=!0,this.animeInfo=yield yt.storage.get(this.key),this._onList=!0,this.animeInfo||(this._onList=!1,this.animeInfo={name:this.title,tags:"",sUrl:"",image:"",progress:0,volumeprogress:0,score:0,status:6})}))}_sync(){return vt(this,void 0,void 0,(function*(){return yt.storage.set(this.key,this.animeInfo)}))}_delete(){return yt.storage.remove(this.key)}setStreamingUrl(e){return this.animeInfo&&e&&(this.animeInfo.sUrl=e),super.setStreamingUrl(e)}getStreamingUrl(){return this.animeInfo&&this.animeInfo.sUrl?this.animeInfo.sUrl:super.getStreamingUrl()}}function _t(e){if(/^local:\/\//i.test(e))return new bt(e);const n=t(e);if("MAL"===n)return new Me(e);if("MALAPI"===n)return new Re(e);if("ANILIST"===n)return new Je(e);if("KITSU"===n)return new at(e);if("SIMKL"===n)return new ut(e);if("SHIKI"===n)return new mt(e);throw"Unknown sync mode"}var wt=n(58339),kt=n(19947);let St;function Et(){clearTimeout(St),St=null,kt.$(".floatbutton").fadeIn()}function xt(e=!1){e?kt.$(".floatbutton").fadeOut():St||(St=setTimeout((()=>{St=null,kt.$(".floatbutton").fadeOut()}),500))}const It={shortName:"MAL",score:"MAL Score:"},Tt={shortName:"AniList",score:"AniList Score:"},$t={shortName:"Kitsu",score:"Kitsu Score:"},Nt={shortName:"Simkl",score:"Simkl Score:",noLogin:'Please Authenticate <a target="_blank" href="https://simkl.com/oauth/authorize?response_type=code&client_id=39e8640b6f1a60aaf60f3f3313475e830517badab8048a4e52ff2d10deb2b9b0&redirect_uri=https://simkl.com/apps/chrome/mal-sync/connected/">Here</a>'},Ot={shortName:"local storage",score:"Local storage Score:"};var Lt=n(58339);function Ct(e){if(/^local:\/\//i.test(e))return Ot;const t=Lt.settings.get("syncMode");return"MAL"===t||"MALAPI"===t?It:"ANILIST"===t?Tt:"KITSU"===t?$t:Nt}var At=n(9e4),Pt=n(58339),Rt=n(19947);let Mt;const Ut=At.m("Player");let jt="";function Dt(e,t){const n=t.currentSrc;e.current>1&&jt!==n&&(jt=n,Ut.log("New player detected",t.currentSrc),function(e){var t,n,i,s;t=this,n=void 0,s=function*(){if(yield Pt.settings.getAsync("autofull"))if(window.fullScreen||window.innerWidth===window.screen.width&&window.innerHeight===window.screen.height)At.info("Browser already in fullscreen");else{let t=e;const n=["player","vstr","vplayer","mgvideo","myVideo","b-video-wrapper","vilos"],i=["AT-player","plyr","AkiraPlayer","video-js"];let s=!1;for(const r in n){const a=document.getElementById(n[r]);if(null!==a){s=!0,t=a;break}}for(const o in i){const l=document.getElementsByClassName(i[o]).item(0);if(null!==l){s=!0,t=l;break}}if(!s){const c=t.offsetHeight,u=t.offsetWidth;for(;t.parentElement&&c===t.parentElement.offsetHeight&&u===t.parentElement.offsetWidth;)t=t.parentElement,s=!0}if(!s&&!e.getAttribute("controls")){function h(){(document.webkitIsFullScreen||document.mozFullScreen||null!==document.msFullscreenElement)&&e.removeAttribute("controls","controls")}document.addEventListener&&(document.addEventListener("fullscreenchange",h,!1),document.addEventListener("mozfullscreenchange",h,!1),document.addEventListener("MSFullscreenChange",h,!1),document.addEventListener("webkitfullscreenchange",h,!1)),e.setAttribute("controls","controls")}t.requestFullscreen?t.requestFullscreen():t.msRequestFullscreen?t.msRequestFullscreen():t.mozRequestFullScreen?t.mozRequestFullScreen():t.webkitRequestFullscreen&&t.webkitRequestFullscreen()}},new((i=void 0)||(i=Promise))((function(e,r){function a(e){try{l(s.next(e))}catch(e){r(e)}}function o(e){try{l(s.throw(e))}catch(e){r(e)}}function l(t){t.done?e(t.value):function(e){return e instanceof i?e:new i((function(t){t(e)}))}(t.value).then(a,o)}l((s=s.apply(t,n||[])).next())}))}(t))}let Ft,Vt=!1;const zt=["introSkipFwd","introSkipBwd","nextEpShort","correctionShort","syncShort"];var Ht=n(3577),Bt=n(2262);function Wt(e,t,n,i){let s;try{s=i?e(...i):e()}catch(e){Gt(e,t,n)}return s}function Kt(e,t,n,i){if((0,Ht.mf)(e)){const s=Wt(e,t,n,i);return s&&(0,Ht.tI)(s)&&s.catch((e=>{Gt(e,t,n)})),s}const s=[];for(let r=0;r<e.length;r++)s.push(Kt(e[r],t,n,i));return s}function Gt(e,t,n,i=!0){if(t&&t.vnode,t){let i=t.parent;const s=t.proxy,r=n;for(;i;){const t=i.ec;if(t)for(let n=0;n<t.length;n++)if(!1===t[n](e,s,r))return;i=i.parent}const a=t.appContext.config.errorHandler;if(a)return void Wt(a,null,10,[e,s,r])}!function(e,t,n,i=!0){console.error(e)}(e,0,0,i)}let qt=!1,Jt=!1;const Xt=[];let Yt=0;const Zt=[];let Qt=null,en=0;const tn=Promise.resolve();let nn=null;function sn(e){const t=nn||tn;return e?t.then(this?e.bind(this):e):t}function rn(e){Xt.length&&Xt.includes(e,qt&&e.allowRecurse?Yt+1:Yt)||(null==e.id?Xt.push(e):Xt.splice(function(e){let t=Yt+1,n=Xt.length;for(;t<n;){const i=t+n>>>1;cn(Xt[i])<e?t=i+1:n=i}return t}(e.id),0,e),an())}function an(){qt||Jt||(Jt=!0,nn=tn.then(hn))}function on(e,t=(qt?Yt+1:0)){for(;t<Xt.length;t++){const e=Xt[t];e&&e.pre&&(Xt.splice(t,1),t--,e())}}function ln(e){if(Zt.length){const e=[...new Set(Zt)];if(Zt.length=0,Qt)return void Qt.push(...e);for(Qt=e,Qt.sort(((e,t)=>cn(e)-cn(t))),en=0;en<Qt.length;en++)Qt[en]();Qt=null,en=0}}const cn=e=>null==e.id?1/0:e.id,un=(e,t)=>{const n=cn(e)-cn(t);if(0===n){if(e.pre&&!t.pre)return-1;if(t.pre&&!e.pre)return 1}return n};function hn(e){Jt=!1,qt=!0,Xt.sort(un),Ht.dG;try{for(Yt=0;Yt<Xt.length;Yt++){const e=Xt[Yt];e&&!1!==e.active&&Wt(e,null,14)}}finally{Yt=0,Xt.length=0,ln(),qt=!1,nn=null,(Xt.length||Zt.length)&&hn(e)}}function dn(e,t,...n){if(e.isUnmounted)return;const i=e.vnode.props||Ht.kT;let s=n;const r=t.startsWith("update:"),a=r&&t.slice(7);if(a&&a in i){const e=`${"modelValue"===a?"model":a}Modifiers`,{number:t,trim:r}=i[e]||Ht.kT;r&&(s=n.map((e=>(0,Ht.HD)(e)?e.trim():e))),t&&(s=n.map(Ht.h5))}let o,l=i[o=(0,Ht.hR)(t)]||i[o=(0,Ht.hR)((0,Ht._A)(t))];!l&&r&&(l=i[o=(0,Ht.hR)((0,Ht.rs)(t))]),l&&Kt(l,e,6,s);const c=i[o+"Once"];if(c){if(e.emitted){if(e.emitted[o])return}else e.emitted={};e.emitted[o]=!0,Kt(c,e,6,s)}}function pn(e,t,n=!1){const i=t.emitsCache,s=i.get(e);if(void 0!==s)return s;const r=e.emits;let a={},o=!1;if(!(0,Ht.mf)(e)){const i=e=>{const n=pn(e,t,!0);n&&(o=!0,(0,Ht.l7)(a,n))};!n&&t.mixins.length&&t.mixins.forEach(i),e.extends&&i(e.extends),e.mixins&&e.mixins.forEach(i)}return r||o?((0,Ht.kJ)(r)?r.forEach((e=>a[e]=null)):(0,Ht.l7)(a,r),(0,Ht.Kn)(e)&&i.set(e,a),a):((0,Ht.Kn)(e)&&i.set(e,null),null)}function mn(e,t){return!(!e||!(0,Ht.F7)(t))&&(t=t.slice(2).replace(/Once$/,""),(0,Ht.RI)(e,t[0].toLowerCase()+t.slice(1))||(0,Ht.RI)(e,(0,Ht.rs)(t))||(0,Ht.RI)(e,t))}let fn=null,gn=null;function yn(e){const t=fn;return fn=e,gn=e&&e.type.__scopeId||null,t}function vn(e){const{type:t,vnode:n,proxy:i,withProxy:s,props:r,propsOptions:[a],slots:o,attrs:l,emit:c,render:u,renderCache:h,data:d,setupState:p,ctx:m,inheritAttrs:f}=e;let g,y;const v=yn(e);try{if(4&n.shapeFlag){const e=s||i;g=vs(u.call(e,e,h,r,p,d,m)),y=l}else{const e=t;g=vs(e.length>1?e(r,{attrs:l,slots:o,emit:c}):e(r,null)),y=t.props?l:bn(l)}}catch(t){Qi.length=0,Gt(t,e,1),g=ps(Yi)}let b=g;if(y&&!1!==f){const e=Object.keys(y),{shapeFlag:t}=b;e.length&&7&t&&(a&&e.some(Ht.tR)&&(y=_n(y,a)),b=ms(b,y))}return n.dirs&&(b=ms(b),b.dirs=b.dirs?b.dirs.concat(n.dirs):n.dirs),n.transition&&(b.transition=n.transition),g=b,yn(v),g}const bn=e=>{let t;for(const n in e)("class"===n||"style"===n||(0,Ht.F7)(n))&&((t||(t={}))[n]=e[n]);return t},_n=(e,t)=>{const n={};for(const i in e)(0,Ht.tR)(i)&&i.slice(9)in t||(n[i]=e[i]);return n};function wn(e,t,n){const i=Object.keys(t);if(i.length!==Object.keys(e).length)return!0;for(let s=0;s<i.length;s++){const r=i[s];if(t[r]!==e[r]&&!mn(n,r))return!0}return!1}const kn={};function Sn(e,t,n){return En(e,t,n)}function En(e,t,{immediate:n,deep:i,flush:s,onTrack:r,onTrigger:a}=Ht.kT){var o;const l=(0,Bt.nZ)()===(null==(o=Es)?void 0:o.scope)?Es:null;let c,u,h=!1,d=!1;if((0,Bt.dq)(e)?(c=()=>e.value,h=(0,Bt.yT)(e)):(0,Bt.PG)(e)?(c=()=>e,i=!0):(0,Ht.kJ)(e)?(d=!0,h=e.some((e=>(0,Bt.PG)(e)||(0,Bt.yT)(e))),c=()=>e.map((e=>(0,Bt.dq)(e)?e.value:(0,Bt.PG)(e)?Tn(e):(0,Ht.mf)(e)?Wt(e,l,2):void 0))):c=(0,Ht.mf)(e)?t?()=>Wt(e,l,2):()=>{if(!l||!l.isUnmounted)return u&&u(),Kt(e,l,3,[m])}:Ht.dG,t&&i){const e=c;c=()=>Tn(e())}let p,m=e=>{u=v.onStop=()=>{Wt(e,l,4)}};if(Ps){if(m=Ht.dG,t?n&&Kt(t,l,3,[c(),d?[]:void 0,m]):c(),"sync"!==s)return Ht.dG;{const e=Fs();p=e.__watcherHandles||(e.__watcherHandles=[])}}let f=d?new Array(e.length).fill(kn):kn;const g=()=>{if(v.active)if(t){const e=v.run();(i||h||(d?e.some(((e,t)=>(0,Ht.aU)(e,f[t]))):(0,Ht.aU)(e,f)))&&(u&&u(),Kt(t,l,3,[e,f===kn?void 0:d&&f[0]===kn?[]:f,m]),f=e)}else v.run()};let y;g.allowRecurse=!!t,"sync"===s?y=g:"post"===s?y=()=>Wi(g,l&&l.suspense):(g.pre=!0,l&&(g.id=l.uid),y=()=>rn(g));const v=new Bt.qq(c,y);t?n?g():f=v.run():"post"===s?Wi(v.run.bind(v),l&&l.suspense):v.run();const b=()=>{v.stop(),l&&l.scope&&(0,Ht.Od)(l.scope.effects,v)};return p&&p.push(b),b}function xn(e,t,n){const i=this.proxy,s=(0,Ht.HD)(e)?e.includes(".")?In(i,e):()=>i[e]:e.bind(i,i);let r;(0,Ht.mf)(t)?r=t:(r=t.handler,n=t);const a=Es;Ns(this);const o=En(s,r.bind(i),n);return a?Ns(a):Os(),o}function In(e,t){const n=t.split(".");return()=>{let t=e;for(let e=0;e<n.length&&t;e++)t=t[n[e]];return t}}function Tn(e,t){if(!(0,Ht.Kn)(e)||e.__v_skip)return e;if((t=t||new Set).has(e))return e;if(t.add(e),(0,Bt.dq)(e))Tn(e.value,t);else if((0,Ht.kJ)(e))for(let n=0;n<e.length;n++)Tn(e[n],t);else if((0,Ht.DM)(e)||(0,Ht._N)(e))e.forEach((e=>{Tn(e,t)}));else if((0,Ht.PO)(e))for(const n in e)Tn(e[n],t);return e}function $n(e,t){const n=fn;if(null===n)return e;const i=Us(n)||n.proxy,s=e.dirs||(e.dirs=[]);for(let e=0;e<t.length;e++){let[n,r,a,o=Ht.kT]=t[e];n&&((0,Ht.mf)(n)&&(n={mounted:n,updated:n}),n.deep&&Tn(r),s.push({dir:n,instance:i,value:r,oldValue:void 0,arg:a,modifiers:o}))}return e}function Nn(e,t,n,i){const s=e.dirs,r=t&&t.dirs;for(let a=0;a<s.length;a++){const o=s[a];r&&(o.oldValue=r[a].value);let l=o.dir[i];l&&((0,Bt.Jd)(),Kt(l,n,8,[e.el,o,e,t]),(0,Bt.lk)())}}const On=[Function,Array],Ln={mode:String,appear:Boolean,persisted:Boolean,onBeforeEnter:On,onEnter:On,onAfterEnter:On,onEnterCancelled:On,onBeforeLeave:On,onLeave:On,onAfterLeave:On,onLeaveCancelled:On,onBeforeAppear:On,onAppear:On,onAfterAppear:On,onAppearCancelled:On},Cn={name:"BaseTransition",props:Ln,setup(e,{slots:t}){const n=xs(),i=function(){const e={isMounted:!1,isLeaving:!1,isUnmounting:!1,leavingVNodes:new Map};return Jn((()=>{e.isMounted=!0})),Zn((()=>{e.isUnmounting=!0})),e}();let s;return()=>{const r=t.default&&Dn(t.default(),!0);if(!r||!r.length)return;let a=r[0];if(r.length>1){let e=!1;for(const t of r)if(t.type!==Yi){a=t,e=!0;break}}const o=(0,Bt.IU)(e),{mode:l}=o;if(i.isLeaving)return Mn(a);const c=Un(a);if(!c)return Mn(a);const u=Rn(c,o,i,n);jn(c,u);const h=n.subTree,d=h&&Un(h);let p=!1;const{getTransitionKey:m}=c.type;if(m){const e=m();void 0===s?s=e:e!==s&&(s=e,p=!0)}if(d&&d.type!==Yi&&(!ls(c,d)||p)){const e=Rn(d,o,i,n);if(jn(d,e),"out-in"===l)return i.isLeaving=!0,e.afterLeave=()=>{i.isLeaving=!1,!1!==n.update.active&&n.update()},Mn(a);"in-out"===l&&c.type!==Yi&&(e.delayLeave=(e,t,n)=>{Pn(i,d)[String(d.key)]=d,e._leaveCb=()=>{t(),e._leaveCb=void 0,delete u.delayedLeave},u.delayedLeave=n})}return a}}},An=Cn;function Pn(e,t){const{leavingVNodes:n}=e;let i=n.get(t.type);return i||(i=Object.create(null),n.set(t.type,i)),i}function Rn(e,t,n,i){const{appear:s,mode:r,persisted:a=!1,onBeforeEnter:o,onEnter:l,onAfterEnter:c,onEnterCancelled:u,onBeforeLeave:h,onLeave:d,onAfterLeave:p,onLeaveCancelled:m,onBeforeAppear:f,onAppear:g,onAfterAppear:y,onAppearCancelled:v}=t,b=String(e.key),_=Pn(n,e),w=(e,t)=>{e&&Kt(e,i,9,t)},k=(e,t)=>{const n=t[1];w(e,t),(0,Ht.kJ)(e)?e.every((e=>e.length<=1))&&n():e.length<=1&&n()},S={mode:r,persisted:a,beforeEnter(t){let i=o;if(!n.isMounted){if(!s)return;i=f||o}t._leaveCb&&t._leaveCb(!0);const r=_[b];r&&ls(e,r)&&r.el._leaveCb&&r.el._leaveCb(),w(i,[t])},enter(e){let t=l,i=c,r=u;if(!n.isMounted){if(!s)return;t=g||l,i=y||c,r=v||u}let a=!1;const o=e._enterCb=t=>{a||(a=!0,w(t?r:i,[e]),S.delayedLeave&&S.delayedLeave(),e._enterCb=void 0)};t?k(t,[e,o]):o()},leave(t,i){const s=String(e.key);if(t._enterCb&&t._enterCb(!0),n.isUnmounting)return i();w(h,[t]);let r=!1;const a=t._leaveCb=n=>{r||(r=!0,i(),w(n?m:p,[t]),t._leaveCb=void 0,_[s]===e&&delete _[s])};_[s]=e,d?k(d,[t,a]):a()},clone:e=>Rn(e,t,n,i)};return S}function Mn(e){if(Vn(e))return(e=ms(e)).children=null,e}function Un(e){return Vn(e)?e.children?e.children[0]:void 0:e}function jn(e,t){6&e.shapeFlag&&e.component?jn(e.component.subTree,t):128&e.shapeFlag?(e.ssContent.transition=t.clone(e.ssContent),e.ssFallback.transition=t.clone(e.ssFallback)):e.transition=t}function Dn(e,t=!1,n){let i=[],s=0;for(let r=0;r<e.length;r++){let a=e[r];const o=null==n?a.key:String(n)+String(null!=a.key?a.key:r);a.type===Ji?(128&a.patchFlag&&s++,i=i.concat(Dn(a.children,t,o))):(t||a.type!==Yi)&&i.push(null!=o?ms(a,{key:o}):a)}if(s>1)for(let e=0;e<i.length;e++)i[e].patchFlag=-2;return i}const Fn=e=>!!e.type.__asyncLoader,Vn=e=>e.type.__isKeepAlive;function zn(e,t){Bn(e,"a",t)}function Hn(e,t){Bn(e,"da",t)}function Bn(e,t,n=Es){const i=e.__wdc||(e.__wdc=()=>{let t=n;for(;t;){if(t.isDeactivated)return;t=t.parent}return e()});if(Kn(t,i,n),n){let e=n.parent;for(;e&&e.parent;)Vn(e.parent.vnode)&&Wn(i,t,n,e),e=e.parent}}function Wn(e,t,n,i){const s=Kn(t,e,i,!0);Qn((()=>{(0,Ht.Od)(i[t],s)}),n)}function Kn(e,t,n=Es,i=!1){if(n){const s=n[e]||(n[e]=[]),r=t.__weh||(t.__weh=(...i)=>{if(n.isUnmounted)return;(0,Bt.Jd)(),Ns(n);const s=Kt(t,n,e,i);return Os(),(0,Bt.lk)(),s});return i?s.unshift(r):s.push(r),r}}RegExp,RegExp;const Gn=e=>(t,n=Es)=>(!Ps||"sp"===e)&&Kn(e,((...e)=>t(...e)),n),qn=Gn("bm"),Jn=Gn("m"),Xn=Gn("bu"),Yn=Gn("u"),Zn=Gn("bum"),Qn=Gn("um"),ei=Gn("sp"),ti=Gn("rtg"),ni=Gn("rtc");function ii(e,t=Es){Kn("ec",e,t)}const si="components";function ri(e,t){return function(e,t,n=!0,i=!1){const s=fn||Es;if(s){const n=s.type;if(e===si){const e=function(e,t=!0){return(0,Ht.mf)(e)?e.displayName||e.name:e.name||t&&e.__name}(n,!1);if(e&&(e===t||e===(0,Ht._A)(t)||e===(0,Ht.kC)((0,Ht._A)(t))))return n}const r=oi(s[e]||n[e],t)||oi(s.appContext[e],t);return!r&&i?n:r}}(si,e,!0,t)||e}const ai=Symbol.for("v-ndc");function oi(e,t){return e&&(e[t]||e[(0,Ht._A)(t)]||e[(0,Ht.kC)((0,Ht._A)(t))])}function li(e,t,n,i){let s;const r=n&&n[i];if((0,Ht.kJ)(e)||(0,Ht.HD)(e)){s=new Array(e.length);for(let n=0,i=e.length;n<i;n++)s[n]=t(e[n],n,void 0,r&&r[n])}else if("number"==typeof e){s=new Array(e);for(let n=0;n<e;n++)s[n]=t(n+1,n,void 0,r&&r[n])}else if((0,Ht.Kn)(e))if(e[Symbol.iterator])s=Array.from(e,((e,n)=>t(e,n,void 0,r&&r[n])));else{const n=Object.keys(e);s=new Array(n.length);for(let i=0,a=n.length;i<a;i++){const a=n[i];s[i]=t(e[a],a,i,r&&r[i])}}else s=[];return n&&(n[i]=s),s}const ci=e=>e?Ls(e)?Us(e)||e.proxy:ci(e.parent):null,ui=(0,Ht.l7)(Object.create(null),{$:e=>e,$el:e=>e.vnode.el,$data:e=>e.data,$props:e=>e.props,$attrs:e=>e.attrs,$slots:e=>e.slots,$refs:e=>e.refs,$parent:e=>ci(e.parent),$root:e=>ci(e.root),$emit:e=>e.emit,$options:e=>yi(e),$forceUpdate:e=>e.f||(e.f=()=>rn(e.update)),$nextTick:e=>e.n||(e.n=sn.bind(e.proxy)),$watch:e=>xn.bind(e)}),hi=(e,t)=>e!==Ht.kT&&!e.__isScriptSetup&&(0,Ht.RI)(e,t),di={get({_:e},t){const{ctx:n,setupState:i,data:s,props:r,accessCache:a,type:o,appContext:l}=e;let c;if("$"!==t[0]){const o=a[t];if(void 0!==o)switch(o){case 1:return i[t];case 2:return s[t];case 4:return n[t];case 3:return r[t]}else{if(hi(i,t))return a[t]=1,i[t];if(s!==Ht.kT&&(0,Ht.RI)(s,t))return a[t]=2,s[t];if((c=e.propsOptions[0])&&(0,Ht.RI)(c,t))return a[t]=3,r[t];if(n!==Ht.kT&&(0,Ht.RI)(n,t))return a[t]=4,n[t];mi&&(a[t]=0)}}const u=ui[t];let h,d;return u?("$attrs"===t&&(0,Bt.j)(e,"get",t),u(e)):(h=o.__cssModules)&&(h=h[t])?h:n!==Ht.kT&&(0,Ht.RI)(n,t)?(a[t]=4,n[t]):(d=l.config.globalProperties,(0,Ht.RI)(d,t)?d[t]:void 0)},set({_:e},t,n){const{data:i,setupState:s,ctx:r}=e;return hi(s,t)?(s[t]=n,!0):i!==Ht.kT&&(0,Ht.RI)(i,t)?(i[t]=n,!0):!((0,Ht.RI)(e.props,t)||"$"===t[0]&&t.slice(1)in e||(r[t]=n,0))},has({_:{data:e,setupState:t,accessCache:n,ctx:i,appContext:s,propsOptions:r}},a){let o;return!!n[a]||e!==Ht.kT&&(0,Ht.RI)(e,a)||hi(t,a)||(o=r[0])&&(0,Ht.RI)(o,a)||(0,Ht.RI)(i,a)||(0,Ht.RI)(ui,a)||(0,Ht.RI)(s.config.globalProperties,a)},defineProperty(e,t,n){return null!=n.get?e._.accessCache[t]=0:(0,Ht.RI)(n,"value")&&this.set(e,t,n.value,null),Reflect.defineProperty(e,t,n)}};function pi(e){return(0,Ht.kJ)(e)?e.reduce(((e,t)=>(e[t]=null,e)),{}):e}let mi=!0;function fi(e,t,n){Kt((0,Ht.kJ)(e)?e.map((e=>e.bind(t.proxy))):e.bind(t.proxy),t,n)}function gi(e,t,n,i){const s=i.includes(".")?In(n,i):()=>n[i];if((0,Ht.HD)(e)){const n=t[e];(0,Ht.mf)(n)&&Sn(s,n)}else if((0,Ht.mf)(e))Sn(s,e.bind(n));else if((0,Ht.Kn)(e))if((0,Ht.kJ)(e))e.forEach((e=>gi(e,t,n,i)));else{const i=(0,Ht.mf)(e.handler)?e.handler.bind(n):t[e.handler];(0,Ht.mf)(i)&&Sn(s,i,e)}}function yi(e){const t=e.type,{mixins:n,extends:i}=t,{mixins:s,optionsCache:r,config:{optionMergeStrategies:a}}=e.appContext,o=r.get(t);let l;return o?l=o:s.length||n||i?(l={},s.length&&s.forEach((e=>vi(l,e,a,!0))),vi(l,t,a)):l=t,(0,Ht.Kn)(t)&&r.set(t,l),l}function vi(e,t,n,i=!1){const{mixins:s,extends:r}=t;r&&vi(e,r,n,!0),s&&s.forEach((t=>vi(e,t,n,!0)));for(const s in t)if(i&&"expose"===s);else{const i=bi[s]||n&&n[s];e[s]=i?i(e[s],t[s]):t[s]}return e}const bi={data:_i,props:Ei,emits:Ei,methods:Si,computed:Si,beforeCreate:ki,created:ki,beforeMount:ki,mounted:ki,beforeUpdate:ki,updated:ki,beforeDestroy:ki,beforeUnmount:ki,destroyed:ki,unmounted:ki,activated:ki,deactivated:ki,errorCaptured:ki,serverPrefetch:ki,components:Si,directives:Si,watch:function(e,t){if(!e)return t;if(!t)return e;const n=(0,Ht.l7)(Object.create(null),e);for(const i in t)n[i]=ki(e[i],t[i]);return n},provide:_i,inject:function(e,t){return Si(wi(e),wi(t))}};function _i(e,t){return t?e?function(){return(0,Ht.l7)((0,Ht.mf)(e)?e.call(this,this):e,(0,Ht.mf)(t)?t.call(this,this):t)}:t:e}function wi(e){if((0,Ht.kJ)(e)){const t={};for(let n=0;n<e.length;n++)t[e[n]]=e[n];return t}return e}function ki(e,t){return e?[...new Set([].concat(e,t))]:t}function Si(e,t){return e?(0,Ht.l7)(Object.create(null),e,t):t}function Ei(e,t){return e?(0,Ht.kJ)(e)&&(0,Ht.kJ)(t)?[...new Set([...e,...t])]:(0,Ht.l7)(Object.create(null),pi(e),pi(null!=t?t:{})):t}function xi(){return{app:null,config:{isNativeTag:Ht.NO,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let Ii=0;function Ti(e,t){return function(n,i=null){(0,Ht.mf)(n)||(n=(0,Ht.l7)({},n)),null==i||(0,Ht.Kn)(i)||(i=null);const s=xi(),r=new Set;let a=!1;const o=s.app={_uid:Ii++,_component:n,_props:i,_container:null,_context:s,_instance:null,version:Vs,get config(){return s.config},set config(e){},use:(e,...t)=>(r.has(e)||(e&&(0,Ht.mf)(e.install)?(r.add(e),e.install(o,...t)):(0,Ht.mf)(e)&&(r.add(e),e(o,...t))),o),mixin:e=>(s.mixins.includes(e)||s.mixins.push(e),o),component:(e,t)=>t?(s.components[e]=t,o):s.components[e],directive:(e,t)=>t?(s.directives[e]=t,o):s.directives[e],mount(r,l,c){if(!a){const u=ps(n,i);return u.appContext=s,l&&t?t(u,r):e(u,r,c),a=!0,o._container=r,r.__vue_app__=o,Us(u.component)||u.component.proxy}},unmount(){a&&(e(null,o._container),delete o._container.__vue_app__)},provide:(e,t)=>(s.provides[e]=t,o),runWithContext(e){$i=o;try{return e()}finally{$i=null}}};return o}}let $i=null;function Ni(e,t,n=!1){const i=Es||fn;if(i||$i){const s=i?null==i.parent?i.vnode.appContext&&i.vnode.appContext.provides:i.parent.provides:$i._context.provides;if(s&&e in s)return s[e];if(arguments.length>1)return n&&(0,Ht.mf)(t)?t.call(i&&i.proxy):t}}function Oi(e,t,n,i){const[s,r]=e.propsOptions;let a,o=!1;if(t)for(let l in t){if((0,Ht.Gg)(l))continue;const c=t[l];let u;s&&(0,Ht.RI)(s,u=(0,Ht._A)(l))?r&&r.includes(u)?(a||(a={}))[u]=c:n[u]=c:mn(e.emitsOptions,l)||l in i&&c===i[l]||(i[l]=c,o=!0)}if(r){const t=(0,Bt.IU)(n),i=a||Ht.kT;for(let a=0;a<r.length;a++){const o=r[a];n[o]=Li(s,t,o,i[o],e,!(0,Ht.RI)(i,o))}}return o}function Li(e,t,n,i,s,r){const a=e[n];if(null!=a){const e=(0,Ht.RI)(a,"default");if(e&&void 0===i){const e=a.default;if(a.type!==Function&&!a.skipFactory&&(0,Ht.mf)(e)){const{propsDefaults:r}=s;n in r?i=r[n]:(Ns(s),i=r[n]=e.call(null,t),Os())}else i=e}a[0]&&(r&&!e?i=!1:!a[1]||""!==i&&i!==(0,Ht.rs)(n)||(i=!0))}return i}function Ci(e,t,n=!1){const i=t.propsCache,s=i.get(e);if(s)return s;const r=e.props,a={},o=[];let l=!1;if(!(0,Ht.mf)(e)){const i=e=>{l=!0;const[n,i]=Ci(e,t,!0);(0,Ht.l7)(a,n),i&&o.push(...i)};!n&&t.mixins.length&&t.mixins.forEach(i),e.extends&&i(e.extends),e.mixins&&e.mixins.forEach(i)}if(!r&&!l)return(0,Ht.Kn)(e)&&i.set(e,Ht.Z6),Ht.Z6;if((0,Ht.kJ)(r))for(let e=0;e<r.length;e++){const t=(0,Ht._A)(r[e]);Ai(t)&&(a[t]=Ht.kT)}else if(r)for(const e in r){const t=(0,Ht._A)(e);if(Ai(t)){const n=r[e],i=a[t]=(0,Ht.kJ)(n)||(0,Ht.mf)(n)?{type:n}:(0,Ht.l7)({},n);if(i){const e=Mi(Boolean,i.type),n=Mi(String,i.type);i[0]=e>-1,i[1]=n<0||e<n,(e>-1||(0,Ht.RI)(i,"default"))&&o.push(t)}}}const c=[a,o];return(0,Ht.Kn)(e)&&i.set(e,c),c}function Ai(e){return"$"!==e[0]}function Pi(e){const t=e&&e.toString().match(/^\s*(function|class) (\w+)/);return t?t[2]:null===e?"null":""}function Ri(e,t){return Pi(e)===Pi(t)}function Mi(e,t){return(0,Ht.kJ)(t)?t.findIndex((t=>Ri(t,e))):(0,Ht.mf)(t)&&Ri(t,e)?0:-1}const Ui=e=>"_"===e[0]||"$stable"===e,ji=e=>(0,Ht.kJ)(e)?e.map(vs):[vs(e)],Di=(e,t,n)=>{if(t._n)return t;const i=function(e,t=fn,n){if(!t)return e;if(e._n)return e;const i=(...n)=>{i._d&&is(-1);const s=yn(t);let r;try{r=e(...n)}finally{yn(s),i._d&&is(1)}return r};return i._n=!0,i._c=!0,i._d=!0,i}(((...e)=>ji(t(...e))),n);return i._c=!1,i},Fi=(e,t,n)=>{const i=e._ctx;for(const n in e){if(Ui(n))continue;const s=e[n];if((0,Ht.mf)(s))t[n]=Di(0,s,i);else if(null!=s){const e=ji(s);t[n]=()=>e}}},Vi=(e,t)=>{const n=ji(t);e.slots.default=()=>n},zi=(e,t)=>{if(32&e.vnode.shapeFlag){const n=t._;n?(e.slots=(0,Bt.IU)(t),(0,Ht.Nj)(t,"_",n)):Fi(t,e.slots={})}else e.slots={},t&&Vi(e,t);(0,Ht.Nj)(e.slots,cs,1)},Hi=(e,t,n)=>{const{vnode:i,slots:s}=e;let r=!0,a=Ht.kT;if(32&i.shapeFlag){const e=t._;e?n&&1===e?r=!1:((0,Ht.l7)(s,t),n||1!==e||delete s._):(r=!t.$stable,Fi(t,s)),a=t}else t&&(Vi(e,t),a={default:1});if(r)for(const e in s)Ui(e)||e in a||delete s[e]};function Bi(e,t,n,i,s=!1){if((0,Ht.kJ)(e))return void e.forEach(((e,r)=>Bi(e,t&&((0,Ht.kJ)(t)?t[r]:t),n,i,s)));if(Fn(i)&&!s)return;const r=4&i.shapeFlag?Us(i.component)||i.component.proxy:i.el,a=s?null:r,{i:o,r:l}=e,c=t&&t.r,u=o.refs===Ht.kT?o.refs={}:o.refs,h=o.setupState;if(null!=c&&c!==l&&((0,Ht.HD)(c)?(u[c]=null,(0,Ht.RI)(h,c)&&(h[c]=null)):(0,Bt.dq)(c)&&(c.value=null)),(0,Ht.mf)(l))Wt(l,o,12,[a,u]);else{const t=(0,Ht.HD)(l),i=(0,Bt.dq)(l);if(t||i){const o=()=>{if(e.f){const n=t?(0,Ht.RI)(h,l)?h[l]:u[l]:l.value;s?(0,Ht.kJ)(n)&&(0,Ht.Od)(n,r):(0,Ht.kJ)(n)?n.includes(r)||n.push(r):t?(u[l]=[r],(0,Ht.RI)(h,l)&&(h[l]=u[l])):(l.value=[r],e.k&&(u[e.k]=l.value))}else t?(u[l]=a,(0,Ht.RI)(h,l)&&(h[l]=a)):i&&(l.value=a,e.k&&(u[e.k]=a))};a?(o.id=-1,Wi(o,n)):o()}}}const Wi=function(e,t){var n;t&&t.pendingBranch?(0,Ht.kJ)(e)?t.effects.push(...e):t.effects.push(e):(n=e,(0,Ht.kJ)(n)?Zt.push(...n):Qt&&Qt.includes(n,n.allowRecurse?en+1:en)||Zt.push(n),an())};function Ki(e,t){(0,Ht.E9)().__VUE__=!0;const{insert:n,remove:i,patchProp:s,createElement:r,createText:a,createComment:o,setText:l,setElementText:c,parentNode:u,nextSibling:h,setScopeId:d=Ht.dG,insertStaticContent:p}=e,m=(e,t,n,i=null,s=null,r=null,a=!1,o=null,l=!!t.dynamicChildren)=>{if(e===t)return;e&&!ls(e,t)&&(i=F(e),R(e,s,r,!0),e=null),-2===t.patchFlag&&(l=!1,t.dynamicChildren=null);const{type:c,ref:u,shapeFlag:h}=t;switch(c){case Xi:f(e,t,n,i);break;case Yi:g(e,t,n,i);break;case Zi:null==e&&y(t,n,i,a);break;case Ji:x(e,t,n,i,s,r,a,o,l);break;default:1&h?v(e,t,n,i,s,r,a,o,l):6&h?I(e,t,n,i,s,r,a,o,l):(64&h||128&h)&&c.process(e,t,n,i,s,r,a,o,l,z)}null!=u&&s&&Bi(u,e&&e.ref,r,t||e,!t)},f=(e,t,i,s)=>{if(null==e)n(t.el=a(t.children),i,s);else{const n=t.el=e.el;t.children!==e.children&&l(n,t.children)}},g=(e,t,i,s)=>{null==e?n(t.el=o(t.children||""),i,s):t.el=e.el},y=(e,t,n,i)=>{[e.el,e.anchor]=p(e.children,t,n,i,e.el,e.anchor)},v=(e,t,n,i,s,r,a,o,l)=>{a=a||"svg"===t.type,null==e?b(t,n,i,s,r,a,o,l):k(e,t,s,r,a,o,l)},b=(e,t,i,a,o,l,u,h)=>{let d,p;const{type:m,props:f,shapeFlag:g,transition:y,dirs:v}=e;if(d=e.el=r(e.type,l,f&&f.is,f),8&g?c(d,e.children):16&g&&w(e.children,d,null,a,o,l&&"foreignObject"!==m,u,h),v&&Nn(e,null,a,"created"),_(d,e,e.scopeId,u,a),f){for(const t in f)"value"===t||(0,Ht.Gg)(t)||s(d,t,null,f[t],l,e.children,a,o,D);"value"in f&&s(d,"value",null,f.value),(p=f.onVnodeBeforeMount)&&ws(p,a,e)}v&&Nn(e,null,a,"beforeMount");const b=(!o||o&&!o.pendingBranch)&&y&&!y.persisted;b&&y.beforeEnter(d),n(d,t,i),((p=f&&f.onVnodeMounted)||b||v)&&Wi((()=>{p&&ws(p,a,e),b&&y.enter(d),v&&Nn(e,null,a,"mounted")}),o)},_=(e,t,n,i,s)=>{if(n&&d(e,n),i)for(let t=0;t<i.length;t++)d(e,i[t]);if(s&&t===s.subTree){const t=s.vnode;_(e,t,t.scopeId,t.slotScopeIds,s.parent)}},w=(e,t,n,i,s,r,a,o,l=0)=>{for(let c=l;c<e.length;c++){const l=e[c]=o?bs(e[c]):vs(e[c]);m(null,l,t,n,i,s,r,a,o)}},k=(e,t,n,i,r,a,o)=>{const l=t.el=e.el;let{patchFlag:u,dynamicChildren:h,dirs:d}=t;u|=16&e.patchFlag;const p=e.props||Ht.kT,m=t.props||Ht.kT;let f;n&&Gi(n,!1),(f=m.onVnodeBeforeUpdate)&&ws(f,n,t,e),d&&Nn(t,e,n,"beforeUpdate"),n&&Gi(n,!0);const g=r&&"foreignObject"!==t.type;if(h?S(e.dynamicChildren,h,l,n,i,g,a):o||L(e,t,l,null,n,i,g,a,!1),u>0){if(16&u)E(l,t,p,m,n,i,r);else if(2&u&&p.class!==m.class&&s(l,"class",null,m.class,r),4&u&&s(l,"style",p.style,m.style,r),8&u){const a=t.dynamicProps;for(let t=0;t<a.length;t++){const o=a[t],c=p[o],u=m[o];u===c&&"value"!==o||s(l,o,c,u,r,e.children,n,i,D)}}1&u&&e.children!==t.children&&c(l,t.children)}else o||null!=h||E(l,t,p,m,n,i,r);((f=m.onVnodeUpdated)||d)&&Wi((()=>{f&&ws(f,n,t,e),d&&Nn(t,e,n,"updated")}),i)},S=(e,t,n,i,s,r,a)=>{for(let o=0;o<t.length;o++){const l=e[o],c=t[o],h=l.el&&(l.type===Ji||!ls(l,c)||70&l.shapeFlag)?u(l.el):n;m(l,c,h,null,i,s,r,a,!0)}},E=(e,t,n,i,r,a,o)=>{if(n!==i){if(n!==Ht.kT)for(const l in n)(0,Ht.Gg)(l)||l in i||s(e,l,n[l],null,o,t.children,r,a,D);for(const l in i){if((0,Ht.Gg)(l))continue;const c=i[l],u=n[l];c!==u&&"value"!==l&&s(e,l,u,c,o,t.children,r,a,D)}"value"in i&&s(e,"value",n.value,i.value)}},x=(e,t,i,s,r,o,l,c,u)=>{const h=t.el=e?e.el:a(""),d=t.anchor=e?e.anchor:a("");let{patchFlag:p,dynamicChildren:m,slotScopeIds:f}=t;f&&(c=c?c.concat(f):f),null==e?(n(h,i,s),n(d,i,s),w(t.children,i,d,r,o,l,c,u)):p>0&&64&p&&m&&e.dynamicChildren?(S(e.dynamicChildren,m,i,r,o,l,c),(null!=t.key||r&&t===r.subTree)&&qi(e,t,!0)):L(e,t,i,d,r,o,l,c,u)},I=(e,t,n,i,s,r,a,o,l)=>{t.slotScopeIds=o,null==e?512&t.shapeFlag?s.ctx.activate(t,n,i,a,l):T(t,n,i,s,r,a,l):$(e,t,l)},T=(e,t,n,i,s,r,a)=>{const o=e.component=function(e,t,n){const i=e.type,s=(t?t.appContext:e.appContext)||ks,r={uid:Ss++,vnode:e,type:i,parent:t,appContext:s,root:null,next:null,subTree:null,effect:null,update:null,scope:new Bt.Bj(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:t?t.provides:Object.create(s.provides),accessCache:null,renderCache:[],components:null,directives:null,propsOptions:Ci(i,s),emitsOptions:pn(i,s),emit:null,emitted:null,propsDefaults:Ht.kT,inheritAttrs:i.inheritAttrs,ctx:Ht.kT,data:Ht.kT,props:Ht.kT,attrs:Ht.kT,slots:Ht.kT,refs:Ht.kT,setupState:Ht.kT,setupContext:null,attrsProxy:null,slotsProxy:null,suspense:n,suspenseId:n?n.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return r.ctx={_:r},r.root=t?t.root:r,r.emit=dn.bind(null,r),e.ce&&e.ce(r),r}(e,i,s);if(Vn(e)&&(o.ctx.renderer=z),function(e,t=!1){Ps=t;const{props:n,children:i}=e.vnode,s=Ls(e);!function(e,t,n,i=!1){const s={},r={};(0,Ht.Nj)(r,cs,1),e.propsDefaults=Object.create(null),Oi(e,t,s,r);for(const t in e.propsOptions[0])t in s||(s[t]=void 0);n?e.props=i?s:(0,Bt.Um)(s):e.type.props?e.props=s:e.props=r,e.attrs=r}(e,n,s,t),zi(e,i);const r=s?function(e,t){const n=e.type;e.accessCache=Object.create(null),e.proxy=(0,Bt.Xl)(new Proxy(e.ctx,di));const{setup:i}=n;if(i){const n=e.setupContext=i.length>1?function(e){const t=t=>{e.exposed=t||{}};return{get attrs(){return function(e){return e.attrsProxy||(e.attrsProxy=new Proxy(e.attrs,{get:(t,n)=>((0,Bt.j)(e,"get","$attrs"),t[n])}))}(e)},slots:e.slots,emit:e.emit,expose:t}}(e):null;Ns(e),(0,Bt.Jd)();const s=Wt(i,e,0,[e.props,n]);if((0,Bt.lk)(),Os(),(0,Ht.tI)(s)){if(s.then(Os,Os),t)return s.then((n=>{Rs(e,n,t)})).catch((t=>{Gt(t,e,0)}));e.asyncDep=s}else Rs(e,s,t)}else Ms(e,t)}(e,t):void 0;Ps=!1}(o),o.asyncDep){if(s&&s.registerDep(o,N),!e.el){const e=o.subTree=ps(Yi);g(null,e,t,n)}}else N(o,e,t,n,s,r,a)},$=(e,t,n)=>{const i=t.component=e.component;if(function(e,t,n){const{props:i,children:s,component:r}=e,{props:a,children:o,patchFlag:l}=t,c=r.emitsOptions;if(t.dirs||t.transition)return!0;if(!(n&&l>=0))return!(!s&&!o||o&&o.$stable)||i!==a&&(i?!a||wn(i,a,c):!!a);if(1024&l)return!0;if(16&l)return i?wn(i,a,c):!!a;if(8&l){const e=t.dynamicProps;for(let t=0;t<e.length;t++){const n=e[t];if(a[n]!==i[n]&&!mn(c,n))return!0}}return!1}(e,t,n)){if(i.asyncDep&&!i.asyncResolved)return void O(i,t,n);i.next=t,function(e){const t=Xt.indexOf(e);t>Yt&&Xt.splice(t,1)}(i.update),i.update()}else t.el=e.el,i.vnode=t},N=(e,t,n,i,s,r,a)=>{const o=e.effect=new Bt.qq((()=>{if(e.isMounted){let t,{next:n,bu:i,u:o,parent:l,vnode:c}=e,h=n;Gi(e,!1),n?(n.el=c.el,O(e,n,a)):n=c,i&&(0,Ht.ir)(i),(t=n.props&&n.props.onVnodeBeforeUpdate)&&ws(t,l,n,c),Gi(e,!0);const d=vn(e),p=e.subTree;e.subTree=d,m(p,d,u(p.el),F(p),e,s,r),n.el=d.el,null===h&&function({vnode:e,parent:t},n){for(;t&&t.subTree===e;)(e=t.vnode).el=n,t=t.parent}(e,d.el),o&&Wi(o,s),(t=n.props&&n.props.onVnodeUpdated)&&Wi((()=>ws(t,l,n,c)),s)}else{let a;const{el:o,props:l}=t,{bm:c,m:u,parent:h}=e,d=Fn(t);if(Gi(e,!1),c&&(0,Ht.ir)(c),!d&&(a=l&&l.onVnodeBeforeMount)&&ws(a,h,t),Gi(e,!0),o&&B){const n=()=>{e.subTree=vn(e),B(o,e.subTree,e,s,null)};d?t.type.__asyncLoader().then((()=>!e.isUnmounted&&n())):n()}else{const a=e.subTree=vn(e);m(null,a,n,i,e,s,r),t.el=a.el}if(u&&Wi(u,s),!d&&(a=l&&l.onVnodeMounted)){const e=t;Wi((()=>ws(a,h,e)),s)}(256&t.shapeFlag||h&&Fn(h.vnode)&&256&h.vnode.shapeFlag)&&e.a&&Wi(e.a,s),e.isMounted=!0,t=n=i=null}}),(()=>rn(l)),e.scope),l=e.update=()=>o.run();l.id=e.uid,Gi(e,!0),l()},O=(e,t,n)=>{t.component=e;const i=e.vnode.props;e.vnode=t,e.next=null,function(e,t,n,i){const{props:s,attrs:r,vnode:{patchFlag:a}}=e,o=(0,Bt.IU)(s),[l]=e.propsOptions;let c=!1;if(!(i||a>0)||16&a){let i;Oi(e,t,s,r)&&(c=!0);for(const r in o)t&&((0,Ht.RI)(t,r)||(i=(0,Ht.rs)(r))!==r&&(0,Ht.RI)(t,i))||(l?!n||void 0===n[r]&&void 0===n[i]||(s[r]=Li(l,o,r,void 0,e,!0)):delete s[r]);if(r!==o)for(const e in r)t&&(0,Ht.RI)(t,e)||(delete r[e],c=!0)}else if(8&a){const n=e.vnode.dynamicProps;for(let i=0;i<n.length;i++){let a=n[i];if(mn(e.emitsOptions,a))continue;const u=t[a];if(l)if((0,Ht.RI)(r,a))u!==r[a]&&(r[a]=u,c=!0);else{const t=(0,Ht._A)(a);s[t]=Li(l,o,t,u,e,!1)}else u!==r[a]&&(r[a]=u,c=!0)}}c&&(0,Bt.X$)(e,"set","$attrs")}(e,t.props,i,n),Hi(e,t.children,n),(0,Bt.Jd)(),on(),(0,Bt.lk)()},L=(e,t,n,i,s,r,a,o,l=!1)=>{const u=e&&e.children,h=e?e.shapeFlag:0,d=t.children,{patchFlag:p,shapeFlag:m}=t;if(p>0){if(128&p)return void A(u,d,n,i,s,r,a,o,l);if(256&p)return void C(u,d,n,i,s,r,a,o,l)}8&m?(16&h&&D(u,s,r),d!==u&&c(n,d)):16&h?16&m?A(u,d,n,i,s,r,a,o,l):D(u,s,r,!0):(8&h&&c(n,""),16&m&&w(d,n,i,s,r,a,o,l))},C=(e,t,n,i,s,r,a,o,l)=>{e=e||Ht.Z6,t=t||Ht.Z6;const c=e.length,u=t.length,h=Math.min(c,u);let d;for(d=0;d<h;d++){const i=t[d]=l?bs(t[d]):vs(t[d]);m(e[d],i,n,null,s,r,a,o,l)}c>u?D(e,s,r,!0,!1,h):w(t,n,i,s,r,a,o,l,h)},A=(e,t,n,i,s,r,a,o,l)=>{let c=0;const u=t.length;let h=e.length-1,d=u-1;for(;c<=h&&c<=d;){const i=e[c],u=t[c]=l?bs(t[c]):vs(t[c]);if(!ls(i,u))break;m(i,u,n,null,s,r,a,o,l),c++}for(;c<=h&&c<=d;){const i=e[h],c=t[d]=l?bs(t[d]):vs(t[d]);if(!ls(i,c))break;m(i,c,n,null,s,r,a,o,l),h--,d--}if(c>h){if(c<=d){const e=d+1,h=e<u?t[e].el:i;for(;c<=d;)m(null,t[c]=l?bs(t[c]):vs(t[c]),n,h,s,r,a,o,l),c++}}else if(c>d)for(;c<=h;)R(e[c],s,r,!0),c++;else{const p=c,f=c,g=new Map;for(c=f;c<=d;c++){const e=t[c]=l?bs(t[c]):vs(t[c]);null!=e.key&&g.set(e.key,c)}let y,v=0;const b=d-f+1;let _=!1,w=0;const k=new Array(b);for(c=0;c<b;c++)k[c]=0;for(c=p;c<=h;c++){const i=e[c];if(v>=b){R(i,s,r,!0);continue}let u;if(null!=i.key)u=g.get(i.key);else for(y=f;y<=d;y++)if(0===k[y-f]&&ls(i,t[y])){u=y;break}void 0===u?R(i,s,r,!0):(k[u-f]=c+1,u>=w?w=u:_=!0,m(i,t[u],n,null,s,r,a,o,l),v++)}const S=_?function(e){const t=e.slice(),n=[0];let i,s,r,a,o;const l=e.length;for(i=0;i<l;i++){const l=e[i];if(0!==l){if(s=n[n.length-1],e[s]<l){t[i]=s,n.push(i);continue}for(r=0,a=n.length-1;r<a;)o=r+a>>1,e[n[o]]<l?r=o+1:a=o;l<e[n[r]]&&(r>0&&(t[i]=n[r-1]),n[r]=i)}}for(r=n.length,a=n[r-1];r-- >0;)n[r]=a,a=t[a];return n}(k):Ht.Z6;for(y=S.length-1,c=b-1;c>=0;c--){const e=f+c,h=t[e],d=e+1<u?t[e+1].el:i;0===k[c]?m(null,h,n,d,s,r,a,o,l):_&&(y<0||c!==S[y]?P(h,n,d,2):y--)}}},P=(e,t,i,s,r=null)=>{const{el:a,type:o,transition:l,children:c,shapeFlag:u}=e;if(6&u)P(e.component.subTree,t,i,s);else if(128&u)e.suspense.move(t,i,s);else if(64&u)o.move(e,t,i,z);else if(o!==Ji)if(o!==Zi)if(2!==s&&1&u&&l)if(0===s)l.beforeEnter(a),n(a,t,i),Wi((()=>l.enter(a)),r);else{const{leave:e,delayLeave:s,afterLeave:r}=l,o=()=>n(a,t,i),c=()=>{e(a,(()=>{o(),r&&r()}))};s?s(a,o,c):c()}else n(a,t,i);else(({el:e,anchor:t},i,s)=>{let r;for(;e&&e!==t;)r=h(e),n(e,i,s),e=r;n(t,i,s)})(e,t,i);else{n(a,t,i);for(let e=0;e<c.length;e++)P(c[e],t,i,s);n(e.anchor,t,i)}},R=(e,t,n,i=!1,s=!1)=>{const{type:r,props:a,ref:o,children:l,dynamicChildren:c,shapeFlag:u,patchFlag:h,dirs:d}=e;if(null!=o&&Bi(o,null,n,e,!0),256&u)return void t.ctx.deactivate(e);const p=1&u&&d,m=!Fn(e);let f;if(m&&(f=a&&a.onVnodeBeforeUnmount)&&ws(f,t,e),6&u)j(e.component,n,i);else{if(128&u)return void e.suspense.unmount(n,i);p&&Nn(e,null,t,"beforeUnmount"),64&u?e.type.remove(e,t,n,s,z,i):c&&(r!==Ji||h>0&&64&h)?D(c,t,n,!1,!0):(r===Ji&&384&h||!s&&16&u)&&D(l,t,n),i&&M(e)}(m&&(f=a&&a.onVnodeUnmounted)||p)&&Wi((()=>{f&&ws(f,t,e),p&&Nn(e,null,t,"unmounted")}),n)},M=e=>{const{type:t,el:n,anchor:s,transition:r}=e;if(t===Ji)return void U(n,s);if(t===Zi)return void(({el:e,anchor:t})=>{let n;for(;e&&e!==t;)n=h(e),i(e),e=n;i(t)})(e);const a=()=>{i(n),r&&!r.persisted&&r.afterLeave&&r.afterLeave()};if(1&e.shapeFlag&&r&&!r.persisted){const{leave:t,delayLeave:i}=r,s=()=>t(n,a);i?i(e.el,a,s):s()}else a()},U=(e,t)=>{let n;for(;e!==t;)n=h(e),i(e),e=n;i(t)},j=(e,t,n)=>{const{bum:i,scope:s,update:r,subTree:a,um:o}=e;i&&(0,Ht.ir)(i),s.stop(),r&&(r.active=!1,R(a,e,t,n)),o&&Wi(o,t),Wi((()=>{e.isUnmounted=!0}),t),t&&t.pendingBranch&&!t.isUnmounted&&e.asyncDep&&!e.asyncResolved&&e.suspenseId===t.pendingId&&(t.deps--,0===t.deps&&t.resolve())},D=(e,t,n,i=!1,s=!1,r=0)=>{for(let a=r;a<e.length;a++)R(e[a],t,n,i,s)},F=e=>6&e.shapeFlag?F(e.component.subTree):128&e.shapeFlag?e.suspense.next():h(e.anchor||e.el),V=(e,t,n)=>{null==e?t._vnode&&R(t._vnode,null,null,!0):m(t._vnode||null,e,t,null,null,null,n),on(),ln(),t._vnode=e},z={p:m,um:R,m:P,r:M,mt:T,mc:w,pc:L,pbc:S,n:F,o:e};let H,B;return t&&([H,B]=t(z)),{render:V,hydrate:H,createApp:Ti(V,H)}}function Gi({effect:e,update:t},n){e.allowRecurse=t.allowRecurse=n}function qi(e,t,n=!1){const i=e.children,s=t.children;if((0,Ht.kJ)(i)&&(0,Ht.kJ)(s))for(let e=0;e<i.length;e++){const t=i[e];let r=s[e];1&r.shapeFlag&&!r.dynamicChildren&&((r.patchFlag<=0||32===r.patchFlag)&&(r=s[e]=bs(s[e]),r.el=t.el),n||qi(t,r)),r.type===Xi&&(r.el=t.el)}}const Ji=Symbol.for("v-fgt"),Xi=Symbol.for("v-txt"),Yi=Symbol.for("v-cmt"),Zi=Symbol.for("v-stc"),Qi=[];let es=null;function ts(e=!1){Qi.push(es=e?null:[])}let ns=1;function is(e){ns+=e}function ss(e){return e.dynamicChildren=ns>0?es||Ht.Z6:null,Qi.pop(),es=Qi[Qi.length-1]||null,ns>0&&es&&es.push(e),e}function rs(e,t,n,i,s,r){return ss(ds(e,t,n,i,s,r,!0))}function as(e,t,n,i,s){return ss(ps(e,t,n,i,s,!0))}function os(e){return!!e&&!0===e.__v_isVNode}function ls(e,t){return e.type===t.type&&e.key===t.key}const cs="__vInternal",us=({key:e})=>null!=e?e:null,hs=({ref:e,ref_key:t,ref_for:n})=>("number"==typeof e&&(e=""+e),null!=e?(0,Ht.HD)(e)||(0,Bt.dq)(e)||(0,Ht.mf)(e)?{i:fn,r:e,k:t,f:!!n}:e:null);function ds(e,t=null,n=null,i=0,s=null,r=(e===Ji?0:1),a=!1,o=!1){const l={__v_isVNode:!0,__v_skip:!0,type:e,props:t,key:t&&us(t),ref:t&&hs(t),scopeId:gn,slotScopeIds:null,children:n,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetAnchor:null,staticCount:0,shapeFlag:r,patchFlag:i,dynamicProps:s,dynamicChildren:null,appContext:null,ctx:fn};return o?(_s(l,n),128&r&&e.normalize(l)):n&&(l.shapeFlag|=(0,Ht.HD)(n)?8:16),ns>0&&!a&&es&&(l.patchFlag>0||6&r)&&32!==l.patchFlag&&es.push(l),l}const ps=function(e,t=null,n=null,i=0,s=null,r=!1){if(e&&e!==ai||(e=Yi),os(e)){const i=ms(e,t,!0);return n&&_s(i,n),ns>0&&!r&&es&&(6&i.shapeFlag?es[es.indexOf(e)]=i:es.push(i)),i.patchFlag|=-2,i}if(function(e){return(0,Ht.mf)(e)&&"__vccOpts"in e}(e)&&(e=e.__vccOpts),t){t=function(e){return e?(0,Bt.X3)(e)||cs in e?(0,Ht.l7)({},e):e:null}(t);let{class:e,style:n}=t;e&&!(0,Ht.HD)(e)&&(t.class=(0,Ht.C_)(e)),(0,Ht.Kn)(n)&&((0,Bt.X3)(n)&&!(0,Ht.kJ)(n)&&(n=(0,Ht.l7)({},n)),t.style=(0,Ht.j5)(n))}return ds(e,t,n,i,s,(0,Ht.HD)(e)?1:(e=>e.__isSuspense)(e)?128:(e=>e.__isTeleport)(e)?64:(0,Ht.Kn)(e)?4:(0,Ht.mf)(e)?2:0,r,!0)};function ms(e,t,n=!1){const{props:i,ref:s,patchFlag:r,children:a}=e,o=t?function(...e){const t={};for(let n=0;n<e.length;n++){const i=e[n];for(const e in i)if("class"===e)t.class!==i.class&&(t.class=(0,Ht.C_)([t.class,i.class]));else if("style"===e)t.style=(0,Ht.j5)([t.style,i.style]);else if((0,Ht.F7)(e)){const n=t[e],s=i[e];!s||n===s||(0,Ht.kJ)(n)&&n.includes(s)||(t[e]=n?[].concat(n,s):s)}else""!==e&&(t[e]=i[e])}return t}(i||{},t):i;return{__v_isVNode:!0,__v_skip:!0,type:e.type,props:o,key:o&&us(o),ref:t&&t.ref?n&&s?(0,Ht.kJ)(s)?s.concat(hs(t)):[s,hs(t)]:hs(t):s,scopeId:e.scopeId,slotScopeIds:e.slotScopeIds,children:a,target:e.target,targetAnchor:e.targetAnchor,staticCount:e.staticCount,shapeFlag:e.shapeFlag,patchFlag:t&&e.type!==Ji?-1===r?16:16|r:r,dynamicProps:e.dynamicProps,dynamicChildren:e.dynamicChildren,appContext:e.appContext,dirs:e.dirs,transition:e.transition,component:e.component,suspense:e.suspense,ssContent:e.ssContent&&ms(e.ssContent),ssFallback:e.ssFallback&&ms(e.ssFallback),el:e.el,anchor:e.anchor,ctx:e.ctx,ce:e.ce}}function fs(e=" ",t=0){return ps(Xi,null,e,t)}function gs(e,t){const n=ps(Zi,null,e);return n.staticCount=t,n}function ys(e="",t=!1){return t?(ts(),as(Yi,null,e)):ps(Yi,null,e)}function vs(e){return null==e||"boolean"==typeof e?ps(Yi):(0,Ht.kJ)(e)?ps(Ji,null,e.slice()):"object"==typeof e?bs(e):ps(Xi,null,String(e))}function bs(e){return null===e.el&&-1!==e.patchFlag||e.memo?e:ms(e)}function _s(e,t){let n=0;const{shapeFlag:i}=e;if(null==t)t=null;else if((0,Ht.kJ)(t))n=16;else if("object"==typeof t){if(65&i){const n=t.default;return void(n&&(n._c&&(n._d=!1),_s(e,n()),n._c&&(n._d=!0)))}{n=32;const i=t._;i||cs in t?3===i&&fn&&(1===fn.slots._?t._=1:(t._=2,e.patchFlag|=1024)):t._ctx=fn}}else(0,Ht.mf)(t)?(t={default:t,_ctx:fn},n=32):(t=String(t),64&i?(n=16,t=[fs(t)]):n=8);e.children=t,e.shapeFlag|=n}function ws(e,t,n,i=null){Kt(e,t,7,[n,i])}const ks=xi();let Ss=0;let Es=null;const xs=()=>Es||fn;let Is,Ts,$s="__VUE_INSTANCE_SETTERS__";(Ts=(0,Ht.E9)()[$s])||(Ts=(0,Ht.E9)()[$s]=[]),Ts.push((e=>Es=e)),Is=e=>{Ts.length>1?Ts.forEach((t=>t(e))):Ts[0](e)};const Ns=e=>{Is(e),e.scope.on()},Os=()=>{Es&&Es.scope.off(),Is(null)};function Ls(e){return 4&e.vnode.shapeFlag}let Cs,As,Ps=!1;function Rs(e,t,n){(0,Ht.mf)(t)?e.type.__ssrInlineRender?e.ssrRender=t:e.render=t:(0,Ht.Kn)(t)&&(e.setupState=(0,Bt.WL)(t)),Ms(e,n)}function Ms(e,t,n){const i=e.type;if(!e.render){if(!t&&Cs&&!i.render){const t=i.template||yi(e).template;if(t){const{isCustomElement:n,compilerOptions:s}=e.appContext.config,{delimiters:r,compilerOptions:a}=i,o=(0,Ht.l7)((0,Ht.l7)({isCustomElement:n,delimiters:r},s),a);i.render=Cs(t,o)}}e.render=i.render||Ht.dG,As&&As(e)}Ns(e),(0,Bt.Jd)(),function(e){const t=yi(e),n=e.proxy,i=e.ctx;mi=!1,t.beforeCreate&&fi(t.beforeCreate,e,"bc");const{data:s,computed:r,methods:a,watch:o,provide:l,inject:c,created:u,beforeMount:h,mounted:d,beforeUpdate:p,updated:m,activated:f,deactivated:g,beforeDestroy:y,beforeUnmount:v,destroyed:b,unmounted:_,render:w,renderTracked:k,renderTriggered:S,errorCaptured:E,serverPrefetch:x,expose:I,inheritAttrs:T,components:$,directives:N,filters:O}=t;if(c&&function(e,t,n=Ht.dG){(0,Ht.kJ)(e)&&(e=wi(e));for(const n in e){const i=e[n];let s;s=(0,Ht.Kn)(i)?"default"in i?Ni(i.from||n,i.default,!0):Ni(i.from||n):Ni(i),(0,Bt.dq)(s)?Object.defineProperty(t,n,{enumerable:!0,configurable:!0,get:()=>s.value,set:e=>s.value=e}):t[n]=s}}(c,i,null),a)for(const e in a){const t=a[e];(0,Ht.mf)(t)&&(i[e]=t.bind(n))}if(s){const t=s.call(n,n);(0,Ht.Kn)(t)&&(e.data=(0,Bt.qj)(t))}if(mi=!0,r)for(const e in r){const t=r[e],s=(0,Ht.mf)(t)?t.bind(n,n):(0,Ht.mf)(t.get)?t.get.bind(n,n):Ht.dG,a=!(0,Ht.mf)(t)&&(0,Ht.mf)(t.set)?t.set.bind(n):Ht.dG,o=js({get:s,set:a});Object.defineProperty(i,e,{enumerable:!0,configurable:!0,get:()=>o.value,set:e=>o.value=e})}if(o)for(const e in o)gi(o[e],i,n,e);if(l){const e=(0,Ht.mf)(l)?l.call(n):l;Reflect.ownKeys(e).forEach((t=>{!function(e,t){if(Es){let n=Es.provides;const i=Es.parent&&Es.parent.provides;i===n&&(n=Es.provides=Object.create(i)),n[e]=t}}(t,e[t])}))}function L(e,t){(0,Ht.kJ)(t)?t.forEach((t=>e(t.bind(n)))):t&&e(t.bind(n))}if(u&&fi(u,e,"c"),L(qn,h),L(Jn,d),L(Xn,p),L(Yn,m),L(zn,f),L(Hn,g),L(ii,E),L(ni,k),L(ti,S),L(Zn,v),L(Qn,_),L(ei,x),(0,Ht.kJ)(I))if(I.length){const t=e.exposed||(e.exposed={});I.forEach((e=>{Object.defineProperty(t,e,{get:()=>n[e],set:t=>n[e]=t})}))}else e.exposed||(e.exposed={});w&&e.render===Ht.dG&&(e.render=w),null!=T&&(e.inheritAttrs=T),$&&(e.components=$),N&&(e.directives=N)}(e),(0,Bt.lk)(),Os()}function Us(e){if(e.exposed)return e.exposeProxy||(e.exposeProxy=new Proxy((0,Bt.WL)((0,Bt.Xl)(e.exposed)),{get:(t,n)=>n in t?t[n]:n in ui?ui[n](e):void 0,has:(e,t)=>t in e||t in ui}))}const js=(e,t)=>(0,Bt.Fl)(e,t,Ps),Ds=Symbol.for("v-scx"),Fs=()=>Ni(Ds),Vs="3.3.4",zs="undefined"!=typeof document?document:null,Hs=zs&&zs.createElement("template"),Bs={insert:(e,t,n)=>{t.insertBefore(e,n||null)},remove:e=>{const t=e.parentNode;t&&t.removeChild(e)},createElement:(e,t,n,i)=>{const s=t?zs.createElementNS("http://www.w3.org/2000/svg",e):zs.createElement(e,n?{is:n}:void 0);return"select"===e&&i&&null!=i.multiple&&s.setAttribute("multiple",i.multiple),s},createText:e=>zs.createTextNode(e),createComment:e=>zs.createComment(e),setText:(e,t)=>{e.nodeValue=t},setElementText:(e,t)=>{e.textContent=t},parentNode:e=>e.parentNode,nextSibling:e=>e.nextSibling,querySelector:e=>zs.querySelector(e),setScopeId(e,t){e.setAttribute(t,"")},insertStaticContent(e,t,n,i,s,r){const a=n?n.previousSibling:t.lastChild;if(s&&(s===r||s.nextSibling))for(;t.insertBefore(s.cloneNode(!0),n),s!==r&&(s=s.nextSibling););else{Hs.innerHTML=i?`<svg>${e}</svg>`:e;const s=Hs.content;if(i){const e=s.firstChild;for(;e.firstChild;)s.appendChild(e.firstChild);s.removeChild(e)}t.insertBefore(s,n)}return[a?a.nextSibling:t.firstChild,n?n.previousSibling:t.lastChild]}},Ws=/\s*!important$/;function Ks(e,t,n){if((0,Ht.kJ)(n))n.forEach((n=>Ks(e,t,n)));else if(null==n&&(n=""),t.startsWith("--"))e.setProperty(t,n);else{const i=function(e,t){const n=qs[t];if(n)return n;let i=(0,Ht._A)(t);if("filter"!==i&&i in e)return qs[t]=i;i=(0,Ht.kC)(i);for(let n=0;n<Gs.length;n++){const s=Gs[n]+i;if(s in e)return qs[t]=s}return t}(e,t);Ws.test(n)?e.setProperty((0,Ht.rs)(i),n.replace(Ws,""),"important"):e[i]=n}}const Gs=["Webkit","Moz","ms"],qs={},Js="http://www.w3.org/1999/xlink";function Xs(e,t,n,i){e.addEventListener(t,n,i)}const Ys=/(?:Once|Passive|Capture)$/;let Zs=0;const Qs=Promise.resolve(),er=()=>Zs||(Qs.then((()=>Zs=0)),Zs=Date.now()),tr=/^on[a-z]/;"undefined"!=typeof HTMLElement&&HTMLElement;const nr="transition",ir="animation",sr=(e,{slots:t})=>function(e,t,n){const i=arguments.length;return 2===i?(0,Ht.Kn)(t)&&!(0,Ht.kJ)(t)?os(t)?ps(e,null,[t]):ps(e,t):ps(e,null,t):(i>3?n=Array.prototype.slice.call(arguments,2):3===i&&os(n)&&(n=[n]),ps(e,t,n))}(An,function(e){const t={};for(const n in e)n in rr||(t[n]=e[n]);if(!1===e.css)return t;const{name:n="v",type:i,duration:s,enterFromClass:r=`${n}-enter-from`,enterActiveClass:a=`${n}-enter-active`,enterToClass:o=`${n}-enter-to`,appearFromClass:l=r,appearActiveClass:c=a,appearToClass:u=o,leaveFromClass:h=`${n}-leave-from`,leaveActiveClass:d=`${n}-leave-active`,leaveToClass:p=`${n}-leave-to`}=e,m=function(e){if(null==e)return null;if((0,Ht.Kn)(e))return[lr(e.enter),lr(e.leave)];{const t=lr(e);return[t,t]}}(s),f=m&&m[0],g=m&&m[1],{onBeforeEnter:y,onEnter:v,onEnterCancelled:b,onLeave:_,onLeaveCancelled:w,onBeforeAppear:k=y,onAppear:S=v,onAppearCancelled:E=b}=t,x=(e,t,n)=>{ur(e,t?u:o),ur(e,t?c:a),n&&n()},I=(e,t)=>{e._isLeaving=!1,ur(e,h),ur(e,p),ur(e,d),t&&t()},T=e=>(t,n)=>{const s=e?S:v,a=()=>x(t,e,n);ar(s,[t,a]),hr((()=>{ur(t,e?l:r),cr(t,e?u:o),or(s)||pr(t,i,f,a)}))};return(0,Ht.l7)(t,{onBeforeEnter(e){ar(y,[e]),cr(e,r),cr(e,a)},onBeforeAppear(e){ar(k,[e]),cr(e,l),cr(e,c)},onEnter:T(!1),onAppear:T(!0),onLeave(e,t){e._isLeaving=!0;const n=()=>I(e,t);cr(e,h),document.body.offsetHeight,cr(e,d),hr((()=>{e._isLeaving&&(ur(e,h),cr(e,p),or(_)||pr(e,i,g,n))})),ar(_,[e,n])},onEnterCancelled(e){x(e,!1),ar(b,[e])},onAppearCancelled(e){x(e,!0),ar(E,[e])},onLeaveCancelled(e){I(e),ar(w,[e])}})}(e),t);sr.displayName="Transition";const rr={name:String,type:String,css:{type:Boolean,default:!0},duration:[String,Number,Object],enterFromClass:String,enterActiveClass:String,enterToClass:String,appearFromClass:String,appearActiveClass:String,appearToClass:String,leaveFromClass:String,leaveActiveClass:String,leaveToClass:String},ar=(sr.props=(0,Ht.l7)({},Ln,rr),(e,t=[])=>{(0,Ht.kJ)(e)?e.forEach((e=>e(...t))):e&&e(...t)}),or=e=>!!e&&((0,Ht.kJ)(e)?e.some((e=>e.length>1)):e.length>1);function lr(e){return(0,Ht.He)(e)}function cr(e,t){t.split(/\s+/).forEach((t=>t&&e.classList.add(t))),(e._vtc||(e._vtc=new Set)).add(t)}function ur(e,t){t.split(/\s+/).forEach((t=>t&&e.classList.remove(t)));const{_vtc:n}=e;n&&(n.delete(t),n.size||(e._vtc=void 0))}function hr(e){requestAnimationFrame((()=>{requestAnimationFrame(e)}))}let dr=0;function pr(e,t,n,i){const s=e._endId=++dr,r=()=>{s===e._endId&&i()};if(n)return setTimeout(r,n);const{type:a,timeout:o,propCount:l}=function(e,t){const n=window.getComputedStyle(e),i=e=>(n[e]||"").split(", "),s=i(`${nr}Delay`),r=i(`${nr}Duration`),a=mr(s,r),o=i(`${ir}Delay`),l=i(`${ir}Duration`),c=mr(o,l);let u=null,h=0,d=0;return t===nr?a>0&&(u=nr,h=a,d=r.length):t===ir?c>0&&(u=ir,h=c,d=l.length):(h=Math.max(a,c),u=h>0?a>c?nr:ir:null,d=u?u===nr?r.length:l.length:0),{type:u,timeout:h,propCount:d,hasTransform:u===nr&&/\b(transform|all)(,|$)/.test(i(`${nr}Property`).toString())}}(e,t);if(!a)return i();const c=a+"end";let u=0;const h=()=>{e.removeEventListener(c,d),r()},d=t=>{t.target===e&&++u>=l&&h()};setTimeout((()=>{u<l&&h()}),o+1),e.addEventListener(c,d)}function mr(e,t){for(;e.length<t.length;)e=e.concat(e);return Math.max(...t.map(((t,n)=>fr(t)+fr(e[n]))))}function fr(e){return 1e3*Number(e.slice(0,-1).replace(",","."))}const gr=e=>{const t=e.props["onUpdate:modelValue"]||!1;return(0,Ht.kJ)(t)?e=>(0,Ht.ir)(t,e):t};function yr(e){e.target.composing=!0}function vr(e){const t=e.target;t.composing&&(t.composing=!1,t.dispatchEvent(new Event("input")))}const br={created(e,{modifiers:{lazy:t,trim:n,number:i}},s){e._assign=gr(s);const r=i||s.props&&"number"===s.props.type;Xs(e,t?"change":"input",(t=>{if(t.target.composing)return;let i=e.value;n&&(i=i.trim()),r&&(i=(0,Ht.h5)(i)),e._assign(i)})),n&&Xs(e,"change",(()=>{e.value=e.value.trim()})),t||(Xs(e,"compositionstart",yr),Xs(e,"compositionend",vr),Xs(e,"change",vr))},mounted(e,{value:t}){e.value=null==t?"":t},beforeUpdate(e,{value:t,modifiers:{lazy:n,trim:i,number:s}},r){if(e._assign=gr(r),e.composing)return;if(document.activeElement===e&&"range"!==e.type){if(n)return;if(i&&e.value.trim()===t)return;if((s||"number"===e.type)&&(0,Ht.h5)(e.value)===t)return}const a=null==t?"":t;e.value!==a&&(e.value=a)}},_r={deep:!0,created(e,t,n){e._assign=gr(n),Xs(e,"change",(()=>{const t=e._modelValue,n=xr(e),i=e.checked,s=e._assign;if((0,Ht.kJ)(t)){const e=(0,Ht.hq)(t,n),r=-1!==e;if(i&&!r)s(t.concat(n));else if(!i&&r){const n=[...t];n.splice(e,1),s(n)}}else if((0,Ht.DM)(t)){const e=new Set(t);i?e.add(n):e.delete(n),s(e)}else s(Ir(e,i))}))},mounted:wr,beforeUpdate(e,t,n){e._assign=gr(n),wr(e,t,n)}};function wr(e,{value:t,oldValue:n},i){e._modelValue=t,(0,Ht.kJ)(t)?e.checked=(0,Ht.hq)(t,i.props.value)>-1:(0,Ht.DM)(t)?e.checked=t.has(i.props.value):t!==n&&(e.checked=(0,Ht.WV)(t,Ir(e,!0)))}const kr={created(e,{value:t},n){e.checked=(0,Ht.WV)(t,n.props.value),e._assign=gr(n),Xs(e,"change",(()=>{e._assign(xr(e))}))},beforeUpdate(e,{value:t,oldValue:n},i){e._assign=gr(i),t!==n&&(e.checked=(0,Ht.WV)(t,i.props.value))}},Sr={deep:!0,created(e,{value:t,modifiers:{number:n}},i){const s=(0,Ht.DM)(t);Xs(e,"change",(()=>{const t=Array.prototype.filter.call(e.options,(e=>e.selected)).map((e=>n?(0,Ht.h5)(xr(e)):xr(e)));e._assign(e.multiple?s?new Set(t):t:t[0])})),e._assign=gr(i)},mounted(e,{value:t}){Er(e,t)},beforeUpdate(e,t,n){e._assign=gr(n)},updated(e,{value:t}){Er(e,t)}};function Er(e,t){const n=e.multiple;if(!n||(0,Ht.kJ)(t)||(0,Ht.DM)(t)){for(let i=0,s=e.options.length;i<s;i++){const s=e.options[i],r=xr(s);if(n)(0,Ht.kJ)(t)?s.selected=(0,Ht.hq)(t,r)>-1:s.selected=t.has(r);else if((0,Ht.WV)(xr(s),t))return void(e.selectedIndex!==i&&(e.selectedIndex=i))}n||-1===e.selectedIndex||(e.selectedIndex=-1)}}function xr(e){return"_value"in e?e._value:e.value}function Ir(e,t){const n=t?"_trueValue":"_falseValue";return n in e?e[n]:t}const Tr={created(e,t,n){$r(e,t,n,null,"created")},mounted(e,t,n){$r(e,t,n,null,"mounted")},beforeUpdate(e,t,n,i){$r(e,t,n,i,"beforeUpdate")},updated(e,t,n,i){$r(e,t,n,i,"updated")}};function $r(e,t,n,i,s){const r=function(e,t){switch(e){case"SELECT":return Sr;case"TEXTAREA":return br;default:switch(t){case"checkbox":return _r;case"radio":return kr;default:return br}}}(e.tagName,n.props&&n.props.type)[s];r&&r(e,t,n,i)}const Nr={beforeMount(e,{value:t},{transition:n}){e._vod="none"===e.style.display?"":e.style.display,n&&t?n.beforeEnter(e):Or(e,t)},mounted(e,{value:t},{transition:n}){n&&t&&n.enter(e)},updated(e,{value:t,oldValue:n},{transition:i}){!t!=!n&&(i?t?(i.beforeEnter(e),Or(e,!0),i.enter(e)):i.leave(e,(()=>{Or(e,!1)})):Or(e,t))},beforeUnmount(e,{value:t}){Or(e,t)}};function Or(e,t){e.style.display=t?e._vod:"none"}const Lr=(0,Ht.l7)({patchProp:(e,t,n,i,s=!1,r,a,o,l)=>{"class"===t?function(e,t,n){const i=e._vtc;i&&(t=(t?[t,...i]:[...i]).join(" ")),null==t?e.removeAttribute("class"):n?e.setAttribute("class",t):e.className=t}(e,i,s):"style"===t?function(e,t,n){const i=e.style,s=(0,Ht.HD)(n);if(n&&!s){if(t&&!(0,Ht.HD)(t))for(const e in t)null==n[e]&&Ks(i,e,"");for(const e in n)Ks(i,e,n[e])}else{const r=i.display;s?t!==n&&(i.cssText=n):t&&e.removeAttribute("style"),"_vod"in e&&(i.display=r)}}(e,n,i):(0,Ht.F7)(t)?(0,Ht.tR)(t)||function(e,t,n,i,s=null){const r=e._vei||(e._vei={}),a=r[t];if(i&&a)a.value=i;else{const[n,o]=function(e){let t;if(Ys.test(e)){let n;for(t={};n=e.match(Ys);)e=e.slice(0,e.length-n[0].length),t[n[0].toLowerCase()]=!0}return[":"===e[2]?e.slice(3):(0,Ht.rs)(e.slice(2)),t]}(t);if(i){const a=r[t]=function(e,t){const n=e=>{if(e._vts){if(e._vts<=n.attached)return}else e._vts=Date.now();Kt(function(e,t){if((0,Ht.kJ)(t)){const n=e.stopImmediatePropagation;return e.stopImmediatePropagation=()=>{n.call(e),e._stopped=!0},t.map((e=>t=>!t._stopped&&e&&e(t)))}return t}(e,n.value),t,5,[e])};return n.value=e,n.attached=er(),n}(i,s);Xs(e,n,a,o)}else a&&(function(e,t,n,i){e.removeEventListener(t,n,i)}(e,n,a,o),r[t]=void 0)}}(e,t,0,i,a):("."===t[0]?(t=t.slice(1),1):"^"===t[0]?(t=t.slice(1),0):function(e,t,n,i){return i?"innerHTML"===t||"textContent"===t||!!(t in e&&tr.test(t)&&(0,Ht.mf)(n)):"spellcheck"!==t&&"draggable"!==t&&"translate"!==t&&("form"!==t&&(("list"!==t||"INPUT"!==e.tagName)&&(("type"!==t||"TEXTAREA"!==e.tagName)&&((!tr.test(t)||!(0,Ht.HD)(n))&&t in e))))}(e,t,i,s))?function(e,t,n,i,s,r,a){if("innerHTML"===t||"textContent"===t)return i&&a(i,s,r),void(e[t]=null==n?"":n);const o=e.tagName;if("value"===t&&"PROGRESS"!==o&&!o.includes("-")){e._value=n;const i=null==n?"":n;return("OPTION"===o?e.getAttribute("value"):e.value)!==i&&(e.value=i),void(null==n&&e.removeAttribute(t))}let l=!1;if(""===n||null==n){const i=typeof e[t];"boolean"===i?n=(0,Ht.yA)(n):null==n&&"string"===i?(n="",l=!0):"number"===i&&(n=0,l=!0)}try{e[t]=n}catch(e){}l&&e.removeAttribute(t)}(e,t,i,r,a,o,l):("true-value"===t?e._trueValue=i:"false-value"===t&&(e._falseValue=i),function(e,t,n,i,s){if(i&&t.startsWith("xlink:"))null==n?e.removeAttributeNS(Js,t.slice(6,t.length)):e.setAttributeNS(Js,t,n);else{const i=(0,Ht.Pq)(t);null==n||i&&!(0,Ht.yA)(n)?e.removeAttribute(t):e.setAttribute(t,i?"":n)}}(e,t,i,s))}},Bs);let Cr;var Ar=n(27856);function Pr(){return Ar()}const Rr={install(e,t={},n=Pr){e.directive("dompurify-html",function(e={},t=Pr){const n=t();!function(e,t){const n=e.hooks??{};let i;for(i in n){const e=n[i];void 0!==e&&t.addHook(i,e)}}(e,n);const i=function(t,i){const s=i.value;if(i.oldValue===s)return;const r=`${s}`,a=i.arg,o=e.namedConfigurations,l=e.default??{};t.innerHTML=o&&void 0!==a?n.sanitize(r,o[a]??l):n.sanitize(r,l)};return{mounted:i,updated:i}}(t,n))}};var Mr=n(58339);function Ur(e,t,n){const i=((...e)=>{const t=(Cr||(Cr=Ki(Lr))).createApp(...e),{mount:n}=t;return t.mount=e=>{const i=function(e){return(0,Ht.HD)(e)?document.querySelector(e):e}(e);if(!i)return;const s=t._component;(0,Ht.mf)(s)||s.render||s.template||(s.template=i.innerHTML),i.innerHTML="";const r=n(i,!1,i instanceof SVGElement);return i instanceof Element&&(i.removeAttribute("v-cloak"),i.setAttribute("data-v-app","")),r},t})(e);i.use(Rr,{default:{ADD_ATTR:["target"]},namedConfigurations:{noMedia:{FORBID_TAGS:["img","svg","picture","video","audio"]}}}),n&&n.use&&n.use(i);let s="string"==typeof t?document.querySelector(t):t;if(!s)throw new Error("Can't find root element");if(n&&n.shadowDom){let e;s.shadowRoot?(e=s.shadowRoot,e.innerHTML=""):e=s.attachShadow({mode:"open"}),s=e.appendChild(document.createElement("div"))}const r={};return i.mixin({beforeCreate(){this.$options.styles&&!r[this.$options.__file]&&(s.appendChild(function(e,t=""){const n=document.createElement("style");n.type="text/css",n.setAttribute("data-name",t);const i=document.createTextNode(e);return n.appendChild(i),n}(this.$options.styles.join("\n"),this.$options.__file)),r[this.$options.__file]=!0)},methods:{lang:Mr.storage.lang,getOption:e=>Mr.settings.get(e)}}),i.directive("visible",((e,t)=>{e.style.visibility=t.value?"visible":"hidden"})),i.mount(s)}var jr=n(15386),Dr=n(9e4);const Fr={apiCall:O,logger:Dr.m("MAL Search"),type:"anime"},Vr=function(e,t,n={},i=!1){return s=this,r=void 0,o=function*(){if(Fr.type=t,(e=e.trim()).length>64&&(e=e.substr(0,64)),!e)return[];if(e.length<3)throw new Error("Search term must be at least 3 characters long");return Fr.apiCall({type:"GET",path:`${t}?q=${e}&limit=15&nsfw=true`,fields:["start_date","mean","alternative_titles","media_type","num_episodes","num_chapters"]}).then((e=>{const n=[];return e.data.forEach((function(e){var i,s,r,a;let o=[e.node.title];e.node.alternative_titles&&(e.node.alternative_titles.en&&o.push(e.node.alternative_titles.en),e.node.alternative_titles.ja&&o.push(e.node.alternative_titles.ja),e.node.alternative_titles.synonyms&&(o=o.concat(e.node.alternative_titles.synonyms))),n.push({id:e.node.id,name:e.node.title,altNames:o,url:`https://myanimelist.net/${t}/${e.node.id}`,malUrl:()=>`https://myanimelist.net/${t}/${e.node.id}`,image:null!==(s=null===(i=e.node.main_picture)||void 0===i?void 0:i.medium)&&void 0!==s?s:"",imageLarge:(null===(r=e.node.main_picture)||void 0===r?void 0:r.large)||(null===(a=e.node.main_picture)||void 0===a?void 0:a.medium)||"",media_type:e.node.media_type?(e.node.media_type.charAt(0)+e.node.media_type.slice(1).toLowerCase()).replace("_"," "):"",isNovel:e.node.media_type.toLowerCase().includes("novel"),score:e.node.mean,year:e.node.start_date,totalEp:e.node.num_episodes||e.node.num_chapters||0})})),Fr.logger.log(n),n}))},new((a=void 0)||(a=Promise))((function(e,t){function n(e){try{l(o.next(e))}catch(e){t(e)}}function i(e){try{l(o.throw(e))}catch(e){t(e)}}function l(t){t.done?e(t.value):function(e){return e instanceof a?e:new a((function(t){t(e)}))}(t.value).then(n,i)}l((o=o.apply(s,r||[])).next())}));var s,r,a,o},zr=Vr;var Hr=n(9e4),Br=n(19947);const Wr=function(e,t,n={},i=!1){return s=this,r=void 0,o=function*(){const n=`\n    query ($search: String) {\n      ${t}: Page (perPage: 25) {\n        pageInfo {\n          total\n        }\n        results: media (type: ${t.toUpperCase()}, search: $search) {\n          id\n          siteUrl\n          idMal\n          episodes\n          chapters\n          title {\n            userPreferred\n            romaji\n            english\n            native\n          }\n          coverImage {\n            large\n            extraLarge\n          }\n          bannerImage\n          type\n          format\n          averageScore\n          startDate {\n            year\n          }\n          synonyms\n        }\n      }\n    }\n  `,i={search:e},s=yield M(n,i,!1);Hr.log(s);const r=[];return Br.$.each(s.data[t].results,(function(e,n){r.push({id:n.id,name:n.title.userPreferred,altNames:Object.values(n.title).concat(n.synonyms),url:n.siteUrl,malUrl:()=>n.idMal?`https://myanimelist.net/${t}/${n.idMal}`:null,image:U(n.coverImage.large),imageLarge:U(n.coverImage.extraLarge),imageBanner:U(n.bannerImage),media_type:n.format?(n.format.charAt(0)+n.format.slice(1).toLowerCase()).replace("_"," "):"",isNovel:"NOVEL"===n.format,score:n.averageScore,year:n.startDate.year,totalEp:n.episodes||n.chapters||0})})),r},new((a=void 0)||(a=Promise))((function(e,t){function n(e){try{l(o.next(e))}catch(e){t(e)}}function i(e){try{l(o.throw(e))}catch(e){t(e)}}function l(t){t.done?e(t.value):function(e){return e instanceof a?e:new a((function(t){t(e)}))}(t.value).then(n,i)}l((o=o.apply(s,r||[])).next())}));var s,r,a,o};var Kr=n(9e4),Gr=function(e,t,n,i){return new(n||(n=Promise))((function(s,r){function a(e){try{l(i.next(e))}catch(e){r(e)}}function o(e){try{l(i.throw(e))}catch(e){r(e)}}function l(e){e.done?s(e.value):function(e){return e instanceof n?e:new n((function(t){t(e)}))}(e.value).then(a,o)}l((i=i.apply(e,t||[])).next())}))};var qr=n(9e4),Jr=n(19947),Xr=n(58339),Yr=n(9375),Zr=function(e,t,n,i){return new(n||(n=Promise))((function(s,r){function a(e){try{l(i.next(e))}catch(e){r(e)}}function o(e){try{l(i.throw(e))}catch(e){r(e)}}function l(e){e.done?s(e.value):function(e){return e instanceof n?e:new n((function(t){t(e)}))}(e.value).then(a,o)}l((i=i.apply(e,t||[])).next())}))};function Qr(e,t={},n=!1,i="GET",s=!0){return Zr(this,void 0,void 0,(function*(){n&&(e+=`?${Jr.$.param(t)}`),qr.log("call",i,e,t);const r={Authorization:s?`Bearer ${Xr.settings.get("simklToken")}`:void 0,"simkl-api-key":G,Accept:"application/vnd.api+json","Content-Type":"application/json"};return s||qr.log("No login"),Xr.request.xhr(i,{url:e,headers:r,data:t}).then((r=>Zr(this,void 0,void 0,(function*(){switch(r.status){case 200:case 201:case 204:case 302:break;case 401:if(s)return Qr(e,t,n,i,!1);throw Yr.flashm('Please Authenticate <a target="_blank" href="https://simkl.com/oauth/authorize?response_type=code&client_id=39e8640b6f1a60aaf60f3f3313475e830517badab8048a4e52ff2d10deb2b9b0&redirect_uri=https://simkl.com/apps/chrome/mal-sync/connected/">Here</a>',{error:!0,type:"error"}),o();default:throw Yr.flashm(`Simkl: ${a()}`,{error:!0,type:"error"}),o()}try{return E(r.responseText)}catch(e){throw qr.error(r),e}function a(){return E(r.responseText).error}function o(){return new Error(a())}}))))}))}const ea=function(e,t,n={},i=!1){return s=this,r=void 0,o=function*(){return(yield oe({path:`${t}s`,parameter:{limit:25,search:e},type:"GET"})).map((e=>({id:e.id,name:ce(e.russian,e.name),altNames:[e.name,e.russian].filter((e=>e)),url:ae+e.url,malUrl:()=>Promise.resolve(e.id?`https://myanimelist.net/${t}/${e.id}`:null),image:ae+e.image.preview,imageLarge:ae+e.image.original,media_type:e.kind,isNovel:"light_novel"===e.kind,score:Number(e.score)?e.score:"",year:e.aired_on,totalEp:e.episodes||e.chapters||0})))},new((a=void 0)||(a=Promise))((function(e,t){function n(e){try{l(o.next(e))}catch(e){t(e)}}function i(e){try{l(o.throw(e))}catch(e){t(e)}}function l(t){t.done?e(t.value):function(e){return e instanceof a?e:new a((function(t){t(e)}))}(t.value).then(n,i)}l((o=o.apply(s,r||[])).next())}));var s,r,a,o};function ta(e,n,i={},s=!1,r=""){return r||(r=t(n)),"KITSU"===r?function(e,t,n={},i=!1){return Gr(this,void 0,void 0,(function*(){return H("GET",`https://kitsu.io/api/edge/${t}?filter[text]=${e}&page[limit]=20&page[offset]=0&fields[${t}]=id,slug,titles,averageRating,startDate,posterImage,coverImage,subtype,${"anime"===t?"episodeCount":"chapterCount"}`,{}).then((e=>{Kr.log("search",e);const n=[];return e.data.forEach((function(e){n.push({id:Number(e.id),name:z(e.attributes.titles,e.attributes.canonicalTitle),altNames:Object.values(e.attributes.titles),url:`https://kitsu.io/${t}/${e.attributes.slug}`,malUrl:()=>Gr(this,void 0,void 0,(function*(){const n=yield function(e,t){return D.request.xhr("GET",{url:`https://kitsu.io/api/edge/${t}/${e}/mappings?filter[externalSite]=myanimelist/${t}`,headers:{"Content-Type":"application/vnd.api+json",Accept:"application/vnd.api+json"}}).then((e=>{const t=JSON.parse(e.responseText);return j.log("[KtoM]",t),void 0!==t.data&&t.data.length?Number(t.data[0].attributes.externalId):null}))}(e.id,t);return n?`https://myanimelist.net/${t}/${n}`:null})),image:e.attributes.posterImage&&e.attributes.posterImage.small?e.attributes.posterImage.small:"",imageLarge:e.attributes.posterImage&&e.attributes.posterImage.original?e.attributes.posterImage.original:"",imageBanner:e.attributes.coverImage&&e.attributes.coverImage.large?e.attributes.coverImage.large:"",media_type:e.attributes.subtype,isNovel:"novel"===e.attributes.subtype,score:e.attributes.averageRating,year:e.attributes.startDate,totalEp:e.attributes.episodeCount||e.attributes.chapterCount||0})})),n}))}))}(e,n,i,s):"ANILIST"===r?Wr(e,n,i,s):"SIMKL"===r?function(e,t,n={},i=!1){return Zr(this,void 0,void 0,(function*(){return Qr(`https://api.simkl.com/search/${t}`,{q:e},!0).then((e=>{const n=[];return qr.log("search",e),Jr.$.each(e,(function(e,i){n.push({id:i.ids.simkl_id,name:i.title,altNames:[],url:`https://simkl.com/${t}/${i.ids.simkl_id}/${i.ids.slug}`,malUrl:()=>Zr(this,void 0,void 0,(function*(){const e=yield(n=i.ids.simkl_id,Qr(`https://api.simkl.com/anime/${n}`,{extended:"full"},!0).then((e=>void 0===e.ids.mal?null:e.ids.mal)));var n;return e?`https://myanimelist.net/${t}/${e}`:null})),image:`https://simkl.in/posters/${i.poster}_ca.jpg`,imageLarge:`https://simkl.in/posters/${i.poster}_m.jpg`,imageBanner:`https://simkl.in/posters/${i.poster}_w.jpg`,media_type:i.type,isNovel:!1,score:null,year:i.year})})),n}))}))}(e,n,i,s):"SHIKI"===r?ea(e,n,i,s):"MALAPI"===r?Vr(e,n,i,s):zr(e,n,i,s)}var na=n(9e4),ia=n(58339),sa=n(9375),ra=function(e,t,n,i){return new(n||(n=Promise))((function(s,r){function a(e){try{l(i.next(e))}catch(e){r(e)}}function o(e){try{l(i.throw(e))}catch(e){r(e)}}function l(e){e.done?s(e.value):function(e){return e instanceof n?e:new n((function(t){t(e)}))}(e.value).then(a,o)}l((i=i.apply(e,t||[])).next())}))};class aa{constructor(e,t){return this.cacheKey=e,this.type=t,this.logger=na.m("Rules"),this}init(){return ra(this,void 0,void 0,(function*(){if(this.state=yield this.getCache(),!this.state||"firebase"===this.state.provider&&this.state.updated&&this.state.updated+6048e5<(new Date).getTime()){const e=yield this.api();e&&(this.state=e)}return this.logger.m("Result").log(this.state),this.state&&(yield this.setCache(this.state)),this}))}getRules(){return this.state&&this.state.rules&&this.state.rules.length?this.state.rules:[]}api(){return ra(this,void 0,void 0,(function*(){const e=this.logger.m("API");try{if("anime"!==this.type)return void e.info("Only supports anime");if(String(this.cacheKey).startsWith("simkl:"))return void e.info("Simkl is not supported");const t=`https://api.malsync.moe/rules/${this.cacheKey}`;e.log(t);const n=yield ia.request.xhr("GET",t);e.log("Response",n);const i=JSON.parse(n.responseText);return{provider:"firebase",updated:(new Date).getTime(),last_modified:i.last_modified,rules:i.rules.map((e=>({from:{title:e.from.title,url:sa.pageUrl(i.page,this.type,e.from.id),start:e.from.start,end:e.from.end},to:{title:e.to.title,url:sa.pageUrl(i.page,this.type,e.to.id),start:e.to.start,end:e.to.end}})))}}catch(t){return void e.error(t)}}))}getCache(){return ra(this,void 0,void 0,(function*(){return ia.storage.get(`${this.type}/${this.cacheKey}/Rules`).then((e=>(e&&(e.cache=!0),e)))}))}setCache(e){return e=JSON.parse(JSON.stringify(e)),ia.storage.set(`${this.type}/${this.cacheKey}/Rules`,e)}applyRules(e,t){const n=this.logger.m("apply");this.activeRule=void 0,t||(t=this.getRules()),n.log(e,t);const i=t.find((t=>t.from.start<=e&&t.from.end>=e));if(i)return n.log("Rule found",i),this.activeRule=i,{url:i.to.url,offset:i.to.start-i.from.start};if(t.length>1){const i=t.find((t=>t.from.url===t.to.url&&e>t.from.end));if(i){const s=i.to.start-i.from.start,r=e+s;n.log("Self Rule",i,r,s);const a=this.applyRules(r,t.filter((e=>e.from.url!==e.to.url)));if(a)return a.offset+=s,a}}}}var oa=n(9e4),la=n(58339),ca=n(9375),ua=function(e,t,n,i){return new(n||(n=Promise))((function(s,r){function a(e){try{l(i.next(e))}catch(e){r(e)}}function o(e){try{l(i.throw(e))}catch(e){r(e)}}function l(e){e.done?s(e.value):function(e){return e instanceof n?e:new n((function(t){t(e)}))}(e.value).then(a,o)}l((i=i.apply(e,t||[])).next())}))};class ha{constructor(e,t,n){this.title=e,this.type=t,this.identifier=n,this.localUrl="",this.state=!1,this.changed=!1,this.identifier+="",this.sanitizedTitel=this.sanitizeTitel(this.title),this.logger=oa.m("search","red")}setPage(e){this.page=e}setLocalUrl(e){this.localUrl=e}setSyncPage(e){this.syncPage=e}getSyncPage(){return this.syncPage}getUrl(){return this.state?this.state.url:null}setUrl(e,t=0){this.state?(this.state.url!==e&&(this.changed=!0),this.state.provider="user",this.state.url=e,this.state.id=t,this.state.cache=!1,this.state.similarity={same:!0,value:1}):(this.changed=!0,this.state={id:t,url:e,offset:0,provider:"user",similarity:{same:!0,value:1}}),this.setCache(this.state)}getOffset(){return this.state&&this.state.offset?this.state.offset:0}setOffset(e){this.state&&(this.state.offset!==e&&(this.changed=!0),this.state.offset=e),this.setCache(this.state)}getCachedOffset(){return ua(this,void 0,void 0,(function*(){return this.state=yield this.getCache(),this.state?this.state.offset:0}))}getId(){return this.state&&this.state.id?this.state.id:0}getSanitizedTitel(){return this.sanitizedTitel}getNormalizedType(){return"anime"===this.type?"anime":"manga"}sanitizeTitel(e){let t=e.replace(/ *(\(dub\)|\(sub\)|\(uncensored\)|\(uncut\)|\(subbed\)|\(dubbed\))/i,"");return t=t.replace(/ *\([^)]+audio\)/i,""),t=t.replace(/ BD( |$)/i,""),t=t.trim(),t=t.substring(0,99),t}search(){return ua(this,void 0,void 0,(function*(){if(this.state=yield this.getCache(),this.state||(this.state=yield this.searchLocal()),this.state||(this.state=yield this.searchForIt()),!this.state||this.state&&!["user","firebase","sync","local"].includes(this.state.provider)){const e=yield this.onsiteSearch();e&&(this.state=e)}return this.state&&(yield this.setCache(this.state)),this.logger.log("Result",this.state),this.state}))}getCache(){return ua(this,void 0,void 0,(function*(){return la.storage.get(`${this.page.name}/${this.identifier}/Search`).then((e=>(e&&(e.cache=!0),e)))}))}setCache(e){return e=JSON.parse(JSON.stringify(e)),setTimeout((()=>{this.databaseRequest()}),200),la.storage.set(`${this.page.name}/${this.identifier}/Search`,e)}static similarity(e,t,n=[]){let i=(0,jr.compareTwoStrings)(t.toLowerCase(),e.toLowerCase());n.forEach((e=>{if(e){const n=(0,jr.compareTwoStrings)(t.toLowerCase(),e.toLowerCase());n>i&&(i=n)}}));let s=!1;return i>.6&&(s=!0),{same:s,value:i}}searchLocal(){return ua(this,void 0,void 0,(function*(){if(!this.localUrl)return!1;const e=new bt(this.localUrl);return yield e.update(),!!e.isOnList()&&(this.logger.m("Local").log("On List"),{url:"",offset:0,provider:"local",similarity:{same:!0,value:1}})}))}searchForIt(){return ua(this,void 0,void 0,(function*(){let e=!1;try{e=t(e,yield this.malSync())}catch(e){this.page&&this.page.database&&this.logger.error("MALSync api error or not supported",e)}if(e&&"firebase"!==e.provider||!e)try{e=t(e,yield this.malSearch())}catch(e){this.logger.m(e)}if(e&&"firebase"!==e.provider||!e)try{e=t(e,yield this.pageSearch(),.5)}catch(e){this.logger.m(e)}if(e&&"firebase"===e.provider&&"MAL"!==la.settings.get("syncMode")&&!e.url)try{const t=yield this.pageSearch();t&&!ca.isDomainMatching(t.url,"myanimelist.net")&&t.similarity.same&&(this.logger.log("Ignore Firebase",e),e=t)}catch(e){this.logger.m(e)}return e;function t(e,t,n=0){return!1!==e&&!1!==t&&t.similarity.value>n?e.similarity.value>=t.similarity.value?e:t:!1!==e?e:t}}))}firebase(){return ua(this,void 0,void 0,(function*(){if(!this.page||!this.page.database)return!1;const e=this.logger.m("Firebase"),t=`https://kissanimelist.firebaseio.com/Data2/${this.page.database}/${encodeURIComponent(this.identifierToDbKey(this.identifier)).toLowerCase()}/Mal.json`;e.log(t);const n=yield la.request.xhr("GET",t);if(e.log("response",n.responseText),!n.responseText||"null"===n.responseText||n.responseText.includes("error"))return!1;let i;try{i=JSON.parse(n.responseText)}catch(t){return e.info("Parse failed"),!1}if(!i||0===Object.keys(i).length)return!1;const s=Object.keys(i)[0];let r="";return"Not-Found"!==s&&(r=`https://myanimelist.net/${this.page.type}/${s}`),{url:r,offset:0,provider:"firebase",similarity:{same:!0,value:1}}}))}malSync(){var e;return ua(this,void 0,void 0,(function*(){const n=this.logger.m("API");if(!this.page)return!1;const i=this.page.database;if(!i)return!1;const s=`https://api.malsync.moe/page/${i}/${encodeURIComponent(this.identifierToDbKey(this.identifier)).toLowerCase()}`;n.log(s);const r=yield la.request.xhr("GET",s);if(n.log("Response",r),400!==r.status&&200!==r.status)throw new Error("malsync offline");if(400===r.status&&(null===(e=r.responseText)||void 0===e?void 0:e.includes("error")))return!1;const a=JSON.parse(r.responseText);let o=a.malUrl;return!o&&a.aniUrl&&"ANILIST"===t(this.getNormalizedType())&&(o=a.aniUrl),{url:o,offset:0,provider:"firebase",similarity:{same:!0,value:1}}}))}malSearch(){var e,t;return ua(this,void 0,void 0,(function*(){const n=this.logger.m("MAL");let i=`https://myanimelist.net/${this.getNormalizedType()}.php?q=${encodeURI(this.sanitizedTitel)}`;"novel"===this.type&&(i=`https://myanimelist.net/${this.getNormalizedType()}.php?type=2&q=${encodeURI(this.sanitizedTitel)}`),n.log(i);const s=yield la.request.xhr("GET",i);return!(!s||(null===(e=s.responseText)||void 0===e?void 0:e.includes("  error ")))&&!(!s||(null===(t=s.responseText)||void 0===t?void 0:t.includes("No titles that matched")))&&function e(t,i,s){const r=function(e,t){try{return e.responseText.split('<a class="hoverinfo_trigger" href="')[t].split('"')[0]}catch(i){n.error(i);try{return e.responseText.split('class="picSurround')[t].split("<a")[1].split('href="')[1].split('"')[0]}catch(e){return n.error(e),!1}}}(t,i);let a=0,o={same:!1,value:0};if(!1!==r)try{if("manga"===s.type&&-1!==t.responseText.split(`href="${r}" id="si`)[1].split("</tr>")[0].indexOf("Novel"))return n.log("Novel Found check next entry"),e(t,i+1,s);const l=function(e,t){try{const n=t.split("/")[4];return e.responseText.split(`rel="#sinfo${n}"><strong>`)[1].split("<")[0]}catch(e){return n.error(e),""}}(t,r);o=ha.similarity(l,s.sanitizedTitel),a=parseInt(r.split("/")[4])}catch(e){n.error(e)}return{id:a,url:r,offset:0,provider:"mal",similarity:o}}(s,1,this)}))}pageSearch(){return ua(this,void 0,void 0,(function*(){const e=yield ta(this.sanitizedTitel,this.getNormalizedType());let t=null;for(let n=0;n<e.length&&n<5;n++){const i=e[n],s=ha.similarity(i.name,this.sanitizedTitel,i.altNames),r={index:n,similarity:s};("manga"===this.type&&!i.isNovel||"novel"===this.type&&i.isNovel||"anime"===this.type)&&(!t||s.value>t.similarity.value)&&(t=r)}if(t){const n=e[t.index],i=yield n.malUrl();return{id:n.id,url:i||n.url,offset:0,provider:"page",similarity:t.similarity}}return!1}))}databaseRequest(){return ua(this,void 0,void 0,(function*(){const e=this.logger.m("DB Request");if(this.page&&this.page.database&&this.syncPage&&this.state){if(this.state.cache)return;if("user"===this.state.provider&&!this.changed)return;if("firebase"===this.state.provider)return;if("local"===this.state.provider)return;let t;if(!t)if(this.page.isSyncPage(this.syncPage.url))t=this.page.sync.getOverviewUrl(this.syncPage.url),"Crunchyroll"===this.page.database&&(t=`${this.syncPage.url}`);else{if("Crunchyroll"===this.page.database)return void e.log("CR block");t=this.syncPage.url}const n={pageUrl:t,malUrl:this.state.url,correction:!1,page:this.page.database};if("user"===this.state.provider){if(!(yield ca.flashConfirm(la.storage.lang("correction_DBRequest"),"dbrequest",(()=>{}),(()=>{}),!0)))return;n.correction=!0}const i="https://api.malsync.moe/corrections";la.request.xhr("POST",{url:i,data:JSON.stringify(n),headers:{"Content-Type":"application/json"}}).then((t=>{try{const n=JSON.parse(t.responseText);if(n.error)throw n;e.log("Send to database:",n)}catch(t){e.error("Send to database:",t)}}))}}))}onsiteSearch(){return ua(this,void 0,void 0,(function*(){if(this.page&&this.syncPage&&this.syncPage.curState&&this.syncPage.curState.on){let e=!1;if("OVERVIEW"===this.syncPage.curState.on?this.page.overview&&this.page.overview.getMalUrl&&(e=yield this.page.overview.getMalUrl(la.settings.get("syncMode"))):this.page.sync&&this.page.sync.getMalUrl&&(e=yield this.page.sync.getMalUrl(la.settings.get("syncMode"))),e)return this.logger.m("Onsite").log("[SEARCH]","Overwrite by onsite url",e),{url:e,offset:0,provider:"sync",similarity:{same:!0,value:1}}}return!1}))}openCorrection(){}identifierToDbKey(e){return"Crunchyroll"===this.page.database?encodeURIComponent(e.toLowerCase().split("#")[0]).replace(/\./g,"%2E"):"MangaFire"===this.page.database?encodeURIComponent(e.toLowerCase().split("#")[0]):e.toLowerCase().split("#")[0].replace(/\./g,"%2E")}initRules(){return ua(this,void 0,void 0,(function*(){const e=oa.m("Rules"),t=this.getUrl();if(e.log("Url",t),t){const n=yield function(e){return t=this,n=void 0,s=function*(){const t=new h(`rulesCacheKey/${e}`,6048e5);if(yield t.hasValue())return t.getValue().then((e=>({rulesCacheKey:e})));const n=_t(e);return yield n.update(),t.setValue(n.getRulesCacheKey()),{rulesCacheKey:n.getRulesCacheKey(),singleObj:n}},new((i=void 0)||(i=Promise))((function(e,r){function a(e){try{l(s.next(e))}catch(e){r(e)}}function o(e){try{l(s.throw(e))}catch(e){r(e)}}function l(t){t.done?e(t.value):function(e){return e instanceof i?e:new i((function(t){t(e)}))}(t.value).then(a,o)}l((s=s.apply(t,n||[])).next())}));var t,n,i,s}(t);return e.log("Cachekey",n),this.rules=yield new aa(n.rulesCacheKey,this.getNormalizedType()).init(),n.singleObj}}))}applyRules(e){if(this.rules){const t=this.getOffset()||0,n=this.rules.applyRules(Number(e)+Number(t));return n&&(n.offset=Number(n.offset)+Number(t)),n}}getRuledOffset(e){const t=this.applyRules(e);return t?t.offset:this.getOffset()}getRuledUrl(e){const t=this.applyRules(e);return t?t.url:this.getUrl()}}const da={key:0,id:"material"},pa={key:0},ma={key:1,class:"scroll"},fa={key:3,id:"offsetUi"},ga={class:"mdl-color--primary top"},ya=gs('<div class="offsetBox"><div class="mdl-color--primary top">...</div><div class="bottom">...</div></div><div class="offsetBox"><div class="mdl-color--primary top">∞</div><div class="bottom">∞</div></div>',2),va={class:"search"},ba={class:"input"},_a={class:"group"},wa=ds("span",{class:"bar"},null,-1),ka={class:"loadingBar"},Sa={class:"mdl-progress mdl-js-progress mdl-progress__indeterminate",style:{width:"100%"}},Ea=[ds("div",{class:"progressbar bar bar1",style:{width:"0%"}},null,-1),ds("div",{class:"bufferbar bar bar2",style:{width:"100%"}},null,-1),ds("div",{class:"auxbar bar bar3",style:{width:"0%"}},null,-1)],xa={key:0,class:"results"},Ia=ds("div",{class:"image"},null,-1),Ta={class:"right"},$a={class:"title"},Na=["href","onClick"],Oa={class:"image"},La=["src"],Ca={class:"right"},Aa={class:"title"},Pa={key:0},Ra={key:1},Ma={key:0},Ua={key:1},ja={key:2};var Da=n(58339),Fa=function(e,t,n,i){return new(n||(n=Promise))((function(s,r){function a(e){try{l(i.next(e))}catch(e){r(e)}}function o(e){try{l(i.throw(e))}catch(e){r(e)}}function l(e){e.done?s(e.value):function(e){return e instanceof n?e:new n((function(t){t(e)}))}(e.value).then(a,o)}l((i=i.apply(e,t||[])).next())}))},Va=n(58339),za=n(9375);let Ha;const Ba={components:{},props:{type:{type:String,default:"anime"},keyword:{type:String,default:""},syncMode:{type:Boolean,default:!1},currentId:{type:Number,default:0}},data:()=>({items:[],loading:!1,searchKeyword:""}),watch:{keyword(){this.searchKeyword=this.keyword,this.load()},searchKeyword(){clearTimeout(Ha),Ha=setTimeout((()=>{this.load()}),200)},type(){this.load()}},mounted(){this.syncMode&&(this.searchKeyword=this.keyword,this.load())},methods:{lang:Va.storage.lang,getStatusText:za.getStatusText,episodeText:za.episode,load(){this.searchKeyword&&(this.loading=!0,function(e,t){return Fa(this,void 0,void 0,(function*(){return ta(e,t).then((e=>Promise.all(e.map((e=>Fa(this,void 0,void 0,(function*(){const n=yield Da.request.database("entry",{id:e.id,type:t});return n&&(e.list={status:n.status,score:n.score,episode:n.watchedEp}),e})))))))}))}(this.searchKeyword,this.type).then((e=>{this.loading=!1,this.items=e,this.$nextTick((()=>{this.$el.scrollIntoView({behavior:"smooth"})}))})))},inputFocus(){this.searchKeyword||(this.searchKeyword=this.keyword)},clickItem(e,t){return n=this,i=void 0,r=function*(){if(e.preventDefault(),!t)return void this.$emit("clicked",{url:"",id:0});const n=yield t.malUrl();n?this.$emit("clicked",{url:n,id:t.id}):this.$emit("clicked",{url:t.url,id:t.id})},new((s=void 0)||(s=Promise))((function(e,t){function a(e){try{l(r.next(e))}catch(e){t(e)}}function o(e){try{l(r.throw(e))}catch(e){t(e)}}function l(t){t.done?e(t.value):function(e){return e instanceof s?e:new s((function(t){t(e)}))}(t.value).then(a,o)}l((r=r.apply(n,i||[])).next())}));var n,i,s,r}}};var Wa=n(83744);const Ka=(0,Wa.Z)(Ba,[["render",function(e,t,n,i,s,r){return ts(),rs("div",va,[ds("div",ba,[ds("div",_a,[$n(ds("input",{"onUpdate:modelValue":t[0]||(t[0]=e=>s.searchKeyword=e),type:"text",required:"",onFocus:t[1]||(t[1]=e=>r.inputFocus())},null,544),[[br,s.searchKeyword]]),wa,ds("label",null,(0,Ht.zw)(r.lang("correction_Search")),1)])]),ds("div",ka,[$n(ds("div",Sa,Ea,512),[[Nr,s.loading]])]),s.searchKeyword?(ts(),rs("div",xa,[ds("a",{class:"result",href:"",style:{cursor:"pointer"},onClick:t[2]||(t[2]=e=>r.clickItem(e,""))},[Ia,ds("div",Ta,[ds("span",$a,(0,Ht.zw)(r.lang("correction_NoEntry")),1),ds("p",null,(0,Ht.zw)(r.lang("correction_NoMal")),1)])]),(ts(!0),rs(Ji,null,li(s.items,(e=>(ts(),rs("a",{key:e.id,class:(0,Ht.C_)(["result",{active:n.currentId===e.id,onList:e.list}]),href:e.url,onClick:t=>r.clickItem(t,e)},[ds("div",Oa,[ds("img",{src:e.image},null,8,La)]),ds("div",Ca,[ds("span",Aa,(0,Ht.zw)(e.name),1),e.list?(ts(),rs(Ji,{key:0},[ds("p",null,(0,Ht.zw)(r.lang("UI_Status"))+" "+(0,Ht.zw)(r.getStatusText(n.type,e.list.status)),1),e.list.score?(ts(),rs("p",Pa,(0,Ht.zw)(r.lang("UI_Score"))+" "+(0,Ht.zw)(e.list.score),1)):1===e.list.status?(ts(),rs("p",Ra,(0,Ht.zw)(r.episodeText(n.type))+" "+(0,Ht.zw)(e.list.episode),1)):ys("v-if",!0)],64)):(ts(),rs(Ji,{key:1},[e.media_type?(ts(),rs("p",Ma,(0,Ht.zw)(r.lang("search_Type"))+" "+(0,Ht.zw)(e.media_type),1)):ys("v-if",!0),e.score?(ts(),rs("p",Ua,(0,Ht.zw)(r.lang("search_Score"))+" "+(0,Ht.zw)(e.score),1)):ys("v-if",!0),e.year?(ts(),rs("p",ja,(0,Ht.zw)(r.lang("search_Year"))+" "+(0,Ht.zw)(e.year),1)):ys("v-if",!0)],64))])],10,Na)))),128))])):ys("v-if",!0)])}],["__file","search.vue"]]),Ga={class:"inputButton"},qa={class:"group"},Ja=["type"],Xa=ds("span",{class:"bar"},null,-1);var Ya=n(58339);const Za={props:{state:{type:[String,Number],default:""},type:{type:String,default:""},label:{type:String,default:""}},data:()=>({inputString:""}),watch:{state(){this.inputString=this.state},inputString(){this.$emit("changed",this.inputString)}},mounted(){this.inputString=this.state},methods:{lang:Ya.storage.lang,click(){this.$emit("clicked",this.inputString)}}},Qa=(0,Wa.Z)(Za,[["render",function(e,t,n,i,s,r){return ts(),rs("div",Ga,[ds("div",qa,[$n(ds("input",{"onUpdate:modelValue":t[0]||(t[0]=e=>s.inputString=e),type:n.type,required:""},null,8,Ja),[[Tr,s.inputString]]),Xa,ds("label",null,(0,Ht.zw)(n.label),1)]),s.inputString!==n.state?(ts(),rs("button",{key:0,onClick:t[1]||(t[1]=(...e)=>r.click&&r.click(...e))},"Update")):ys("v-if",!0)])}],["__file","inputButton.vue"]]),eo={key:0,class:"entry"},to=["href"],no={class:"image"},io=["src"],so={class:"right"},ro={class:"title"},ao={key:0},oo={key:1},lo={key:2},co={key:0,id:"curEps"},uo={key:1};var ho=n(58339),po=n(9375);const mo={props:{obj:{type:Object,default:void 0}},data:()=>({}),computed:{status:{get(){return this.obj&&this.obj.isAuthenticated()?this.obj.getStatus():null},set(e){this.obj&&this.obj.isAuthenticated()&&this.obj.setStatus(e)}},episode:{get(){return this.obj&&this.obj.isAuthenticated()&&this.obj.isOnList()?this.obj.getEpisode():null},set(e){this.obj&&this.obj.isAuthenticated()&&this.obj.setEpisode(e)}},volume:{get(){return this.obj&&this.obj.isAuthenticated()&&this.obj.isOnList()?this.obj.getVolume():null},set(e){this.obj&&this.obj.isAuthenticated()&&this.obj.setVolume(e)}},score:{get(){return this.obj&&this.obj.isAuthenticated()?this.obj.getDisplayScoreCheckbox():null},set(e){this.obj&&this.obj.isAuthenticated()&&this.obj.setScore(e)}}},methods:{lang:ho.storage.lang,utilsepisode:po.episode,statusText(e){switch(e){case 1:return ho.storage.lang(`UI_Status_watching_${this.obj.getType()}`);case 2:return ho.storage.lang("UI_Status_Completed");case 3:return ho.storage.lang("UI_Status_OnHold");case 4:return ho.storage.lang("UI_Status_Dropped");case 6:return ho.storage.lang(`UI_Status_planTo_${this.obj.getType()}`);case 23:return ho.storage.lang(`UI_Status_Rewatching_${this.obj.getType()}`);default:return""}}}},fo=(0,Wa.Z)(mo,[["render",function(e,t,n,i,s,r){return n.obj?(ts(),rs("div",eo,[ds("a",{class:"result",href:n.obj.getDisplayUrl(),target:"_blank",style:{cursor:"pointer"}},[ds("div",no,[n.obj.getImage()?(ts(),rs("img",{key:0,src:n.obj.getImage()},null,8,io)):ys("v-if",!0)]),ds("div",so,[ds("span",ro,(0,Ht.zw)(n.obj.getTitle()),1),n.obj.isOnList()?(ts(),rs("p",ao,(0,Ht.zw)(r.lang("UI_Status"))+" "+(0,Ht.zw)(r.statusText(r.status)),1)):ys("v-if",!0),n.obj.isOnList()?(ts(),rs("p",oo,(0,Ht.zw)(r.lang("UI_Score"))+" "+(0,Ht.zw)(r.score),1)):ys("v-if",!0),n.obj.isOnList()?(ts(),rs("p",lo,[fs((0,Ht.zw)(r.utilsepisode(n.obj.getType()))+" "+(0,Ht.zw)(r.episode),1),n.obj.getTotalEpisodes()?(ts(),rs("span",co,"/"+(0,Ht.zw)(n.obj.getTotalEpisodes()),1)):(ts(),rs("span",uo,"/?"))])):ys("v-if",!0)])],8,to)])):ys("v-if",!0)}],["__file","entry.vue"]]),go={key:0,class:"rules"},yo={class:"title"},vo={class:"header"},bo={class:"noHover"},_o={class:"hover"},wo={class:"content"};var ko=n(58339);const So={props:{obj:{type:Object,default:void 0}},data:()=>({}),computed:{rules(){return this.obj&&this.obj.getRules()?this.obj.getRules().sort(((e,t)=>e.from.start-t.from.start)):[]}},methods:{lang:ko.storage.lang,activeRule(e){return{active:!!this.obj&&e===this.obj.activeRule}}}},Eo=(0,Wa.Z)(So,[["render",function(e,t,n,i,s,r){return r.rules&&r.rules.length?(ts(),rs("div",go,[ds("div",yo,(0,Ht.zw)(r.lang("UI_Rules")),1),(ts(!0),rs(Ji,null,li(r.rules,((e,t)=>(ts(),rs("div",{key:t,class:(0,Ht.C_)(["rule",r.activeRule(e)])},[ds("div",vo,[e.to.title?(ts(),rs(Ji,{key:0},[ds("span",bo,(0,Ht.zw)(e.to.title),1),ds("span",_o,(0,Ht.zw)(e.to.url),1)],64)):(ts(),rs(Ji,{key:1},[fs((0,Ht.zw)(e.to.url),1)],64))]),ds("div",wo,[fs((0,Ht.zw)(r.lang("UI_Episode"))+" "+(0,Ht.zw)(e.from.start)+" ",1),e.from.start!==e.from.end?(ts(),rs(Ji,{key:0},[fs(" - "+(0,Ht.zw)(Number.MAX_SAFE_INTEGER===e.from.end?"∞":e.from.end),1)],64)):ys("v-if",!0),fs(" ➞ "+(0,Ht.zw)(Number.MAX_SAFE_INTEGER===e.to.start?"∞":e.to.start)+" ",1),e.to.start!==e.to.end?(ts(),rs(Ji,{key:1},[fs(" - "+(0,Ht.zw)(Number.MAX_SAFE_INTEGER===e.to.end?"∞":e.to.end),1)],64)):ys("v-if",!0)])],2)))),128))])):ys("v-if",!0)}],["__file","rules.vue"]]);var xo=n(58339),Io=n(9375);const To={components:{entry:fo,inputButton:Qa,search:Ka,rules:Eo},data:()=>({inputOffset:0,minimized:!1,syncMode:null,searchClass:null,unmountFnc:()=>{}}),computed:{syncPage(){return this.searchClass?this.searchClass.getSyncPage():null},rulesClass(){return this.searchClass.rules},currentStateEp(){if(this.syncPage&&this.syncPage.curState&&this.syncPage.curState.episode)return this.syncPage.curState.episode},offset(){return this.searchClass.getOffset()}},created(){this.minimized=xo.settings.get("minimizeBigPopup"),xo.settings.get("floatButtonCorrection")&&xt(!0)},unmounted(){this.unmountFnc(),Et()},methods:{lang:xo.storage.lang,setPage(e,t=0){this.searchClass.setUrl(e,t),Io.flashm(xo.storage.lang("correction_NewUrl",[e])),this.close()},setOffset(e){this.searchClass.setOffset(e)},close(){this.$.appContext.app.unmount()},calcEpOffset(e){return parseInt(e)-parseInt(this.inputOffset)}}},$o=(0,Wa.Z)(To,[["render",function(e,t,n,i,s,r){const a=ri("entry"),o=ri("rules"),l=ri("input-button"),c=ri("search");return r.syncPage?(ts(),rs("div",da,[e.syncMode&&e.minimized?(ts(),rs("div",pa,[ds("a",{style:{cursor:"pointer"},onClick:t[0]||(t[0]=t=>e.minimized=!1)}," Action required ")])):(ts(),rs("div",ma,[e.syncMode?ys("v-if",!0):(ts(),as(a,{key:0,obj:r.syncPage.singleObj},null,8,["obj"])),ps(o,{obj:r.rulesClass},null,8,["obj"]),e.syncMode?ys("v-if",!0):(ts(),as(l,{key:1,label:"URL",state:e.searchClass.getUrl(),onClicked:r.setPage},null,8,["state","onClicked"])),e.syncMode?ys("v-if",!0):(ts(),as(l,{key:2,label:r.lang("correction_Offset"),state:r.offset,type:"number",onClicked:r.setOffset,onChanged:t[1]||(t[1]=t=>e.inputOffset=t)},null,8,["label","state","onClicked"])),e.inputOffset&&"0"!==e.inputOffset?(ts(),rs("div",fa,[(ts(),rs(Ji,null,li(5,(e=>ds("div",{key:e,class:"offsetBox"},[ds("div",ga,(0,Ht.zw)(e),1),ds("div",{class:(0,Ht.C_)(["bottom",{active:parseInt(r.currentStateEp)===r.calcEpOffset(e)}])},(0,Ht.zw)(r.calcEpOffset(e)),3)]))),64)),ya])):ys("v-if",!0),ps(c,{keyword:e.searchClass.getSanitizedTitel(),type:e.searchClass.getNormalizedType(),"sync-mode":Boolean(e.syncMode),"current-id":e.searchClass.getId(),onClicked:t[2]||(t[2]=e=>r.setPage(e.url,e.id))},null,8,["keyword","type","sync-mode","current-id"])])),e.syncMode&&e.minimized?ys("v-if",!0):(ts(),rs("a",{key:2,class:"close",onClick:t[3]||(t[3]=e=>r.close())},(0,Ht.zw)(r.lang("close")),1))])):ys("v-if",!0)}],["styles",["::-webkit-scrollbar {\n  display: none;\n}\n#material {\n  all: initial;\n  color: white;\n  font-family: Helvetica, Arial, sans-serif;\n  font-size: 14px;\n  font-weight: 400;\n  line-height: 20px;\n}\n#material * {\n  box-sizing: border-box;\n}\n#material .scroll {\n  overflow-y: auto;\n  max-height: 80vh;\n  scrollbar-width: none;\n}\n#material .close {\n  display: block;\n  margin-top: 15px;\n  text-align: center;\n  cursor: pointer;\n}\n#material .mdl-color--primary {\n  background-color: #3f51b5;\n}\n#material p {\n  font-weight: 400;\n  line-height: 24px;\n  font-size: 14px;\n  letter-spacing: 0;\n  margin: 0 0 16px;\n}\n#material a {\n  color: #f43b7a;\n  text-decoration: none !important;\n}\n#material .search .input {\n  width: 100%;\n}\n#material .result {\n  cursor: pointer;\n  display: flex;\n  position: relative;\n  margin-bottom: 15px;\n  background-color: #484848;\n  max-width: 400px;\n}\n#material .result.active {\n  border: 1px solid #f43b7a;\n  border-style: dashed;\n}\n#material .result.onList::before {\n  content: '';\n  top: 0;\n  right: 0;\n  position: absolute;\n  width: 0;\n  height: 0;\n  border-style: solid;\n  border-width: 0 20px 20px 0;\n  border-color: transparent #f43b7a transparent transparent;\n}\n#material .result .image {\n  height: 100px;\n  width: 64px;\n  min-width: 64px;\n  background-color: grey;\n}\n#material .result .image img {\n  height: 100%;\n  width: 100%;\n  object-fit: cover;\n}\n#material .result .right {\n  flex-grow: 100;\n  cursor: pointer;\n  margin-top: 0;\n  margin-bottom: 0;\n  padding: 5px 10px;\n  display: flex;\n  flex-direction: column;\n}\n#material .result .right .title {\n  font-size: 20px;\n  font-weight: 400;\n  line-height: 1;\n  margin-bottom: 3px;\n}\n#material .result .right p {\n  margin-bottom: 0;\n  line-height: 20px;\n  color: white;\n}\n#material .rules .title {\n  color: #f43b7a;\n}\n#material .rules .rule {\n  margin-bottom: 15px;\n  background-color: #484848;\n  max-width: 400px;\n}\n#material .rules .rule .header {\n  padding: 5px 10px;\n  border-bottom: 1px solid white;\n}\n#material .rules .rule.active {\n  border: 1px solid #f43b7a;\n}\n#material .rules .rule .content {\n  padding: 5px 10px;\n}\n#material .rules .rule .hover {\n  display: none;\n}\n#material .rules .rule:hover .hover {\n  display: block;\n}\n#material .rules .rule:hover .noHover {\n  display: none;\n}\n#material .inputButton {\n  display: flex;\n  align-items: center;\n}\n#material .inputButton .group {\n  width: 100%;\n}\n#material .group {\n  position: relative;\n  margin-bottom: 15px;\n  margin-top: 25px;\n}\n#material .group input {\n  font-size: 18px;\n  padding: 10px 10px 10px 5px;\n  display: block;\n  color: white;\n  width: 100%;\n  border: none;\n  background-color: #484848;\n  border-bottom: 1px solid white;\n}\n#material .group input:focus {\n  outline: none;\n}\n#material .group label {\n  color: #999;\n  font-size: 18px;\n  font-weight: normal;\n  position: absolute;\n  pointer-events: none;\n  left: 5px;\n  top: 10px;\n  transition: 0.2s ease all;\n}\n#material .group input:focus ~ label,\n#material .group input:valid ~ label {\n  left: 0;\n  top: -20px;\n  font-size: 14px;\n  color: #f43b7a;\n}\n#material .group .bar {\n  position: relative;\n  display: block;\n}\n#material .group .bar::before,\n#material .group .bar::after {\n  content: '';\n  height: 2px;\n  width: 0;\n  bottom: 0;\n  position: absolute;\n  background: #f43b7a;\n  transition: 0.2s ease all;\n}\n#material .group .bar::before {\n  left: 50%;\n}\n#material .group .bar::after {\n  right: 50%;\n}\n#material .group input:focus ~ .bar::before,\n#material .group input:focus ~ .bar::after {\n  width: 50%;\n}\n#material .mdl-progress {\n  display: block;\n  position: relative;\n  height: 3px;\n  width: 500px;\n  max-width: 100%;\n}\n#material .mdl-progress > .bar {\n  display: block;\n  position: absolute;\n  top: 0;\n  bottom: 0;\n  width: 0%;\n  transition: width 0.2s linear;\n}\n#material .mdl-progress > .bar1 {\n  background-color: #3f51b5;\n  animation-name: indeterminate1;\n  animation-duration: 2s;\n  animation-iteration-count: infinite;\n  animation-timing-function: linear;\n}\n@keyframes indeterminate1 {\n0% {\n    left: 0%;\n    width: 0%;\n}\n50% {\n    left: 25%;\n    width: 75%;\n}\n75% {\n    left: 100%;\n    width: 0%;\n}\n}\n#material .loadingBar {\n  position: relative;\n}\n#material .loadingBar .mdl-progress {\n  position: absolute;\n  top: -9px;\n}\n#material button {\n  margin-top: 10px;\n  margin-left: 10px;\n  background-color: #3f51b5;\n  color: white;\n  border: none;\n  border-radius: 2px;\n  position: relative;\n  height: 42px;\n  padding: 0 16px;\n  display: inline-block;\n  font-size: 14px;\n  font-weight: 500;\n  text-transform: uppercase;\n  letter-spacing: 0;\n  cursor: pointer;\n  text-decoration: none;\n  text-align: center;\n  line-height: 36px;\n  vertical-align: middle;\n}\n#material #offsetUi {\n  display: flex;\n  justify-content: space-around;\n}\n#material #offsetUi .offsetBox {\n  text-align: center;\n  min-width: 40px;\n  margin-left: 5px;\n  margin-right: 5px;\n}\n#material #offsetUi .offsetBox .top {\n  padding: 5px 10px;\n}\n#material #offsetUi .offsetBox .bottom {\n  padding: 5px 10px;\n}\n#material #offsetUi .offsetBox .bottom.active {\n  border: 1px solid #f43b7a;\n  border-top: 0;\n}\n"]],["__file","correctionApp.vue"]]);var No=n(9e4),Oo=n(9375);class Lo extends ha{constructor(){super(...arguments),this.reloadSync=!1}openCorrectionCheck(){return this.state&&this.state.similarity&&this.state.similarity.same?(No.log("similarity",this.state.similarity.value),!1):this.openCorrection(!0).then((()=>this.changed))}openCorrection(e=!1){return new Promise(((t,n)=>{if(this.vueInstance&&(this.vueInstance.$.appContext.app.unmount(),!e))return void t(!1);const i=Oo.flashm('<div class="ms-shadow"></div>',{permanent:!0,position:"top",type:"correction"});this.vueInstance=Ur($o,i.find(".ms-shadow").get(0),{shadowDom:!0}),this.vueInstance.searchClass=this,this.vueInstance.syncMode=e,this.vueInstance.unmountFnc=()=>{t(this.changed),i.remove(),this.vueInstance=void 0}}))}}const Co=/^(https?|wss?|file|ftp|\*):\/\/(\*|\*\.[^*/]+|[^*/]+)\/.*$|^file:\/\/\/.*$|^resource:\/\/(\*|\*\.[^*/]+|[^*/]+)\/.*$|^about:/,Ao="object"==typeof navigator&&navigator.userAgent.includes("Firefox/"),Po=Ao?/^(https?|wss?):[/][/][^/]+([/].*)?$/:/^https?:[/][/][^/]+([/].*)?$/,Ro=/^(https?|file|ftp):[/]+/;function Mo(...e){return 0===e.length?/$./:e.includes("<all_urls>")?Ro:e.includes("*://*/*")?Po:new RegExp(e.map((e=>function(e){if(!Co.test(e))throw new Error(e+" is an invalid pattern, it must match "+String(Co));let[,t,n,i]=e.split(/(^[^:]+:[/][/])([^/]+)?/);return t=t.replace("*",Ao?"(https?|wss?)":"https?").replace(/[/]/g,"[/]"),n=(null!=n?n:"").replace(/^[*][.]/,"([^/]+.)*").replace(/^[*]$/,"[^/]+").replace(/[.]/g,"[.]").replace(/[*]$/g,"[^.]+"),i=i.replace(/[/]/g,"[/]").replace(/[.]/g,"[.]").replace(/[*]/g,".*"),"^"+t+n+"("+i+")?$"}(e))).join("|"))}var Uo=n(25903),jo=n.n(Uo),Do=n(58339);n(58339),n(9e4);const Fo=n(16245);var Vo=n(58339),zo=n(9e4),Ho=(n(9375),function(e,t,n,i){return new(n||(n=Promise))((function(s,r){function a(e){try{l(i.next(e))}catch(e){r(e)}}function o(e){try{l(i.throw(e))}catch(e){r(e)}}function l(e){e.done?s(e.value):function(e){return e instanceof n?e:new n((function(t){t(e)}))}(e.value).then(a,o)}l((i=i.apply(e,t||[])).next())}))});class Bo{constructor(){this.missingPermissions={},this.options=function(){const e=[{key:"iframe",title:"Video Iframe"}];return Fo.forEach((t=>{e.push({key:t.key,title:t.name})})),e}()}init(){return Ho(this,void 0,void 0,(function*(){return Vo.request.xhr("GET","https://api.malsync.moe/general/permissions").then((e=>{const t=JSON.parse(e.responseText),n=Object.keys(t).filter((e=>"ttl"!==e)).filter((e=>function(e){return jo()(e,Do.storage.version())}(e))).reduce(((e,n)=>{for(const i in t[n])this.options.some((e=>e.key===i))&&(e[i]?e[i]=e[i].concat(t[n][i]):e[i]=t[n][i]);return e}),{});this.missingPermissions=n}))}))}getMissingPermissions(e){const t=this.getFormatedPermissions();return console.log(e),t.filter((t=>!e.some((e=>e.page===t.page&&e.domain===t.domain)))).filter((e=>!function(e){try{return chrome.runtime.getManifest().content_scripts.some((t=>t.matches&&t.matches.some((t=>Mo(t).test(e)))))}catch(e){return!1}}(e.domain)))}getFormatedPermissions(){const e=[];for(const t in this.missingPermissions)this.missingPermissions[t].forEach((n=>{e.push({page:t,domain:n,auto:!0})}));return e}}class Wo{getProgress(e){return Number(this.execute(e))}}var Ko=n(19947),Go=n(19947),qo=n(19947),Jo=n(19947);const Xo={text:class extends Wo{execute(e){let t=Ko.$(e.selector).first().text().trim();if(e.regex){const n=new RegExp(e.regex),i=t.match(n);i&&(t=i[e.group||0])}const n=Number(t);if(Number.isNaN(n)||0===n)throw new Error(`No number found in text '${t}' (${n})`);return n}},count:class extends Wo{execute(e){const t=Go.$(e.selector).length;if(0===t)throw new Error(`No element found for '${e.selector}'`);return t}},countAbove:class extends Wo{execute(e){const t=qo.$(e.selector);if(0===t.length)throw new Error(`No element found for '${e.selector}'`);const n=this.getElementInViewport(t);return n?this.countElementsAbove(t,n):0}getElementInViewport(e){const t=[],n=window.innerHeight||document.documentElement.clientHeight,i=window.innerWidth||document.documentElement.clientWidth;for(let s=0;s<e.length;s++){const r=e[s],a=r.getBoundingClientRect();a.bottom<=n&&a.left<=i&&a.width&&a.height&&t.push(r)}return t.length?t[t.length-1]:null}countElementsAbove(e,t){let n=0;for(let i=0;i<e.length&&(n++,e[i]!==t);i++);return n}},prop:class extends Wo{execute(e){let t=Jo.$(e.selector).first().prop(e.property).trim();if(e.regex){const n=new RegExp(e.regex),i=t.match(n);i&&(t=i[e.group||0])}const n=Number(t);if(Number.isNaN(n)||0===n)throw new Error(`No number found in property '${e.property}' for '${t}' (${n})`);return n}}};function Yo(e){return(new Xo[e.mode]).getProgress(e)}var Zo=n(9e4),Qo=n(19947),el=n(58339),tl=function(e,t,n,i){return new(n||(n=Promise))((function(s,r){function a(e){try{l(i.next(e))}catch(e){r(e)}}function o(e){try{l(i.throw(e))}catch(e){r(e)}}function l(e){e.done?s(e.value):function(e){return e instanceof n?e:new n((function(t){t(e)}))}(e.value).then(a,o)}l((i=i.apply(e,t||[])).next())}))};const nl=Zo.m("MangaProgress"),il=[{condition:"#amrapp",current:{mode:"text",selector:".amr-pages-nav .text-h6",regex:"(\\d+) /",group:1},total:{mode:"text",selector:".amr-pages-nav .text-h6",regex:"/ (\\d+)",group:1}}];class sl{constructor(e,t){this.result=null,this.stopPromise=()=>{},this.configs=[...il,...e],this.page=t,nl.log("config",this.configs)}getProgressFromCollectors(e){return{current:Yo(e.current),total:Yo(e.total)}}applyConfig(){for(const e in this.configs){const t=this.configs[e];if(!t.condition||Qo.$(t.condition).length)try{return this.getProgressFromCollectors(t)}catch(n){nl.m(`skip ${e}`).debug(n.message,t)}}return null}getProgress(){return this.result}isSuccessful(){return null!==this.result}getLimit(){const e=this.getProgress();return null===e?0:Math.floor(e.total/100*90)}progressPercentage(){const e=this.getProgress();if(null===e)return null;if(0===e.total)return 0;const t=e.current/this.getLimit();return t>1?1:t<0?0:t}finished(){const e=this.getProgress();if(null===e)return!1;const t=this.getLimit();return t<1||e.current>=t}execute(){this.result=this.applyConfig()}start(){return tl(this,void 0,void 0,(function*(){return clearInterval(this.interval),yield this.checkForUpdatedConfig().catch((e=>nl.error(e))),new Promise(((e,t)=>{this.stopPromise=()=>e(!1);let n=!1;this.interval=setInterval((()=>{if(this.execute(),!this.isSuccessful())return clearInterval(this.interval),void t(new Error("MangaProgress: Progress not found"));n||(n=!0,e(!0)),this.setProgress(),nl.debug(this.finished(),this.getProgress())}),1e3)}))}))}stop(){clearInterval(this.interval)}setProgress(){Qo.$(".ms-progress").css("width",100*this.progressPercentage()+"%"),Qo.$("#malSyncProgress").removeClass("ms-loading").removeClass("ms-done"),this.finished()&&Qo.$("#malSyncProgress").length&&(Qo.$("#malSyncProgress").addClass("ms-done"),Qo.$(".flash.type-update .sync").trigger("click"),clearInterval(this.interval))}checkForUpdatedConfig(){return tl(this,void 0,void 0,(function*(){const e=new h(`reader/${this.page}`,864e5);let t;if(yield e.hasValue())t=yield e.getValue();else{const n=`https://api.malsync.moe/static/reader/${this.page}`;t=yield el.request.xhr("GET",n).then((e=>tl(this,void 0,void 0,(function*(){return 200===e.status&&e.responseText?JSON.parse(e.responseText):null})))),yield e.setValue(t)}t&&(nl.log("Override config",t),this.configs=[...il,...t])}))}}var rl=n(9e4),al=n(58339),ol=n(19947),ll=n(9375),cl=function(e,t,n,i){return new(n||(n=Promise))((function(s,r){function a(e){try{l(i.next(e))}catch(e){r(e)}}function o(e){try{l(i.throw(e))}catch(e){r(e)}}function l(e){e.done?s(e.value):function(e){return e instanceof n?e:new n((function(t){t(e)}))}(e.value).then(a,o)}l((i=i.apply(e,t||[])).next())}))};let ul="agnaejlkbiiggajjmnpmeheigkflbnoo";"undefined"!=typeof browser&&"undefined"!=typeof chrome&&(ul="{57081fef-67b4-482f-bcb0-69296e63ec4f}");const hl=rl.m("Sync","#348fff");let dl,pl;class ml{constructor(e,t,n=(()=>{throw"No click handling found"})){if(this.url=e,this.pages=t,this.floatClick=n,this.novel=!1,this.strongVolumes=!1,this.videoSyncOffset=!0,this.autoNextEpRun=!1,this.curState=void 0,this.tempPlayer=void 0,this.UILoaded=!1,this.browsingtime=Date.now(),this.page=this.getPage(e),null===this.page)throw new Error("Page could not be recognized");if(this.domainSet(),hl.log("Page",this.page.name),void 0!==al.settings.get("enablePages")[this.page.name]&&!al.settings.get("enablePages")[this.page.name])throw hl.info("Sync is disabled for this page",this.page.name),"Stop Script";"manga"===this.page.type&&al.settings.get("readerTracking")&&(this.mangaProgress=new sl(this.page.sync.readerConfig||[],this.page.name)),g.on("syncPage_fillUi",(()=>this.fillUI()))}init(){const e=this;if(ol.$(document).ready((function(){!function(e,t){const n=wt.settings.get("posLeft"),i=wt.settings.get("miniMalWidth"),s=wt.settings.get("miniMalHeight");if(!kt.$("#info-popup").length){wt.storage.addStyle(`.modal-content-kal.fullscreen{width: 100% !important;height: 100% !important; bottom: 0 !important;${n}: 0 !important;}      .modal-content-kal{-webkit-transition: all 0.5s ease; -moz-transition: all 0.5s ease; -o-transition: all 0.5s ease; transition: all 0.5s ease;}      .floatbutton:hover {background-color:rgb(63,81,181) !important;}      .floatbutton:hover div {background-color:white;border-color:white;}      .floatbutton div {background-color:black;border-color:black;-webkit-transition: all 0.5s ease;-moz-transition: all 0.5s ease;-o-transition: all 0.5s ease;transition: all 0.5s ease;}      .floatbutton {       z-index: 9999;display: none; position:fixed; bottom:40px; right:40px; border-radius: 50%; font-size: 24px; height: 56px; margin: auto; min-width: 56px; width: 56px; padding: 0; overflow: hidden; background: rgba(158,158,158,.2); box-shadow: 0 1px 1.5px 0 rgba(0,0,0,.12), 0 1px 1px 0 rgba(0,0,0,.24); line-height: normal; border: none;       font-weight: 500; text-transform: uppercase; letter-spacing: 0; will-change: box-shadow; transition: box-shadow .2s cubic-bezier(.4,0,1,1),background-color .2s cubic-bezier(.4,0,.2,1),color .2s cubic-bezier(.4,0,.2,1); outline: none; cursor: pointer; text-decoration: none; text-align: center; vertical-align: middle; padding: 16px !important;      }      .floatbutton.stealth {        background: rgba(158,158,158,.03);      }      .floatbutton.stealth .open-info-popup{        visibility: hidden;      }      .floatbutton.floatHide{        visibility: hidden !important;      }`);let r=`max-width: 100%; max-height: 100%; min-width: 500px; min-height: 300px; width: ${i}; height: ${s}; position: absolute; bottom: 0%; ${n}: 0%`;kt.$(window).width()<500&&(r=`width: 100vw; height: 100%; position: absolute; top: 0%; ${n}: 0%`);let a='<div class="modal-kal" id="info-popup" style="pointer-events: none;display: none; position: fixed;z-index: 9999;left: 0;top: 0;bottom: 0;width: 100%; height: 100%; background-color: transparent; padding: 0; margin: 0; border: 0;">';a+=`<div id="modal-content" class="modal-content-kal" Style="pointer-events: all; background-color: #f9f9f9; margin: 0; ${r}">`,a+="</div>",a+="</div>",kt.$("body").after(kt.html(a));let o="";wt.settings.get("floatButtonStealth")&&(o+="stealth "),wt.settings.get("floatButtonHide")&&(o+="floatHide ");let l=`<button class="open-info-popup floatbutton ${o}" style="">`;wt.settings.get("floatButtonCorrection")?l+='\n        <i\n          class="my-float open-info-popup"\n          style="display: flex; height: 8px; transform: rotate(-45deg); margin-left: -7px; margin-right: -5px; pointer-events: none;"\n        >\n          <div\n            style="\n              width: 1px;\n              margin-left: 2px;\n              border-top: 4px solid transparent;\n              border-bottom: 4px solid transparent;\n              border-right-width: 4px;\n              border-right-style: solid;\n              background-color: transparent;\n            "\n          ></div>\n          <div style="flex-grow: 1; border-top-left-radius: 2px; border-bottom-left-radius: 2px; margin-left: -1px;"></div>\n          <div style="width: 5px; margin-left: 2px; border-top-right-radius: 2px; border-bottom-right-radius: 2px;"></div>\n        </i>\n      ':l+='<i class="my-float open-info-popup" style="margin-top:22px; pointer-events: none;"><div class="open-info-popup" style="width: 100%; height: 4px; margin-bottom: 15%;"></div><div class="open-info-popup" style="width: 100%; height: 4px; margin-bottom: 15%;"></div><div class="open-info-popup" style="width: 100%; height: 4px"></div></i>',l+="</button>",kt.$("#info-popup").after(kt.html(l)),wt.settings.get("floatButtonCorrection")||Et(),wt.settings.get("autoCloseMinimal")&&kt.$(".modal-kal").css("pointer-events","initial"),document.addEventListener("click",(function(n){n&&n.target&&(kt.$(n.target).hasClass("open-info-popup")&&t(e),kt.$(n.target).hasClass("modal-kal")&&(document.getElementById("info-popup").style.display="none",Et()))}))}}(e,e.floatClick)})),this.testForCloudflare())return hl.log("loading"),void this.cdn();if(this.page.init(this),"webextension"===al.type)try{chrome.runtime.onMessage.addListener(((e,t,n)=>{this.presence(e,t,n)}))}catch(e){hl.error(e)}}getPage(e){if(this.pages.type)return this.pages;for(const t in this.pages){const n=this.pages[t];if(ol.$.isArray(n.domain)){let s;if(n.domain.forEach((e=>{i(e)&&(n.domain=e,s=n)})),s)return s}else if(i(n.domain))return n;function i(t){return e.indexOf(`${ll.urlPart(t,2).replace(".com.br",".br").split(".").slice(-2,-1)[0]}.`)>-1}}return null}domainSet(){this.page.domain=new URL(window.location.href).origin}openNextEp(){if(void 0===this.page.sync.nextEpUrl)ll.flashm(al.storage.lang("nextEpShort_no_support"),{error:!0,type:"EpError"});else{if(this.page.isSyncPage(this.url)){const e=this.page.sync.nextEpUrl(this.url);if(e)return void(window.location.href=e)}ll.flashm(al.storage.lang("nextEpShort_no_nextEp"),{error:!0,type:"EpError"})}}setVideoTime(e,t){this.resetPlayerError();const n=al.settings.get("videoDuration"),i=e.current/(e.duration*(n/100))*100;ol.$("#malSyncProgress").length&&(i<100?(ol.$(".ms-progress").css("width",`${i}%`),ol.$("#malSyncProgress").removeClass("ms-loading").removeClass("ms-done")):this.videoSyncOffset?(ol.$("#malSyncProgress").addClass("ms-done"),ol.$(".flash.type-update .sync").click()):rl.log("videoSyncOffset",i)),this.handleVideoResume(e,t),this.autoNextEp(e)}autoNextEp(e){al.settings.get("autoNextEp")&&!this.autoNextEpRun&&e.current+1>e.duration&&(this.autoNextEpRun=!0,this.openNextEp())}handleVideoResume(e,t){if(void 0===this.curState||void 0===this.curState.identifier||void 0===this.curState.episode)return;const n=this,i=`${this.curState.identifier}/${this.curState.episode}`;if(this.curState.lastVideoTime=e,void 0!==this.curState.videoChecked&&this.curState.videoChecked)this.curState.videoChecked>1&&e.current>10&&(hl.debug("Set Resume",e.current),r.setItem(i,e.current),this.curState.videoChecked=!0,setTimeout((()=>{this.curState&&(this.curState.videoChecked=2)}),1e4));else{const s=r.getItem(i);if(hl.info("Resume",s),null!==s&&parseInt(s)-30>e.current&&parseInt(s)>30){ol.$("#MALSyncResume").length||ol.$("#MALSyncResume").parent().parent().remove();const i=Math.round(parseInt(s));let r="";if(al.settings.get("autoresume")&&e.duration-i>.1*e.duration)return t(i),void(n.curState.videoChecked=2);let a=i;const o=Math.floor(a/60);a-=60*o;let l=`${a}`;for(;l.length<2;)l=`0${l}`;r=`${o}:${l}`;const c=ll.flashm(`<button id="MALSyncResume" class="sync" style="margin-bottom: 2px; background-color: transparent; border: none; color: rgb(255,64,129);cursor: pointer;">${al.storage.lang("syncPage_flashm_resumeMsg",[r])}</button><br><button class="resumeClose" style="background-color: transparent; border: none; color: white;margin-top: 10px;cursor: pointer;">Close</button>`,{permanent:!0,error:!1,type:"resume",minimized:!1,position:"top"});c.find(".sync").on("click",(function(){t(i),n.curState.videoChecked=2,ol.$(this).parent().parent().remove()})),c.find(".resumeClose").on("click",(function(){n.curState.videoChecked=2,ol.$(this).parent().parent().remove()}))}else setTimeout((()=>{this.curState.videoChecked=2}),15e3);this.curState.videoChecked=!0}}reset(){this.url=window.location.href,this.UILoaded=!1,this.curState=void 0,this.setSearchObj(void 0),this.mangaProgress&&this.mangaProgress.stop(),$("#flashinfo-div, #flash-div-bottom, #flash-div-top, #malp").remove()}setSearchObj(e){e?Et():al.settings.get("floatButtonCorrection")&&xt(),this.searchObj=e}handlePage(e=window.location.href){return cl(this,void 0,void 0,(function*(){let t,n;if(this.resetPlayerError(),this.curState=void 0,this.setSearchObj(void 0),this.url=e,this.browsingtime=Date.now(),this.videoSyncOffset=!1,clearTimeout(this.videoSyncInterval),this.videoSyncInterval=setTimeout((()=>{this.videoSyncOffset=!0}),1e4),this.page.isSyncPage(this.url)){this.loadUI(),t={on:"SYNC",title:this.page.sync.getTitle(this.url),identifier:this.page.sync.getIdentifier(this.url),detectedEpisode:parseInt(`${this.page.sync.getEpisode(this.url)}`)},this.setSearchObj(new Lo(t.title,this.novel?"novel":this.page.type,t.identifier)),this.searchObj.setPage(this.page),this.searchObj.setSyncPage(this),this.searchObj.setLocalUrl(this.generateLocalUrl(this.page,t)),this.curState=t,yield this.searchObj.search();try{n=yield this.searchObj.initRules()}catch(e){throw e instanceof _&&this.incorrectUrl(),e}t.detectedEpisode||0===t.detectedEpisode?t.episode=t.detectedEpisode+parseInt(this.searchObj.getRuledOffset(t.detectedEpisode)):"anime"===this.page.type?t.episode=1:t.episode=0,void 0!==this.page.sync.getVolume&&(t.volume=this.page.sync.getVolume(this.url)),"anime"===this.page.type&&(i=(e,t)=>{this.tempPlayer=t,this.setVideoTime(e,(e=>{void 0!==t?void 0!==e&&(t.play(),t.currentTime=e):hl.error("No player Found")}))},clearInterval(Mt),Mt=setInterval((function(){const e=document.getElementsByTagName("video");for(let t=0;t<e.length;t++){const n=e[t],{duration:s}=n,r=n.currentTime,{paused:a}=n;if(s&&s>60){const e={current:r,duration:s,paused:a};Ut.debug(window.location.href,e),i(e,n),Dt(e,n);break}}}),1e3)),hl.m("Sync","green").log(t)}else{if(void 0===this.page.overview)return void hl.log("No overview definition");if(void 0!==this.page.isOverviewPage&&!this.page.isOverviewPage(this.url))return void hl.info("Not an overview/sync page");this.loadUI(),t={on:"OVERVIEW",title:this.page.overview.getTitle(this.url),identifier:this.page.overview.getIdentifier(this.url)},this.setSearchObj(new Lo(t.title,this.novel?"novel":this.page.type,t.identifier)),this.searchObj.setPage(this.page),this.searchObj.setSyncPage(this),this.searchObj.setLocalUrl(this.generateLocalUrl(this.page,t)),this.curState=t,yield this.searchObj.search();try{n=yield this.searchObj.initRules()}catch(e){throw e instanceof _&&this.incorrectUrl(),e}hl.m("Overview","green").log(t)}var i;this.curState=t;let s=this.searchObj.getRuledUrl(t.detectedEpisode);const r=this.generateLocalUrl(this.page,t);if(null!==s&&s||!al.settings.get("localSync")||(hl.log("Local Fallback"),s=r),null===s)ol.$("#MalInfo").text(al.storage.lang("Not_Found")),ol.$("#MalData").css("display","none"),hl.log("Not on mal");else if(s){hl.log("MyAnimeList",s);try{n||(n=_t(s),yield n.update()),this.singleObj=n}catch(e){if(e instanceof _)throw this.incorrectUrl(),e;if(!(e instanceof k&&al.settings.get("localSync")))throw n&&(this.singleObj=n),this.singleObj.flashmError(e),this.fillUI(),e;hl.log("Local Fallback"),n=_t(r),yield n.update(),this.singleObj=n}if("webextension"===al.type&&al.settings.get("rpc"))try{chrome.runtime.sendMessage(ul,{mode:"active"},(function(e){hl.log("Presence registred",e)}))}catch(e){hl.error(e)}if(this.fillUI(),this.page.isSyncPage(this.url)){if(yield this.searchObj.openCorrectionCheck())return void this.handlePage(e);(yield this.singleObj.checkSync(t.episode,t.volume))?(this.strongVolumes&&!t.episode||this.singleObj.setEpisode(t.episode),this.singleObj.setStreamingUrl(this.page.sync.getOverviewUrl(this.url)),void 0!==t.volume&&t.volume>this.singleObj.getVolume()&&this.singleObj.setVolume(t.volume),hl.log(`Start Sync (${al.settings.get("delay")} Seconds)`),this.singleObj.getMalId()&&"anime"===this.singleObj.getType()&&al.settings.get("checkForFiller")&&this.checkForFiller(this.singleObj.getMalId(),this.singleObj.getEpisode()),yield this.startSyncHandling(t,s)):hl.log("Nothing to Sync")}yield this.imageFallback()}else ol.$("#MalInfo").text(al.storage.lang("NothingFound")),ol.$("#MalData").css("display","none"),hl.log("Nothing found")}))}startSyncHandling(e,t){return cl(this,void 0,void 0,(function*(){let n=!1;if(this.mangaProgress)try{if(n=yield this.mangaProgress.start(),!n)return}catch(e){hl.error(e)}if(n||"instant"!==al.settings.get(`autoTrackingMode${this.page.type}`)){const i={key:`syncPage_flashm_sync_${this.page.type}`,value:String(e.episode)};"manga"===this.page.type&&!e.episode&&e.volume&&(i.key="syncPage_flashm_sync_manga_volume",i.value=String(e.volume));let s=`<button class="sync" style="margin-bottom: 8px; background-color: transparent; border: none; color: rgb(255,64,129);margin-top: 10px;cursor: pointer;">${al.storage.lang(i.key,[Ct(t).shortName,i.value])}</button>`,r={hoverInfo:!0,error:!0,type:"update",minimized:!1};"video"===al.settings.get(`autoTrackingMode${this.page.type}`)&&"anime"===this.page.type&&(s=`\n          <div id="malSyncProgress" class="ms-loading" style="background-color: transparent; position: absolute; top: 0; left: 0; right: 0; height: 4px;">\n            <div class="ms-progress" style="background-color: #2980b9; width: 0%; height: 100%; transition: width 1s;"></div>\n          </div>\n          <div class="player-error" style="display: none; position: absolute; left: 0; right: 0; padding: 5px; bottom: 100%; color: rgb(255,64,129); background-color: #323232;">\n            <span class="player-error-default">${al.storage.lang("syncPage_flash_player_error")}</span>\n            <span class="player-error-missing-permissions" style="display: none; padding-top: 10px">\n              ${al.storage.lang("settings_custom_domains_missing_permissions_header")}\n            </span>\n            <div style="display: flex; justify-content: space-evenly">\n              <a class="player-error-missing-permissions" href="https://malsync.moe/pwa/#/settings/customDomains" style="display: none; margin: 10px; border-bottom: 2px solid #e13f7b;">\n                ${al.storage.lang("Add")}\n              </a>\n              <a href="https://discord.com/invite/cTH4yaw" style="display: block; margin: 10px">Help</a>\n            </div>\n\n          </div>\n        ${s}`,r={hoverInfo:!0,error:!1,type:"update",minimized:!0}),n&&(s=`\n          <div id="malSyncProgress" style="background-color: transparent; position: absolute; top: 0; left: 0; right: 0; height: 4px;">\n            <div class="ms-progress" style="background-color: #2980b9; width: 0%; height: 100%; transition: width 1s;"></div>\n          </div>\n        ${s}`,r={hoverInfo:!0,error:!1,type:"update",minimized:!0}),ll.flashm(s,r).find(".sync").on("click",(()=>{ol.$(".flashinfo").remove(),this.sync(e),this.resetPlayerError()})),"anime"===this.singleObj.getType()&&(pl=setTimeout((()=>cl(this,void 0,void 0,(function*(){ol.$("#flashinfo-div").addClass("player-error"),(yield function(){return Ho(this,void 0,void 0,(function*(){if("webextension"!==Vo.type)return!1;const e=new Bo;yield e.init();const t=e.getMissingPermissions(Vo.settings.get("customDomains"));return zo.m("Missing Permissions").log(t),Boolean(t.length)}))}())&&ol.$("#flashinfo-div").addClass("player-error-missing-permissions");const e=$("iframe").toArray().map((e=>ll.absoluteLink($(e).attr("src"),window.location.origin))).filter((e=>e)).filter((e=>!function(e){try{const t=chrome.runtime.getManifest().content_scripts.find((e=>e.js&&e.js.includes("content/iframe.js")));return!(!t||!t.matches)&&Mo(...t.matches).test(e)}catch(e){return!1}}(e)));rl.log("No Player found",e)}))),3e5)),hl.log("overviewUrl",this.page.sync.getOverviewUrl(this.url)),void 0!==this.page.sync.nextEpUrl&&hl.log("nextEp",this.page.sync.nextEpUrl(this.url))}else setTimeout((()=>{this.sync(e)}),1e3*al.settings.get("delay"))}))}sync(e){if(this.singleObj.setResumeWatching(this.url,e.episode),void 0!==this.page.sync.nextEpUrl){const t=this.page.sync.nextEpUrl(this.url);t&&-1===t.indexOf("undefined")&&this.singleObj.setContinueWatching(t,e.episode+1)}this.syncHandling(!0)}resetPlayerError(){pl&&(clearTimeout(pl),pl=void 0,ol.$("#flashinfo-div").removeClass("player-error"),ol.$("#flashinfo-div").removeClass("player-error-missing-permissions"))}generateLocalUrl(e,t){return`local://${e.name}/${e.type}/${t.identifier}/${encodeURIComponent(t.title)}`}openCorrectionUi(){if(this.searchObj)return this.searchObj.openCorrection().then((e=>{e&&this.handlePage()}))}syncHandling(e=!1,t=!1){let n;return n=t?this.singleObj.undo():this.singleObj.sync(),n.then((()=>{let t=this.singleObj.getTitle(),n="<br>",i=this.singleObj.getTotalVolumes();0===i&&(i="?");let s=this.singleObj.getTotalEpisodes();0===s&&(s="?");let r=this.singleObj.getStateDiff();if(r||(r={onList:this.singleObj.isOnList(),episode:this.singleObj.getEpisode(),volume:this.singleObj.getVolume(),status:this.singleObj.getStatus(),score:this.singleObj.getScore()}),void 0===r.onList&&(r.onList=!0),r.onList&&r.status){let e="";switch(parseInt(r.status)){case 1:e=al.storage.lang(`UI_Status_watching_${this.page.type}`);break;case 2:e=al.storage.lang("UI_Status_Completed");break;case 3:e=al.storage.lang("UI_Status_OnHold");break;case 4:e=al.storage.lang("UI_Status_Dropped");break;case 6:e=al.storage.lang(`UI_Status_planTo_${this.page.type}`);break;case 23:e=al.storage.lang(`UI_Status_Rewatching_${this.page.type}`)}t+=n+e,n=" | "}if(r.onList||(t+=n+al.storage.lang("removed"),n=" | "),r.onList&&"manga"===this.page.type&&r.volume&&(t+=`${n+al.storage.lang("UI_Volume")} ${r.volume}/${i}`,n=" | "),r.onList&&r.episode&&(t+=`${n+ll.episode(this.page.type)} ${r.episode}/${s}`,n=" | "),r.onList&&r.score&&(t+=`${n+al.storage.lang("UI_Score")} ${r.score}`,n=" | "),e){this.fullNotification(t),t+=`\n            <br>\n            <button class="undoButton" style="background-color: transparent; border: none; color: rgb(255,64,129);margin-top: 10px;cursor: pointer;">\n              ${al.storage.lang("syncPage_flashm_sync_undefined_undo")}\n            </button>\n            <button class="wrongButton" style="background-color: transparent; border: none; color: rgb(255,64,129);margin-top: 10px;cursor: pointer;">\n              ${al.storage.lang("syncPage_flashm_sync_undefined_wrong")}\n            </button>`;const e=ll.flashm(t,{hoverInfo:!0,type:"update"});e.find(".undoButton").on("click",(e=>{const t=e.target.closest(".flash");t&&t.remove(),this.syncHandling(!1,!0)})),e.find(".wrongButton").on("click",(e=>{this.openCorrectionUi();const t=e.target.closest(".flash");t&&t.remove(),this.syncHandling(!1,!0)}))}else ll.flashm(t);this.fillUI()})).catch((e=>{throw this.singleObj.flashmError(e),e}))}fullNotification(e){try{!function(e){if(Pt.settings.get("floatButtonStealth"))return;const t=document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement||document.msFullscreenElement;if(t){const n=Rt.$(Rt.html(`\n        <div style="\n          all: initial;\n          position: absolute;\n          bottom: 0;\n          left: 0;\n          right: 0;\n          color: white;\n          display: none;\n          z-index: 20000;\n        ">\n          <div style="\n            background: rgba(50, 50, 50, 0.6);\n            color: white;\n            padding: 10px 15px 10px;\n            margin-left: auto;\n            margin-right: auto;\n            max-width: 60%;\n            display: table;\n            font-family: Helvetica,Arial,sans-serif;\n            text-align: center;\n          ">${e}</div>\n        </div>\n        `)).appendTo(Rt.$(t));n.slideDown(400).delay(2e3).slideUp(400,(()=>{n.remove()}))}}(e),"webextension"===al.type&&chrome.runtime.sendMessage({name:"content",item:{action:"fullscreenNotification",text:e}})}catch(e){hl.error(e)}}fillUI(){if(ol.$(".MalLogin").css("display",""),ol.$("#AddMalDiv, #LoginMalDiv").remove(),ol.$("#malRating").attr("href",this.singleObj.getDisplayUrl()),this.singleObj.getLastError())return ol.$(".MalLogin").css("display","none"),ol.$("#MalData").css("display","flex"),ol.$("#MalInfo").text(""),void ol.$("#malRating").after(ol.html(`&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span id='LoginMalDiv'>${this.singleObj.getLastErrorMessage()}</span>`));let e="";this.singleObj.getScoreCheckbox().forEach((t=>{e+=`<option value="${t.value}" >${t.label}</option>`})),ol.$("#malUserRating").html(ol.html(e));let t="";if(this.singleObj.getStatusCheckbox().forEach((e=>{t+=`<option value="${e.value}" >${e.label}</option>`})),ol.$("#malStatus").html(ol.html(t)),this.singleObj.getRating().then((e=>{ol.$("#malRating").text(e)})),this.singleObj.isOnList())ol.$("#malTotal, #malTotalCha").text(this.singleObj.getTotalEpisodes()),0===this.singleObj.getTotalEpisodes()&&ol.$("#malTotal, #malTotalCha").text("?"),ol.$("#malTotalVol").text(this.singleObj.getTotalVolumes()),0===this.singleObj.getTotalVolumes()&&ol.$("#malTotalVol").text("?"),ol.$("#malEpisodes").val(this.singleObj.getEpisode()),ol.$("#malVolumes").val(this.singleObj.getVolume()),ol.$("#malStatus").val(this.singleObj.getStatusCheckboxValue()),ol.$("#malUserRating").val(this.singleObj.getScoreCheckboxValue());else{ol.$(".MalLogin").css("display","none"),ol.$("#malRating").after(ol.html(`<span id='AddMalDiv'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href='#' id='AddMal' onclick='return false;'>${al.storage.lang("syncPage_malObj_addAnime",[this.singleObj.shortName])}</a></span>`));const e=this;ol.$("#AddMal").click((function(t){return cl(this,void 0,void 0,(function*(){t.preventDefault(),e.page.isSyncPage(e.url)||e.singleObj.setStreamingUrl(e.url),(yield e.searchObj.openCorrectionCheck())?e.handlePage():e.syncHandling().then((()=>e.singleObj.update())).then((()=>{e.fillUI()}))}))}))}ol.$("#MalData").css("display","flex"),ol.$("#MalInfo").text(""),this.calcSelectWidth(ol.$("#malEpisodes, #malVolumes, #malUserRating, #malStatus")),ol.$("#malEpisodes, #malVolumes").trigger("input");try{this.handleList(!0)}catch(e){hl.error(e)}}handleList(e=!1,t=0){if(this.singleObj&&(ol.$(".mal-sync-active").removeClass("mal-sync-active"),void 0!==this.page.overview&&void 0!==this.page.overview.list)){const n=this.getEpList();if(void 0!==n&&n.length>0&&(this.offsetHandler(n),this.page.overview.list.elementUrl)){const{elementUrl:i}=this.page.overview.list;hl.log("Episode List",ol.$.map(n,(function(e,t){return void 0!==e?i(e):"-"}))),void 0!==this.page.overview.list.handleListHook&&this.page.overview.list.handleListHook(this.singleObj.getEpisode(),n);const s=n[parseInt(this.singleObj.getEpisode()||1)];if(void 0===s&&!s&&e&&t<10&&void 0!==this.page.overview.list.paginationNext){hl.log("Pagination next");const e=this;this.page.overview.list.paginationNext(!1)&&setTimeout((function(){t++,e.handleList(!0,t)}),500)}const r=n[this.singleObj.getEpisode()+1];if(void 0!==r&&r&&!this.page.isSyncPage(this.url)){const e=`<a href="${i(r)}">${al.storage.lang(`syncPage_malObj_nextEp_${this.page.type}`,[this.singleObj.getEpisode()+1])}</a>`;ll.flashm(e,{hoverInfo:!0,type:"nextEp",minimized:!0})}}}}getEpList(){const e=this,t=[];if(void 0!==this.page.overview&&void 0!==this.page.overview.list){const{elementEp:n}=this.page.overview.list;let i=0;this.singleObj&&(i=parseInt(this.singleObj.getEpisode())),this.page.overview.list.elementsSelector().each((function(s,r){try{const s=parseInt(`${n(ol.$(r))}`)+parseInt(e.getOffset());t[s]=ol.$(r),(al.settings.get("highlightAllEp")&&s<=i||s===i)&&ol.$(r).addClass("mal-sync-active")}catch(e){hl.info(e)}}))}return t}offsetHandler(e){if(this.page.overview.list.offsetHandler&&!this.getOffset()&&this.searchObj&&"user"!==this.searchObj.provider)for(let t=0;t<e.length;++t)if(void 0!==e[t]){if(hl.log("Offset",t),t>1){const e=1-t;ll.flashConfirm(al.storage.lang("syncPage_flashConfirm_offsetHandler_1",[String(e)]),"offset",(()=>{this.setOffset(e)}),(()=>{this.setOffset(0)}),!0)}return}}imageFallback(){return cl(this,void 0,void 0,(function*(){if(this.singleObj&&void 0!==this.singleObj.setImage&&this.page.getImage){const e=yield this.page.getImage();e&&this.singleObj.setImage(e)}}))}incorrectUrl(){ll.flashm("Incorrect url provided",{error:!0,type:"error"}),this.openCorrectionUi()}testForCloudflare(){return"Just a moment..."===document.title||-1!==document.title.indexOf("Cloudflare")}cdn(e="default"){al.storage.addStyle("\n      .bubbles {\n        display: none !important;\n      }\n      div#cf-content:before {\n        content: '';\n        background-image: url(https://raw.githubusercontent.com/MALSync/MALSync/master/assets/icons/icon128.png);\n        height: 64px;\n        width: 64px;\n        display: block;\n        background-size: cover;\n        animation: rotate 3s linear infinite;\n        background-color: #251e2b;\n        border-radius: 50%;\n      }\n      @keyframes rotate{ to{ transform: rotate(360deg); } }\n    ")}getOffset(){return this.searchObj&&this.searchObj.getOffset()?this.searchObj.getOffset():0}setOffset(e){return cl(this,void 0,void 0,(function*(){this.searchObj&&this.searchObj.setOffset(e),void 0!==this.singleObj&&al.storage.remove(`updateCheck/${this.singleObj.getType()}/${this.singleObj.getCacheKey()}`)}))}loadUI(){const e=this;if(this.UILoaded)return;this.UILoaded=!0;const t="</span>";let n='<p id="malp">';n+=`<span id="MalInfo">${al.storage.lang("Loading")}</span>`,n+='<span id="MalData" style="display: none; justify-content: space-between; flex-wrap: wrap;">',n+='<span style="display: inline-block;" class="malp-group malp-group-rating">',n+=`<span class="info malp-group-label">${al.storage.lang("search_Score")} </span>`,n+='<a id="malRating" class="malp-group-field" style="min-width: 30px;display: inline-block;" target="_blank" href="">____</a>',n+=t;const i=e=>`<span style="display: inline-block; display: none;" class="MalLogin malp-group malp-group-${e}">`;n+=i("status"),n+=`<span class="info malp-group-label">${al.storage.lang("UI_Status")} </span>`,n+='<select id="malStatus" class="malp-group-field malp-group-select">',n+="</select>",n+=t;let s="";"anime"===this.page.type?(s+=i("episode"),s+=`<span class="info malp-group-label">${al.storage.lang("UI_Episode")} </span>`,s+='<span style=" text-decoration: none; outline: medium none;" class="malp-group-value-section">',s+='<input id="malEpisodes" class="malp-group-field malp-group-input" value="0" type="text" size="1" maxlength="4">',s+='/<span id="malTotal" class="malp-group-value">0</span>',s+="</span>",s+=t):(s+=i("volume"),s+=`<span class="info malp-group-label">${al.storage.lang("UI_Volume")} </span>`,s+='<span style=" text-decoration: none; outline: medium none;" class="malp-group-value-section">',s+='<input id="malVolumes" class="malp-group-field malp-group-input" value="0" type="text" size="1" maxlength="4">',s+='/<span id="malTotalVol" class="malp-group-value">0</span>',s+="</span>",s+=t,s+=i("chapter"),s+=`<span class="info malp-group-label">${al.storage.lang("UI_Chapter")} </span>`,s+='<span style=" text-decoration: none; outline: medium none;" class="malp-group-value-section">',s+='<input id="malEpisodes" class="malp-group-field malp-group-input" value="0" type="text" size="1" maxlength="4">',s+='/<span id="malTotalCha" class="malp-group-value">0</span>',s+="</span>",s+=t),n+=s,n+=i("score"),n+=`<span class="info malp-group-label">${al.storage.lang("UI_Score")}</span>`,n+='<select id="malUserRating" class="malp-group-field malp-group-select">',n+="</select>",n+=t,n+="</span>",n+="</p>",this.page.isSyncPage(this.url)?void 0!==this.page.sync.uiSelector&&this.page.sync.uiSelector(n):void 0!==this.page.overview&&this.page.overview.uiSelector(n),ol.$("#malEpisodes, #malVolumes, #malUserRating, #malStatus").change((function(){e.buttonclick();const t=ol.$(this);e.calcSelectWidth(t)})),ol.$("#malEpisodes, #malVolumes").on("input",(function(){const e=ol.$(this);let t=e.val().toString().length;t<1&&(t=1);const n=7.7*t+3;e.css("width",`${n}px`)})).trigger("input")}calcSelectWidth(e){e.each((function(e,t){const n=ol.$(t).find("option:selected").text(),i=ol.$('<select style="width: auto;"/>').append(ol.html(`<option>${n}</option>`)),s=i.width()||0;s&&(ol.$("#malp").append(ol.html(i)),ol.$(t).width(s+5),i.remove())}))}buttonclick(){return cl(this,void 0,void 0,(function*(){this.singleObj.setEpisode(ol.$("#malEpisodes").val()),ol.$("#malVolumes").length&&this.singleObj.setVolume(ol.$("#malVolumes").val()),this.singleObj.handleScoreCheckbox(ol.$("#malUserRating").val()),this.singleObj.handleStatusCheckbox(ol.$("#malStatus").val()),this.page.isSyncPage(this.url)||this.singleObj.setStreamingUrl(this.url),(yield this.searchObj.openCorrectionCheck())?this.handlePage():this.syncHandling().then((()=>this.singleObj.update())).then((()=>{this.fillUI()}))}))}presence(e,t,n){try{if("presence"===e.action){console.log("Presence requested",e,this.curState),clearTimeout(dl),dl=setTimeout((()=>{this.browsingtime=void 0}),3e5),this.browsingtime||(this.browsingtime=Date.now());let t=!0,i=!0;switch(al.settings.get("presenceLargeImage")){case"website":t=!1,i=!1;break;case"malsync":t=!1,i=!0}let s,r,a="606504719212478504";if(al.settings.get("presenceShowMalsync")||(a="anime"!==this.page.type?"823563138669608980":"823563096747802695"),i?(s="malsync",r="MAL-Sync"):(s=this.page.name.toLowerCase(),r=`${this.page.name} • MAL-Sync`),t&&this.singleObj.getImage()&&(s=this.singleObj.getImage()),this.curState){const e={clientId:a,presence:{details:this.singleObj.getTitle(!0)||this.curState.title,largeImageKey:s,largeImageText:r,instance:!0}};if(al.settings.get("presenceShowButtons")){let t=null;"Local"!==this.singleObj.shortName&&(t=this.singleObj.getDisplayUrl()),t||(t=this.singleObj.getMalUrl()),t||i||(t=this.singleObj.getStreamingUrl()),t&&(e.presence.buttons=[{label:al.storage.lang(`discord_rpc_view_${this.singleObj.getType()}`),url:t}])}if(void 0!==this.curState.episode){const t=[];if(this.curState.episode>0){let e=this.singleObj.getTotalEpisodes();e=e?`/${e}`:"",t.push(`${ll.episode(this.page.type)} ${this.curState.episode}${e}`)}if(this.curState.volume>0){const e=this.curState.volume;let n=this.singleObj.getTotalVolumes();n=n?`/${n}`:"",t.push(`${al.storage.lang("UI_Volume")} ${e}${n}`)}if(e.presence.state=t.join(" | "),void 0!==this.curState.lastVideoTime)if(this.curState.lastVideoTime.paused)e.presence.smallImageKey="pause",e.presence.smallImageText="Paused";else{const t=this.curState.lastVideoTime.duration-this.curState.lastVideoTime.current;e.presence.endTimestamp=Date.now()+1e3*t,e.presence.smallImageKey="play",e.presence.smallImageText="Playing"}else e.presence.startTimestamp=this.browsingtime,"anime"!==this.page.type&&(e.presence.smallImageKey="reading",e.presence.smallImageText="Reading")}else{let t;t=i?this.page.type.toString():this.page.name,e.presence.startTimestamp=this.browsingtime,e.presence.state=al.storage.lang("Discord_rpc_browsing",[t])}return void n(e)}}}catch(e){hl.error(e)}n({})}checkForFiller(e,t){return cl(this,void 0,void 0,(function*(){const n=Math.ceil(t/100),i=new h(`fillers/${e}/${n}`,6048e5);if(!(yield i.hasValueAndIsNotEmpty())){const t=`https://api.jikan.moe/v4/anime/${e}/episodes?page=${n}`,s=yield al.request.xhr("GET",t).then((e=>cl(this,void 0,void 0,(function*(){try{if(200===e.status&&e.responseText){const t=JSON.parse(e.responseText);if(t.data&&t.data.length)return t.data.map((e=>({filler:e.filler,recap:e.recap,episode_id:e.mal_id}))).filter((e=>e.filler||e.recap))}}catch(e){}return[]}))));yield i.setValue(s)}const s=yield i.getValue();if(s&&s.length){const e=s.find((e=>e.episode_id===t));if(e&&(e.filler||e.recap)){const t=e.filler?"filler":"recap";ll.flashConfirm(al.storage.lang(`filler_${t}_confirm`),"filler",(()=>{this.openNextEp()}),(()=>{}),!0)}}}))}}var fl=n(58339),gl=n(19947),yl=n(9e4),vl=n(9375),bl=function(e,t,n,i){return new(n||(n=Promise))((function(s,r){function a(e){try{l(i.next(e))}catch(e){r(e)}}function o(e){try{l(i.throw(e))}catch(e){r(e)}}function l(e){e.done?s(e.value):function(e){return e instanceof n?e:new n((function(t){t(e)}))}(e.value).then(a,o)}l((i=i.apply(e,t||[])).next())}))};function _l(){return bl(this,void 0,void 0,(function*(){const e=yield fl.storage.get("timestampUpdate/firebaseNotification");(void 0===e||gl.$.now()-e>6e5)&&(yield wl(),fl.storage.set("timestampUpdate/firebaseNotification",gl.$.now()))}))}function wl(){return bl(this,void 0,void 0,(function*(){yl.log("checkNotifications");const e=yield fl.request.xhr("GET","https://kissanimelist.firebaseio.com/Data2/Notification/Current.json"),t=parseInt(JSON.parse(e.responseText));Number.isNaN(t)&&yl.error("Could not read current Notification number"),yl.log("Current Notification",t);const n=parseInt(yield fl.storage.get("firebaseNotification")),i=n+1;if(void 0===n||Number.isNaN(n))return void fl.storage.set("firebaseNotification",t);if(t<i)return void yl.log("No new notifications");const s=`https://kissanimelist.firebaseio.com/Data2/Notification/list/N${i}.json`,r=yield fl.request.xhr("GET",s);if(!r)return;const a=JSON.parse(r.responseText);if(!a)return yl.info("Notification empty",r.responseText),void fl.storage.set("firebaseNotification",i).then((function(){wl()}));gl.$(document).ready((function(){const e=vl.flashm(`<div style="text-align: left;">${a}</div><button class="okChangelog" style="background-color: transparent; border: none; color: rgb(255,64,129);margin-top: 10px;cursor: pointer;">Close</button>`,{permanent:!0,position:"top"});e.find(".okChangelog").click((function(){e.remove(),fl.storage.set("firebaseNotification",i).then((function(){wl()}))}))}))}))}var kl=n(58339),Sl=n(9e4);function El(e){kl.settings.get("floatButtonCorrection")?(Sl.log("Open correction"),e.openCorrectionUi()):(Sl.log("Open miniMAL"),function(e){const t=xl(kl.settings.get("miniMalWidth"),window.screen.width),n=xl(kl.settings.get("miniMalHeight"),window.screen.height);let i;i="right"===kl.settings.get("posLeft")?window.screen.width-t:"left"===kl.settings.get("posLeft")?1:0,chrome.runtime.sendMessage({name:"minimalWindow",height:n,width:t,left:i},(function(e){Sl.log("Opened")}))}())}function xl(e,t){if(/^\d+px$/i.test(e))return parseInt(e.replace(/px/i,""));if(/^\d+%$/i.test(e)){const n=parseInt(e.replace(/%/i,""));return parseInt(""+t*(n/100))}return NaN}var Il=n(9e4),Tl=n(58339),$l=n(19947),Nl=function(e,t,n,i){return new(n||(n=Promise))((function(s,r){function a(e){try{l(i.next(e))}catch(e){r(e)}}function o(e){try{l(i.throw(e))}catch(e){r(e)}}function l(e){e.done?s(e.value):function(e){return e instanceof n?e:new n((function(t){t(e)}))}(e.value).then(a,o)}l((i=i.apply(e,t||[])).next())}))};let Ol,Ll;if(void 0!==n.g.doubleLoad&&n.g.doubleLoad)throw Il.error("Double Execution"),"Double Execution";n.g.doubleLoad=!0,console.log("%cMAL-Sync","font-size: 40px; padding-bottom: 3px; color: white; text-shadow: -1px -1px #2e51a2, 1px -1px #2e51a2, -1px 1px #2e51a2, 1px 1px #2e51a2, 2px 2px #2e51a2, 3px 3px #2e51a2;",`Version: ${Tl.storage.version()}`),Tl.settings.init().then((()=>{!function(){if(Tl.settings.get("userscriptModeButton"))throw"Userscript mode";const e=new ml(window.location.href,_Page,El);!function(e){var t;chrome.runtime.onMessage.addListener((function(t,n,i){if("TabMalUrl"===t.action&&Date.now()-Ol<3e3&&(Il.log("TabMalUrl Message",e.singleObj.url),i({url:e.singleObj.url,title:e.singleObj.getTitle(),image:e.singleObj.getImage()})),"videoTime"===t.action&&(e.setVideoTime(t.item,(function(e){chrome.runtime.sendMessage({name:"videoTimeSet",time:e,sender:t.sender})})),Ll=function(e){return Nl(this,void 0,void 0,(function*(){chrome.runtime.sendMessage({name:"videoTimeSet",timeAdd:e,sender:t.sender})}))}),"videoTimeSet"===t.action){if(Il.log("[Iframe] Set Time",t),void 0===e.tempPlayer)return void Il.error("[Iframe] No player Found");if(void 0!==t.time)return e.tempPlayer.play(),void(e.tempPlayer.currentTime=t.time);if(void 0!==t.timeAdd)return e.tempPlayer.play(),void(e.tempPlayer.currentTime+=t.timeAdd)}if("content"===t.action)switch(t.item.action){case"nextEpShort":e.openNextEp();break;case"correctionShort":e.openCorrectionUi();break;case"syncShort":$l.$("#malSyncProgress").addClass("ms-done"),$l.$(".flash.type-update .sync").click()}})),Ft=t=t=>{switch(Il.log("[content] Shortcut",t),t.shortcut){case"introSkipFwd":n(!0);break;case"introSkipBwd":n(!1);break;case"nextEpShort":e.openNextEp();break;case"correctionShort":e.openCorrectionUi();break;case"syncShort":$l.$("#malSyncProgress").addClass("ms-done"),$l.$(".flash.type-update .sync").click()}function n(t){return Nl(this,void 0,void 0,(function*(){if(void 0===e.tempPlayer)return Ll?void Ll(t):void Il.error("[content] No iframe and onsite player found");let n=parseInt(yield Tl.settings.getAsync("introSkip"));t||(n=0-n);const i=e.tempPlayer.currentTime+n;e.tempPlayer.duration&&e.tempPlayer.duration>15&&i>e.tempPlayer.duration-3?e.tempPlayer.currentTime=e.tempPlayer.duration-3:e.tempPlayer.currentTime=i}))}},Vt||function(){Vt=!0;let e={};function n(n){const s=(n=n||event).which||n.keyCode;e[s]="keydown"===n.type;for(let e=0;e<zt.length;e++){const t=zt[e];i(t)&&(n.target instanceof Node&&(/textarea|input|select/i.test(n.target.nodeName)||n.target instanceof Element&&n.target.shadowRoot)?At.info("Input field. Shortcut suppressed."):r(t))}function r(n){return e={},t({shortcut:n}),!1}}function i(t){const n=Pt.settings.get(t);if(!n.length)return!1;let i=!0;return n.forEach((function(t){e[t]||(i=!1)})),i&&Object.values(e).filter((e=>e)).length!==n.length&&(i=!1),i}document.addEventListener("keydown",n),document.addEventListener("keyup",n),window.addEventListener("focus",(function(){e={}}),!1)}()}(e),e.init(),_l(),$(window).blur((function(){Ol=Date.now()}))}()}))})()})();
//# sourceMappingURL=content-script.js.map