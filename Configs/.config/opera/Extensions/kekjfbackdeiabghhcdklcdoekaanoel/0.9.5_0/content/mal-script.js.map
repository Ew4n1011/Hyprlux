{"version":3,"file":"content/mal-script.js","mappings":"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","sources":["webpack://MALSync/./node_modules/@vue/reactivity/dist/reactivity.esm-bundler.js","webpack://MALSync/./node_modules/@vue/shared/dist/shared.esm-bundler.js","webpack://MALSync/./node_modules/dompurify/dist/purify.js","webpack://MALSync/./node_modules/eventemitter2/lib/eventemitter2.js","webpack://MALSync/./src/api/storage/webextension.ts","webpack://MALSync/./src/api/request/requestWebextension.ts","webpack://MALSync/./src/api/settings.ts","webpack://MALSync/./src/api/webextension.ts","webpack://MALSync/./src/utils/console.ts","webpack://MALSync/./src/utils/general.ts","webpack://MALSync/./src/utils/j.ts","webpack://MALSync/webpack/bootstrap","webpack://MALSync/webpack/runtime/compat get default export","webpack://MALSync/webpack/runtime/define property getters","webpack://MALSync/webpack/runtime/global","webpack://MALSync/webpack/runtime/hasOwnProperty shorthand","webpack://MALSync/webpack/runtime/make namespace object","webpack://MALSync/./src/_provider/definitions.ts","webpack://MALSync/./src/utils/localStore.ts","webpack://MALSync/./src/utils/Cache.ts","webpack://MALSync/./src/utils/emitter.ts","webpack://MALSync/./src/_provider/Errors.ts","webpack://MALSync/./src/_provider/listAbstract.ts","webpack://MALSync/./src/_provider/MyAnimeList_api/helper.ts","webpack://MALSync/./src/_provider/MyAnimeList_hybrid/list.ts","webpack://MALSync/./src/_provider/MyAnimeList_api/list.ts","webpack://MALSync/./src/_provider/AniList/helper.ts","webpack://MALSync/./src/_provider/Shikimori/helper.ts","webpack://MALSync/./src/_provider/Kitsu/helper.ts","webpack://MALSync/./src/background/releaseProgress.ts","webpack://MALSync/./src/utils/time.ts","webpack://MALSync/./src/utils/progress.ts","webpack://MALSync/./src/utils/errors.ts","webpack://MALSync/./src/_provider/ScoreMode/point10.ts","webpack://MALSync/./src/_provider/singleAbstract.ts","webpack://MALSync/./src/_provider/MyAnimeList_hybrid/single.ts","webpack://MALSync/./src/_provider/MyAnimeList_api/single.ts","webpack://MALSync/./src/_provider/MyAnimeList_legacy/list.ts","webpack://MALSync/./src/utils/quicklinksBuilder.ts","webpack://MALSync/./src/myanimelist/myanimelistClass.ts","webpack://MALSync/./src/utils/firebaseNotification.ts","webpack://MALSync/./src/index-webextension/myanimelist.ts"],"sourcesContent":["import { extend, isArray, isMap, isIntegerKey, hasOwn, isSymbol, isObject, hasChanged, makeMap, capitalize, toRawType, def, isFunction, NOOP } from '@vue/shared';\n\nfunction warn(msg, ...args) {\n  console.warn(`[Vue warn] ${msg}`, ...args);\n}\n\nlet activeEffectScope;\nclass EffectScope {\n  constructor(detached = false) {\n    this.detached = detached;\n    /**\n     * @internal\n     */\n    this._active = true;\n    /**\n     * @internal\n     */\n    this.effects = [];\n    /**\n     * @internal\n     */\n    this.cleanups = [];\n    this.parent = activeEffectScope;\n    if (!detached && activeEffectScope) {\n      this.index = (activeEffectScope.scopes || (activeEffectScope.scopes = [])).push(\n        this\n      ) - 1;\n    }\n  }\n  get active() {\n    return this._active;\n  }\n  run(fn) {\n    if (this._active) {\n      const currentEffectScope = activeEffectScope;\n      try {\n        activeEffectScope = this;\n        return fn();\n      } finally {\n        activeEffectScope = currentEffectScope;\n      }\n    } else if (!!(process.env.NODE_ENV !== \"production\")) {\n      warn(`cannot run an inactive effect scope.`);\n    }\n  }\n  /**\n   * This should only be called on non-detached scopes\n   * @internal\n   */\n  on() {\n    activeEffectScope = this;\n  }\n  /**\n   * This should only be called on non-detached scopes\n   * @internal\n   */\n  off() {\n    activeEffectScope = this.parent;\n  }\n  stop(fromParent) {\n    if (this._active) {\n      let i, l;\n      for (i = 0, l = this.effects.length; i < l; i++) {\n        this.effects[i].stop();\n      }\n      for (i = 0, l = this.cleanups.length; i < l; i++) {\n        this.cleanups[i]();\n      }\n      if (this.scopes) {\n        for (i = 0, l = this.scopes.length; i < l; i++) {\n          this.scopes[i].stop(true);\n        }\n      }\n      if (!this.detached && this.parent && !fromParent) {\n        const last = this.parent.scopes.pop();\n        if (last && last !== this) {\n          this.parent.scopes[this.index] = last;\n          last.index = this.index;\n        }\n      }\n      this.parent = void 0;\n      this._active = false;\n    }\n  }\n}\nfunction effectScope(detached) {\n  return new EffectScope(detached);\n}\nfunction recordEffectScope(effect, scope = activeEffectScope) {\n  if (scope && scope.active) {\n    scope.effects.push(effect);\n  }\n}\nfunction getCurrentScope() {\n  return activeEffectScope;\n}\nfunction onScopeDispose(fn) {\n  if (activeEffectScope) {\n    activeEffectScope.cleanups.push(fn);\n  } else if (!!(process.env.NODE_ENV !== \"production\")) {\n    warn(\n      `onScopeDispose() is called when there is no active effect scope to be associated with.`\n    );\n  }\n}\n\nconst createDep = (effects) => {\n  const dep = new Set(effects);\n  dep.w = 0;\n  dep.n = 0;\n  return dep;\n};\nconst wasTracked = (dep) => (dep.w & trackOpBit) > 0;\nconst newTracked = (dep) => (dep.n & trackOpBit) > 0;\nconst initDepMarkers = ({ deps }) => {\n  if (deps.length) {\n    for (let i = 0; i < deps.length; i++) {\n      deps[i].w |= trackOpBit;\n    }\n  }\n};\nconst finalizeDepMarkers = (effect) => {\n  const { deps } = effect;\n  if (deps.length) {\n    let ptr = 0;\n    for (let i = 0; i < deps.length; i++) {\n      const dep = deps[i];\n      if (wasTracked(dep) && !newTracked(dep)) {\n        dep.delete(effect);\n      } else {\n        deps[ptr++] = dep;\n      }\n      dep.w &= ~trackOpBit;\n      dep.n &= ~trackOpBit;\n    }\n    deps.length = ptr;\n  }\n};\n\nconst targetMap = /* @__PURE__ */ new WeakMap();\nlet effectTrackDepth = 0;\nlet trackOpBit = 1;\nconst maxMarkerBits = 30;\nlet activeEffect;\nconst ITERATE_KEY = Symbol(!!(process.env.NODE_ENV !== \"production\") ? \"iterate\" : \"\");\nconst MAP_KEY_ITERATE_KEY = Symbol(!!(process.env.NODE_ENV !== \"production\") ? \"Map key iterate\" : \"\");\nclass ReactiveEffect {\n  constructor(fn, scheduler = null, scope) {\n    this.fn = fn;\n    this.scheduler = scheduler;\n    this.active = true;\n    this.deps = [];\n    this.parent = void 0;\n    recordEffectScope(this, scope);\n  }\n  run() {\n    if (!this.active) {\n      return this.fn();\n    }\n    let parent = activeEffect;\n    let lastShouldTrack = shouldTrack;\n    while (parent) {\n      if (parent === this) {\n        return;\n      }\n      parent = parent.parent;\n    }\n    try {\n      this.parent = activeEffect;\n      activeEffect = this;\n      shouldTrack = true;\n      trackOpBit = 1 << ++effectTrackDepth;\n      if (effectTrackDepth <= maxMarkerBits) {\n        initDepMarkers(this);\n      } else {\n        cleanupEffect(this);\n      }\n      return this.fn();\n    } finally {\n      if (effectTrackDepth <= maxMarkerBits) {\n        finalizeDepMarkers(this);\n      }\n      trackOpBit = 1 << --effectTrackDepth;\n      activeEffect = this.parent;\n      shouldTrack = lastShouldTrack;\n      this.parent = void 0;\n      if (this.deferStop) {\n        this.stop();\n      }\n    }\n  }\n  stop() {\n    if (activeEffect === this) {\n      this.deferStop = true;\n    } else if (this.active) {\n      cleanupEffect(this);\n      if (this.onStop) {\n        this.onStop();\n      }\n      this.active = false;\n    }\n  }\n}\nfunction cleanupEffect(effect2) {\n  const { deps } = effect2;\n  if (deps.length) {\n    for (let i = 0; i < deps.length; i++) {\n      deps[i].delete(effect2);\n    }\n    deps.length = 0;\n  }\n}\nfunction effect(fn, options) {\n  if (fn.effect) {\n    fn = fn.effect.fn;\n  }\n  const _effect = new ReactiveEffect(fn);\n  if (options) {\n    extend(_effect, options);\n    if (options.scope)\n      recordEffectScope(_effect, options.scope);\n  }\n  if (!options || !options.lazy) {\n    _effect.run();\n  }\n  const runner = _effect.run.bind(_effect);\n  runner.effect = _effect;\n  return runner;\n}\nfunction stop(runner) {\n  runner.effect.stop();\n}\nlet shouldTrack = true;\nconst trackStack = [];\nfunction pauseTracking() {\n  trackStack.push(shouldTrack);\n  shouldTrack = false;\n}\nfunction enableTracking() {\n  trackStack.push(shouldTrack);\n  shouldTrack = true;\n}\nfunction resetTracking() {\n  const last = trackStack.pop();\n  shouldTrack = last === void 0 ? true : last;\n}\nfunction track(target, type, key) {\n  if (shouldTrack && activeEffect) {\n    let depsMap = targetMap.get(target);\n    if (!depsMap) {\n      targetMap.set(target, depsMap = /* @__PURE__ */ new Map());\n    }\n    let dep = depsMap.get(key);\n    if (!dep) {\n      depsMap.set(key, dep = createDep());\n    }\n    const eventInfo = !!(process.env.NODE_ENV !== \"production\") ? { effect: activeEffect, target, type, key } : void 0;\n    trackEffects(dep, eventInfo);\n  }\n}\nfunction trackEffects(dep, debuggerEventExtraInfo) {\n  let shouldTrack2 = false;\n  if (effectTrackDepth <= maxMarkerBits) {\n    if (!newTracked(dep)) {\n      dep.n |= trackOpBit;\n      shouldTrack2 = !wasTracked(dep);\n    }\n  } else {\n    shouldTrack2 = !dep.has(activeEffect);\n  }\n  if (shouldTrack2) {\n    dep.add(activeEffect);\n    activeEffect.deps.push(dep);\n    if (!!(process.env.NODE_ENV !== \"production\") && activeEffect.onTrack) {\n      activeEffect.onTrack(\n        extend(\n          {\n            effect: activeEffect\n          },\n          debuggerEventExtraInfo\n        )\n      );\n    }\n  }\n}\nfunction trigger(target, type, key, newValue, oldValue, oldTarget) {\n  const depsMap = targetMap.get(target);\n  if (!depsMap) {\n    return;\n  }\n  let deps = [];\n  if (type === \"clear\") {\n    deps = [...depsMap.values()];\n  } else if (key === \"length\" && isArray(target)) {\n    const newLength = Number(newValue);\n    depsMap.forEach((dep, key2) => {\n      if (key2 === \"length\" || key2 >= newLength) {\n        deps.push(dep);\n      }\n    });\n  } else {\n    if (key !== void 0) {\n      deps.push(depsMap.get(key));\n    }\n    switch (type) {\n      case \"add\":\n        if (!isArray(target)) {\n          deps.push(depsMap.get(ITERATE_KEY));\n          if (isMap(target)) {\n            deps.push(depsMap.get(MAP_KEY_ITERATE_KEY));\n          }\n        } else if (isIntegerKey(key)) {\n          deps.push(depsMap.get(\"length\"));\n        }\n        break;\n      case \"delete\":\n        if (!isArray(target)) {\n          deps.push(depsMap.get(ITERATE_KEY));\n          if (isMap(target)) {\n            deps.push(depsMap.get(MAP_KEY_ITERATE_KEY));\n          }\n        }\n        break;\n      case \"set\":\n        if (isMap(target)) {\n          deps.push(depsMap.get(ITERATE_KEY));\n        }\n        break;\n    }\n  }\n  const eventInfo = !!(process.env.NODE_ENV !== \"production\") ? { target, type, key, newValue, oldValue, oldTarget } : void 0;\n  if (deps.length === 1) {\n    if (deps[0]) {\n      if (!!(process.env.NODE_ENV !== \"production\")) {\n        triggerEffects(deps[0], eventInfo);\n      } else {\n        triggerEffects(deps[0]);\n      }\n    }\n  } else {\n    const effects = [];\n    for (const dep of deps) {\n      if (dep) {\n        effects.push(...dep);\n      }\n    }\n    if (!!(process.env.NODE_ENV !== \"production\")) {\n      triggerEffects(createDep(effects), eventInfo);\n    } else {\n      triggerEffects(createDep(effects));\n    }\n  }\n}\nfunction triggerEffects(dep, debuggerEventExtraInfo) {\n  const effects = isArray(dep) ? dep : [...dep];\n  for (const effect2 of effects) {\n    if (effect2.computed) {\n      triggerEffect(effect2, debuggerEventExtraInfo);\n    }\n  }\n  for (const effect2 of effects) {\n    if (!effect2.computed) {\n      triggerEffect(effect2, debuggerEventExtraInfo);\n    }\n  }\n}\nfunction triggerEffect(effect2, debuggerEventExtraInfo) {\n  if (effect2 !== activeEffect || effect2.allowRecurse) {\n    if (!!(process.env.NODE_ENV !== \"production\") && effect2.onTrigger) {\n      effect2.onTrigger(extend({ effect: effect2 }, debuggerEventExtraInfo));\n    }\n    if (effect2.scheduler) {\n      effect2.scheduler();\n    } else {\n      effect2.run();\n    }\n  }\n}\nfunction getDepFromReactive(object, key) {\n  var _a;\n  return (_a = targetMap.get(object)) == null ? void 0 : _a.get(key);\n}\n\nconst isNonTrackableKeys = /* @__PURE__ */ makeMap(`__proto__,__v_isRef,__isVue`);\nconst builtInSymbols = new Set(\n  /* @__PURE__ */ Object.getOwnPropertyNames(Symbol).filter((key) => key !== \"arguments\" && key !== \"caller\").map((key) => Symbol[key]).filter(isSymbol)\n);\nconst get$1 = /* @__PURE__ */ createGetter();\nconst shallowGet = /* @__PURE__ */ createGetter(false, true);\nconst readonlyGet = /* @__PURE__ */ createGetter(true);\nconst shallowReadonlyGet = /* @__PURE__ */ createGetter(true, true);\nconst arrayInstrumentations = /* @__PURE__ */ createArrayInstrumentations();\nfunction createArrayInstrumentations() {\n  const instrumentations = {};\n  [\"includes\", \"indexOf\", \"lastIndexOf\"].forEach((key) => {\n    instrumentations[key] = function(...args) {\n      const arr = toRaw(this);\n      for (let i = 0, l = this.length; i < l; i++) {\n        track(arr, \"get\", i + \"\");\n      }\n      const res = arr[key](...args);\n      if (res === -1 || res === false) {\n        return arr[key](...args.map(toRaw));\n      } else {\n        return res;\n      }\n    };\n  });\n  [\"push\", \"pop\", \"shift\", \"unshift\", \"splice\"].forEach((key) => {\n    instrumentations[key] = function(...args) {\n      pauseTracking();\n      const res = toRaw(this)[key].apply(this, args);\n      resetTracking();\n      return res;\n    };\n  });\n  return instrumentations;\n}\nfunction hasOwnProperty(key) {\n  const obj = toRaw(this);\n  track(obj, \"has\", key);\n  return obj.hasOwnProperty(key);\n}\nfunction createGetter(isReadonly2 = false, shallow = false) {\n  return function get2(target, key, receiver) {\n    if (key === \"__v_isReactive\") {\n      return !isReadonly2;\n    } else if (key === \"__v_isReadonly\") {\n      return isReadonly2;\n    } else if (key === \"__v_isShallow\") {\n      return shallow;\n    } else if (key === \"__v_raw\" && receiver === (isReadonly2 ? shallow ? shallowReadonlyMap : readonlyMap : shallow ? shallowReactiveMap : reactiveMap).get(target)) {\n      return target;\n    }\n    const targetIsArray = isArray(target);\n    if (!isReadonly2) {\n      if (targetIsArray && hasOwn(arrayInstrumentations, key)) {\n        return Reflect.get(arrayInstrumentations, key, receiver);\n      }\n      if (key === \"hasOwnProperty\") {\n        return hasOwnProperty;\n      }\n    }\n    const res = Reflect.get(target, key, receiver);\n    if (isSymbol(key) ? builtInSymbols.has(key) : isNonTrackableKeys(key)) {\n      return res;\n    }\n    if (!isReadonly2) {\n      track(target, \"get\", key);\n    }\n    if (shallow) {\n      return res;\n    }\n    if (isRef(res)) {\n      return targetIsArray && isIntegerKey(key) ? res : res.value;\n    }\n    if (isObject(res)) {\n      return isReadonly2 ? readonly(res) : reactive(res);\n    }\n    return res;\n  };\n}\nconst set$1 = /* @__PURE__ */ createSetter();\nconst shallowSet = /* @__PURE__ */ createSetter(true);\nfunction createSetter(shallow = false) {\n  return function set2(target, key, value, receiver) {\n    let oldValue = target[key];\n    if (isReadonly(oldValue) && isRef(oldValue) && !isRef(value)) {\n      return false;\n    }\n    if (!shallow) {\n      if (!isShallow(value) && !isReadonly(value)) {\n        oldValue = toRaw(oldValue);\n        value = toRaw(value);\n      }\n      if (!isArray(target) && isRef(oldValue) && !isRef(value)) {\n        oldValue.value = value;\n        return true;\n      }\n    }\n    const hadKey = isArray(target) && isIntegerKey(key) ? Number(key) < target.length : hasOwn(target, key);\n    const result = Reflect.set(target, key, value, receiver);\n    if (target === toRaw(receiver)) {\n      if (!hadKey) {\n        trigger(target, \"add\", key, value);\n      } else if (hasChanged(value, oldValue)) {\n        trigger(target, \"set\", key, value, oldValue);\n      }\n    }\n    return result;\n  };\n}\nfunction deleteProperty(target, key) {\n  const hadKey = hasOwn(target, key);\n  const oldValue = target[key];\n  const result = Reflect.deleteProperty(target, key);\n  if (result && hadKey) {\n    trigger(target, \"delete\", key, void 0, oldValue);\n  }\n  return result;\n}\nfunction has$1(target, key) {\n  const result = Reflect.has(target, key);\n  if (!isSymbol(key) || !builtInSymbols.has(key)) {\n    track(target, \"has\", key);\n  }\n  return result;\n}\nfunction ownKeys(target) {\n  track(target, \"iterate\", isArray(target) ? \"length\" : ITERATE_KEY);\n  return Reflect.ownKeys(target);\n}\nconst mutableHandlers = {\n  get: get$1,\n  set: set$1,\n  deleteProperty,\n  has: has$1,\n  ownKeys\n};\nconst readonlyHandlers = {\n  get: readonlyGet,\n  set(target, key) {\n    if (!!(process.env.NODE_ENV !== \"production\")) {\n      warn(\n        `Set operation on key \"${String(key)}\" failed: target is readonly.`,\n        target\n      );\n    }\n    return true;\n  },\n  deleteProperty(target, key) {\n    if (!!(process.env.NODE_ENV !== \"production\")) {\n      warn(\n        `Delete operation on key \"${String(key)}\" failed: target is readonly.`,\n        target\n      );\n    }\n    return true;\n  }\n};\nconst shallowReactiveHandlers = /* @__PURE__ */ extend(\n  {},\n  mutableHandlers,\n  {\n    get: shallowGet,\n    set: shallowSet\n  }\n);\nconst shallowReadonlyHandlers = /* @__PURE__ */ extend(\n  {},\n  readonlyHandlers,\n  {\n    get: shallowReadonlyGet\n  }\n);\n\nconst toShallow = (value) => value;\nconst getProto = (v) => Reflect.getPrototypeOf(v);\nfunction get(target, key, isReadonly = false, isShallow = false) {\n  target = target[\"__v_raw\"];\n  const rawTarget = toRaw(target);\n  const rawKey = toRaw(key);\n  if (!isReadonly) {\n    if (key !== rawKey) {\n      track(rawTarget, \"get\", key);\n    }\n    track(rawTarget, \"get\", rawKey);\n  }\n  const { has: has2 } = getProto(rawTarget);\n  const wrap = isShallow ? toShallow : isReadonly ? toReadonly : toReactive;\n  if (has2.call(rawTarget, key)) {\n    return wrap(target.get(key));\n  } else if (has2.call(rawTarget, rawKey)) {\n    return wrap(target.get(rawKey));\n  } else if (target !== rawTarget) {\n    target.get(key);\n  }\n}\nfunction has(key, isReadonly = false) {\n  const target = this[\"__v_raw\"];\n  const rawTarget = toRaw(target);\n  const rawKey = toRaw(key);\n  if (!isReadonly) {\n    if (key !== rawKey) {\n      track(rawTarget, \"has\", key);\n    }\n    track(rawTarget, \"has\", rawKey);\n  }\n  return key === rawKey ? target.has(key) : target.has(key) || target.has(rawKey);\n}\nfunction size(target, isReadonly = false) {\n  target = target[\"__v_raw\"];\n  !isReadonly && track(toRaw(target), \"iterate\", ITERATE_KEY);\n  return Reflect.get(target, \"size\", target);\n}\nfunction add(value) {\n  value = toRaw(value);\n  const target = toRaw(this);\n  const proto = getProto(target);\n  const hadKey = proto.has.call(target, value);\n  if (!hadKey) {\n    target.add(value);\n    trigger(target, \"add\", value, value);\n  }\n  return this;\n}\nfunction set(key, value) {\n  value = toRaw(value);\n  const target = toRaw(this);\n  const { has: has2, get: get2 } = getProto(target);\n  let hadKey = has2.call(target, key);\n  if (!hadKey) {\n    key = toRaw(key);\n    hadKey = has2.call(target, key);\n  } else if (!!(process.env.NODE_ENV !== \"production\")) {\n    checkIdentityKeys(target, has2, key);\n  }\n  const oldValue = get2.call(target, key);\n  target.set(key, value);\n  if (!hadKey) {\n    trigger(target, \"add\", key, value);\n  } else if (hasChanged(value, oldValue)) {\n    trigger(target, \"set\", key, value, oldValue);\n  }\n  return this;\n}\nfunction deleteEntry(key) {\n  const target = toRaw(this);\n  const { has: has2, get: get2 } = getProto(target);\n  let hadKey = has2.call(target, key);\n  if (!hadKey) {\n    key = toRaw(key);\n    hadKey = has2.call(target, key);\n  } else if (!!(process.env.NODE_ENV !== \"production\")) {\n    checkIdentityKeys(target, has2, key);\n  }\n  const oldValue = get2 ? get2.call(target, key) : void 0;\n  const result = target.delete(key);\n  if (hadKey) {\n    trigger(target, \"delete\", key, void 0, oldValue);\n  }\n  return result;\n}\nfunction clear() {\n  const target = toRaw(this);\n  const hadItems = target.size !== 0;\n  const oldTarget = !!(process.env.NODE_ENV !== \"production\") ? isMap(target) ? new Map(target) : new Set(target) : void 0;\n  const result = target.clear();\n  if (hadItems) {\n    trigger(target, \"clear\", void 0, void 0, oldTarget);\n  }\n  return result;\n}\nfunction createForEach(isReadonly, isShallow) {\n  return function forEach(callback, thisArg) {\n    const observed = this;\n    const target = observed[\"__v_raw\"];\n    const rawTarget = toRaw(target);\n    const wrap = isShallow ? toShallow : isReadonly ? toReadonly : toReactive;\n    !isReadonly && track(rawTarget, \"iterate\", ITERATE_KEY);\n    return target.forEach((value, key) => {\n      return callback.call(thisArg, wrap(value), wrap(key), observed);\n    });\n  };\n}\nfunction createIterableMethod(method, isReadonly, isShallow) {\n  return function(...args) {\n    const target = this[\"__v_raw\"];\n    const rawTarget = toRaw(target);\n    const targetIsMap = isMap(rawTarget);\n    const isPair = method === \"entries\" || method === Symbol.iterator && targetIsMap;\n    const isKeyOnly = method === \"keys\" && targetIsMap;\n    const innerIterator = target[method](...args);\n    const wrap = isShallow ? toShallow : isReadonly ? toReadonly : toReactive;\n    !isReadonly && track(\n      rawTarget,\n      \"iterate\",\n      isKeyOnly ? MAP_KEY_ITERATE_KEY : ITERATE_KEY\n    );\n    return {\n      // iterator protocol\n      next() {\n        const { value, done } = innerIterator.next();\n        return done ? { value, done } : {\n          value: isPair ? [wrap(value[0]), wrap(value[1])] : wrap(value),\n          done\n        };\n      },\n      // iterable protocol\n      [Symbol.iterator]() {\n        return this;\n      }\n    };\n  };\n}\nfunction createReadonlyMethod(type) {\n  return function(...args) {\n    if (!!(process.env.NODE_ENV !== \"production\")) {\n      const key = args[0] ? `on key \"${args[0]}\" ` : ``;\n      console.warn(\n        `${capitalize(type)} operation ${key}failed: target is readonly.`,\n        toRaw(this)\n      );\n    }\n    return type === \"delete\" ? false : this;\n  };\n}\nfunction createInstrumentations() {\n  const mutableInstrumentations2 = {\n    get(key) {\n      return get(this, key);\n    },\n    get size() {\n      return size(this);\n    },\n    has,\n    add,\n    set,\n    delete: deleteEntry,\n    clear,\n    forEach: createForEach(false, false)\n  };\n  const shallowInstrumentations2 = {\n    get(key) {\n      return get(this, key, false, true);\n    },\n    get size() {\n      return size(this);\n    },\n    has,\n    add,\n    set,\n    delete: deleteEntry,\n    clear,\n    forEach: createForEach(false, true)\n  };\n  const readonlyInstrumentations2 = {\n    get(key) {\n      return get(this, key, true);\n    },\n    get size() {\n      return size(this, true);\n    },\n    has(key) {\n      return has.call(this, key, true);\n    },\n    add: createReadonlyMethod(\"add\"),\n    set: createReadonlyMethod(\"set\"),\n    delete: createReadonlyMethod(\"delete\"),\n    clear: createReadonlyMethod(\"clear\"),\n    forEach: createForEach(true, false)\n  };\n  const shallowReadonlyInstrumentations2 = {\n    get(key) {\n      return get(this, key, true, true);\n    },\n    get size() {\n      return size(this, true);\n    },\n    has(key) {\n      return has.call(this, key, true);\n    },\n    add: createReadonlyMethod(\"add\"),\n    set: createReadonlyMethod(\"set\"),\n    delete: createReadonlyMethod(\"delete\"),\n    clear: createReadonlyMethod(\"clear\"),\n    forEach: createForEach(true, true)\n  };\n  const iteratorMethods = [\"keys\", \"values\", \"entries\", Symbol.iterator];\n  iteratorMethods.forEach((method) => {\n    mutableInstrumentations2[method] = createIterableMethod(\n      method,\n      false,\n      false\n    );\n    readonlyInstrumentations2[method] = createIterableMethod(\n      method,\n      true,\n      false\n    );\n    shallowInstrumentations2[method] = createIterableMethod(\n      method,\n      false,\n      true\n    );\n    shallowReadonlyInstrumentations2[method] = createIterableMethod(\n      method,\n      true,\n      true\n    );\n  });\n  return [\n    mutableInstrumentations2,\n    readonlyInstrumentations2,\n    shallowInstrumentations2,\n    shallowReadonlyInstrumentations2\n  ];\n}\nconst [\n  mutableInstrumentations,\n  readonlyInstrumentations,\n  shallowInstrumentations,\n  shallowReadonlyInstrumentations\n] = /* @__PURE__ */ createInstrumentations();\nfunction createInstrumentationGetter(isReadonly, shallow) {\n  const instrumentations = shallow ? isReadonly ? shallowReadonlyInstrumentations : shallowInstrumentations : isReadonly ? readonlyInstrumentations : mutableInstrumentations;\n  return (target, key, receiver) => {\n    if (key === \"__v_isReactive\") {\n      return !isReadonly;\n    } else if (key === \"__v_isReadonly\") {\n      return isReadonly;\n    } else if (key === \"__v_raw\") {\n      return target;\n    }\n    return Reflect.get(\n      hasOwn(instrumentations, key) && key in target ? instrumentations : target,\n      key,\n      receiver\n    );\n  };\n}\nconst mutableCollectionHandlers = {\n  get: /* @__PURE__ */ createInstrumentationGetter(false, false)\n};\nconst shallowCollectionHandlers = {\n  get: /* @__PURE__ */ createInstrumentationGetter(false, true)\n};\nconst readonlyCollectionHandlers = {\n  get: /* @__PURE__ */ createInstrumentationGetter(true, false)\n};\nconst shallowReadonlyCollectionHandlers = {\n  get: /* @__PURE__ */ createInstrumentationGetter(true, true)\n};\nfunction checkIdentityKeys(target, has2, key) {\n  const rawKey = toRaw(key);\n  if (rawKey !== key && has2.call(target, rawKey)) {\n    const type = toRawType(target);\n    console.warn(\n      `Reactive ${type} contains both the raw and reactive versions of the same object${type === `Map` ? ` as keys` : ``}, which can lead to inconsistencies. Avoid differentiating between the raw and reactive versions of an object and only use the reactive version if possible.`\n    );\n  }\n}\n\nconst reactiveMap = /* @__PURE__ */ new WeakMap();\nconst shallowReactiveMap = /* @__PURE__ */ new WeakMap();\nconst readonlyMap = /* @__PURE__ */ new WeakMap();\nconst shallowReadonlyMap = /* @__PURE__ */ new WeakMap();\nfunction targetTypeMap(rawType) {\n  switch (rawType) {\n    case \"Object\":\n    case \"Array\":\n      return 1 /* COMMON */;\n    case \"Map\":\n    case \"Set\":\n    case \"WeakMap\":\n    case \"WeakSet\":\n      return 2 /* COLLECTION */;\n    default:\n      return 0 /* INVALID */;\n  }\n}\nfunction getTargetType(value) {\n  return value[\"__v_skip\"] || !Object.isExtensible(value) ? 0 /* INVALID */ : targetTypeMap(toRawType(value));\n}\nfunction reactive(target) {\n  if (isReadonly(target)) {\n    return target;\n  }\n  return createReactiveObject(\n    target,\n    false,\n    mutableHandlers,\n    mutableCollectionHandlers,\n    reactiveMap\n  );\n}\nfunction shallowReactive(target) {\n  return createReactiveObject(\n    target,\n    false,\n    shallowReactiveHandlers,\n    shallowCollectionHandlers,\n    shallowReactiveMap\n  );\n}\nfunction readonly(target) {\n  return createReactiveObject(\n    target,\n    true,\n    readonlyHandlers,\n    readonlyCollectionHandlers,\n    readonlyMap\n  );\n}\nfunction shallowReadonly(target) {\n  return createReactiveObject(\n    target,\n    true,\n    shallowReadonlyHandlers,\n    shallowReadonlyCollectionHandlers,\n    shallowReadonlyMap\n  );\n}\nfunction createReactiveObject(target, isReadonly2, baseHandlers, collectionHandlers, proxyMap) {\n  if (!isObject(target)) {\n    if (!!(process.env.NODE_ENV !== \"production\")) {\n      console.warn(`value cannot be made reactive: ${String(target)}`);\n    }\n    return target;\n  }\n  if (target[\"__v_raw\"] && !(isReadonly2 && target[\"__v_isReactive\"])) {\n    return target;\n  }\n  const existingProxy = proxyMap.get(target);\n  if (existingProxy) {\n    return existingProxy;\n  }\n  const targetType = getTargetType(target);\n  if (targetType === 0 /* INVALID */) {\n    return target;\n  }\n  const proxy = new Proxy(\n    target,\n    targetType === 2 /* COLLECTION */ ? collectionHandlers : baseHandlers\n  );\n  proxyMap.set(target, proxy);\n  return proxy;\n}\nfunction isReactive(value) {\n  if (isReadonly(value)) {\n    return isReactive(value[\"__v_raw\"]);\n  }\n  return !!(value && value[\"__v_isReactive\"]);\n}\nfunction isReadonly(value) {\n  return !!(value && value[\"__v_isReadonly\"]);\n}\nfunction isShallow(value) {\n  return !!(value && value[\"__v_isShallow\"]);\n}\nfunction isProxy(value) {\n  return isReactive(value) || isReadonly(value);\n}\nfunction toRaw(observed) {\n  const raw = observed && observed[\"__v_raw\"];\n  return raw ? toRaw(raw) : observed;\n}\nfunction markRaw(value) {\n  def(value, \"__v_skip\", true);\n  return value;\n}\nconst toReactive = (value) => isObject(value) ? reactive(value) : value;\nconst toReadonly = (value) => isObject(value) ? readonly(value) : value;\n\nfunction trackRefValue(ref2) {\n  if (shouldTrack && activeEffect) {\n    ref2 = toRaw(ref2);\n    if (!!(process.env.NODE_ENV !== \"production\")) {\n      trackEffects(ref2.dep || (ref2.dep = createDep()), {\n        target: ref2,\n        type: \"get\",\n        key: \"value\"\n      });\n    } else {\n      trackEffects(ref2.dep || (ref2.dep = createDep()));\n    }\n  }\n}\nfunction triggerRefValue(ref2, newVal) {\n  ref2 = toRaw(ref2);\n  const dep = ref2.dep;\n  if (dep) {\n    if (!!(process.env.NODE_ENV !== \"production\")) {\n      triggerEffects(dep, {\n        target: ref2,\n        type: \"set\",\n        key: \"value\",\n        newValue: newVal\n      });\n    } else {\n      triggerEffects(dep);\n    }\n  }\n}\nfunction isRef(r) {\n  return !!(r && r.__v_isRef === true);\n}\nfunction ref(value) {\n  return createRef(value, false);\n}\nfunction shallowRef(value) {\n  return createRef(value, true);\n}\nfunction createRef(rawValue, shallow) {\n  if (isRef(rawValue)) {\n    return rawValue;\n  }\n  return new RefImpl(rawValue, shallow);\n}\nclass RefImpl {\n  constructor(value, __v_isShallow) {\n    this.__v_isShallow = __v_isShallow;\n    this.dep = void 0;\n    this.__v_isRef = true;\n    this._rawValue = __v_isShallow ? value : toRaw(value);\n    this._value = __v_isShallow ? value : toReactive(value);\n  }\n  get value() {\n    trackRefValue(this);\n    return this._value;\n  }\n  set value(newVal) {\n    const useDirectValue = this.__v_isShallow || isShallow(newVal) || isReadonly(newVal);\n    newVal = useDirectValue ? newVal : toRaw(newVal);\n    if (hasChanged(newVal, this._rawValue)) {\n      this._rawValue = newVal;\n      this._value = useDirectValue ? newVal : toReactive(newVal);\n      triggerRefValue(this, newVal);\n    }\n  }\n}\nfunction triggerRef(ref2) {\n  triggerRefValue(ref2, !!(process.env.NODE_ENV !== \"production\") ? ref2.value : void 0);\n}\nfunction unref(ref2) {\n  return isRef(ref2) ? ref2.value : ref2;\n}\nfunction toValue(source) {\n  return isFunction(source) ? source() : unref(source);\n}\nconst shallowUnwrapHandlers = {\n  get: (target, key, receiver) => unref(Reflect.get(target, key, receiver)),\n  set: (target, key, value, receiver) => {\n    const oldValue = target[key];\n    if (isRef(oldValue) && !isRef(value)) {\n      oldValue.value = value;\n      return true;\n    } else {\n      return Reflect.set(target, key, value, receiver);\n    }\n  }\n};\nfunction proxyRefs(objectWithRefs) {\n  return isReactive(objectWithRefs) ? objectWithRefs : new Proxy(objectWithRefs, shallowUnwrapHandlers);\n}\nclass CustomRefImpl {\n  constructor(factory) {\n    this.dep = void 0;\n    this.__v_isRef = true;\n    const { get, set } = factory(\n      () => trackRefValue(this),\n      () => triggerRefValue(this)\n    );\n    this._get = get;\n    this._set = set;\n  }\n  get value() {\n    return this._get();\n  }\n  set value(newVal) {\n    this._set(newVal);\n  }\n}\nfunction customRef(factory) {\n  return new CustomRefImpl(factory);\n}\nfunction toRefs(object) {\n  if (!!(process.env.NODE_ENV !== \"production\") && !isProxy(object)) {\n    console.warn(`toRefs() expects a reactive object but received a plain one.`);\n  }\n  const ret = isArray(object) ? new Array(object.length) : {};\n  for (const key in object) {\n    ret[key] = propertyToRef(object, key);\n  }\n  return ret;\n}\nclass ObjectRefImpl {\n  constructor(_object, _key, _defaultValue) {\n    this._object = _object;\n    this._key = _key;\n    this._defaultValue = _defaultValue;\n    this.__v_isRef = true;\n  }\n  get value() {\n    const val = this._object[this._key];\n    return val === void 0 ? this._defaultValue : val;\n  }\n  set value(newVal) {\n    this._object[this._key] = newVal;\n  }\n  get dep() {\n    return getDepFromReactive(toRaw(this._object), this._key);\n  }\n}\nclass GetterRefImpl {\n  constructor(_getter) {\n    this._getter = _getter;\n    this.__v_isRef = true;\n    this.__v_isReadonly = true;\n  }\n  get value() {\n    return this._getter();\n  }\n}\nfunction toRef(source, key, defaultValue) {\n  if (isRef(source)) {\n    return source;\n  } else if (isFunction(source)) {\n    return new GetterRefImpl(source);\n  } else if (isObject(source) && arguments.length > 1) {\n    return propertyToRef(source, key, defaultValue);\n  } else {\n    return ref(source);\n  }\n}\nfunction propertyToRef(source, key, defaultValue) {\n  const val = source[key];\n  return isRef(val) ? val : new ObjectRefImpl(\n    source,\n    key,\n    defaultValue\n  );\n}\n\nclass ComputedRefImpl {\n  constructor(getter, _setter, isReadonly, isSSR) {\n    this._setter = _setter;\n    this.dep = void 0;\n    this.__v_isRef = true;\n    this[\"__v_isReadonly\"] = false;\n    this._dirty = true;\n    this.effect = new ReactiveEffect(getter, () => {\n      if (!this._dirty) {\n        this._dirty = true;\n        triggerRefValue(this);\n      }\n    });\n    this.effect.computed = this;\n    this.effect.active = this._cacheable = !isSSR;\n    this[\"__v_isReadonly\"] = isReadonly;\n  }\n  get value() {\n    const self = toRaw(this);\n    trackRefValue(self);\n    if (self._dirty || !self._cacheable) {\n      self._dirty = false;\n      self._value = self.effect.run();\n    }\n    return self._value;\n  }\n  set value(newValue) {\n    this._setter(newValue);\n  }\n}\nfunction computed(getterOrOptions, debugOptions, isSSR = false) {\n  let getter;\n  let setter;\n  const onlyGetter = isFunction(getterOrOptions);\n  if (onlyGetter) {\n    getter = getterOrOptions;\n    setter = !!(process.env.NODE_ENV !== \"production\") ? () => {\n      console.warn(\"Write operation failed: computed value is readonly\");\n    } : NOOP;\n  } else {\n    getter = getterOrOptions.get;\n    setter = getterOrOptions.set;\n  }\n  const cRef = new ComputedRefImpl(getter, setter, onlyGetter || !setter, isSSR);\n  if (!!(process.env.NODE_ENV !== \"production\") && debugOptions && !isSSR) {\n    cRef.effect.onTrack = debugOptions.onTrack;\n    cRef.effect.onTrigger = debugOptions.onTrigger;\n  }\n  return cRef;\n}\n\nconst tick = /* @__PURE__ */ Promise.resolve();\nconst queue = [];\nlet queued = false;\nconst scheduler = (fn) => {\n  queue.push(fn);\n  if (!queued) {\n    queued = true;\n    tick.then(flush);\n  }\n};\nconst flush = () => {\n  for (let i = 0; i < queue.length; i++) {\n    queue[i]();\n  }\n  queue.length = 0;\n  queued = false;\n};\nclass DeferredComputedRefImpl {\n  constructor(getter) {\n    this.dep = void 0;\n    this._dirty = true;\n    this.__v_isRef = true;\n    this[\"__v_isReadonly\"] = true;\n    let compareTarget;\n    let hasCompareTarget = false;\n    let scheduled = false;\n    this.effect = new ReactiveEffect(getter, (computedTrigger) => {\n      if (this.dep) {\n        if (computedTrigger) {\n          compareTarget = this._value;\n          hasCompareTarget = true;\n        } else if (!scheduled) {\n          const valueToCompare = hasCompareTarget ? compareTarget : this._value;\n          scheduled = true;\n          hasCompareTarget = false;\n          scheduler(() => {\n            if (this.effect.active && this._get() !== valueToCompare) {\n              triggerRefValue(this);\n            }\n            scheduled = false;\n          });\n        }\n        for (const e of this.dep) {\n          if (e.computed instanceof DeferredComputedRefImpl) {\n            e.scheduler(\n              true\n              /* computedTrigger */\n            );\n          }\n        }\n      }\n      this._dirty = true;\n    });\n    this.effect.computed = this;\n  }\n  _get() {\n    if (this._dirty) {\n      this._dirty = false;\n      return this._value = this.effect.run();\n    }\n    return this._value;\n  }\n  get value() {\n    trackRefValue(this);\n    return toRaw(this)._get();\n  }\n}\nfunction deferredComputed(getter) {\n  return new DeferredComputedRefImpl(getter);\n}\n\nexport { EffectScope, ITERATE_KEY, ReactiveEffect, computed, customRef, deferredComputed, effect, effectScope, enableTracking, getCurrentScope, isProxy, isReactive, isReadonly, isRef, isShallow, markRaw, onScopeDispose, pauseTracking, proxyRefs, reactive, readonly, ref, resetTracking, shallowReactive, shallowReadonly, shallowRef, stop, toRaw, toRef, toRefs, toValue, track, trigger, triggerRef, unref };\n","function makeMap(str, expectsLowerCase) {\n  const map = /* @__PURE__ */ Object.create(null);\n  const list = str.split(\",\");\n  for (let i = 0; i < list.length; i++) {\n    map[list[i]] = true;\n  }\n  return expectsLowerCase ? (val) => !!map[val.toLowerCase()] : (val) => !!map[val];\n}\n\nconst EMPTY_OBJ = !!(process.env.NODE_ENV !== \"production\") ? Object.freeze({}) : {};\nconst EMPTY_ARR = !!(process.env.NODE_ENV !== \"production\") ? Object.freeze([]) : [];\nconst NOOP = () => {\n};\nconst NO = () => false;\nconst onRE = /^on[^a-z]/;\nconst isOn = (key) => onRE.test(key);\nconst isModelListener = (key) => key.startsWith(\"onUpdate:\");\nconst extend = Object.assign;\nconst remove = (arr, el) => {\n  const i = arr.indexOf(el);\n  if (i > -1) {\n    arr.splice(i, 1);\n  }\n};\nconst hasOwnProperty = Object.prototype.hasOwnProperty;\nconst hasOwn = (val, key) => hasOwnProperty.call(val, key);\nconst isArray = Array.isArray;\nconst isMap = (val) => toTypeString(val) === \"[object Map]\";\nconst isSet = (val) => toTypeString(val) === \"[object Set]\";\nconst isDate = (val) => toTypeString(val) === \"[object Date]\";\nconst isRegExp = (val) => toTypeString(val) === \"[object RegExp]\";\nconst isFunction = (val) => typeof val === \"function\";\nconst isString = (val) => typeof val === \"string\";\nconst isSymbol = (val) => typeof val === \"symbol\";\nconst isObject = (val) => val !== null && typeof val === \"object\";\nconst isPromise = (val) => {\n  return isObject(val) && isFunction(val.then) && isFunction(val.catch);\n};\nconst objectToString = Object.prototype.toString;\nconst toTypeString = (value) => objectToString.call(value);\nconst toRawType = (value) => {\n  return toTypeString(value).slice(8, -1);\n};\nconst isPlainObject = (val) => toTypeString(val) === \"[object Object]\";\nconst isIntegerKey = (key) => isString(key) && key !== \"NaN\" && key[0] !== \"-\" && \"\" + parseInt(key, 10) === key;\nconst isReservedProp = /* @__PURE__ */ makeMap(\n  // the leading comma is intentional so empty string \"\" is also included\n  \",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted\"\n);\nconst isBuiltInDirective = /* @__PURE__ */ makeMap(\n  \"bind,cloak,else-if,else,for,html,if,model,on,once,pre,show,slot,text,memo\"\n);\nconst cacheStringFunction = (fn) => {\n  const cache = /* @__PURE__ */ Object.create(null);\n  return (str) => {\n    const hit = cache[str];\n    return hit || (cache[str] = fn(str));\n  };\n};\nconst camelizeRE = /-(\\w)/g;\nconst camelize = cacheStringFunction((str) => {\n  return str.replace(camelizeRE, (_, c) => c ? c.toUpperCase() : \"\");\n});\nconst hyphenateRE = /\\B([A-Z])/g;\nconst hyphenate = cacheStringFunction(\n  (str) => str.replace(hyphenateRE, \"-$1\").toLowerCase()\n);\nconst capitalize = cacheStringFunction(\n  (str) => str.charAt(0).toUpperCase() + str.slice(1)\n);\nconst toHandlerKey = cacheStringFunction(\n  (str) => str ? `on${capitalize(str)}` : ``\n);\nconst hasChanged = (value, oldValue) => !Object.is(value, oldValue);\nconst invokeArrayFns = (fns, arg) => {\n  for (let i = 0; i < fns.length; i++) {\n    fns[i](arg);\n  }\n};\nconst def = (obj, key, value) => {\n  Object.defineProperty(obj, key, {\n    configurable: true,\n    enumerable: false,\n    value\n  });\n};\nconst looseToNumber = (val) => {\n  const n = parseFloat(val);\n  return isNaN(n) ? val : n;\n};\nconst toNumber = (val) => {\n  const n = isString(val) ? Number(val) : NaN;\n  return isNaN(n) ? val : n;\n};\nlet _globalThis;\nconst getGlobalThis = () => {\n  return _globalThis || (_globalThis = typeof globalThis !== \"undefined\" ? globalThis : typeof self !== \"undefined\" ? self : typeof window !== \"undefined\" ? window : typeof global !== \"undefined\" ? global : {});\n};\nconst identRE = /^[_$a-zA-Z\\xA0-\\uFFFF][_$a-zA-Z0-9\\xA0-\\uFFFF]*$/;\nfunction genPropsAccessExp(name) {\n  return identRE.test(name) ? `__props.${name}` : `__props[${JSON.stringify(name)}]`;\n}\n\nconst PatchFlagNames = {\n  [1]: `TEXT`,\n  [2]: `CLASS`,\n  [4]: `STYLE`,\n  [8]: `PROPS`,\n  [16]: `FULL_PROPS`,\n  [32]: `HYDRATE_EVENTS`,\n  [64]: `STABLE_FRAGMENT`,\n  [128]: `KEYED_FRAGMENT`,\n  [256]: `UNKEYED_FRAGMENT`,\n  [512]: `NEED_PATCH`,\n  [1024]: `DYNAMIC_SLOTS`,\n  [2048]: `DEV_ROOT_FRAGMENT`,\n  [-1]: `HOISTED`,\n  [-2]: `BAIL`\n};\n\nconst slotFlagsText = {\n  [1]: \"STABLE\",\n  [2]: \"DYNAMIC\",\n  [3]: \"FORWARDED\"\n};\n\nconst GLOBALS_WHITE_LISTED = \"Infinity,undefined,NaN,isFinite,isNaN,parseFloat,parseInt,decodeURI,decodeURIComponent,encodeURI,encodeURIComponent,Math,Number,Date,Array,Object,Boolean,String,RegExp,Map,Set,JSON,Intl,BigInt,console\";\nconst isGloballyWhitelisted = /* @__PURE__ */ makeMap(GLOBALS_WHITE_LISTED);\n\nconst range = 2;\nfunction generateCodeFrame(source, start = 0, end = source.length) {\n  let lines = source.split(/(\\r?\\n)/);\n  const newlineSequences = lines.filter((_, idx) => idx % 2 === 1);\n  lines = lines.filter((_, idx) => idx % 2 === 0);\n  let count = 0;\n  const res = [];\n  for (let i = 0; i < lines.length; i++) {\n    count += lines[i].length + (newlineSequences[i] && newlineSequences[i].length || 0);\n    if (count >= start) {\n      for (let j = i - range; j <= i + range || end > count; j++) {\n        if (j < 0 || j >= lines.length)\n          continue;\n        const line = j + 1;\n        res.push(\n          `${line}${\" \".repeat(Math.max(3 - String(line).length, 0))}|  ${lines[j]}`\n        );\n        const lineLength = lines[j].length;\n        const newLineSeqLength = newlineSequences[j] && newlineSequences[j].length || 0;\n        if (j === i) {\n          const pad = start - (count - (lineLength + newLineSeqLength));\n          const length = Math.max(\n            1,\n            end > count ? lineLength - pad : end - start\n          );\n          res.push(`   |  ` + \" \".repeat(pad) + \"^\".repeat(length));\n        } else if (j > i) {\n          if (end > count) {\n            const length = Math.max(Math.min(end - count, lineLength), 1);\n            res.push(`   |  ` + \"^\".repeat(length));\n          }\n          count += lineLength + newLineSeqLength;\n        }\n      }\n      break;\n    }\n  }\n  return res.join(\"\\n\");\n}\n\nfunction normalizeStyle(value) {\n  if (isArray(value)) {\n    const res = {};\n    for (let i = 0; i < value.length; i++) {\n      const item = value[i];\n      const normalized = isString(item) ? parseStringStyle(item) : normalizeStyle(item);\n      if (normalized) {\n        for (const key in normalized) {\n          res[key] = normalized[key];\n        }\n      }\n    }\n    return res;\n  } else if (isString(value)) {\n    return value;\n  } else if (isObject(value)) {\n    return value;\n  }\n}\nconst listDelimiterRE = /;(?![^(]*\\))/g;\nconst propertyDelimiterRE = /:([^]+)/;\nconst styleCommentRE = /\\/\\*[^]*?\\*\\//g;\nfunction parseStringStyle(cssText) {\n  const ret = {};\n  cssText.replace(styleCommentRE, \"\").split(listDelimiterRE).forEach((item) => {\n    if (item) {\n      const tmp = item.split(propertyDelimiterRE);\n      tmp.length > 1 && (ret[tmp[0].trim()] = tmp[1].trim());\n    }\n  });\n  return ret;\n}\nfunction stringifyStyle(styles) {\n  let ret = \"\";\n  if (!styles || isString(styles)) {\n    return ret;\n  }\n  for (const key in styles) {\n    const value = styles[key];\n    const normalizedKey = key.startsWith(`--`) ? key : hyphenate(key);\n    if (isString(value) || typeof value === \"number\") {\n      ret += `${normalizedKey}:${value};`;\n    }\n  }\n  return ret;\n}\nfunction normalizeClass(value) {\n  let res = \"\";\n  if (isString(value)) {\n    res = value;\n  } else if (isArray(value)) {\n    for (let i = 0; i < value.length; i++) {\n      const normalized = normalizeClass(value[i]);\n      if (normalized) {\n        res += normalized + \" \";\n      }\n    }\n  } else if (isObject(value)) {\n    for (const name in value) {\n      if (value[name]) {\n        res += name + \" \";\n      }\n    }\n  }\n  return res.trim();\n}\nfunction normalizeProps(props) {\n  if (!props)\n    return null;\n  let { class: klass, style } = props;\n  if (klass && !isString(klass)) {\n    props.class = normalizeClass(klass);\n  }\n  if (style) {\n    props.style = normalizeStyle(style);\n  }\n  return props;\n}\n\nconst HTML_TAGS = \"html,body,base,head,link,meta,style,title,address,article,aside,footer,header,hgroup,h1,h2,h3,h4,h5,h6,nav,section,div,dd,dl,dt,figcaption,figure,picture,hr,img,li,main,ol,p,pre,ul,a,b,abbr,bdi,bdo,br,cite,code,data,dfn,em,i,kbd,mark,q,rp,rt,ruby,s,samp,small,span,strong,sub,sup,time,u,var,wbr,area,audio,map,track,video,embed,object,param,source,canvas,script,noscript,del,ins,caption,col,colgroup,table,thead,tbody,td,th,tr,button,datalist,fieldset,form,input,label,legend,meter,optgroup,option,output,progress,select,textarea,details,dialog,menu,summary,template,blockquote,iframe,tfoot\";\nconst SVG_TAGS = \"svg,animate,animateMotion,animateTransform,circle,clipPath,color-profile,defs,desc,discard,ellipse,feBlend,feColorMatrix,feComponentTransfer,feComposite,feConvolveMatrix,feDiffuseLighting,feDisplacementMap,feDistantLight,feDropShadow,feFlood,feFuncA,feFuncB,feFuncG,feFuncR,feGaussianBlur,feImage,feMerge,feMergeNode,feMorphology,feOffset,fePointLight,feSpecularLighting,feSpotLight,feTile,feTurbulence,filter,foreignObject,g,hatch,hatchpath,image,line,linearGradient,marker,mask,mesh,meshgradient,meshpatch,meshrow,metadata,mpath,path,pattern,polygon,polyline,radialGradient,rect,set,solidcolor,stop,switch,symbol,text,textPath,title,tspan,unknown,use,view\";\nconst VOID_TAGS = \"area,base,br,col,embed,hr,img,input,link,meta,param,source,track,wbr\";\nconst isHTMLTag = /* @__PURE__ */ makeMap(HTML_TAGS);\nconst isSVGTag = /* @__PURE__ */ makeMap(SVG_TAGS);\nconst isVoidTag = /* @__PURE__ */ makeMap(VOID_TAGS);\n\nconst specialBooleanAttrs = `itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly`;\nconst isSpecialBooleanAttr = /* @__PURE__ */ makeMap(specialBooleanAttrs);\nconst isBooleanAttr = /* @__PURE__ */ makeMap(\n  specialBooleanAttrs + `,async,autofocus,autoplay,controls,default,defer,disabled,hidden,inert,loop,open,required,reversed,scoped,seamless,checked,muted,multiple,selected`\n);\nfunction includeBooleanAttr(value) {\n  return !!value || value === \"\";\n}\nconst unsafeAttrCharRE = /[>/=\"'\\u0009\\u000a\\u000c\\u0020]/;\nconst attrValidationCache = {};\nfunction isSSRSafeAttrName(name) {\n  if (attrValidationCache.hasOwnProperty(name)) {\n    return attrValidationCache[name];\n  }\n  const isUnsafe = unsafeAttrCharRE.test(name);\n  if (isUnsafe) {\n    console.error(`unsafe attribute name: ${name}`);\n  }\n  return attrValidationCache[name] = !isUnsafe;\n}\nconst propsToAttrMap = {\n  acceptCharset: \"accept-charset\",\n  className: \"class\",\n  htmlFor: \"for\",\n  httpEquiv: \"http-equiv\"\n};\nconst isKnownHtmlAttr = /* @__PURE__ */ makeMap(\n  `accept,accept-charset,accesskey,action,align,allow,alt,async,autocapitalize,autocomplete,autofocus,autoplay,background,bgcolor,border,buffered,capture,challenge,charset,checked,cite,class,code,codebase,color,cols,colspan,content,contenteditable,contextmenu,controls,coords,crossorigin,csp,data,datetime,decoding,default,defer,dir,dirname,disabled,download,draggable,dropzone,enctype,enterkeyhint,for,form,formaction,formenctype,formmethod,formnovalidate,formtarget,headers,height,hidden,high,href,hreflang,http-equiv,icon,id,importance,inert,integrity,ismap,itemprop,keytype,kind,label,lang,language,loading,list,loop,low,manifest,max,maxlength,minlength,media,min,multiple,muted,name,novalidate,open,optimum,pattern,ping,placeholder,poster,preload,radiogroup,readonly,referrerpolicy,rel,required,reversed,rows,rowspan,sandbox,scope,scoped,selected,shape,size,sizes,slot,span,spellcheck,src,srcdoc,srclang,srcset,start,step,style,summary,tabindex,target,title,translate,type,usemap,value,width,wrap`\n);\nconst isKnownSvgAttr = /* @__PURE__ */ makeMap(\n  `xmlns,accent-height,accumulate,additive,alignment-baseline,alphabetic,amplitude,arabic-form,ascent,attributeName,attributeType,azimuth,baseFrequency,baseline-shift,baseProfile,bbox,begin,bias,by,calcMode,cap-height,class,clip,clipPathUnits,clip-path,clip-rule,color,color-interpolation,color-interpolation-filters,color-profile,color-rendering,contentScriptType,contentStyleType,crossorigin,cursor,cx,cy,d,decelerate,descent,diffuseConstant,direction,display,divisor,dominant-baseline,dur,dx,dy,edgeMode,elevation,enable-background,end,exponent,fill,fill-opacity,fill-rule,filter,filterRes,filterUnits,flood-color,flood-opacity,font-family,font-size,font-size-adjust,font-stretch,font-style,font-variant,font-weight,format,from,fr,fx,fy,g1,g2,glyph-name,glyph-orientation-horizontal,glyph-orientation-vertical,glyphRef,gradientTransform,gradientUnits,hanging,height,href,hreflang,horiz-adv-x,horiz-origin-x,id,ideographic,image-rendering,in,in2,intercept,k,k1,k2,k3,k4,kernelMatrix,kernelUnitLength,kerning,keyPoints,keySplines,keyTimes,lang,lengthAdjust,letter-spacing,lighting-color,limitingConeAngle,local,marker-end,marker-mid,marker-start,markerHeight,markerUnits,markerWidth,mask,maskContentUnits,maskUnits,mathematical,max,media,method,min,mode,name,numOctaves,offset,opacity,operator,order,orient,orientation,origin,overflow,overline-position,overline-thickness,panose-1,paint-order,path,pathLength,patternContentUnits,patternTransform,patternUnits,ping,pointer-events,points,pointsAtX,pointsAtY,pointsAtZ,preserveAlpha,preserveAspectRatio,primitiveUnits,r,radius,referrerPolicy,refX,refY,rel,rendering-intent,repeatCount,repeatDur,requiredExtensions,requiredFeatures,restart,result,rotate,rx,ry,scale,seed,shape-rendering,slope,spacing,specularConstant,specularExponent,speed,spreadMethod,startOffset,stdDeviation,stemh,stemv,stitchTiles,stop-color,stop-opacity,strikethrough-position,strikethrough-thickness,string,stroke,stroke-dasharray,stroke-dashoffset,stroke-linecap,stroke-linejoin,stroke-miterlimit,stroke-opacity,stroke-width,style,surfaceScale,systemLanguage,tabindex,tableValues,target,targetX,targetY,text-anchor,text-decoration,text-rendering,textLength,to,transform,transform-origin,type,u1,u2,underline-position,underline-thickness,unicode,unicode-bidi,unicode-range,units-per-em,v-alphabetic,v-hanging,v-ideographic,v-mathematical,values,vector-effect,version,vert-adv-y,vert-origin-x,vert-origin-y,viewBox,viewTarget,visibility,width,widths,word-spacing,writing-mode,x,x-height,x1,x2,xChannelSelector,xlink:actuate,xlink:arcrole,xlink:href,xlink:role,xlink:show,xlink:title,xlink:type,xml:base,xml:lang,xml:space,y,y1,y2,yChannelSelector,z,zoomAndPan`\n);\n\nconst escapeRE = /[\"'&<>]/;\nfunction escapeHtml(string) {\n  const str = \"\" + string;\n  const match = escapeRE.exec(str);\n  if (!match) {\n    return str;\n  }\n  let html = \"\";\n  let escaped;\n  let index;\n  let lastIndex = 0;\n  for (index = match.index; index < str.length; index++) {\n    switch (str.charCodeAt(index)) {\n      case 34:\n        escaped = \"&quot;\";\n        break;\n      case 38:\n        escaped = \"&amp;\";\n        break;\n      case 39:\n        escaped = \"&#39;\";\n        break;\n      case 60:\n        escaped = \"&lt;\";\n        break;\n      case 62:\n        escaped = \"&gt;\";\n        break;\n      default:\n        continue;\n    }\n    if (lastIndex !== index) {\n      html += str.slice(lastIndex, index);\n    }\n    lastIndex = index + 1;\n    html += escaped;\n  }\n  return lastIndex !== index ? html + str.slice(lastIndex, index) : html;\n}\nconst commentStripRE = /^-?>|<!--|-->|--!>|<!-$/g;\nfunction escapeHtmlComment(src) {\n  return src.replace(commentStripRE, \"\");\n}\n\nfunction looseCompareArrays(a, b) {\n  if (a.length !== b.length)\n    return false;\n  let equal = true;\n  for (let i = 0; equal && i < a.length; i++) {\n    equal = looseEqual(a[i], b[i]);\n  }\n  return equal;\n}\nfunction looseEqual(a, b) {\n  if (a === b)\n    return true;\n  let aValidType = isDate(a);\n  let bValidType = isDate(b);\n  if (aValidType || bValidType) {\n    return aValidType && bValidType ? a.getTime() === b.getTime() : false;\n  }\n  aValidType = isSymbol(a);\n  bValidType = isSymbol(b);\n  if (aValidType || bValidType) {\n    return a === b;\n  }\n  aValidType = isArray(a);\n  bValidType = isArray(b);\n  if (aValidType || bValidType) {\n    return aValidType && bValidType ? looseCompareArrays(a, b) : false;\n  }\n  aValidType = isObject(a);\n  bValidType = isObject(b);\n  if (aValidType || bValidType) {\n    if (!aValidType || !bValidType) {\n      return false;\n    }\n    const aKeysCount = Object.keys(a).length;\n    const bKeysCount = Object.keys(b).length;\n    if (aKeysCount !== bKeysCount) {\n      return false;\n    }\n    for (const key in a) {\n      const aHasKey = a.hasOwnProperty(key);\n      const bHasKey = b.hasOwnProperty(key);\n      if (aHasKey && !bHasKey || !aHasKey && bHasKey || !looseEqual(a[key], b[key])) {\n        return false;\n      }\n    }\n  }\n  return String(a) === String(b);\n}\nfunction looseIndexOf(arr, val) {\n  return arr.findIndex((item) => looseEqual(item, val));\n}\n\nconst toDisplayString = (val) => {\n  return isString(val) ? val : val == null ? \"\" : isArray(val) || isObject(val) && (val.toString === objectToString || !isFunction(val.toString)) ? JSON.stringify(val, replacer, 2) : String(val);\n};\nconst replacer = (_key, val) => {\n  if (val && val.__v_isRef) {\n    return replacer(_key, val.value);\n  } else if (isMap(val)) {\n    return {\n      [`Map(${val.size})`]: [...val.entries()].reduce((entries, [key, val2]) => {\n        entries[`${key} =>`] = val2;\n        return entries;\n      }, {})\n    };\n  } else if (isSet(val)) {\n    return {\n      [`Set(${val.size})`]: [...val.values()]\n    };\n  } else if (isObject(val) && !isArray(val) && !isPlainObject(val)) {\n    return String(val);\n  }\n  return val;\n};\n\nexport { EMPTY_ARR, EMPTY_OBJ, NO, NOOP, PatchFlagNames, camelize, capitalize, def, escapeHtml, escapeHtmlComment, extend, genPropsAccessExp, generateCodeFrame, getGlobalThis, hasChanged, hasOwn, hyphenate, includeBooleanAttr, invokeArrayFns, isArray, isBooleanAttr, isBuiltInDirective, isDate, isFunction, isGloballyWhitelisted, isHTMLTag, isIntegerKey, isKnownHtmlAttr, isKnownSvgAttr, isMap, isModelListener, isObject, isOn, isPlainObject, isPromise, isRegExp, isReservedProp, isSSRSafeAttrName, isSVGTag, isSet, isSpecialBooleanAttr, isString, isSymbol, isVoidTag, looseEqual, looseIndexOf, looseToNumber, makeMap, normalizeClass, normalizeProps, normalizeStyle, objectToString, parseStringStyle, propsToAttrMap, remove, slotFlagsText, stringifyStyle, toDisplayString, toHandlerKey, toNumber, toRawType, toTypeString };\n","/*! @license DOMPurify 3.0.3 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/3.0.3/LICENSE */\n\n(function (global, factory) {\n  typeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory() :\n  typeof define === 'function' && define.amd ? define(factory) :\n  (global = typeof globalThis !== 'undefined' ? globalThis : global || self, global.DOMPurify = factory());\n})(this, (function () { 'use strict';\n\n  const {\n    entries,\n    setPrototypeOf,\n    isFrozen,\n    getPrototypeOf,\n    getOwnPropertyDescriptor\n  } = Object;\n  let {\n    freeze,\n    seal,\n    create\n  } = Object; // eslint-disable-line import/no-mutable-exports\n\n  let {\n    apply,\n    construct\n  } = typeof Reflect !== 'undefined' && Reflect;\n\n  if (!apply) {\n    apply = function apply(fun, thisValue, args) {\n      return fun.apply(thisValue, args);\n    };\n  }\n\n  if (!freeze) {\n    freeze = function freeze(x) {\n      return x;\n    };\n  }\n\n  if (!seal) {\n    seal = function seal(x) {\n      return x;\n    };\n  }\n\n  if (!construct) {\n    construct = function construct(Func, args) {\n      return new Func(...args);\n    };\n  }\n\n  const arrayForEach = unapply(Array.prototype.forEach);\n  const arrayPop = unapply(Array.prototype.pop);\n  const arrayPush = unapply(Array.prototype.push);\n  const stringToLowerCase = unapply(String.prototype.toLowerCase);\n  const stringToString = unapply(String.prototype.toString);\n  const stringMatch = unapply(String.prototype.match);\n  const stringReplace = unapply(String.prototype.replace);\n  const stringIndexOf = unapply(String.prototype.indexOf);\n  const stringTrim = unapply(String.prototype.trim);\n  const regExpTest = unapply(RegExp.prototype.test);\n  const typeErrorCreate = unconstruct(TypeError);\n  function unapply(func) {\n    return function (thisArg) {\n      for (var _len = arguments.length, args = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n        args[_key - 1] = arguments[_key];\n      }\n\n      return apply(func, thisArg, args);\n    };\n  }\n  function unconstruct(func) {\n    return function () {\n      for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n        args[_key2] = arguments[_key2];\n      }\n\n      return construct(func, args);\n    };\n  }\n  /* Add properties to a lookup table */\n\n  function addToSet(set, array, transformCaseFunc) {\n    var _transformCaseFunc;\n\n    transformCaseFunc = (_transformCaseFunc = transformCaseFunc) !== null && _transformCaseFunc !== void 0 ? _transformCaseFunc : stringToLowerCase;\n\n    if (setPrototypeOf) {\n      // Make 'in' and truthy checks like Boolean(set.constructor)\n      // independent of any properties defined on Object.prototype.\n      // Prevent prototype setters from intercepting set as a this value.\n      setPrototypeOf(set, null);\n    }\n\n    let l = array.length;\n\n    while (l--) {\n      let element = array[l];\n\n      if (typeof element === 'string') {\n        const lcElement = transformCaseFunc(element);\n\n        if (lcElement !== element) {\n          // Config presets (e.g. tags.js, attrs.js) are immutable.\n          if (!isFrozen(array)) {\n            array[l] = lcElement;\n          }\n\n          element = lcElement;\n        }\n      }\n\n      set[element] = true;\n    }\n\n    return set;\n  }\n  /* Shallow clone an object */\n\n  function clone(object) {\n    const newObject = create(null);\n\n    for (const [property, value] of entries(object)) {\n      newObject[property] = value;\n    }\n\n    return newObject;\n  }\n  /* This method automatically checks if the prop is function\n   * or getter and behaves accordingly. */\n\n  function lookupGetter(object, prop) {\n    while (object !== null) {\n      const desc = getOwnPropertyDescriptor(object, prop);\n\n      if (desc) {\n        if (desc.get) {\n          return unapply(desc.get);\n        }\n\n        if (typeof desc.value === 'function') {\n          return unapply(desc.value);\n        }\n      }\n\n      object = getPrototypeOf(object);\n    }\n\n    function fallbackValue(element) {\n      console.warn('fallback value for', element);\n      return null;\n    }\n\n    return fallbackValue;\n  }\n\n  const html$1 = freeze(['a', 'abbr', 'acronym', 'address', 'area', 'article', 'aside', 'audio', 'b', 'bdi', 'bdo', 'big', 'blink', 'blockquote', 'body', 'br', 'button', 'canvas', 'caption', 'center', 'cite', 'code', 'col', 'colgroup', 'content', 'data', 'datalist', 'dd', 'decorator', 'del', 'details', 'dfn', 'dialog', 'dir', 'div', 'dl', 'dt', 'element', 'em', 'fieldset', 'figcaption', 'figure', 'font', 'footer', 'form', 'h1', 'h2', 'h3', 'h4', 'h5', 'h6', 'head', 'header', 'hgroup', 'hr', 'html', 'i', 'img', 'input', 'ins', 'kbd', 'label', 'legend', 'li', 'main', 'map', 'mark', 'marquee', 'menu', 'menuitem', 'meter', 'nav', 'nobr', 'ol', 'optgroup', 'option', 'output', 'p', 'picture', 'pre', 'progress', 'q', 'rp', 'rt', 'ruby', 's', 'samp', 'section', 'select', 'shadow', 'small', 'source', 'spacer', 'span', 'strike', 'strong', 'style', 'sub', 'summary', 'sup', 'table', 'tbody', 'td', 'template', 'textarea', 'tfoot', 'th', 'thead', 'time', 'tr', 'track', 'tt', 'u', 'ul', 'var', 'video', 'wbr']); // SVG\n\n  const svg$1 = freeze(['svg', 'a', 'altglyph', 'altglyphdef', 'altglyphitem', 'animatecolor', 'animatemotion', 'animatetransform', 'circle', 'clippath', 'defs', 'desc', 'ellipse', 'filter', 'font', 'g', 'glyph', 'glyphref', 'hkern', 'image', 'line', 'lineargradient', 'marker', 'mask', 'metadata', 'mpath', 'path', 'pattern', 'polygon', 'polyline', 'radialgradient', 'rect', 'stop', 'style', 'switch', 'symbol', 'text', 'textpath', 'title', 'tref', 'tspan', 'view', 'vkern']);\n  const svgFilters = freeze(['feBlend', 'feColorMatrix', 'feComponentTransfer', 'feComposite', 'feConvolveMatrix', 'feDiffuseLighting', 'feDisplacementMap', 'feDistantLight', 'feDropShadow', 'feFlood', 'feFuncA', 'feFuncB', 'feFuncG', 'feFuncR', 'feGaussianBlur', 'feImage', 'feMerge', 'feMergeNode', 'feMorphology', 'feOffset', 'fePointLight', 'feSpecularLighting', 'feSpotLight', 'feTile', 'feTurbulence']); // List of SVG elements that are disallowed by default.\n  // We still need to know them so that we can do namespace\n  // checks properly in case one wants to add them to\n  // allow-list.\n\n  const svgDisallowed = freeze(['animate', 'color-profile', 'cursor', 'discard', 'font-face', 'font-face-format', 'font-face-name', 'font-face-src', 'font-face-uri', 'foreignobject', 'hatch', 'hatchpath', 'mesh', 'meshgradient', 'meshpatch', 'meshrow', 'missing-glyph', 'script', 'set', 'solidcolor', 'unknown', 'use']);\n  const mathMl$1 = freeze(['math', 'menclose', 'merror', 'mfenced', 'mfrac', 'mglyph', 'mi', 'mlabeledtr', 'mmultiscripts', 'mn', 'mo', 'mover', 'mpadded', 'mphantom', 'mroot', 'mrow', 'ms', 'mspace', 'msqrt', 'mstyle', 'msub', 'msup', 'msubsup', 'mtable', 'mtd', 'mtext', 'mtr', 'munder', 'munderover', 'mprescripts']); // Similarly to SVG, we want to know all MathML elements,\n  // even those that we disallow by default.\n\n  const mathMlDisallowed = freeze(['maction', 'maligngroup', 'malignmark', 'mlongdiv', 'mscarries', 'mscarry', 'msgroup', 'mstack', 'msline', 'msrow', 'semantics', 'annotation', 'annotation-xml', 'mprescripts', 'none']);\n  const text = freeze(['#text']);\n\n  const html = freeze(['accept', 'action', 'align', 'alt', 'autocapitalize', 'autocomplete', 'autopictureinpicture', 'autoplay', 'background', 'bgcolor', 'border', 'capture', 'cellpadding', 'cellspacing', 'checked', 'cite', 'class', 'clear', 'color', 'cols', 'colspan', 'controls', 'controlslist', 'coords', 'crossorigin', 'datetime', 'decoding', 'default', 'dir', 'disabled', 'disablepictureinpicture', 'disableremoteplayback', 'download', 'draggable', 'enctype', 'enterkeyhint', 'face', 'for', 'headers', 'height', 'hidden', 'high', 'href', 'hreflang', 'id', 'inputmode', 'integrity', 'ismap', 'kind', 'label', 'lang', 'list', 'loading', 'loop', 'low', 'max', 'maxlength', 'media', 'method', 'min', 'minlength', 'multiple', 'muted', 'name', 'nonce', 'noshade', 'novalidate', 'nowrap', 'open', 'optimum', 'pattern', 'placeholder', 'playsinline', 'poster', 'preload', 'pubdate', 'radiogroup', 'readonly', 'rel', 'required', 'rev', 'reversed', 'role', 'rows', 'rowspan', 'spellcheck', 'scope', 'selected', 'shape', 'size', 'sizes', 'span', 'srclang', 'start', 'src', 'srcset', 'step', 'style', 'summary', 'tabindex', 'title', 'translate', 'type', 'usemap', 'valign', 'value', 'width', 'xmlns', 'slot']);\n  const svg = freeze(['accent-height', 'accumulate', 'additive', 'alignment-baseline', 'ascent', 'attributename', 'attributetype', 'azimuth', 'basefrequency', 'baseline-shift', 'begin', 'bias', 'by', 'class', 'clip', 'clippathunits', 'clip-path', 'clip-rule', 'color', 'color-interpolation', 'color-interpolation-filters', 'color-profile', 'color-rendering', 'cx', 'cy', 'd', 'dx', 'dy', 'diffuseconstant', 'direction', 'display', 'divisor', 'dur', 'edgemode', 'elevation', 'end', 'fill', 'fill-opacity', 'fill-rule', 'filter', 'filterunits', 'flood-color', 'flood-opacity', 'font-family', 'font-size', 'font-size-adjust', 'font-stretch', 'font-style', 'font-variant', 'font-weight', 'fx', 'fy', 'g1', 'g2', 'glyph-name', 'glyphref', 'gradientunits', 'gradienttransform', 'height', 'href', 'id', 'image-rendering', 'in', 'in2', 'k', 'k1', 'k2', 'k3', 'k4', 'kerning', 'keypoints', 'keysplines', 'keytimes', 'lang', 'lengthadjust', 'letter-spacing', 'kernelmatrix', 'kernelunitlength', 'lighting-color', 'local', 'marker-end', 'marker-mid', 'marker-start', 'markerheight', 'markerunits', 'markerwidth', 'maskcontentunits', 'maskunits', 'max', 'mask', 'media', 'method', 'mode', 'min', 'name', 'numoctaves', 'offset', 'operator', 'opacity', 'order', 'orient', 'orientation', 'origin', 'overflow', 'paint-order', 'path', 'pathlength', 'patterncontentunits', 'patterntransform', 'patternunits', 'points', 'preservealpha', 'preserveaspectratio', 'primitiveunits', 'r', 'rx', 'ry', 'radius', 'refx', 'refy', 'repeatcount', 'repeatdur', 'restart', 'result', 'rotate', 'scale', 'seed', 'shape-rendering', 'specularconstant', 'specularexponent', 'spreadmethod', 'startoffset', 'stddeviation', 'stitchtiles', 'stop-color', 'stop-opacity', 'stroke-dasharray', 'stroke-dashoffset', 'stroke-linecap', 'stroke-linejoin', 'stroke-miterlimit', 'stroke-opacity', 'stroke', 'stroke-width', 'style', 'surfacescale', 'systemlanguage', 'tabindex', 'targetx', 'targety', 'transform', 'transform-origin', 'text-anchor', 'text-decoration', 'text-rendering', 'textlength', 'type', 'u1', 'u2', 'unicode', 'values', 'viewbox', 'visibility', 'version', 'vert-adv-y', 'vert-origin-x', 'vert-origin-y', 'width', 'word-spacing', 'wrap', 'writing-mode', 'xchannelselector', 'ychannelselector', 'x', 'x1', 'x2', 'xmlns', 'y', 'y1', 'y2', 'z', 'zoomandpan']);\n  const mathMl = freeze(['accent', 'accentunder', 'align', 'bevelled', 'close', 'columnsalign', 'columnlines', 'columnspan', 'denomalign', 'depth', 'dir', 'display', 'displaystyle', 'encoding', 'fence', 'frame', 'height', 'href', 'id', 'largeop', 'length', 'linethickness', 'lspace', 'lquote', 'mathbackground', 'mathcolor', 'mathsize', 'mathvariant', 'maxsize', 'minsize', 'movablelimits', 'notation', 'numalign', 'open', 'rowalign', 'rowlines', 'rowspacing', 'rowspan', 'rspace', 'rquote', 'scriptlevel', 'scriptminsize', 'scriptsizemultiplier', 'selection', 'separator', 'separators', 'stretchy', 'subscriptshift', 'supscriptshift', 'symmetric', 'voffset', 'width', 'xmlns']);\n  const xml = freeze(['xlink:href', 'xml:id', 'xlink:title', 'xml:space', 'xmlns:xlink']);\n\n  const MUSTACHE_EXPR = seal(/\\{\\{[\\w\\W]*|[\\w\\W]*\\}\\}/gm); // Specify template detection regex for SAFE_FOR_TEMPLATES mode\n\n  const ERB_EXPR = seal(/<%[\\w\\W]*|[\\w\\W]*%>/gm);\n  const TMPLIT_EXPR = seal(/\\${[\\w\\W]*}/gm);\n  const DATA_ATTR = seal(/^data-[\\-\\w.\\u00B7-\\uFFFF]/); // eslint-disable-line no-useless-escape\n\n  const ARIA_ATTR = seal(/^aria-[\\-\\w]+$/); // eslint-disable-line no-useless-escape\n\n  const IS_ALLOWED_URI = seal(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp):|[^a-z]|[a-z+.\\-]+(?:[^a-z+.\\-:]|$))/i // eslint-disable-line no-useless-escape\n  );\n  const IS_SCRIPT_OR_DATA = seal(/^(?:\\w+script|data):/i);\n  const ATTR_WHITESPACE = seal(/[\\u0000-\\u0020\\u00A0\\u1680\\u180E\\u2000-\\u2029\\u205F\\u3000]/g // eslint-disable-line no-control-regex\n  );\n  const DOCTYPE_NAME = seal(/^html$/i);\n\n  var EXPRESSIONS = /*#__PURE__*/Object.freeze({\n    __proto__: null,\n    MUSTACHE_EXPR: MUSTACHE_EXPR,\n    ERB_EXPR: ERB_EXPR,\n    TMPLIT_EXPR: TMPLIT_EXPR,\n    DATA_ATTR: DATA_ATTR,\n    ARIA_ATTR: ARIA_ATTR,\n    IS_ALLOWED_URI: IS_ALLOWED_URI,\n    IS_SCRIPT_OR_DATA: IS_SCRIPT_OR_DATA,\n    ATTR_WHITESPACE: ATTR_WHITESPACE,\n    DOCTYPE_NAME: DOCTYPE_NAME\n  });\n\n  const getGlobal = () => typeof window === 'undefined' ? null : window;\n  /**\n   * Creates a no-op policy for internal use only.\n   * Don't export this function outside this module!\n   * @param {?TrustedTypePolicyFactory} trustedTypes The policy factory.\n   * @param {HTMLScriptElement} purifyHostElement The Script element used to load DOMPurify (to determine policy name suffix).\n   * @return {?TrustedTypePolicy} The policy created (or null, if Trusted Types\n   * are not supported or creating the policy failed).\n   */\n\n\n  const _createTrustedTypesPolicy = function _createTrustedTypesPolicy(trustedTypes, purifyHostElement) {\n    if (typeof trustedTypes !== 'object' || typeof trustedTypes.createPolicy !== 'function') {\n      return null;\n    } // Allow the callers to control the unique policy name\n    // by adding a data-tt-policy-suffix to the script element with the DOMPurify.\n    // Policy creation with duplicate names throws in Trusted Types.\n\n\n    let suffix = null;\n    const ATTR_NAME = 'data-tt-policy-suffix';\n\n    if (purifyHostElement && purifyHostElement.hasAttribute(ATTR_NAME)) {\n      suffix = purifyHostElement.getAttribute(ATTR_NAME);\n    }\n\n    const policyName = 'dompurify' + (suffix ? '#' + suffix : '');\n\n    try {\n      return trustedTypes.createPolicy(policyName, {\n        createHTML(html) {\n          return html;\n        },\n\n        createScriptURL(scriptUrl) {\n          return scriptUrl;\n        }\n\n      });\n    } catch (_) {\n      // Policy creation failed (most likely another DOMPurify script has\n      // already run). Skip creating the policy, as this will only cause errors\n      // if TT are enforced.\n      console.warn('TrustedTypes policy ' + policyName + ' could not be created.');\n      return null;\n    }\n  };\n\n  function createDOMPurify() {\n    let window = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : getGlobal();\n\n    const DOMPurify = root => createDOMPurify(root);\n    /**\n     * Version label, exposed for easier checks\n     * if DOMPurify is up to date or not\n     */\n\n\n    DOMPurify.version = '3.0.3';\n    /**\n     * Array of elements that DOMPurify removed during sanitation.\n     * Empty if nothing was removed.\n     */\n\n    DOMPurify.removed = [];\n\n    if (!window || !window.document || window.document.nodeType !== 9) {\n      // Not running in a browser, provide a factory function\n      // so that you can pass your own Window\n      DOMPurify.isSupported = false;\n      return DOMPurify;\n    }\n\n    const originalDocument = window.document;\n    const currentScript = originalDocument.currentScript;\n    let {\n      document\n    } = window;\n    const {\n      DocumentFragment,\n      HTMLTemplateElement,\n      Node,\n      Element,\n      NodeFilter,\n      NamedNodeMap = window.NamedNodeMap || window.MozNamedAttrMap,\n      HTMLFormElement,\n      DOMParser,\n      trustedTypes\n    } = window;\n    const ElementPrototype = Element.prototype;\n    const cloneNode = lookupGetter(ElementPrototype, 'cloneNode');\n    const getNextSibling = lookupGetter(ElementPrototype, 'nextSibling');\n    const getChildNodes = lookupGetter(ElementPrototype, 'childNodes');\n    const getParentNode = lookupGetter(ElementPrototype, 'parentNode'); // As per issue #47, the web-components registry is inherited by a\n    // new document created via createHTMLDocument. As per the spec\n    // (http://w3c.github.io/webcomponents/spec/custom/#creating-and-passing-registries)\n    // a new empty registry is used when creating a template contents owner\n    // document, so we use that as our parent document to ensure nothing\n    // is inherited.\n\n    if (typeof HTMLTemplateElement === 'function') {\n      const template = document.createElement('template');\n\n      if (template.content && template.content.ownerDocument) {\n        document = template.content.ownerDocument;\n      }\n    }\n\n    let trustedTypesPolicy;\n    let emptyHTML = '';\n    const {\n      implementation,\n      createNodeIterator,\n      createDocumentFragment,\n      getElementsByTagName\n    } = document;\n    const {\n      importNode\n    } = originalDocument;\n    let hooks = {};\n    /**\n     * Expose whether this browser supports running the full DOMPurify.\n     */\n\n    DOMPurify.isSupported = typeof entries === 'function' && typeof getParentNode === 'function' && implementation && implementation.createHTMLDocument !== undefined;\n    const {\n      MUSTACHE_EXPR,\n      ERB_EXPR,\n      TMPLIT_EXPR,\n      DATA_ATTR,\n      ARIA_ATTR,\n      IS_SCRIPT_OR_DATA,\n      ATTR_WHITESPACE\n    } = EXPRESSIONS;\n    let {\n      IS_ALLOWED_URI: IS_ALLOWED_URI$1\n    } = EXPRESSIONS;\n    /**\n     * We consider the elements and attributes below to be safe. Ideally\n     * don't add any new ones but feel free to remove unwanted ones.\n     */\n\n    /* allowed element names */\n\n    let ALLOWED_TAGS = null;\n    const DEFAULT_ALLOWED_TAGS = addToSet({}, [...html$1, ...svg$1, ...svgFilters, ...mathMl$1, ...text]);\n    /* Allowed attribute names */\n\n    let ALLOWED_ATTR = null;\n    const DEFAULT_ALLOWED_ATTR = addToSet({}, [...html, ...svg, ...mathMl, ...xml]);\n    /*\n     * Configure how DOMPUrify should handle custom elements and their attributes as well as customized built-in elements.\n     * @property {RegExp|Function|null} tagNameCheck one of [null, regexPattern, predicate]. Default: `null` (disallow any custom elements)\n     * @property {RegExp|Function|null} attributeNameCheck one of [null, regexPattern, predicate]. Default: `null` (disallow any attributes not on the allow list)\n     * @property {boolean} allowCustomizedBuiltInElements allow custom elements derived from built-ins if they pass CUSTOM_ELEMENT_HANDLING.tagNameCheck. Default: `false`.\n     */\n\n    let CUSTOM_ELEMENT_HANDLING = Object.seal(Object.create(null, {\n      tagNameCheck: {\n        writable: true,\n        configurable: false,\n        enumerable: true,\n        value: null\n      },\n      attributeNameCheck: {\n        writable: true,\n        configurable: false,\n        enumerable: true,\n        value: null\n      },\n      allowCustomizedBuiltInElements: {\n        writable: true,\n        configurable: false,\n        enumerable: true,\n        value: false\n      }\n    }));\n    /* Explicitly forbidden tags (overrides ALLOWED_TAGS/ADD_TAGS) */\n\n    let FORBID_TAGS = null;\n    /* Explicitly forbidden attributes (overrides ALLOWED_ATTR/ADD_ATTR) */\n\n    let FORBID_ATTR = null;\n    /* Decide if ARIA attributes are okay */\n\n    let ALLOW_ARIA_ATTR = true;\n    /* Decide if custom data attributes are okay */\n\n    let ALLOW_DATA_ATTR = true;\n    /* Decide if unknown protocols are okay */\n\n    let ALLOW_UNKNOWN_PROTOCOLS = false;\n    /* Decide if self-closing tags in attributes are allowed.\n     * Usually removed due to a mXSS issue in jQuery 3.0 */\n\n    let ALLOW_SELF_CLOSE_IN_ATTR = true;\n    /* Output should be safe for common template engines.\n     * This means, DOMPurify removes data attributes, mustaches and ERB\n     */\n\n    let SAFE_FOR_TEMPLATES = false;\n    /* Decide if document with <html>... should be returned */\n\n    let WHOLE_DOCUMENT = false;\n    /* Track whether config is already set on this instance of DOMPurify. */\n\n    let SET_CONFIG = false;\n    /* Decide if all elements (e.g. style, script) must be children of\n     * document.body. By default, browsers might move them to document.head */\n\n    let FORCE_BODY = false;\n    /* Decide if a DOM `HTMLBodyElement` should be returned, instead of a html\n     * string (or a TrustedHTML object if Trusted Types are supported).\n     * If `WHOLE_DOCUMENT` is enabled a `HTMLHtmlElement` will be returned instead\n     */\n\n    let RETURN_DOM = false;\n    /* Decide if a DOM `DocumentFragment` should be returned, instead of a html\n     * string  (or a TrustedHTML object if Trusted Types are supported) */\n\n    let RETURN_DOM_FRAGMENT = false;\n    /* Try to return a Trusted Type object instead of a string, return a string in\n     * case Trusted Types are not supported  */\n\n    let RETURN_TRUSTED_TYPE = false;\n    /* Output should be free from DOM clobbering attacks?\n     * This sanitizes markups named with colliding, clobberable built-in DOM APIs.\n     */\n\n    let SANITIZE_DOM = true;\n    /* Achieve full DOM Clobbering protection by isolating the namespace of named\n     * properties and JS variables, mitigating attacks that abuse the HTML/DOM spec rules.\n     *\n     * HTML/DOM spec rules that enable DOM Clobbering:\n     *   - Named Access on Window (§7.3.3)\n     *   - DOM Tree Accessors (§3.1.5)\n     *   - Form Element Parent-Child Relations (§4.10.3)\n     *   - Iframe srcdoc / Nested WindowProxies (§4.8.5)\n     *   - HTMLCollection (§4.2.10.2)\n     *\n     * Namespace isolation is implemented by prefixing `id` and `name` attributes\n     * with a constant string, i.e., `user-content-`\n     */\n\n    let SANITIZE_NAMED_PROPS = false;\n    const SANITIZE_NAMED_PROPS_PREFIX = 'user-content-';\n    /* Keep element content when removing element? */\n\n    let KEEP_CONTENT = true;\n    /* If a `Node` is passed to sanitize(), then performs sanitization in-place instead\n     * of importing it into a new Document and returning a sanitized copy */\n\n    let IN_PLACE = false;\n    /* Allow usage of profiles like html, svg and mathMl */\n\n    let USE_PROFILES = {};\n    /* Tags to ignore content of when KEEP_CONTENT is true */\n\n    let FORBID_CONTENTS = null;\n    const DEFAULT_FORBID_CONTENTS = addToSet({}, ['annotation-xml', 'audio', 'colgroup', 'desc', 'foreignobject', 'head', 'iframe', 'math', 'mi', 'mn', 'mo', 'ms', 'mtext', 'noembed', 'noframes', 'noscript', 'plaintext', 'script', 'style', 'svg', 'template', 'thead', 'title', 'video', 'xmp']);\n    /* Tags that are safe for data: URIs */\n\n    let DATA_URI_TAGS = null;\n    const DEFAULT_DATA_URI_TAGS = addToSet({}, ['audio', 'video', 'img', 'source', 'image', 'track']);\n    /* Attributes safe for values like \"javascript:\" */\n\n    let URI_SAFE_ATTRIBUTES = null;\n    const DEFAULT_URI_SAFE_ATTRIBUTES = addToSet({}, ['alt', 'class', 'for', 'id', 'label', 'name', 'pattern', 'placeholder', 'role', 'summary', 'title', 'value', 'style', 'xmlns']);\n    const MATHML_NAMESPACE = 'http://www.w3.org/1998/Math/MathML';\n    const SVG_NAMESPACE = 'http://www.w3.org/2000/svg';\n    const HTML_NAMESPACE = 'http://www.w3.org/1999/xhtml';\n    /* Document namespace */\n\n    let NAMESPACE = HTML_NAMESPACE;\n    let IS_EMPTY_INPUT = false;\n    /* Allowed XHTML+XML namespaces */\n\n    let ALLOWED_NAMESPACES = null;\n    const DEFAULT_ALLOWED_NAMESPACES = addToSet({}, [MATHML_NAMESPACE, SVG_NAMESPACE, HTML_NAMESPACE], stringToString);\n    /* Parsing of strict XHTML documents */\n\n    let PARSER_MEDIA_TYPE;\n    const SUPPORTED_PARSER_MEDIA_TYPES = ['application/xhtml+xml', 'text/html'];\n    const DEFAULT_PARSER_MEDIA_TYPE = 'text/html';\n    let transformCaseFunc;\n    /* Keep a reference to config to pass to hooks */\n\n    let CONFIG = null;\n    /* Ideally, do not touch anything below this line */\n\n    /* ______________________________________________ */\n\n    const formElement = document.createElement('form');\n\n    const isRegexOrFunction = function isRegexOrFunction(testValue) {\n      return testValue instanceof RegExp || testValue instanceof Function;\n    };\n    /**\n     * _parseConfig\n     *\n     * @param  {Object} cfg optional config literal\n     */\n    // eslint-disable-next-line complexity\n\n\n    const _parseConfig = function _parseConfig(cfg) {\n      if (CONFIG && CONFIG === cfg) {\n        return;\n      }\n      /* Shield configuration object from tampering */\n\n\n      if (!cfg || typeof cfg !== 'object') {\n        cfg = {};\n      }\n      /* Shield configuration object from prototype pollution */\n\n\n      cfg = clone(cfg);\n      PARSER_MEDIA_TYPE = // eslint-disable-next-line unicorn/prefer-includes\n      SUPPORTED_PARSER_MEDIA_TYPES.indexOf(cfg.PARSER_MEDIA_TYPE) === -1 ? PARSER_MEDIA_TYPE = DEFAULT_PARSER_MEDIA_TYPE : PARSER_MEDIA_TYPE = cfg.PARSER_MEDIA_TYPE; // HTML tags and attributes are not case-sensitive, converting to lowercase. Keeping XHTML as is.\n\n      transformCaseFunc = PARSER_MEDIA_TYPE === 'application/xhtml+xml' ? stringToString : stringToLowerCase;\n      /* Set configuration parameters */\n\n      ALLOWED_TAGS = 'ALLOWED_TAGS' in cfg ? addToSet({}, cfg.ALLOWED_TAGS, transformCaseFunc) : DEFAULT_ALLOWED_TAGS;\n      ALLOWED_ATTR = 'ALLOWED_ATTR' in cfg ? addToSet({}, cfg.ALLOWED_ATTR, transformCaseFunc) : DEFAULT_ALLOWED_ATTR;\n      ALLOWED_NAMESPACES = 'ALLOWED_NAMESPACES' in cfg ? addToSet({}, cfg.ALLOWED_NAMESPACES, stringToString) : DEFAULT_ALLOWED_NAMESPACES;\n      URI_SAFE_ATTRIBUTES = 'ADD_URI_SAFE_ATTR' in cfg ? addToSet(clone(DEFAULT_URI_SAFE_ATTRIBUTES), // eslint-disable-line indent\n      cfg.ADD_URI_SAFE_ATTR, // eslint-disable-line indent\n      transformCaseFunc // eslint-disable-line indent\n      ) // eslint-disable-line indent\n      : DEFAULT_URI_SAFE_ATTRIBUTES;\n      DATA_URI_TAGS = 'ADD_DATA_URI_TAGS' in cfg ? addToSet(clone(DEFAULT_DATA_URI_TAGS), // eslint-disable-line indent\n      cfg.ADD_DATA_URI_TAGS, // eslint-disable-line indent\n      transformCaseFunc // eslint-disable-line indent\n      ) // eslint-disable-line indent\n      : DEFAULT_DATA_URI_TAGS;\n      FORBID_CONTENTS = 'FORBID_CONTENTS' in cfg ? addToSet({}, cfg.FORBID_CONTENTS, transformCaseFunc) : DEFAULT_FORBID_CONTENTS;\n      FORBID_TAGS = 'FORBID_TAGS' in cfg ? addToSet({}, cfg.FORBID_TAGS, transformCaseFunc) : {};\n      FORBID_ATTR = 'FORBID_ATTR' in cfg ? addToSet({}, cfg.FORBID_ATTR, transformCaseFunc) : {};\n      USE_PROFILES = 'USE_PROFILES' in cfg ? cfg.USE_PROFILES : false;\n      ALLOW_ARIA_ATTR = cfg.ALLOW_ARIA_ATTR !== false; // Default true\n\n      ALLOW_DATA_ATTR = cfg.ALLOW_DATA_ATTR !== false; // Default true\n\n      ALLOW_UNKNOWN_PROTOCOLS = cfg.ALLOW_UNKNOWN_PROTOCOLS || false; // Default false\n\n      ALLOW_SELF_CLOSE_IN_ATTR = cfg.ALLOW_SELF_CLOSE_IN_ATTR !== false; // Default true\n\n      SAFE_FOR_TEMPLATES = cfg.SAFE_FOR_TEMPLATES || false; // Default false\n\n      WHOLE_DOCUMENT = cfg.WHOLE_DOCUMENT || false; // Default false\n\n      RETURN_DOM = cfg.RETURN_DOM || false; // Default false\n\n      RETURN_DOM_FRAGMENT = cfg.RETURN_DOM_FRAGMENT || false; // Default false\n\n      RETURN_TRUSTED_TYPE = cfg.RETURN_TRUSTED_TYPE || false; // Default false\n\n      FORCE_BODY = cfg.FORCE_BODY || false; // Default false\n\n      SANITIZE_DOM = cfg.SANITIZE_DOM !== false; // Default true\n\n      SANITIZE_NAMED_PROPS = cfg.SANITIZE_NAMED_PROPS || false; // Default false\n\n      KEEP_CONTENT = cfg.KEEP_CONTENT !== false; // Default true\n\n      IN_PLACE = cfg.IN_PLACE || false; // Default false\n\n      IS_ALLOWED_URI$1 = cfg.ALLOWED_URI_REGEXP || IS_ALLOWED_URI;\n      NAMESPACE = cfg.NAMESPACE || HTML_NAMESPACE;\n      CUSTOM_ELEMENT_HANDLING = cfg.CUSTOM_ELEMENT_HANDLING || {};\n\n      if (cfg.CUSTOM_ELEMENT_HANDLING && isRegexOrFunction(cfg.CUSTOM_ELEMENT_HANDLING.tagNameCheck)) {\n        CUSTOM_ELEMENT_HANDLING.tagNameCheck = cfg.CUSTOM_ELEMENT_HANDLING.tagNameCheck;\n      }\n\n      if (cfg.CUSTOM_ELEMENT_HANDLING && isRegexOrFunction(cfg.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)) {\n        CUSTOM_ELEMENT_HANDLING.attributeNameCheck = cfg.CUSTOM_ELEMENT_HANDLING.attributeNameCheck;\n      }\n\n      if (cfg.CUSTOM_ELEMENT_HANDLING && typeof cfg.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements === 'boolean') {\n        CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements = cfg.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements;\n      }\n\n      if (SAFE_FOR_TEMPLATES) {\n        ALLOW_DATA_ATTR = false;\n      }\n\n      if (RETURN_DOM_FRAGMENT) {\n        RETURN_DOM = true;\n      }\n      /* Parse profile info */\n\n\n      if (USE_PROFILES) {\n        ALLOWED_TAGS = addToSet({}, [...text]);\n        ALLOWED_ATTR = [];\n\n        if (USE_PROFILES.html === true) {\n          addToSet(ALLOWED_TAGS, html$1);\n          addToSet(ALLOWED_ATTR, html);\n        }\n\n        if (USE_PROFILES.svg === true) {\n          addToSet(ALLOWED_TAGS, svg$1);\n          addToSet(ALLOWED_ATTR, svg);\n          addToSet(ALLOWED_ATTR, xml);\n        }\n\n        if (USE_PROFILES.svgFilters === true) {\n          addToSet(ALLOWED_TAGS, svgFilters);\n          addToSet(ALLOWED_ATTR, svg);\n          addToSet(ALLOWED_ATTR, xml);\n        }\n\n        if (USE_PROFILES.mathMl === true) {\n          addToSet(ALLOWED_TAGS, mathMl$1);\n          addToSet(ALLOWED_ATTR, mathMl);\n          addToSet(ALLOWED_ATTR, xml);\n        }\n      }\n      /* Merge configuration parameters */\n\n\n      if (cfg.ADD_TAGS) {\n        if (ALLOWED_TAGS === DEFAULT_ALLOWED_TAGS) {\n          ALLOWED_TAGS = clone(ALLOWED_TAGS);\n        }\n\n        addToSet(ALLOWED_TAGS, cfg.ADD_TAGS, transformCaseFunc);\n      }\n\n      if (cfg.ADD_ATTR) {\n        if (ALLOWED_ATTR === DEFAULT_ALLOWED_ATTR) {\n          ALLOWED_ATTR = clone(ALLOWED_ATTR);\n        }\n\n        addToSet(ALLOWED_ATTR, cfg.ADD_ATTR, transformCaseFunc);\n      }\n\n      if (cfg.ADD_URI_SAFE_ATTR) {\n        addToSet(URI_SAFE_ATTRIBUTES, cfg.ADD_URI_SAFE_ATTR, transformCaseFunc);\n      }\n\n      if (cfg.FORBID_CONTENTS) {\n        if (FORBID_CONTENTS === DEFAULT_FORBID_CONTENTS) {\n          FORBID_CONTENTS = clone(FORBID_CONTENTS);\n        }\n\n        addToSet(FORBID_CONTENTS, cfg.FORBID_CONTENTS, transformCaseFunc);\n      }\n      /* Add #text in case KEEP_CONTENT is set to true */\n\n\n      if (KEEP_CONTENT) {\n        ALLOWED_TAGS['#text'] = true;\n      }\n      /* Add html, head and body to ALLOWED_TAGS in case WHOLE_DOCUMENT is true */\n\n\n      if (WHOLE_DOCUMENT) {\n        addToSet(ALLOWED_TAGS, ['html', 'head', 'body']);\n      }\n      /* Add tbody to ALLOWED_TAGS in case tables are permitted, see #286, #365 */\n\n\n      if (ALLOWED_TAGS.table) {\n        addToSet(ALLOWED_TAGS, ['tbody']);\n        delete FORBID_TAGS.tbody;\n      }\n\n      if (cfg.TRUSTED_TYPES_POLICY) {\n        if (typeof cfg.TRUSTED_TYPES_POLICY.createHTML !== 'function') {\n          throw typeErrorCreate('TRUSTED_TYPES_POLICY configuration option must provide a \"createHTML\" hook.');\n        }\n\n        if (typeof cfg.TRUSTED_TYPES_POLICY.createScriptURL !== 'function') {\n          throw typeErrorCreate('TRUSTED_TYPES_POLICY configuration option must provide a \"createScriptURL\" hook.');\n        } // Overwrite existing TrustedTypes policy.\n\n\n        trustedTypesPolicy = cfg.TRUSTED_TYPES_POLICY; // Sign local variables required by `sanitize`.\n\n        emptyHTML = trustedTypesPolicy.createHTML('');\n      } else {\n        // Uninitialized policy, attempt to initialize the internal dompurify policy.\n        if (trustedTypesPolicy === undefined) {\n          trustedTypesPolicy = _createTrustedTypesPolicy(trustedTypes, currentScript);\n        } // If creating the internal policy succeeded sign internal variables.\n\n\n        if (trustedTypesPolicy !== null && typeof emptyHTML === 'string') {\n          emptyHTML = trustedTypesPolicy.createHTML('');\n        }\n      } // Prevent further manipulation of configuration.\n      // Not available in IE8, Safari 5, etc.\n\n\n      if (freeze) {\n        freeze(cfg);\n      }\n\n      CONFIG = cfg;\n    };\n\n    const MATHML_TEXT_INTEGRATION_POINTS = addToSet({}, ['mi', 'mo', 'mn', 'ms', 'mtext']);\n    const HTML_INTEGRATION_POINTS = addToSet({}, ['foreignobject', 'desc', 'title', 'annotation-xml']); // Certain elements are allowed in both SVG and HTML\n    // namespace. We need to specify them explicitly\n    // so that they don't get erroneously deleted from\n    // HTML namespace.\n\n    const COMMON_SVG_AND_HTML_ELEMENTS = addToSet({}, ['title', 'style', 'font', 'a', 'script']);\n    /* Keep track of all possible SVG and MathML tags\n     * so that we can perform the namespace checks\n     * correctly. */\n\n    const ALL_SVG_TAGS = addToSet({}, svg$1);\n    addToSet(ALL_SVG_TAGS, svgFilters);\n    addToSet(ALL_SVG_TAGS, svgDisallowed);\n    const ALL_MATHML_TAGS = addToSet({}, mathMl$1);\n    addToSet(ALL_MATHML_TAGS, mathMlDisallowed);\n    /**\n     *\n     *\n     * @param  {Element} element a DOM element whose namespace is being checked\n     * @returns {boolean} Return false if the element has a\n     *  namespace that a spec-compliant parser would never\n     *  return. Return true otherwise.\n     */\n\n    const _checkValidNamespace = function _checkValidNamespace(element) {\n      let parent = getParentNode(element); // In JSDOM, if we're inside shadow DOM, then parentNode\n      // can be null. We just simulate parent in this case.\n\n      if (!parent || !parent.tagName) {\n        parent = {\n          namespaceURI: NAMESPACE,\n          tagName: 'template'\n        };\n      }\n\n      const tagName = stringToLowerCase(element.tagName);\n      const parentTagName = stringToLowerCase(parent.tagName);\n\n      if (!ALLOWED_NAMESPACES[element.namespaceURI]) {\n        return false;\n      }\n\n      if (element.namespaceURI === SVG_NAMESPACE) {\n        // The only way to switch from HTML namespace to SVG\n        // is via <svg>. If it happens via any other tag, then\n        // it should be killed.\n        if (parent.namespaceURI === HTML_NAMESPACE) {\n          return tagName === 'svg';\n        } // The only way to switch from MathML to SVG is via`\n        // svg if parent is either <annotation-xml> or MathML\n        // text integration points.\n\n\n        if (parent.namespaceURI === MATHML_NAMESPACE) {\n          return tagName === 'svg' && (parentTagName === 'annotation-xml' || MATHML_TEXT_INTEGRATION_POINTS[parentTagName]);\n        } // We only allow elements that are defined in SVG\n        // spec. All others are disallowed in SVG namespace.\n\n\n        return Boolean(ALL_SVG_TAGS[tagName]);\n      }\n\n      if (element.namespaceURI === MATHML_NAMESPACE) {\n        // The only way to switch from HTML namespace to MathML\n        // is via <math>. If it happens via any other tag, then\n        // it should be killed.\n        if (parent.namespaceURI === HTML_NAMESPACE) {\n          return tagName === 'math';\n        } // The only way to switch from SVG to MathML is via\n        // <math> and HTML integration points\n\n\n        if (parent.namespaceURI === SVG_NAMESPACE) {\n          return tagName === 'math' && HTML_INTEGRATION_POINTS[parentTagName];\n        } // We only allow elements that are defined in MathML\n        // spec. All others are disallowed in MathML namespace.\n\n\n        return Boolean(ALL_MATHML_TAGS[tagName]);\n      }\n\n      if (element.namespaceURI === HTML_NAMESPACE) {\n        // The only way to switch from SVG to HTML is via\n        // HTML integration points, and from MathML to HTML\n        // is via MathML text integration points\n        if (parent.namespaceURI === SVG_NAMESPACE && !HTML_INTEGRATION_POINTS[parentTagName]) {\n          return false;\n        }\n\n        if (parent.namespaceURI === MATHML_NAMESPACE && !MATHML_TEXT_INTEGRATION_POINTS[parentTagName]) {\n          return false;\n        } // We disallow tags that are specific for MathML\n        // or SVG and should never appear in HTML namespace\n\n\n        return !ALL_MATHML_TAGS[tagName] && (COMMON_SVG_AND_HTML_ELEMENTS[tagName] || !ALL_SVG_TAGS[tagName]);\n      } // For XHTML and XML documents that support custom namespaces\n\n\n      if (PARSER_MEDIA_TYPE === 'application/xhtml+xml' && ALLOWED_NAMESPACES[element.namespaceURI]) {\n        return true;\n      } // The code should never reach this place (this means\n      // that the element somehow got namespace that is not\n      // HTML, SVG, MathML or allowed via ALLOWED_NAMESPACES).\n      // Return false just in case.\n\n\n      return false;\n    };\n    /**\n     * _forceRemove\n     *\n     * @param  {Node} node a DOM node\n     */\n\n\n    const _forceRemove = function _forceRemove(node) {\n      arrayPush(DOMPurify.removed, {\n        element: node\n      });\n\n      try {\n        // eslint-disable-next-line unicorn/prefer-dom-node-remove\n        node.parentNode.removeChild(node);\n      } catch (_) {\n        node.remove();\n      }\n    };\n    /**\n     * _removeAttribute\n     *\n     * @param  {String} name an Attribute name\n     * @param  {Node} node a DOM node\n     */\n\n\n    const _removeAttribute = function _removeAttribute(name, node) {\n      try {\n        arrayPush(DOMPurify.removed, {\n          attribute: node.getAttributeNode(name),\n          from: node\n        });\n      } catch (_) {\n        arrayPush(DOMPurify.removed, {\n          attribute: null,\n          from: node\n        });\n      }\n\n      node.removeAttribute(name); // We void attribute values for unremovable \"is\"\" attributes\n\n      if (name === 'is' && !ALLOWED_ATTR[name]) {\n        if (RETURN_DOM || RETURN_DOM_FRAGMENT) {\n          try {\n            _forceRemove(node);\n          } catch (_) {}\n        } else {\n          try {\n            node.setAttribute(name, '');\n          } catch (_) {}\n        }\n      }\n    };\n    /**\n     * _initDocument\n     *\n     * @param  {String} dirty a string of dirty markup\n     * @return {Document} a DOM, filled with the dirty markup\n     */\n\n\n    const _initDocument = function _initDocument(dirty) {\n      /* Create a HTML document */\n      let doc;\n      let leadingWhitespace;\n\n      if (FORCE_BODY) {\n        dirty = '<remove></remove>' + dirty;\n      } else {\n        /* If FORCE_BODY isn't used, leading whitespace needs to be preserved manually */\n        const matches = stringMatch(dirty, /^[\\r\\n\\t ]+/);\n        leadingWhitespace = matches && matches[0];\n      }\n\n      if (PARSER_MEDIA_TYPE === 'application/xhtml+xml' && NAMESPACE === HTML_NAMESPACE) {\n        // Root of XHTML doc must contain xmlns declaration (see https://www.w3.org/TR/xhtml1/normative.html#strict)\n        dirty = '<html xmlns=\"http://www.w3.org/1999/xhtml\"><head></head><body>' + dirty + '</body></html>';\n      }\n\n      const dirtyPayload = trustedTypesPolicy ? trustedTypesPolicy.createHTML(dirty) : dirty;\n      /*\n       * Use the DOMParser API by default, fallback later if needs be\n       * DOMParser not work for svg when has multiple root element.\n       */\n\n      if (NAMESPACE === HTML_NAMESPACE) {\n        try {\n          doc = new DOMParser().parseFromString(dirtyPayload, PARSER_MEDIA_TYPE);\n        } catch (_) {}\n      }\n      /* Use createHTMLDocument in case DOMParser is not available */\n\n\n      if (!doc || !doc.documentElement) {\n        doc = implementation.createDocument(NAMESPACE, 'template', null);\n\n        try {\n          doc.documentElement.innerHTML = IS_EMPTY_INPUT ? emptyHTML : dirtyPayload;\n        } catch (_) {// Syntax error if dirtyPayload is invalid xml\n        }\n      }\n\n      const body = doc.body || doc.documentElement;\n\n      if (dirty && leadingWhitespace) {\n        body.insertBefore(document.createTextNode(leadingWhitespace), body.childNodes[0] || null);\n      }\n      /* Work on whole document or just its body */\n\n\n      if (NAMESPACE === HTML_NAMESPACE) {\n        return getElementsByTagName.call(doc, WHOLE_DOCUMENT ? 'html' : 'body')[0];\n      }\n\n      return WHOLE_DOCUMENT ? doc.documentElement : body;\n    };\n    /**\n     * _createIterator\n     *\n     * @param  {Document} root document/fragment to create iterator for\n     * @return {Iterator} iterator instance\n     */\n\n\n    const _createIterator = function _createIterator(root) {\n      return createNodeIterator.call(root.ownerDocument || root, root, // eslint-disable-next-line no-bitwise\n      NodeFilter.SHOW_ELEMENT | NodeFilter.SHOW_COMMENT | NodeFilter.SHOW_TEXT, null, false);\n    };\n    /**\n     * _isClobbered\n     *\n     * @param  {Node} elm element to check for clobbering attacks\n     * @return {Boolean} true if clobbered, false if safe\n     */\n\n\n    const _isClobbered = function _isClobbered(elm) {\n      return elm instanceof HTMLFormElement && (typeof elm.nodeName !== 'string' || typeof elm.textContent !== 'string' || typeof elm.removeChild !== 'function' || !(elm.attributes instanceof NamedNodeMap) || typeof elm.removeAttribute !== 'function' || typeof elm.setAttribute !== 'function' || typeof elm.namespaceURI !== 'string' || typeof elm.insertBefore !== 'function' || typeof elm.hasChildNodes !== 'function');\n    };\n    /**\n     * _isNode\n     *\n     * @param  {Node} obj object to check whether it's a DOM node\n     * @return {Boolean} true is object is a DOM node\n     */\n\n\n    const _isNode = function _isNode(object) {\n      return typeof Node === 'object' ? object instanceof Node : object && typeof object === 'object' && typeof object.nodeType === 'number' && typeof object.nodeName === 'string';\n    };\n    /**\n     * _executeHook\n     * Execute user configurable hooks\n     *\n     * @param  {String} entryPoint  Name of the hook's entry point\n     * @param  {Node} currentNode node to work on with the hook\n     * @param  {Object} data additional hook parameters\n     */\n\n\n    const _executeHook = function _executeHook(entryPoint, currentNode, data) {\n      if (!hooks[entryPoint]) {\n        return;\n      }\n\n      arrayForEach(hooks[entryPoint], hook => {\n        hook.call(DOMPurify, currentNode, data, CONFIG);\n      });\n    };\n    /**\n     * _sanitizeElements\n     *\n     * @protect nodeName\n     * @protect textContent\n     * @protect removeChild\n     *\n     * @param   {Node} currentNode to check for permission to exist\n     * @return  {Boolean} true if node was killed, false if left alive\n     */\n\n\n    const _sanitizeElements = function _sanitizeElements(currentNode) {\n      let content;\n      /* Execute a hook if present */\n\n      _executeHook('beforeSanitizeElements', currentNode, null);\n      /* Check if element is clobbered or can clobber */\n\n\n      if (_isClobbered(currentNode)) {\n        _forceRemove(currentNode);\n\n        return true;\n      }\n      /* Now let's check the element's type and name */\n\n\n      const tagName = transformCaseFunc(currentNode.nodeName);\n      /* Execute a hook if present */\n\n      _executeHook('uponSanitizeElement', currentNode, {\n        tagName,\n        allowedTags: ALLOWED_TAGS\n      });\n      /* Detect mXSS attempts abusing namespace confusion */\n\n\n      if (currentNode.hasChildNodes() && !_isNode(currentNode.firstElementChild) && (!_isNode(currentNode.content) || !_isNode(currentNode.content.firstElementChild)) && regExpTest(/<[/\\w]/g, currentNode.innerHTML) && regExpTest(/<[/\\w]/g, currentNode.textContent)) {\n        _forceRemove(currentNode);\n\n        return true;\n      }\n      /* Remove element if anything forbids its presence */\n\n\n      if (!ALLOWED_TAGS[tagName] || FORBID_TAGS[tagName]) {\n        /* Check if we have a custom element to handle */\n        if (!FORBID_TAGS[tagName] && _basicCustomElementTest(tagName)) {\n          if (CUSTOM_ELEMENT_HANDLING.tagNameCheck instanceof RegExp && regExpTest(CUSTOM_ELEMENT_HANDLING.tagNameCheck, tagName)) return false;\n          if (CUSTOM_ELEMENT_HANDLING.tagNameCheck instanceof Function && CUSTOM_ELEMENT_HANDLING.tagNameCheck(tagName)) return false;\n        }\n        /* Keep content except for bad-listed elements */\n\n\n        if (KEEP_CONTENT && !FORBID_CONTENTS[tagName]) {\n          const parentNode = getParentNode(currentNode) || currentNode.parentNode;\n          const childNodes = getChildNodes(currentNode) || currentNode.childNodes;\n\n          if (childNodes && parentNode) {\n            const childCount = childNodes.length;\n\n            for (let i = childCount - 1; i >= 0; --i) {\n              parentNode.insertBefore(cloneNode(childNodes[i], true), getNextSibling(currentNode));\n            }\n          }\n        }\n\n        _forceRemove(currentNode);\n\n        return true;\n      }\n      /* Check whether element has a valid namespace */\n\n\n      if (currentNode instanceof Element && !_checkValidNamespace(currentNode)) {\n        _forceRemove(currentNode);\n\n        return true;\n      }\n      /* Make sure that older browsers don't get noscript mXSS */\n\n\n      if ((tagName === 'noscript' || tagName === 'noembed') && regExpTest(/<\\/no(script|embed)/i, currentNode.innerHTML)) {\n        _forceRemove(currentNode);\n\n        return true;\n      }\n      /* Sanitize element content to be template-safe */\n\n\n      if (SAFE_FOR_TEMPLATES && currentNode.nodeType === 3) {\n        /* Get the element's text content */\n        content = currentNode.textContent;\n        content = stringReplace(content, MUSTACHE_EXPR, ' ');\n        content = stringReplace(content, ERB_EXPR, ' ');\n        content = stringReplace(content, TMPLIT_EXPR, ' ');\n\n        if (currentNode.textContent !== content) {\n          arrayPush(DOMPurify.removed, {\n            element: currentNode.cloneNode()\n          });\n          currentNode.textContent = content;\n        }\n      }\n      /* Execute a hook if present */\n\n\n      _executeHook('afterSanitizeElements', currentNode, null);\n\n      return false;\n    };\n    /**\n     * _isValidAttribute\n     *\n     * @param  {string} lcTag Lowercase tag name of containing element.\n     * @param  {string} lcName Lowercase attribute name.\n     * @param  {string} value Attribute value.\n     * @return {Boolean} Returns true if `value` is valid, otherwise false.\n     */\n    // eslint-disable-next-line complexity\n\n\n    const _isValidAttribute = function _isValidAttribute(lcTag, lcName, value) {\n      /* Make sure attribute cannot clobber */\n      if (SANITIZE_DOM && (lcName === 'id' || lcName === 'name') && (value in document || value in formElement)) {\n        return false;\n      }\n      /* Allow valid data-* attributes: At least one character after \"-\"\n          (https://html.spec.whatwg.org/multipage/dom.html#embedding-custom-non-visible-data-with-the-data-*-attributes)\n          XML-compatible (https://html.spec.whatwg.org/multipage/infrastructure.html#xml-compatible and http://www.w3.org/TR/xml/#d0e804)\n          We don't need to check the value; it's always URI safe. */\n\n\n      if (ALLOW_DATA_ATTR && !FORBID_ATTR[lcName] && regExpTest(DATA_ATTR, lcName)) ; else if (ALLOW_ARIA_ATTR && regExpTest(ARIA_ATTR, lcName)) ; else if (!ALLOWED_ATTR[lcName] || FORBID_ATTR[lcName]) {\n        if ( // First condition does a very basic check if a) it's basically a valid custom element tagname AND\n        // b) if the tagName passes whatever the user has configured for CUSTOM_ELEMENT_HANDLING.tagNameCheck\n        // and c) if the attribute name passes whatever the user has configured for CUSTOM_ELEMENT_HANDLING.attributeNameCheck\n        _basicCustomElementTest(lcTag) && (CUSTOM_ELEMENT_HANDLING.tagNameCheck instanceof RegExp && regExpTest(CUSTOM_ELEMENT_HANDLING.tagNameCheck, lcTag) || CUSTOM_ELEMENT_HANDLING.tagNameCheck instanceof Function && CUSTOM_ELEMENT_HANDLING.tagNameCheck(lcTag)) && (CUSTOM_ELEMENT_HANDLING.attributeNameCheck instanceof RegExp && regExpTest(CUSTOM_ELEMENT_HANDLING.attributeNameCheck, lcName) || CUSTOM_ELEMENT_HANDLING.attributeNameCheck instanceof Function && CUSTOM_ELEMENT_HANDLING.attributeNameCheck(lcName)) || // Alternative, second condition checks if it's an `is`-attribute, AND\n        // the value passes whatever the user has configured for CUSTOM_ELEMENT_HANDLING.tagNameCheck\n        lcName === 'is' && CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements && (CUSTOM_ELEMENT_HANDLING.tagNameCheck instanceof RegExp && regExpTest(CUSTOM_ELEMENT_HANDLING.tagNameCheck, value) || CUSTOM_ELEMENT_HANDLING.tagNameCheck instanceof Function && CUSTOM_ELEMENT_HANDLING.tagNameCheck(value))) ; else {\n          return false;\n        }\n        /* Check value is safe. First, is attr inert? If so, is safe */\n\n      } else if (URI_SAFE_ATTRIBUTES[lcName]) ; else if (regExpTest(IS_ALLOWED_URI$1, stringReplace(value, ATTR_WHITESPACE, ''))) ; else if ((lcName === 'src' || lcName === 'xlink:href' || lcName === 'href') && lcTag !== 'script' && stringIndexOf(value, 'data:') === 0 && DATA_URI_TAGS[lcTag]) ; else if (ALLOW_UNKNOWN_PROTOCOLS && !regExpTest(IS_SCRIPT_OR_DATA, stringReplace(value, ATTR_WHITESPACE, ''))) ; else if (value) {\n        return false;\n      } else ;\n\n      return true;\n    };\n    /**\n     * _basicCustomElementCheck\n     * checks if at least one dash is included in tagName, and it's not the first char\n     * for more sophisticated checking see https://github.com/sindresorhus/validate-element-name\n     * @param {string} tagName name of the tag of the node to sanitize\n     */\n\n\n    const _basicCustomElementTest = function _basicCustomElementTest(tagName) {\n      return tagName.indexOf('-') > 0;\n    };\n    /**\n     * _sanitizeAttributes\n     *\n     * @protect attributes\n     * @protect nodeName\n     * @protect removeAttribute\n     * @protect setAttribute\n     *\n     * @param  {Node} currentNode to sanitize\n     */\n\n\n    const _sanitizeAttributes = function _sanitizeAttributes(currentNode) {\n      let attr;\n      let value;\n      let lcName;\n      let l;\n      /* Execute a hook if present */\n\n      _executeHook('beforeSanitizeAttributes', currentNode, null);\n\n      const {\n        attributes\n      } = currentNode;\n      /* Check if we have attributes; if not we might have a text node */\n\n      if (!attributes) {\n        return;\n      }\n\n      const hookEvent = {\n        attrName: '',\n        attrValue: '',\n        keepAttr: true,\n        allowedAttributes: ALLOWED_ATTR\n      };\n      l = attributes.length;\n      /* Go backwards over all attributes; safely remove bad ones */\n\n      while (l--) {\n        attr = attributes[l];\n        const {\n          name,\n          namespaceURI\n        } = attr;\n        value = name === 'value' ? attr.value : stringTrim(attr.value);\n        lcName = transformCaseFunc(name);\n        /* Execute a hook if present */\n\n        hookEvent.attrName = lcName;\n        hookEvent.attrValue = value;\n        hookEvent.keepAttr = true;\n        hookEvent.forceKeepAttr = undefined; // Allows developers to see this is a property they can set\n\n        _executeHook('uponSanitizeAttribute', currentNode, hookEvent);\n\n        value = hookEvent.attrValue;\n        /* Did the hooks approve of the attribute? */\n\n        if (hookEvent.forceKeepAttr) {\n          continue;\n        }\n        /* Remove attribute */\n\n\n        _removeAttribute(name, currentNode);\n        /* Did the hooks approve of the attribute? */\n\n\n        if (!hookEvent.keepAttr) {\n          continue;\n        }\n        /* Work around a security issue in jQuery 3.0 */\n\n\n        if (!ALLOW_SELF_CLOSE_IN_ATTR && regExpTest(/\\/>/i, value)) {\n          _removeAttribute(name, currentNode);\n\n          continue;\n        }\n        /* Sanitize attribute content to be template-safe */\n\n\n        if (SAFE_FOR_TEMPLATES) {\n          value = stringReplace(value, MUSTACHE_EXPR, ' ');\n          value = stringReplace(value, ERB_EXPR, ' ');\n          value = stringReplace(value, TMPLIT_EXPR, ' ');\n        }\n        /* Is `value` valid for this attribute? */\n\n\n        const lcTag = transformCaseFunc(currentNode.nodeName);\n\n        if (!_isValidAttribute(lcTag, lcName, value)) {\n          continue;\n        }\n        /* Full DOM Clobbering protection via namespace isolation,\n         * Prefix id and name attributes with `user-content-`\n         */\n\n\n        if (SANITIZE_NAMED_PROPS && (lcName === 'id' || lcName === 'name')) {\n          // Remove the attribute with this value\n          _removeAttribute(name, currentNode); // Prefix the value and later re-create the attribute with the sanitized value\n\n\n          value = SANITIZE_NAMED_PROPS_PREFIX + value;\n        }\n        /* Handle attributes that require Trusted Types */\n\n\n        if (trustedTypesPolicy && typeof trustedTypes === 'object' && typeof trustedTypes.getAttributeType === 'function') {\n          if (namespaceURI) ; else {\n            switch (trustedTypes.getAttributeType(lcTag, lcName)) {\n              case 'TrustedHTML':\n                {\n                  value = trustedTypesPolicy.createHTML(value);\n                  break;\n                }\n\n              case 'TrustedScriptURL':\n                {\n                  value = trustedTypesPolicy.createScriptURL(value);\n                  break;\n                }\n            }\n          }\n        }\n        /* Handle invalid data-* attribute set by try-catching it */\n\n\n        try {\n          if (namespaceURI) {\n            currentNode.setAttributeNS(namespaceURI, name, value);\n          } else {\n            /* Fallback to setAttribute() for browser-unrecognized namespaces e.g. \"x-schema\". */\n            currentNode.setAttribute(name, value);\n          }\n\n          arrayPop(DOMPurify.removed);\n        } catch (_) {}\n      }\n      /* Execute a hook if present */\n\n\n      _executeHook('afterSanitizeAttributes', currentNode, null);\n    };\n    /**\n     * _sanitizeShadowDOM\n     *\n     * @param  {DocumentFragment} fragment to iterate over recursively\n     */\n\n\n    const _sanitizeShadowDOM = function _sanitizeShadowDOM(fragment) {\n      let shadowNode;\n\n      const shadowIterator = _createIterator(fragment);\n      /* Execute a hook if present */\n\n\n      _executeHook('beforeSanitizeShadowDOM', fragment, null);\n\n      while (shadowNode = shadowIterator.nextNode()) {\n        /* Execute a hook if present */\n        _executeHook('uponSanitizeShadowNode', shadowNode, null);\n        /* Sanitize tags and elements */\n\n\n        if (_sanitizeElements(shadowNode)) {\n          continue;\n        }\n        /* Deep shadow DOM detected */\n\n\n        if (shadowNode.content instanceof DocumentFragment) {\n          _sanitizeShadowDOM(shadowNode.content);\n        }\n        /* Check attributes, sanitize if necessary */\n\n\n        _sanitizeAttributes(shadowNode);\n      }\n      /* Execute a hook if present */\n\n\n      _executeHook('afterSanitizeShadowDOM', fragment, null);\n    };\n    /**\n     * Sanitize\n     * Public method providing core sanitation functionality\n     *\n     * @param {String|Node} dirty string or DOM node\n     * @param {Object} configuration object\n     */\n    // eslint-disable-next-line complexity\n\n\n    DOMPurify.sanitize = function (dirty) {\n      let cfg = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n      let body;\n      let importedNode;\n      let currentNode;\n      let returnNode;\n      /* Make sure we have a string to sanitize.\n        DO NOT return early, as this will return the wrong type if\n        the user has requested a DOM object rather than a string */\n\n      IS_EMPTY_INPUT = !dirty;\n\n      if (IS_EMPTY_INPUT) {\n        dirty = '<!-->';\n      }\n      /* Stringify, in case dirty is an object */\n\n\n      if (typeof dirty !== 'string' && !_isNode(dirty)) {\n        if (typeof dirty.toString === 'function') {\n          dirty = dirty.toString();\n\n          if (typeof dirty !== 'string') {\n            throw typeErrorCreate('dirty is not a string, aborting');\n          }\n        } else {\n          throw typeErrorCreate('toString is not a function');\n        }\n      }\n      /* Return dirty HTML if DOMPurify cannot run */\n\n\n      if (!DOMPurify.isSupported) {\n        return dirty;\n      }\n      /* Assign config vars */\n\n\n      if (!SET_CONFIG) {\n        _parseConfig(cfg);\n      }\n      /* Clean up removed elements */\n\n\n      DOMPurify.removed = [];\n      /* Check if dirty is correctly typed for IN_PLACE */\n\n      if (typeof dirty === 'string') {\n        IN_PLACE = false;\n      }\n\n      if (IN_PLACE) {\n        /* Do some early pre-sanitization to avoid unsafe root nodes */\n        if (dirty.nodeName) {\n          const tagName = transformCaseFunc(dirty.nodeName);\n\n          if (!ALLOWED_TAGS[tagName] || FORBID_TAGS[tagName]) {\n            throw typeErrorCreate('root node is forbidden and cannot be sanitized in-place');\n          }\n        }\n      } else if (dirty instanceof Node) {\n        /* If dirty is a DOM element, append to an empty document to avoid\n           elements being stripped by the parser */\n        body = _initDocument('<!---->');\n        importedNode = body.ownerDocument.importNode(dirty, true);\n\n        if (importedNode.nodeType === 1 && importedNode.nodeName === 'BODY') {\n          /* Node is already a body, use as is */\n          body = importedNode;\n        } else if (importedNode.nodeName === 'HTML') {\n          body = importedNode;\n        } else {\n          // eslint-disable-next-line unicorn/prefer-dom-node-append\n          body.appendChild(importedNode);\n        }\n      } else {\n        /* Exit directly if we have nothing to do */\n        if (!RETURN_DOM && !SAFE_FOR_TEMPLATES && !WHOLE_DOCUMENT && // eslint-disable-next-line unicorn/prefer-includes\n        dirty.indexOf('<') === -1) {\n          return trustedTypesPolicy && RETURN_TRUSTED_TYPE ? trustedTypesPolicy.createHTML(dirty) : dirty;\n        }\n        /* Initialize the document to work on */\n\n\n        body = _initDocument(dirty);\n        /* Check we have a DOM node from the data */\n\n        if (!body) {\n          return RETURN_DOM ? null : RETURN_TRUSTED_TYPE ? emptyHTML : '';\n        }\n      }\n      /* Remove first element node (ours) if FORCE_BODY is set */\n\n\n      if (body && FORCE_BODY) {\n        _forceRemove(body.firstChild);\n      }\n      /* Get node iterator */\n\n\n      const nodeIterator = _createIterator(IN_PLACE ? dirty : body);\n      /* Now start iterating over the created document */\n\n\n      while (currentNode = nodeIterator.nextNode()) {\n        /* Sanitize tags and elements */\n        if (_sanitizeElements(currentNode)) {\n          continue;\n        }\n        /* Shadow DOM detected, sanitize it */\n\n\n        if (currentNode.content instanceof DocumentFragment) {\n          _sanitizeShadowDOM(currentNode.content);\n        }\n        /* Check attributes, sanitize if necessary */\n\n\n        _sanitizeAttributes(currentNode);\n      }\n      /* If we sanitized `dirty` in-place, return it. */\n\n\n      if (IN_PLACE) {\n        return dirty;\n      }\n      /* Return sanitized string or DOM */\n\n\n      if (RETURN_DOM) {\n        if (RETURN_DOM_FRAGMENT) {\n          returnNode = createDocumentFragment.call(body.ownerDocument);\n\n          while (body.firstChild) {\n            // eslint-disable-next-line unicorn/prefer-dom-node-append\n            returnNode.appendChild(body.firstChild);\n          }\n        } else {\n          returnNode = body;\n        }\n\n        if (ALLOWED_ATTR.shadowroot || ALLOWED_ATTR.shadowrootmod) {\n          /*\n            AdoptNode() is not used because internal state is not reset\n            (e.g. the past names map of a HTMLFormElement), this is safe\n            in theory but we would rather not risk another attack vector.\n            The state that is cloned by importNode() is explicitly defined\n            by the specs.\n          */\n          returnNode = importNode.call(originalDocument, returnNode, true);\n        }\n\n        return returnNode;\n      }\n\n      let serializedHTML = WHOLE_DOCUMENT ? body.outerHTML : body.innerHTML;\n      /* Serialize doctype if allowed */\n\n      if (WHOLE_DOCUMENT && ALLOWED_TAGS['!doctype'] && body.ownerDocument && body.ownerDocument.doctype && body.ownerDocument.doctype.name && regExpTest(DOCTYPE_NAME, body.ownerDocument.doctype.name)) {\n        serializedHTML = '<!DOCTYPE ' + body.ownerDocument.doctype.name + '>\\n' + serializedHTML;\n      }\n      /* Sanitize final string template-safe */\n\n\n      if (SAFE_FOR_TEMPLATES) {\n        serializedHTML = stringReplace(serializedHTML, MUSTACHE_EXPR, ' ');\n        serializedHTML = stringReplace(serializedHTML, ERB_EXPR, ' ');\n        serializedHTML = stringReplace(serializedHTML, TMPLIT_EXPR, ' ');\n      }\n\n      return trustedTypesPolicy && RETURN_TRUSTED_TYPE ? trustedTypesPolicy.createHTML(serializedHTML) : serializedHTML;\n    };\n    /**\n     * Public method to set the configuration once\n     * setConfig\n     *\n     * @param {Object} cfg configuration object\n     */\n\n\n    DOMPurify.setConfig = function (cfg) {\n      _parseConfig(cfg);\n\n      SET_CONFIG = true;\n    };\n    /**\n     * Public method to remove the configuration\n     * clearConfig\n     *\n     */\n\n\n    DOMPurify.clearConfig = function () {\n      CONFIG = null;\n      SET_CONFIG = false;\n    };\n    /**\n     * Public method to check if an attribute value is valid.\n     * Uses last set config, if any. Otherwise, uses config defaults.\n     * isValidAttribute\n     *\n     * @param  {string} tag Tag name of containing element.\n     * @param  {string} attr Attribute name.\n     * @param  {string} value Attribute value.\n     * @return {Boolean} Returns true if `value` is valid. Otherwise, returns false.\n     */\n\n\n    DOMPurify.isValidAttribute = function (tag, attr, value) {\n      /* Initialize shared config vars if necessary. */\n      if (!CONFIG) {\n        _parseConfig({});\n      }\n\n      const lcTag = transformCaseFunc(tag);\n      const lcName = transformCaseFunc(attr);\n      return _isValidAttribute(lcTag, lcName, value);\n    };\n    /**\n     * AddHook\n     * Public method to add DOMPurify hooks\n     *\n     * @param {String} entryPoint entry point for the hook to add\n     * @param {Function} hookFunction function to execute\n     */\n\n\n    DOMPurify.addHook = function (entryPoint, hookFunction) {\n      if (typeof hookFunction !== 'function') {\n        return;\n      }\n\n      hooks[entryPoint] = hooks[entryPoint] || [];\n      arrayPush(hooks[entryPoint], hookFunction);\n    };\n    /**\n     * RemoveHook\n     * Public method to remove a DOMPurify hook at a given entryPoint\n     * (pops it from the stack of hooks if more are present)\n     *\n     * @param {String} entryPoint entry point for the hook to remove\n     * @return {Function} removed(popped) hook\n     */\n\n\n    DOMPurify.removeHook = function (entryPoint) {\n      if (hooks[entryPoint]) {\n        return arrayPop(hooks[entryPoint]);\n      }\n    };\n    /**\n     * RemoveHooks\n     * Public method to remove all DOMPurify hooks at a given entryPoint\n     *\n     * @param  {String} entryPoint entry point for the hooks to remove\n     */\n\n\n    DOMPurify.removeHooks = function (entryPoint) {\n      if (hooks[entryPoint]) {\n        hooks[entryPoint] = [];\n      }\n    };\n    /**\n     * RemoveAllHooks\n     * Public method to remove all DOMPurify hooks\n     *\n     */\n\n\n    DOMPurify.removeAllHooks = function () {\n      hooks = {};\n    };\n\n    return DOMPurify;\n  }\n\n  var purify = createDOMPurify();\n\n  return purify;\n\n}));\n//# sourceMappingURL=purify.js.map\n","/*!\n * EventEmitter2\n * https://github.com/hij1nx/EventEmitter2\n *\n * Copyright (c) 2013 hij1nx\n * Licensed under the MIT license.\n */\n;!function(undefined) {\n  var hasOwnProperty= Object.hasOwnProperty;\n  var isArray = Array.isArray ? Array.isArray : function _isArray(obj) {\n    return Object.prototype.toString.call(obj) === \"[object Array]\";\n  };\n  var defaultMaxListeners = 10;\n  var nextTickSupported= typeof process=='object' && typeof process.nextTick=='function';\n  var symbolsSupported= typeof Symbol==='function';\n  var reflectSupported= typeof Reflect === 'object';\n  var setImmediateSupported= typeof setImmediate === 'function';\n  var _setImmediate= setImmediateSupported ? setImmediate : setTimeout;\n  var ownKeys= symbolsSupported? (reflectSupported && typeof Reflect.ownKeys==='function'? Reflect.ownKeys : function(obj){\n    var arr= Object.getOwnPropertyNames(obj);\n    arr.push.apply(arr, Object.getOwnPropertySymbols(obj));\n    return arr;\n  }) : Object.keys;\n\n  function init() {\n    this._events = {};\n    if (this._conf) {\n      configure.call(this, this._conf);\n    }\n  }\n\n  function configure(conf) {\n    if (conf) {\n      this._conf = conf;\n\n      conf.delimiter && (this.delimiter = conf.delimiter);\n\n      if(conf.maxListeners!==undefined){\n          this._maxListeners= conf.maxListeners;\n      }\n\n      conf.wildcard && (this.wildcard = conf.wildcard);\n      conf.newListener && (this._newListener = conf.newListener);\n      conf.removeListener && (this._removeListener = conf.removeListener);\n      conf.verboseMemoryLeak && (this.verboseMemoryLeak = conf.verboseMemoryLeak);\n      conf.ignoreErrors && (this.ignoreErrors = conf.ignoreErrors);\n\n      if (this.wildcard) {\n        this.listenerTree = {};\n      }\n    }\n  }\n\n  function logPossibleMemoryLeak(count, eventName) {\n    var errorMsg = '(node) warning: possible EventEmitter memory ' +\n        'leak detected. ' + count + ' listeners added. ' +\n        'Use emitter.setMaxListeners() to increase limit.';\n\n    if(this.verboseMemoryLeak){\n      errorMsg += ' Event name: ' + eventName + '.';\n    }\n\n    if(typeof process !== 'undefined' && process.emitWarning){\n      var e = new Error(errorMsg);\n      e.name = 'MaxListenersExceededWarning';\n      e.emitter = this;\n      e.count = count;\n      process.emitWarning(e);\n    } else {\n      console.error(errorMsg);\n\n      if (console.trace){\n        console.trace();\n      }\n    }\n  }\n\n  var toArray = function (a, b, c) {\n    var n = arguments.length;\n    switch (n) {\n      case 0:\n        return [];\n      case 1:\n        return [a];\n      case 2:\n        return [a, b];\n      case 3:\n        return [a, b, c];\n      default:\n        var arr = new Array(n);\n        while (n--) {\n          arr[n] = arguments[n];\n        }\n        return arr;\n    }\n  };\n\n  function toObject(keys, values) {\n    var obj = {};\n    var key;\n    var len = keys.length;\n    var valuesCount = values ? value.length : 0;\n    for (var i = 0; i < len; i++) {\n      key = keys[i];\n      obj[key] = i < valuesCount ? values[i] : undefined;\n    }\n    return obj;\n  }\n\n  function TargetObserver(emitter, target, options) {\n    this._emitter = emitter;\n    this._target = target;\n    this._listeners = {};\n    this._listenersCount = 0;\n\n    var on, off;\n\n    if (options.on || options.off) {\n      on = options.on;\n      off = options.off;\n    }\n\n    if (target.addEventListener) {\n      on = target.addEventListener;\n      off = target.removeEventListener;\n    } else if (target.addListener) {\n      on = target.addListener;\n      off = target.removeListener;\n    } else if (target.on) {\n      on = target.on;\n      off = target.off;\n    }\n\n    if (!on && !off) {\n      throw Error('target does not implement any known event API');\n    }\n\n    if (typeof on !== 'function') {\n      throw TypeError('on method must be a function');\n    }\n\n    if (typeof off !== 'function') {\n      throw TypeError('off method must be a function');\n    }\n\n    this._on = on;\n    this._off = off;\n\n    var _observers= emitter._observers;\n    if(_observers){\n      _observers.push(this);\n    }else{\n      emitter._observers= [this];\n    }\n  }\n\n  Object.assign(TargetObserver.prototype, {\n    subscribe: function(event, localEvent, reducer){\n      var observer= this;\n      var target= this._target;\n      var emitter= this._emitter;\n      var listeners= this._listeners;\n      var handler= function(){\n        var args= toArray.apply(null, arguments);\n        var eventObj= {\n          data: args,\n          name: localEvent,\n          original: event\n        };\n        if(reducer){\n          var result= reducer.call(target, eventObj);\n          if(result!==false){\n            emitter.emit.apply(emitter, [eventObj.name].concat(args))\n          }\n          return;\n        }\n        emitter.emit.apply(emitter, [localEvent].concat(args));\n      };\n\n\n      if(listeners[event]){\n        throw Error('Event \\'' + event + '\\' is already listening');\n      }\n\n      this._listenersCount++;\n\n      if(emitter._newListener && emitter._removeListener && !observer._onNewListener){\n\n        this._onNewListener = function (_event) {\n          if (_event === localEvent && listeners[event] === null) {\n            listeners[event] = handler;\n            observer._on.call(target, event, handler);\n          }\n        };\n\n        emitter.on('newListener', this._onNewListener);\n\n        this._onRemoveListener= function(_event){\n          if(_event === localEvent && !emitter.hasListeners(_event) && listeners[event]){\n            listeners[event]= null;\n            observer._off.call(target, event, handler);\n          }\n        };\n\n        listeners[event]= null;\n\n        emitter.on('removeListener', this._onRemoveListener);\n      }else{\n        listeners[event]= handler;\n        observer._on.call(target, event, handler);\n      }\n    },\n\n    unsubscribe: function(event){\n      var observer= this;\n      var listeners= this._listeners;\n      var emitter= this._emitter;\n      var handler;\n      var events;\n      var off= this._off;\n      var target= this._target;\n      var i;\n\n      if(event && typeof event!=='string'){\n        throw TypeError('event must be a string');\n      }\n\n      function clearRefs(){\n        if(observer._onNewListener){\n          emitter.off('newListener', observer._onNewListener);\n          emitter.off('removeListener', observer._onRemoveListener);\n          observer._onNewListener= null;\n          observer._onRemoveListener= null;\n        }\n        var index= findTargetIndex.call(emitter, observer);\n        emitter._observers.splice(index, 1);\n      }\n\n      if(event){\n        handler= listeners[event];\n        if(!handler) return;\n        off.call(target, event, handler);\n        delete listeners[event];\n        if(!--this._listenersCount){\n          clearRefs();\n        }\n      }else{\n        events= ownKeys(listeners);\n        i= events.length;\n        while(i-->0){\n          event= events[i];\n          off.call(target, event, listeners[event]);\n        }\n        this._listeners= {};\n        this._listenersCount= 0;\n        clearRefs();\n      }\n    }\n  });\n\n  function resolveOptions(options, schema, reducers, allowUnknown) {\n    var computedOptions = Object.assign({}, schema);\n\n    if (!options) return computedOptions;\n\n    if (typeof options !== 'object') {\n      throw TypeError('options must be an object')\n    }\n\n    var keys = Object.keys(options);\n    var length = keys.length;\n    var option, value;\n    var reducer;\n\n    function reject(reason) {\n      throw Error('Invalid \"' + option + '\" option value' + (reason ? '. Reason: ' + reason : ''))\n    }\n\n    for (var i = 0; i < length; i++) {\n      option = keys[i];\n      if (!allowUnknown && !hasOwnProperty.call(schema, option)) {\n        throw Error('Unknown \"' + option + '\" option');\n      }\n      value = options[option];\n      if (value !== undefined) {\n        reducer = reducers[option];\n        computedOptions[option] = reducer ? reducer(value, reject) : value;\n      }\n    }\n    return computedOptions;\n  }\n\n  function constructorReducer(value, reject) {\n    if (typeof value !== 'function' || !value.hasOwnProperty('prototype')) {\n      reject('value must be a constructor');\n    }\n    return value;\n  }\n\n  function makeTypeReducer(types) {\n    var message= 'value must be type of ' + types.join('|');\n    var len= types.length;\n    var firstType= types[0];\n    var secondType= types[1];\n\n    if (len === 1) {\n      return function (v, reject) {\n        if (typeof v === firstType) {\n          return v;\n        }\n        reject(message);\n      }\n    }\n\n    if (len === 2) {\n      return function (v, reject) {\n        var kind= typeof v;\n        if (kind === firstType || kind === secondType) return v;\n        reject(message);\n      }\n    }\n\n    return function (v, reject) {\n      var kind = typeof v;\n      var i = len;\n      while (i-- > 0) {\n        if (kind === types[i]) return v;\n      }\n      reject(message);\n    }\n  }\n\n  var functionReducer= makeTypeReducer(['function']);\n\n  var objectFunctionReducer= makeTypeReducer(['object', 'function']);\n\n  function makeCancelablePromise(Promise, executor, options) {\n    var isCancelable;\n    var callbacks;\n    var timer= 0;\n    var subscriptionClosed;\n\n    var promise = new Promise(function (resolve, reject, onCancel) {\n      options= resolveOptions(options, {\n        timeout: 0,\n        overload: false\n      }, {\n        timeout: function(value, reject){\n          value*= 1;\n          if (typeof value !== 'number' || value < 0 || !Number.isFinite(value)) {\n            reject('timeout must be a positive number');\n          }\n          return value;\n        }\n      });\n\n      isCancelable = !options.overload && typeof Promise.prototype.cancel === 'function' && typeof onCancel === 'function';\n\n      function cleanup() {\n        if (callbacks) {\n          callbacks = null;\n        }\n        if (timer) {\n          clearTimeout(timer);\n          timer = 0;\n        }\n      }\n\n      var _resolve= function(value){\n        cleanup();\n        resolve(value);\n      };\n\n      var _reject= function(err){\n        cleanup();\n        reject(err);\n      };\n\n      if (isCancelable) {\n        executor(_resolve, _reject, onCancel);\n      } else {\n        callbacks = [function(reason){\n          _reject(reason || Error('canceled'));\n        }];\n        executor(_resolve, _reject, function (cb) {\n          if (subscriptionClosed) {\n            throw Error('Unable to subscribe on cancel event asynchronously')\n          }\n          if (typeof cb !== 'function') {\n            throw TypeError('onCancel callback must be a function');\n          }\n          callbacks.push(cb);\n        });\n        subscriptionClosed= true;\n      }\n\n      if (options.timeout > 0) {\n        timer= setTimeout(function(){\n          var reason= Error('timeout');\n          reason.code = 'ETIMEDOUT'\n          timer= 0;\n          promise.cancel(reason);\n          reject(reason);\n        }, options.timeout);\n      }\n    });\n\n    if (!isCancelable) {\n      promise.cancel = function (reason) {\n        if (!callbacks) {\n          return;\n        }\n        var length = callbacks.length;\n        for (var i = 1; i < length; i++) {\n          callbacks[i](reason);\n        }\n        // internal callback to reject the promise\n        callbacks[0](reason);\n        callbacks = null;\n      };\n    }\n\n    return promise;\n  }\n\n  function findTargetIndex(observer) {\n    var observers = this._observers;\n    if(!observers){\n      return -1;\n    }\n    var len = observers.length;\n    for (var i = 0; i < len; i++) {\n      if (observers[i]._target === observer) return i;\n    }\n    return -1;\n  }\n\n  // Attention, function return type now is array, always !\n  // It has zero elements if no any matches found and one or more\n  // elements (leafs) if there are matches\n  //\n  function searchListenerTree(handlers, type, tree, i, typeLength) {\n    if (!tree) {\n      return null;\n    }\n\n    if (i === 0) {\n      var kind = typeof type;\n      if (kind === 'string') {\n        var ns, n, l = 0, j = 0, delimiter = this.delimiter, dl = delimiter.length;\n        if ((n = type.indexOf(delimiter)) !== -1) {\n          ns = new Array(5);\n          do {\n            ns[l++] = type.slice(j, n);\n            j = n + dl;\n          } while ((n = type.indexOf(delimiter, j)) !== -1);\n\n          ns[l++] = type.slice(j);\n          type = ns;\n          typeLength = l;\n        } else {\n          type = [type];\n          typeLength = 1;\n        }\n      } else if (kind === 'object') {\n        typeLength = type.length;\n      } else {\n        type = [type];\n        typeLength = 1;\n      }\n    }\n\n    var listeners= null, branch, xTree, xxTree, isolatedBranch, endReached, currentType = type[i],\n        nextType = type[i + 1], branches, _listeners;\n\n    if (i === typeLength) {\n      //\n      // If at the end of the event(s) list and the tree has listeners\n      // invoke those listeners.\n      //\n\n      if(tree._listeners) {\n        if (typeof tree._listeners === 'function') {\n          handlers && handlers.push(tree._listeners);\n          listeners = [tree];\n        } else {\n          handlers && handlers.push.apply(handlers, tree._listeners);\n          listeners = [tree];\n        }\n      }\n    } else {\n\n      if (currentType === '*') {\n        //\n        // If the event emitted is '*' at this part\n        // or there is a concrete match at this patch\n        //\n        branches = ownKeys(tree);\n        n = branches.length;\n        while (n-- > 0) {\n          branch = branches[n];\n          if (branch !== '_listeners') {\n            _listeners = searchListenerTree(handlers, type, tree[branch], i + 1, typeLength);\n            if (_listeners) {\n              if (listeners) {\n                listeners.push.apply(listeners, _listeners);\n              } else {\n                listeners = _listeners;\n              }\n            }\n          }\n        }\n        return listeners;\n      } else if (currentType === '**') {\n        endReached = (i + 1 === typeLength || (i + 2 === typeLength && nextType === '*'));\n        if (endReached && tree._listeners) {\n          // The next element has a _listeners, add it to the handlers.\n          listeners = searchListenerTree(handlers, type, tree, typeLength, typeLength);\n        }\n\n        branches = ownKeys(tree);\n        n = branches.length;\n        while (n-- > 0) {\n          branch = branches[n];\n          if (branch !== '_listeners') {\n            if (branch === '*' || branch === '**') {\n              if (tree[branch]._listeners && !endReached) {\n                _listeners = searchListenerTree(handlers, type, tree[branch], typeLength, typeLength);\n                if (_listeners) {\n                  if (listeners) {\n                    listeners.push.apply(listeners, _listeners);\n                  } else {\n                    listeners = _listeners;\n                  }\n                }\n              }\n              _listeners = searchListenerTree(handlers, type, tree[branch], i, typeLength);\n            } else if (branch === nextType) {\n              _listeners = searchListenerTree(handlers, type, tree[branch], i + 2, typeLength);\n            } else {\n              // No match on this one, shift into the tree but not in the type array.\n              _listeners = searchListenerTree(handlers, type, tree[branch], i, typeLength);\n            }\n            if (_listeners) {\n              if (listeners) {\n                listeners.push.apply(listeners, _listeners);\n              } else {\n                listeners = _listeners;\n              }\n            }\n          }\n        }\n        return listeners;\n      } else if (tree[currentType]) {\n        listeners = searchListenerTree(handlers, type, tree[currentType], i + 1, typeLength);\n      }\n    }\n\n      xTree = tree['*'];\n    if (xTree) {\n      //\n      // If the listener tree will allow any match for this part,\n      // then recursively explore all branches of the tree\n      //\n      searchListenerTree(handlers, type, xTree, i + 1, typeLength);\n    }\n\n    xxTree = tree['**'];\n    if (xxTree) {\n      if (i < typeLength) {\n        if (xxTree._listeners) {\n          // If we have a listener on a '**', it will catch all, so add its handler.\n          searchListenerTree(handlers, type, xxTree, typeLength, typeLength);\n        }\n\n        // Build arrays of matching next branches and others.\n        branches= ownKeys(xxTree);\n        n= branches.length;\n        while(n-->0){\n          branch= branches[n];\n          if (branch !== '_listeners') {\n            if (branch === nextType) {\n              // We know the next element will match, so jump twice.\n              searchListenerTree(handlers, type, xxTree[branch], i + 2, typeLength);\n            } else if (branch === currentType) {\n              // Current node matches, move into the tree.\n              searchListenerTree(handlers, type, xxTree[branch], i + 1, typeLength);\n            } else {\n              isolatedBranch = {};\n              isolatedBranch[branch] = xxTree[branch];\n              searchListenerTree(handlers, type, {'**': isolatedBranch}, i + 1, typeLength);\n            }\n          }\n        }\n      } else if (xxTree._listeners) {\n        // We have reached the end and still on a '**'\n        searchListenerTree(handlers, type, xxTree, typeLength, typeLength);\n      } else if (xxTree['*'] && xxTree['*']._listeners) {\n        searchListenerTree(handlers, type, xxTree['*'], typeLength, typeLength);\n      }\n    }\n\n    return listeners;\n  }\n\n  function growListenerTree(type, listener, prepend) {\n    var len = 0, j = 0, i, delimiter = this.delimiter, dl= delimiter.length, ns;\n\n    if(typeof type==='string') {\n      if ((i = type.indexOf(delimiter)) !== -1) {\n        ns = new Array(5);\n        do {\n          ns[len++] = type.slice(j, i);\n          j = i + dl;\n        } while ((i = type.indexOf(delimiter, j)) !== -1);\n\n        ns[len++] = type.slice(j);\n      }else{\n        ns= [type];\n        len= 1;\n      }\n    }else{\n      ns= type;\n      len= type.length;\n    }\n\n    //\n    // Looks for two consecutive '**', if so, don't add the event at all.\n    //\n    if (len > 1) {\n      for (i = 0; i + 1 < len; i++) {\n        if (ns[i] === '**' && ns[i + 1] === '**') {\n          return;\n        }\n      }\n    }\n\n\n\n    var tree = this.listenerTree, name;\n\n    for (i = 0; i < len; i++) {\n      name = ns[i];\n\n      tree = tree[name] || (tree[name] = {});\n\n      if (i === len - 1) {\n        if (!tree._listeners) {\n          tree._listeners = listener;\n        } else {\n          if (typeof tree._listeners === 'function') {\n            tree._listeners = [tree._listeners];\n          }\n\n          if (prepend) {\n            tree._listeners.unshift(listener);\n          } else {\n            tree._listeners.push(listener);\n          }\n\n          if (\n              !tree._listeners.warned &&\n              this._maxListeners > 0 &&\n              tree._listeners.length > this._maxListeners\n          ) {\n            tree._listeners.warned = true;\n            logPossibleMemoryLeak.call(this, tree._listeners.length, name);\n          }\n        }\n        return true;\n      }\n    }\n\n    return true;\n  }\n\n  function collectTreeEvents(tree, events, root, asArray){\n     var branches= ownKeys(tree);\n     var i= branches.length;\n     var branch, branchName, path;\n     var hasListeners= tree['_listeners'];\n     var isArrayPath;\n\n     while(i-->0){\n         branchName= branches[i];\n\n         branch= tree[branchName];\n\n         if(branchName==='_listeners'){\n             path= root;\n         }else {\n             path = root ? root.concat(branchName) : [branchName];\n         }\n\n         isArrayPath= asArray || typeof branchName==='symbol';\n\n         hasListeners && events.push(isArrayPath? path : path.join(this.delimiter));\n\n         if(typeof branch==='object'){\n             collectTreeEvents.call(this, branch, events, path, isArrayPath);\n         }\n     }\n\n     return events;\n  }\n\n  function recursivelyGarbageCollect(root) {\n    var keys = ownKeys(root);\n    var i= keys.length;\n    var obj, key, flag;\n    while(i-->0){\n      key = keys[i];\n      obj = root[key];\n\n      if(obj){\n          flag= true;\n          if(key !== '_listeners' && !recursivelyGarbageCollect(obj)){\n             delete root[key];\n          }\n      }\n    }\n\n    return flag;\n  }\n\n  function Listener(emitter, event, listener){\n    this.emitter= emitter;\n    this.event= event;\n    this.listener= listener;\n  }\n\n  Listener.prototype.off= function(){\n    this.emitter.off(this.event, this.listener);\n    return this;\n  };\n\n  function setupListener(event, listener, options){\n      if (options === true) {\n        promisify = true;\n      } else if (options === false) {\n        async = true;\n      } else {\n        if (!options || typeof options !== 'object') {\n          throw TypeError('options should be an object or true');\n        }\n        var async = options.async;\n        var promisify = options.promisify;\n        var nextTick = options.nextTick;\n        var objectify = options.objectify;\n      }\n\n      if (async || nextTick || promisify) {\n        var _listener = listener;\n        var _origin = listener._origin || listener;\n\n        if (nextTick && !nextTickSupported) {\n          throw Error('process.nextTick is not supported');\n        }\n\n        if (promisify === undefined) {\n          promisify = listener.constructor.name === 'AsyncFunction';\n        }\n\n        listener = function () {\n          var args = arguments;\n          var context = this;\n          var event = this.event;\n\n          return promisify ? (nextTick ? Promise.resolve() : new Promise(function (resolve) {\n            _setImmediate(resolve);\n          }).then(function () {\n            context.event = event;\n            return _listener.apply(context, args)\n          })) : (nextTick ? process.nextTick : _setImmediate)(function () {\n            context.event = event;\n            _listener.apply(context, args)\n          });\n        };\n\n        listener._async = true;\n        listener._origin = _origin;\n      }\n\n    return [listener, objectify? new Listener(this, event, listener): this];\n  }\n\n  function EventEmitter(conf) {\n    this._events = {};\n    this._newListener = false;\n    this._removeListener = false;\n    this.verboseMemoryLeak = false;\n    configure.call(this, conf);\n  }\n\n  EventEmitter.EventEmitter2 = EventEmitter; // backwards compatibility for exporting EventEmitter property\n\n  EventEmitter.prototype.listenTo= function(target, events, options){\n    if(typeof target!=='object'){\n      throw TypeError('target musts be an object');\n    }\n\n    var emitter= this;\n\n    options = resolveOptions(options, {\n      on: undefined,\n      off: undefined,\n      reducers: undefined\n    }, {\n      on: functionReducer,\n      off: functionReducer,\n      reducers: objectFunctionReducer\n    });\n\n    function listen(events){\n      if(typeof events!=='object'){\n        throw TypeError('events must be an object');\n      }\n\n      var reducers= options.reducers;\n      var index= findTargetIndex.call(emitter, target);\n      var observer;\n\n      if(index===-1){\n        observer= new TargetObserver(emitter, target, options);\n      }else{\n        observer= emitter._observers[index];\n      }\n\n      var keys= ownKeys(events);\n      var len= keys.length;\n      var event;\n      var isSingleReducer= typeof reducers==='function';\n\n      for(var i=0; i<len; i++){\n        event= keys[i];\n        observer.subscribe(\n            event,\n            events[event] || event,\n            isSingleReducer ? reducers : reducers && reducers[event]\n        );\n      }\n    }\n\n    isArray(events)?\n        listen(toObject(events)) :\n        (typeof events==='string'? listen(toObject(events.split(/\\s+/))): listen(events));\n\n    return this;\n  };\n\n  EventEmitter.prototype.stopListeningTo = function (target, event) {\n    var observers = this._observers;\n\n    if(!observers){\n      return false;\n    }\n\n    var i = observers.length;\n    var observer;\n    var matched= false;\n\n    if(target && typeof target!=='object'){\n      throw TypeError('target should be an object');\n    }\n\n    while (i-- > 0) {\n      observer = observers[i];\n      if (!target || observer._target === target) {\n        observer.unsubscribe(event);\n        matched= true;\n      }\n    }\n\n    return matched;\n  };\n\n  // By default EventEmitters will print a warning if more than\n  // 10 listeners are added to it. This is a useful default which\n  // helps finding memory leaks.\n  //\n  // Obviously not all Emitters should be limited to 10. This function allows\n  // that to be increased. Set to zero for unlimited.\n\n  EventEmitter.prototype.delimiter = '.';\n\n  EventEmitter.prototype.setMaxListeners = function(n) {\n    if (n !== undefined) {\n      this._maxListeners = n;\n      if (!this._conf) this._conf = {};\n      this._conf.maxListeners = n;\n    }\n  };\n\n  EventEmitter.prototype.getMaxListeners = function() {\n    return this._maxListeners;\n  };\n\n  EventEmitter.prototype.event = '';\n\n  EventEmitter.prototype.once = function(event, fn, options) {\n    return this._once(event, fn, false, options);\n  };\n\n  EventEmitter.prototype.prependOnceListener = function(event, fn, options) {\n    return this._once(event, fn, true, options);\n  };\n\n  EventEmitter.prototype._once = function(event, fn, prepend, options) {\n    return this._many(event, 1, fn, prepend, options);\n  };\n\n  EventEmitter.prototype.many = function(event, ttl, fn, options) {\n    return this._many(event, ttl, fn, false, options);\n  };\n\n  EventEmitter.prototype.prependMany = function(event, ttl, fn, options) {\n    return this._many(event, ttl, fn, true, options);\n  };\n\n  EventEmitter.prototype._many = function(event, ttl, fn, prepend, options) {\n    var self = this;\n\n    if (typeof fn !== 'function') {\n      throw new Error('many only accepts instances of Function');\n    }\n\n    function listener() {\n      if (--ttl === 0) {\n        self.off(event, listener);\n      }\n      return fn.apply(this, arguments);\n    }\n\n    listener._origin = fn;\n\n    return this._on(event, listener, prepend, options);\n  };\n\n  EventEmitter.prototype.emit = function() {\n    if (!this._events && !this._all) {\n      return false;\n    }\n\n    this._events || init.call(this);\n\n    var type = arguments[0], ns, wildcard= this.wildcard;\n    var args,l,i,j, containsSymbol;\n\n    if (type === 'newListener' && !this._newListener) {\n      if (!this._events.newListener) {\n        return false;\n      }\n    }\n\n    if (wildcard) {\n      ns= type;\n      if(type!=='newListener' && type!=='removeListener'){\n        if (typeof type === 'object') {\n          l = type.length;\n          if (symbolsSupported) {\n            for (i = 0; i < l; i++) {\n              if (typeof type[i] === 'symbol') {\n                containsSymbol = true;\n                break;\n              }\n            }\n          }\n          if (!containsSymbol) {\n            type = type.join(this.delimiter);\n          }\n        }\n      }\n    }\n\n    var al = arguments.length;\n    var handler;\n\n    if (this._all && this._all.length) {\n      handler = this._all.slice();\n\n      for (i = 0, l = handler.length; i < l; i++) {\n        this.event = type;\n        switch (al) {\n        case 1:\n          handler[i].call(this, type);\n          break;\n        case 2:\n          handler[i].call(this, type, arguments[1]);\n          break;\n        case 3:\n          handler[i].call(this, type, arguments[1], arguments[2]);\n          break;\n        default:\n          handler[i].apply(this, arguments);\n        }\n      }\n    }\n\n    if (wildcard) {\n      handler = [];\n      searchListenerTree.call(this, handler, ns, this.listenerTree, 0, l);\n    } else {\n      handler = this._events[type];\n      if (typeof handler === 'function') {\n        this.event = type;\n        switch (al) {\n        case 1:\n          handler.call(this);\n          break;\n        case 2:\n          handler.call(this, arguments[1]);\n          break;\n        case 3:\n          handler.call(this, arguments[1], arguments[2]);\n          break;\n        default:\n          args = new Array(al - 1);\n          for (j = 1; j < al; j++) args[j - 1] = arguments[j];\n          handler.apply(this, args);\n        }\n        return true;\n      } else if (handler) {\n        // need to make copy of handlers because list can change in the middle\n        // of emit call\n        handler = handler.slice();\n      }\n    }\n\n    if (handler && handler.length) {\n      if (al > 3) {\n        args = new Array(al - 1);\n        for (j = 1; j < al; j++) args[j - 1] = arguments[j];\n      }\n      for (i = 0, l = handler.length; i < l; i++) {\n        this.event = type;\n        switch (al) {\n        case 1:\n          handler[i].call(this);\n          break;\n        case 2:\n          handler[i].call(this, arguments[1]);\n          break;\n        case 3:\n          handler[i].call(this, arguments[1], arguments[2]);\n          break;\n        default:\n          handler[i].apply(this, args);\n        }\n      }\n      return true;\n    } else if (!this.ignoreErrors && !this._all && type === 'error') {\n      if (arguments[1] instanceof Error) {\n        throw arguments[1]; // Unhandled 'error' event\n      } else {\n        throw new Error(\"Uncaught, unspecified 'error' event.\");\n      }\n    }\n\n    return !!this._all;\n  };\n\n  EventEmitter.prototype.emitAsync = function() {\n    if (!this._events && !this._all) {\n      return false;\n    }\n\n    this._events || init.call(this);\n\n    var type = arguments[0], wildcard= this.wildcard, ns, containsSymbol;\n    var args,l,i,j;\n\n    if (type === 'newListener' && !this._newListener) {\n        if (!this._events.newListener) { return Promise.resolve([false]); }\n    }\n\n    if (wildcard) {\n      ns= type;\n      if(type!=='newListener' && type!=='removeListener'){\n        if (typeof type === 'object') {\n          l = type.length;\n          if (symbolsSupported) {\n            for (i = 0; i < l; i++) {\n              if (typeof type[i] === 'symbol') {\n                containsSymbol = true;\n                break;\n              }\n            }\n          }\n          if (!containsSymbol) {\n            type = type.join(this.delimiter);\n          }\n        }\n      }\n    }\n\n    var promises= [];\n\n    var al = arguments.length;\n    var handler;\n\n    if (this._all) {\n      for (i = 0, l = this._all.length; i < l; i++) {\n        this.event = type;\n        switch (al) {\n        case 1:\n          promises.push(this._all[i].call(this, type));\n          break;\n        case 2:\n          promises.push(this._all[i].call(this, type, arguments[1]));\n          break;\n        case 3:\n          promises.push(this._all[i].call(this, type, arguments[1], arguments[2]));\n          break;\n        default:\n          promises.push(this._all[i].apply(this, arguments));\n        }\n      }\n    }\n\n    if (wildcard) {\n      handler = [];\n      searchListenerTree.call(this, handler, ns, this.listenerTree, 0);\n    } else {\n      handler = this._events[type];\n    }\n\n    if (typeof handler === 'function') {\n      this.event = type;\n      switch (al) {\n      case 1:\n        promises.push(handler.call(this));\n        break;\n      case 2:\n        promises.push(handler.call(this, arguments[1]));\n        break;\n      case 3:\n        promises.push(handler.call(this, arguments[1], arguments[2]));\n        break;\n      default:\n        args = new Array(al - 1);\n        for (j = 1; j < al; j++) args[j - 1] = arguments[j];\n        promises.push(handler.apply(this, args));\n      }\n    } else if (handler && handler.length) {\n      handler = handler.slice();\n      if (al > 3) {\n        args = new Array(al - 1);\n        for (j = 1; j < al; j++) args[j - 1] = arguments[j];\n      }\n      for (i = 0, l = handler.length; i < l; i++) {\n        this.event = type;\n        switch (al) {\n        case 1:\n          promises.push(handler[i].call(this));\n          break;\n        case 2:\n          promises.push(handler[i].call(this, arguments[1]));\n          break;\n        case 3:\n          promises.push(handler[i].call(this, arguments[1], arguments[2]));\n          break;\n        default:\n          promises.push(handler[i].apply(this, args));\n        }\n      }\n    } else if (!this.ignoreErrors && !this._all && type === 'error') {\n      if (arguments[1] instanceof Error) {\n        return Promise.reject(arguments[1]); // Unhandled 'error' event\n      } else {\n        return Promise.reject(\"Uncaught, unspecified 'error' event.\");\n      }\n    }\n\n    return Promise.all(promises);\n  };\n\n  EventEmitter.prototype.on = function(type, listener, options) {\n    return this._on(type, listener, false, options);\n  };\n\n  EventEmitter.prototype.prependListener = function(type, listener, options) {\n    return this._on(type, listener, true, options);\n  };\n\n  EventEmitter.prototype.onAny = function(fn) {\n    return this._onAny(fn, false);\n  };\n\n  EventEmitter.prototype.prependAny = function(fn) {\n    return this._onAny(fn, true);\n  };\n\n  EventEmitter.prototype.addListener = EventEmitter.prototype.on;\n\n  EventEmitter.prototype._onAny = function(fn, prepend){\n    if (typeof fn !== 'function') {\n      throw new Error('onAny only accepts instances of Function');\n    }\n\n    if (!this._all) {\n      this._all = [];\n    }\n\n    // Add the function to the event listener collection.\n    if(prepend){\n      this._all.unshift(fn);\n    }else{\n      this._all.push(fn);\n    }\n\n    return this;\n  };\n\n  EventEmitter.prototype._on = function(type, listener, prepend, options) {\n    if (typeof type === 'function') {\n      this._onAny(type, listener);\n      return this;\n    }\n\n    if (typeof listener !== 'function') {\n      throw new Error('on only accepts instances of Function');\n    }\n    this._events || init.call(this);\n\n    var returnValue= this, temp;\n\n    if (options !== undefined) {\n      temp = setupListener.call(this, type, listener, options);\n      listener = temp[0];\n      returnValue = temp[1];\n    }\n\n    // To avoid recursion in the case that type == \"newListeners\"! Before\n    // adding it to the listeners, first emit \"newListeners\".\n    if (this._newListener) {\n      this.emit('newListener', type, listener);\n    }\n\n    if (this.wildcard) {\n      growListenerTree.call(this, type, listener, prepend);\n      return returnValue;\n    }\n\n    if (!this._events[type]) {\n      // Optimize the case of one listener. Don't need the extra array object.\n      this._events[type] = listener;\n    } else {\n      if (typeof this._events[type] === 'function') {\n        // Change to array.\n        this._events[type] = [this._events[type]];\n      }\n\n      // If we've already got an array, just add\n      if(prepend){\n        this._events[type].unshift(listener);\n      }else{\n        this._events[type].push(listener);\n      }\n\n      // Check for listener leak\n      if (\n        !this._events[type].warned &&\n        this._maxListeners > 0 &&\n        this._events[type].length > this._maxListeners\n      ) {\n        this._events[type].warned = true;\n        logPossibleMemoryLeak.call(this, this._events[type].length, type);\n      }\n    }\n\n    return returnValue;\n  };\n\n  EventEmitter.prototype.off = function(type, listener) {\n    if (typeof listener !== 'function') {\n      throw new Error('removeListener only takes instances of Function');\n    }\n\n    var handlers,leafs=[];\n\n    if(this.wildcard) {\n      var ns = typeof type === 'string' ? type.split(this.delimiter) : type.slice();\n      leafs = searchListenerTree.call(this, null, ns, this.listenerTree, 0);\n      if(!leafs) return this;\n    } else {\n      // does not use listeners(), so no side effect of creating _events[type]\n      if (!this._events[type]) return this;\n      handlers = this._events[type];\n      leafs.push({_listeners:handlers});\n    }\n\n    for (var iLeaf=0; iLeaf<leafs.length; iLeaf++) {\n      var leaf = leafs[iLeaf];\n      handlers = leaf._listeners;\n      if (isArray(handlers)) {\n\n        var position = -1;\n\n        for (var i = 0, length = handlers.length; i < length; i++) {\n          if (handlers[i] === listener ||\n            (handlers[i].listener && handlers[i].listener === listener) ||\n            (handlers[i]._origin && handlers[i]._origin === listener)) {\n            position = i;\n            break;\n          }\n        }\n\n        if (position < 0) {\n          continue;\n        }\n\n        if(this.wildcard) {\n          leaf._listeners.splice(position, 1);\n        }\n        else {\n          this._events[type].splice(position, 1);\n        }\n\n        if (handlers.length === 0) {\n          if(this.wildcard) {\n            delete leaf._listeners;\n          }\n          else {\n            delete this._events[type];\n          }\n        }\n        if (this._removeListener)\n          this.emit(\"removeListener\", type, listener);\n\n        return this;\n      }\n      else if (handlers === listener ||\n        (handlers.listener && handlers.listener === listener) ||\n        (handlers._origin && handlers._origin === listener)) {\n        if(this.wildcard) {\n          delete leaf._listeners;\n        }\n        else {\n          delete this._events[type];\n        }\n        if (this._removeListener)\n          this.emit(\"removeListener\", type, listener);\n      }\n    }\n\n    this.listenerTree && recursivelyGarbageCollect(this.listenerTree);\n\n    return this;\n  };\n\n  EventEmitter.prototype.offAny = function(fn) {\n    var i = 0, l = 0, fns;\n    if (fn && this._all && this._all.length > 0) {\n      fns = this._all;\n      for(i = 0, l = fns.length; i < l; i++) {\n        if(fn === fns[i]) {\n          fns.splice(i, 1);\n          if (this._removeListener)\n            this.emit(\"removeListenerAny\", fn);\n          return this;\n        }\n      }\n    } else {\n      fns = this._all;\n      if (this._removeListener) {\n        for(i = 0, l = fns.length; i < l; i++)\n          this.emit(\"removeListenerAny\", fns[i]);\n      }\n      this._all = [];\n    }\n    return this;\n  };\n\n  EventEmitter.prototype.removeListener = EventEmitter.prototype.off;\n\n  EventEmitter.prototype.removeAllListeners = function (type) {\n    if (type === undefined) {\n      !this._events || init.call(this);\n      return this;\n    }\n\n    if (this.wildcard) {\n      var leafs = searchListenerTree.call(this, null, type, this.listenerTree, 0), leaf, i;\n      if (!leafs) return this;\n      for (i = 0; i < leafs.length; i++) {\n        leaf = leafs[i];\n        leaf._listeners = null;\n      }\n      this.listenerTree && recursivelyGarbageCollect(this.listenerTree);\n    } else if (this._events) {\n      this._events[type] = null;\n    }\n    return this;\n  };\n\n  EventEmitter.prototype.listeners = function (type) {\n    var _events = this._events;\n    var keys, listeners, allListeners;\n    var i;\n    var listenerTree;\n\n    if (type === undefined) {\n      if (this.wildcard) {\n        throw Error('event name required for wildcard emitter');\n      }\n\n      if (!_events) {\n        return [];\n      }\n\n      keys = ownKeys(_events);\n      i = keys.length;\n      allListeners = [];\n      while (i-- > 0) {\n        listeners = _events[keys[i]];\n        if (typeof listeners === 'function') {\n          allListeners.push(listeners);\n        } else {\n          allListeners.push.apply(allListeners, listeners);\n        }\n      }\n      return allListeners;\n    } else {\n      if (this.wildcard) {\n        listenerTree= this.listenerTree;\n        if(!listenerTree) return [];\n        var handlers = [];\n        var ns = typeof type === 'string' ? type.split(this.delimiter) : type.slice();\n        searchListenerTree.call(this, handlers, ns, listenerTree, 0);\n        return handlers;\n      }\n\n      if (!_events) {\n        return [];\n      }\n\n      listeners = _events[type];\n\n      if (!listeners) {\n        return [];\n      }\n      return typeof listeners === 'function' ? [listeners] : listeners;\n    }\n  };\n\n  EventEmitter.prototype.eventNames = function(nsAsArray){\n    var _events= this._events;\n    return this.wildcard? collectTreeEvents.call(this, this.listenerTree, [], null, nsAsArray) : (_events? ownKeys(_events) : []);\n  };\n\n  EventEmitter.prototype.listenerCount = function(type) {\n    return this.listeners(type).length;\n  };\n\n  EventEmitter.prototype.hasListeners = function (type) {\n    if (this.wildcard) {\n      var handlers = [];\n      var ns = typeof type === 'string' ? type.split(this.delimiter) : type.slice();\n      searchListenerTree.call(this, handlers, ns, this.listenerTree, 0);\n      return handlers.length > 0;\n    }\n\n    var _events = this._events;\n    var _all = this._all;\n\n    return !!(_all && _all.length || _events && (type === undefined ? ownKeys(_events).length : _events[type]));\n  };\n\n  EventEmitter.prototype.listenersAny = function() {\n\n    if(this._all) {\n      return this._all;\n    }\n    else {\n      return [];\n    }\n\n  };\n\n  EventEmitter.prototype.waitFor = function (event, options) {\n    var self = this;\n    var type = typeof options;\n    if (type === 'number') {\n      options = {timeout: options};\n    } else if (type === 'function') {\n      options = {filter: options};\n    }\n\n    options= resolveOptions(options, {\n      timeout: 0,\n      filter: undefined,\n      handleError: false,\n      Promise: Promise,\n      overload: false\n    }, {\n      filter: functionReducer,\n      Promise: constructorReducer\n    });\n\n    return makeCancelablePromise(options.Promise, function (resolve, reject, onCancel) {\n      function listener() {\n        var filter= options.filter;\n        if (filter && !filter.apply(self, arguments)) {\n          return;\n        }\n        self.off(event, listener);\n        if (options.handleError) {\n          var err = arguments[0];\n          err ? reject(err) : resolve(toArray.apply(null, arguments).slice(1));\n        } else {\n          resolve(toArray.apply(null, arguments));\n        }\n      }\n\n      onCancel(function(){\n        self.off(event, listener);\n      });\n\n      self._on(event, listener, false);\n    }, {\n      timeout: options.timeout,\n      overload: options.overload\n    })\n  };\n\n  function once(emitter, name, options) {\n    options= resolveOptions(options, {\n      Promise: Promise,\n      timeout: 0,\n      overload: false\n    }, {\n      Promise: constructorReducer\n    });\n\n    var _Promise= options.Promise;\n\n    return makeCancelablePromise(_Promise, function(resolve, reject, onCancel){\n      var handler;\n      if (typeof emitter.addEventListener === 'function') {\n        handler=  function () {\n          resolve(toArray.apply(null, arguments));\n        };\n\n        onCancel(function(){\n          emitter.removeEventListener(name, handler);\n        });\n\n        emitter.addEventListener(\n            name,\n            handler,\n            {once: true}\n        );\n        return;\n      }\n\n      var eventListener = function(){\n        errorListener && emitter.removeListener('error', errorListener);\n        resolve(toArray.apply(null, arguments));\n      };\n\n      var errorListener;\n\n      if (name !== 'error') {\n        errorListener = function (err){\n          emitter.removeListener(name, eventListener);\n          reject(err);\n        };\n\n        emitter.once('error', errorListener);\n      }\n\n      onCancel(function(){\n        errorListener && emitter.removeListener('error', errorListener);\n        emitter.removeListener(name, eventListener);\n      });\n\n      emitter.once(name, eventListener);\n    }, {\n      timeout: options.timeout,\n      overload: options.overload\n    });\n  }\n\n  var prototype= EventEmitter.prototype;\n\n  Object.defineProperties(EventEmitter, {\n    defaultMaxListeners: {\n      get: function () {\n        return prototype._maxListeners;\n      },\n      set: function (n) {\n        if (typeof n !== 'number' || n < 0 || Number.isNaN(n)) {\n          throw TypeError('n must be a non-negative number')\n        }\n        prototype._maxListeners = n;\n      },\n      enumerable: true\n    },\n    once: {\n      value: once,\n      writable: true,\n      configurable: true\n    }\n  });\n\n  Object.defineProperties(prototype, {\n      _maxListeners: {\n          value: defaultMaxListeners,\n          writable: true,\n          configurable: true\n      },\n      _observers: {value: null, writable: true, configurable: true}\n  });\n\n  if (typeof define === 'function' && define.amd) {\n     // AMD. Register as an anonymous module.\n    define(function() {\n      return EventEmitter;\n    });\n  } else if (typeof exports === 'object') {\n    // CommonJS\n    module.exports = EventEmitter;\n  }\n  else {\n    // global for any kind of environment.\n    var _global= new Function('','return this')();\n    _global.EventEmitter2 = EventEmitter;\n  }\n}();\n","import { storageInterface } from './storageInterface';\n\ndeclare let i18n: string[];\n\nexport const webextension: storageInterface = {\n  async set(key: string, value: string): Promise<void> {\n    const obj = {} as any;\n    obj[key] = value;\n    return new Promise((resolve, reject) => {\n      getStorage(key).set(obj, function () {\n        if (chrome.runtime.lastError) {\n          reject(chrome.runtime.lastError);\n          return;\n        }\n        resolve();\n      });\n    });\n  },\n\n  async get(key: string): Promise<any> {\n    return new Promise((resolve, reject) => {\n      getStorage(key).get(key, function (results) {\n        if (chrome.runtime.lastError) {\n          reject(chrome.runtime.lastError);\n          return;\n        }\n        resolve(results[key]);\n      });\n    });\n  },\n\n  async remove(key: string): Promise<void> {\n    return new Promise((resolve, reject) => {\n      getStorage(key).remove(key, function () {\n        if (chrome.runtime.lastError) {\n          reject(chrome.runtime.lastError);\n          return;\n        }\n        resolve();\n      });\n    });\n  },\n\n  async list(type = 'local'): Promise<any> {\n    return new Promise((resolve, reject) => {\n      if (type === 'local') {\n        chrome.storage.local.get(null, function (results) {\n          resolve(results);\n        });\n      } else {\n        chrome.storage.sync.get(null, function (results) {\n          resolve(results);\n        });\n      }\n    });\n  },\n\n  async addStyle(css) {\n    try {\n      const style = document.createElement('style');\n      style.textContent = css;\n      (document.head || document.body || document.documentElement || document).appendChild(style);\n    } catch (e) {\n      console.log(`Could not add css:${e}`);\n    }\n  },\n\n  version() {\n    return chrome.runtime.getManifest().version;\n  },\n\n  lang(selector, args) {\n    if (api.settings.get('forceEn') && typeof i18n !== 'undefined') {\n      let message = i18n[selector];\n      if (typeof args !== 'undefined') {\n        for (let argIndex = 0; argIndex < args.length; argIndex++) {\n          message = message.replace(`$${argIndex + 1}`, args[argIndex]);\n        }\n      }\n      return message;\n    }\n    // @ts-ignore\n    return chrome.i18n.getMessage(selector, args);\n  },\n\n  assetUrl(filename) {\n    return chrome.extension.getURL(`assets/${filename}`);\n  },\n\n  injectCssResource(res, head) {\n    alert('injectCssResource not supported in webextension');\n  },\n\n  injectjsResource(res, head) {\n    const s = document.createElement('script');\n    s.src = chrome.extension.getURL(`vendor/${res}`);\n    s.onload = function () {\n      // @ts-ignore\n      this.remove();\n    };\n    head.get(0).appendChild(s);\n  },\n\n  updateDom(head) {\n    const s = document.createElement('script');\n    s.text = `\n        document.getElementsByTagName('head')[0].onclick = function(e){\n          try{\n            componentHandler.upgradeDom();\n          }catch(e){\n            console.log(e);\n            setTimeout(function(){\n              componentHandler.upgradeDom();\n            },500);\n          }\n        }`;\n    s.onload = function () {\n      // @ts-ignore\n      this.remove();\n    };\n    head.get(0).appendChild(s);\n  },\n\n  storageOnChanged(cb) {\n    chrome.storage.onChanged.addListener(cb);\n  },\n};\n\nfunction getStorage(key: string) {\n  if (utils.syncRegex.test(key)) {\n    return chrome.storage.sync;\n  }\n  return chrome.storage.local;\n}\n","import { sendMessageI, responseMessageI } from '../messageInterface';\nimport { requestInterface } from './requestInterface';\n\nexport const requestApi: requestInterface = {\n  async xhr(method, url) {\n    if (typeof requestApi.sendMessage !== 'undefined') {\n      return requestApi.sendMessage({ name: 'xhr', method, url }).then(xhr => {\n        if (xhr.status === 429) throw 'Rate limit Timeout';\n        return xhr;\n      });\n    }\n    throw 'Could not send xhr';\n  },\n\n  async sendMessage(message: sendMessageI): Promise<any> {\n    return new Promise((resolve, reject) => {\n      chrome.runtime.sendMessage(message, function (response: responseMessageI) {\n        resolve(response);\n      });\n    });\n  },\n\n  notification(options) {\n    this.sendMessage({\n      name: 'notification',\n      options,\n    });\n  },\n  database(call, param) {\n    return this.sendMessage({\n      name: 'database',\n      options: {\n        call,\n        param,\n      },\n    });\n  },\n};\n","import { reactive, ref } from 'vue';\n\nexport const settingsObj = {\n  options: reactive({\n    autoTrackingModeanime: 'video',\n    readerTracking: true,\n    autoTrackingModemanga: 'instant',\n    enablePages: {},\n    forceEn: false,\n    rpc: true,\n    presenceLargeImage: 'cover',\n    presenceShowButtons: true,\n    presenceShowMalsync: false,\n    userscriptModeButton: false,\n    syncMode: 'MAL',\n    syncModeSimkl: 'MAL',\n    localSync: true,\n    delay: 0,\n    videoDuration: 85,\n    malTags: false,\n    malContinue: true,\n    malResume: true,\n    usedPage: true,\n    epPredictions: true,\n\n    theme: 'auto',\n    themeSidebars: true,\n    themeColor: '#000000',\n    themeOpacity: 100,\n    themeImage: '',\n\n    minimalWindow: false,\n    posLeft: 'left',\n    miniMALonMal: false,\n    floatButtonStealth: false,\n    minimizeBigPopup: false,\n    floatButtonCorrection: true,\n    floatButtonHide: false,\n    autoCloseMinimal: false,\n    outWay: true,\n    miniMalWidth: '550px',\n    miniMalHeight: '90%',\n    malThumbnail: 100,\n    friendScore: true,\n    loadPTWForProgress: false,\n\n    quicklinks: [\n      '9anime',\n      'Crunchyroll',\n      'Gogoanime',\n      'Mangadex',\n      'MangaNato',\n      'MangaFox',\n      'MangaSee',\n      'MangaFire',\n      'YugenAnime',\n      'Zoro',\n      'Funimation',\n      'Hulu',\n      'Netflix',\n      'Hidive',\n      'Vrv',\n      'VIZ',\n      'MangaPlus',\n      'MangaReader',\n      'marin',\n      'ComicK',\n    ],\n    quicklinksPosition: 'default',\n\n    autofull: false,\n    autoresume: false,\n    autoNextEp: false,\n    highlightAllEp: false,\n    checkForFiller: true,\n    crashReport: true,\n\n    introSkip: 85,\n    introSkipFwd: [17, 39],\n    introSkipBwd: [17, 37],\n    nextEpShort: [],\n    correctionShort: [67],\n    syncShort: [],\n\n    progressInterval: 120,\n    progressIntervalDefaultAnime: 'en/sub',\n    progressIntervalDefaultManga: 'en/sub',\n    progressNotificationsAnime: true,\n    progressNotificationsManga: true,\n\n    bookMarksList: false,\n\n    customDomains: [],\n\n    anilistUpdateUi: true,\n\n    anilistToken: '',\n    anilistOptions: {\n      displayAdultContent: true,\n      scoreFormat: 'POINT_10',\n    },\n    kitsuToken: '',\n    kitsuOptions: {\n      titleLanguagePreference: 'canonical',\n      sfwFilter: false,\n      ratingSystem: 'regular',\n    },\n    simklToken: '',\n\n    malToken: '',\n    malRefresh: '',\n\n    shikiToken: '',\n    shikiOptions: {\n      locale: 'ru',\n    },\n  }),\n\n  debounceArray: {},\n\n  isInit: ref(false),\n\n  async init() {\n    const tempSettings = [];\n    for (const key in this.options) {\n      const store = await api.storage.get(`settings/${key}`);\n      if (typeof store !== 'undefined') {\n        this.options[key] = store;\n        tempSettings[key] = /(token|refresh)/i.test(key) && store ? '********' : store;\n      }\n    }\n    con.log('Settings', tempSettings);\n\n    let rateDebounce;\n\n    api.storage.storageOnChanged((changes, namespace) => {\n      if (namespace === 'sync') {\n        for (const key in changes) {\n          const storageChange = changes[key];\n          if (/^settings\\//i.test(key)) {\n            this.options[key.replace('settings/', '')] = storageChange.newValue;\n            con.info(`Update ${key} option to ${storageChange.newValue}`);\n          }\n        }\n      }\n      if (namespace === 'local' && changes.rateLimit) {\n        try {\n          clearTimeout(rateDebounce);\n          if (changes.rateLimit.newValue) {\n            con.log('Rate limited');\n            if (!$('.type-rate').length) {\n              utils.flashm('Rate limited. Retrying in a moment', {\n                error: true,\n                type: 'rate',\n                permanent: true,\n              });\n            }\n          } else {\n            rateDebounce = setTimeout(() => {\n              con.log('No Rate limited');\n              $('.type-rate').remove();\n            }, 5000);\n          }\n        } catch (e) {\n          con.error(e);\n        }\n      }\n    });\n\n    this.isInit.value = true;\n\n    return this;\n  },\n\n  get(name: string) {\n    if (!this.isInit.value) throw 'Settings not initialized';\n    return this.options[name];\n  },\n\n  set(name: string, value: any) {\n    if (!Object.prototype.hasOwnProperty.call(this.options, name)) {\n      const err = Error(`${name} is not a defined option`);\n      con.error(err);\n      throw err;\n    }\n\n    this.options[name] = value;\n    return api.storage.set(`settings/${name}`, value);\n  },\n\n  setDebounce(name: string, value: any) {\n    this.options[name] = value;\n    clearTimeout(this.debounceArray[name]);\n    this.debounceArray[name] = setTimeout(() => {\n      this.set(name, value);\n      delete this.debounceArray[name];\n    }, 1000);\n  },\n\n  async getAsync(name: string) {\n    const value = await api.storage.get(`settings/${name}`);\n    if (typeof value === 'undefined' && typeof this.options[name] !== 'undefined')\n      return this.options[name];\n    return value;\n  },\n};\n","import { webextension } from './storage/webextension';\nimport { requestApi } from './request/requestWebextension';\nimport { settingsObj } from './settings';\n\nexport const storage = webextension;\n\nexport const request = requestApi;\n\nexport const settings = settingsObj;\n\nexport const type = 'webextension';\n","/* eslint-disable no-bitwise */\n\nexport const log = (function () {\n  return Function.prototype.bind.call(\n    console.log,\n    console,\n    '%cMAL-Sync',\n    'background-color: #2e51a2; color: white; padding: 2px 10px; border-radius: 3px;',\n  );\n})();\n\nexport const error = (function () {\n  return Function.prototype.bind.call(\n    console.error,\n    console,\n    '%cMAL-Sync',\n    'background-color: #8f0000; color: white; padding: 2px 10px; border-radius: 3px;',\n  );\n})();\n\nexport const info = (function () {\n  return Function.prototype.bind.call(\n    console.info,\n    console,\n    '%cMAL-Sync',\n    'background-color: wheat; color: black; padding: 2px 10px; border-radius: 3px;',\n  );\n})();\n\nexport const debug = (function () {\n  return Function.prototype.bind.call(\n    console.debug,\n    console,\n    '%cMAL-Sync',\n    'background-color: steelblue; color: black; padding: 2px 10px; border-radius: 3px;',\n  );\n})();\n\nexport const m = (name, color = '', blocks: { name: string; style: string }[] = []) => {\n  let fontColor = 'white';\n  if (!color) color = stringToColour(name);\n  if (color[0] === '#') fontColor = getColorByBgColor(color);\n  const style = `background-color: ${color}; color: ${fontColor}; padding: 2px 10px; border-radius: 3px; margin-left: -5px; border-left: 1px solid white;`;\n  blocks.push({\n    name,\n    style,\n  });\n\n  const temp: any = {};\n\n  temp.m = (name2, color2 = '') => {\n    return m(name2, color2, [...blocks]);\n  };\n\n  const moduleText = blocks.reduce((sum, el) => `${sum}%c${el.name}`, '');\n  const moduleStyle = blocks.map(el => el.style);\n\n  temp.log = (function () {\n    return Function.prototype.bind.call(\n      console.log,\n      console,\n      `%cM ${moduleText}`,\n      'background-color: #2e51a2; color: white; padding: 2px 10px; border-radius: 3px;',\n      ...moduleStyle,\n    );\n  })();\n\n  temp.error = (function () {\n    return Function.prototype.bind.call(\n      console.error,\n      console,\n      `%cM ${moduleText}`,\n      'background-color: #8f0000; color: white; padding: 2px 10px; border-radius: 3px;',\n      ...moduleStyle,\n    );\n  })();\n\n  temp.info = (function () {\n    return Function.prototype.bind.call(\n      console.info,\n      console,\n      `%cM ${moduleText}`,\n      'background-color: wheat; color: black; padding: 2px 10px; border-radius: 3px;',\n      ...moduleStyle,\n    );\n  })();\n\n  temp.debug = (function () {\n    return Function.prototype.bind.call(\n      console.debug,\n      console,\n      `%cM ${moduleText}`,\n      'background-color: steelblue; color: black; padding: 2px 10px; border-radius: 3px;',\n      ...moduleStyle,\n    );\n  })();\n\n  return temp;\n};\n\nfunction stringToColour(str) {\n  if (!str) return '#ffffff';\n  str = String(str);\n  let hash = 0;\n  for (let i = 0; i < str.length; i++) {\n    hash = str.charCodeAt(i) + ((hash << 5) - hash);\n  }\n  let colour = '#';\n  for (let i = 0; i < 3; i++) {\n    const value = (hash >> (i * 8)) & 0xff;\n    colour += `00${value.toString(16)}`.substr(-2);\n  }\n  return colour;\n}\n\nfunction getColorByBgColor(bgColor) {\n  return parseInt(bgColor.replace('#', ''), 16) > 0xffffff / 2 ? '#000' : '#fff';\n}\n","declare let browser: any;\n\nexport function urlPart(url: string, part: number) {\n  if (!url) return '';\n\n  const urlParts = url.split('/');\n\n  if (!urlParts[part]) return '';\n\n  return urlParts[part].replace(/[#?].*/, '');\n}\n\nexport function urlStrip(url: string) {\n  return url.replace(/[#?].*/, '');\n}\n\nexport function urlParam(url, name) {\n  const results = new RegExp(`[?&]${name}=([^&#]*)`).exec(url);\n  if (results === null) {\n    return null;\n  }\n  return decodeURI(results[1]) || 0;\n}\n\nexport function getBaseText(element) {\n  let text = element.text();\n  element.children().each(function () {\n    // @ts-ignore\n    text = text.replace(j.$(this).text(), '');\n  });\n  return text;\n}\n\n/**\n * Generates a (hex) string ID for randomisation/verification.\n */\nexport function generateUniqueID(arraySize = 10): string {\n  const array = new Uint32Array(arraySize);\n  window.crypto.getRandomValues(array);\n  return Array.from(array, value => value.toString(16)).join('');\n}\n\nexport function favicon(domain) {\n  if (!domain) return '';\n  const res = domain.match(/^(https?:\\/\\/)?[^/]+/);\n\n  if (res) domain = res[0];\n\n  return `https://favicon.malsync.moe/?domain=${domain}`;\n}\n\nexport function watching(type: 'anime' | 'manga') {\n  if (type === 'manga') return 'Reading';\n  return 'Watching';\n}\n\nexport function planTo(type: 'anime' | 'manga') {\n  if (type === 'manga') return 'Plan to Read';\n  return 'Plan to Watch';\n}\n\nexport function episode(type: 'anime' | 'manga') {\n  if (type === 'manga') return api.storage.lang('UI_Chapter');\n  return api.storage.lang('UI_Episode');\n}\n\nexport const syncRegex =\n  /(^settings\\/.*|^updateCheckTime$|^tempVersion$|^local:\\/\\/|^list-tagSettings$)/;\n\nexport const rateLimitExclude = /^https:\\/\\/api.malsync.moe\\/(shark|mal\\/|nc\\/mal\\/.*\\/progress$)/i;\n\n// eslint-disable-next-line no-shadow\nexport enum status {\n  // eslint-disable-next-line no-shadow\n  watching = 1,\n  completed = 2,\n  onhold = 3,\n  dropped = 4,\n  planToWatch = 6,\n}\n\nexport function getselect(data, name) {\n  let temp = data.split(`name=\"${name}\"`)[1].split('</select>')[0];\n  if (temp.indexOf('selected=\"selected\"') > -1) {\n    temp = temp.split('<option');\n    for (let i = 0; i < temp.length; ++i) {\n      if (temp[i].indexOf('selected=\"selected\"') > -1) {\n        return temp[i].split('value=\"')[1].split('\"')[0];\n      }\n    }\n  }\n  return '';\n}\n\nexport function absoluteLink(url, domain) {\n  if (typeof url === 'undefined') {\n    return url;\n  }\n  if (!url.startsWith('http')) {\n    if (url.charAt(0) !== '/') url = `/${url}`;\n    url = domain + url;\n  }\n  return url;\n}\n\nexport function parseHtml(text) {\n  const parser = new DOMParser();\n  const dom = parser.parseFromString(`<!doctype html><body>${text}`, 'text/html');\n  return dom.body.textContent;\n}\n\nexport function urlChangeDetect(callback) {\n  let currentPage = window.location.href;\n  return setInterval(function () {\n    if (currentPage !== window.location.href) {\n      currentPage = window.location.href;\n      callback();\n    }\n  }, 100);\n}\n\nexport function fullUrlChangeDetect(callback, strip = false) {\n  let currentPage = '';\n  const intervalId = setInterval(function () {\n    const url = strip ? urlStrip(window.location.href) : window.location.href;\n    if (currentPage !== url) {\n      currentPage = url;\n      callback();\n    }\n  }, 100);\n\n  return Number(intervalId);\n}\n\nexport function changeDetect(callback, func, immediate = false) {\n  let currentPage = func();\n  const intervalId = setInterval(function () {\n    const temp = func();\n    if (typeof temp !== 'undefined' && currentPage !== temp) {\n      currentPage = func();\n      callback();\n    }\n  }, 500);\n\n  if (immediate) callback();\n\n  return Number(intervalId);\n}\n\nexport function waitUntilTrue(condition: Function, callback: Function, interval = 100) {\n  const intervalId = setInterval(function () {\n    if (condition()) {\n      clearInterval(intervalId);\n      callback();\n    }\n  }, interval);\n\n  return intervalId;\n}\n\nexport function getAsyncWaitUntilTrue(condition: Function, interval = 100) {\n  let intervalId;\n  let rejectThis;\n  const reset = () => {\n    clearTimeout(intervalId);\n    if (rejectThis) rejectThis('AsyncWait stopped');\n  };\n\n  return {\n    asyncWaitUntilTrue: () => {\n      reset();\n      return new Promise<void>((resolve, reject) => {\n        rejectThis = reject;\n        intervalId = waitUntilTrue(condition, () => resolve(), interval);\n      });\n    },\n    reset,\n  };\n}\n\nconst doubleId = Math.random();\nexport function checkDoubleExecution() {\n  if ($('.mal-sync-double-detect').length) {\n    $('.mal-sync-double-detect').each(function (index) {\n      if ($(this).text() !== doubleId.toString()) {\n        alert('Double execution detected! Please run MAL-Sync once only.');\n      }\n    });\n  }\n  $('body').after(\n    j.html(\n      `<div class=\"mal-sync-double-detect\" style=\"display: none;\">${doubleId.toString()}</div>`,\n    ),\n  );\n}\n\nexport function getUrlFromTags(tags: string) {\n  if (/malSync::[\\d\\D]+::/.test(tags)) {\n    return atobURL(tags.split('malSync::')[1].split('::')[0]);\n  }\n  if (/last::[\\d\\D]+::/.test(tags)) {\n    return atobURL(tags.split('last::')[1].split('::')[0]);\n  }\n  return undefined;\n\n  function atobURL(encoded) {\n    try {\n      return atob(encoded);\n    } catch (e) {\n      return encoded;\n    }\n  }\n}\n\nexport function setUrlInTags(url: string, tags: string) {\n  if (url === '') {\n    tags = tags.replace(/,?(malSync|last)::[^ \\n]+?::/, '');\n    return tags;\n  }\n  if (!api.settings.get('malTags')) return tags;\n  const addition = `malSync::${btoa(url)}::`;\n  if (/(last|malSync)::[\\d\\D]+::/.test(tags)) {\n    tags = tags.replace(/(last|malSync)::[^^]*?::/, addition);\n  } else {\n    tags = `${tags},${addition}`;\n  }\n  return tags;\n}\n\nexport async function setResumeWaching(url: string, ep: number, type, id) {\n  return api.storage.set(`resume/${type}/${id}`, { url, ep });\n}\n\nexport async function getResumeWaching(type, id): Promise<{ url?: string; ep?: number } | void> {\n  if (!api.settings.get('malResume')) return;\n\n  /* eslint-disable-next-line consistent-return */\n  return api.storage.get(`resume/${type}/${id}`);\n}\n\nexport async function setContinueWaching(url: string, ep: number, type, id) {\n  return api.storage.set(`continue/${type}/${id}`, { url, ep });\n}\n\nexport async function getContinueWaching(type, id): Promise<{ url?: string; ep?: number } | void> {\n  if (!api.settings.get('malContinue')) return;\n\n  /* eslint-disable-next-line consistent-return */\n  return api.storage.get(`continue/${type}/${id}`);\n}\n\nexport async function setEntrySettings(type, id, options, tags = '') {\n  const tempOptions = {};\n  if (options) {\n    for (const key in options) {\n      switch (key) {\n        case 'u':\n        case 'p':\n          tempOptions[key] = options[key];\n          break;\n        default:\n      }\n    }\n\n    if (api.settings.get('malTags')) {\n      // TAG mode\n      tags = setUrlInTags(JSON.stringify(tempOptions), tags);\n    } else {\n      // No TAG mode\n      await api.storage.set(`tagSettings/${type}/${id}`, JSON.stringify(tempOptions));\n    }\n  }\n\n  if (!Object.values(tempOptions).find(el => Boolean(el))) {\n    tags = setUrlInTags('', tags);\n    if (!api.settings.get('malTags')) {\n      await api.storage.remove(`tagSettings/${type}/${id}`);\n    }\n  }\n\n  return tags;\n}\n\nexport async function getEntrySettings(type, id, tags = '') {\n  const tempOptions: any = {\n    u: null, // url\n    c: null, // Continue Url\n    r: null, // Resume Url\n    p: '', // Progress Mode\n  };\n\n  if (api.settings.get('malTags')) {\n    // TAG mode\n    const tagString = getUrlFromTags(tags);\n    if (tagString) {\n      if (tagString[0] === '{') {\n        try {\n          const temp = JSON.parse(tagString);\n          for (const key in tempOptions) {\n            if (temp[key]) tempOptions[key] = temp[key];\n          }\n        } catch (e) {\n          con.error(e);\n        }\n      } else {\n        tempOptions.u = tagString;\n      }\n    }\n  } else {\n    // No TAG mode\n    let temp: any = await api.storage.get(`tagSettings/${type}/${id}`);\n\n    if (temp) {\n      temp = JSON.parse(temp);\n\n      for (const key in tempOptions) {\n        if (temp[key]) tempOptions[key] = temp[key];\n      }\n    }\n  }\n\n  const continueUrlObj = await getContinueWaching(type, id);\n  if (continueUrlObj) tempOptions.c = continueUrlObj;\n  const resumeUrlObj = await getResumeWaching(type, id);\n  if (resumeUrlObj) tempOptions.r = resumeUrlObj;\n\n  if (!api.settings.get('usedPage')) tempOptions.u = null;\n\n  return tempOptions;\n}\n\nexport function handleMalImages(url) {\n  if (url.indexOf('questionmark') !== -1) return api.storage.assetUrl('questionmark.gif');\n  return url;\n}\n\nexport function getTooltip(text, style = '', direction = 'top') {\n  const rNumber = Math.floor(Math.random() * 1000 + 1);\n  return `<div id=\"tt${rNumber}\" class=\"icon material-icons\" style=\"font-size:16px; line-height: 0; color: #7f7f7f; padding-bottom: 20px; padding-left: 3px; ${style}\">contact_support</div>\\\n  <div class=\"mdl-tooltip mdl-tooltip--${direction} mdl-tooltip--large\" for=\"tt${rNumber}\">${text}</div>`;\n}\n\nexport function timeDiffToText(delta) {\n  let text = '';\n\n  delta /= 1000;\n\n  const diffYears = Math.floor(delta / 31536000);\n  delta -= diffYears * 31536000;\n  if (diffYears) {\n    text += `${diffYears}y `;\n  }\n\n  const diffDays = Math.floor(delta / 86400);\n  delta -= diffDays * 86400;\n  if (diffDays) {\n    text += `${diffDays}d `;\n  }\n\n  const diffHours = Math.floor(delta / 3600) % 24;\n  delta -= diffHours * 3600;\n  if (diffHours && diffDays < 2) {\n    text += `${diffHours}h `;\n  }\n\n  const diffMinutes = Math.floor(delta / 60) % 60;\n  delta -= diffMinutes * 60;\n  if (diffMinutes && !diffDays && diffHours < 3) {\n    text += `${diffMinutes}min `;\n  }\n\n  return text;\n}\n\nexport function canHideTabs() {\n  if (typeof browser !== 'undefined' && typeof browser.tabs.hide !== 'undefined') {\n    return true;\n  }\n  return false;\n}\n\n// eslint-disable-next-line no-shadow\nexport function statusTag(status, type, id) {\n  const info = {\n    anime: {\n      1: {\n        class: 'watching',\n        text: 'CW',\n        title: api.storage.lang(`UI_Status_watching_${type}`),\n      },\n      2: {\n        class: 'completed',\n        text: 'CMPL',\n        title: api.storage.lang('UI_Status_Completed'),\n      },\n      3: {\n        class: 'on-hold',\n        text: 'HOLD',\n        title: api.storage.lang('UI_Status_OnHold'),\n      },\n      4: {\n        class: 'dropped',\n        text: 'DROP',\n        title: api.storage.lang('UI_Status_Dropped'),\n      },\n      6: {\n        class: 'plantowatch',\n        text: 'PTW',\n        title: api.storage.lang(`UI_Status_planTo_${type}`),\n      },\n      23: {\n        class: 'rewatching',\n        text: 'RE',\n        title: api.storage.lang(`UI_Status_Rewatching_${type}`),\n      },\n    },\n    manga: {\n      1: {\n        class: 'reading',\n        text: 'CR',\n        title: api.storage.lang(`UI_Status_watching_${type}`),\n      },\n      2: {\n        class: 'completed',\n        text: 'CMPL',\n        title: api.storage.lang('UI_Status_Completed'),\n      },\n      3: {\n        class: 'on-hold',\n        text: 'HOLD',\n        title: api.storage.lang('UI_Status_OnHold'),\n      },\n      4: {\n        class: 'dropped',\n        text: 'DROP',\n        title: api.storage.lang('UI_Status_Dropped'),\n      },\n      6: {\n        class: 'plantoread',\n        text: 'PTR',\n        title: api.storage.lang(`UI_Status_planTo_${type}`),\n      },\n      23: {\n        class: 'rewatching',\n        text: 'RE',\n        title: api.storage.lang(`UI_Status_Rewatching_${type}`),\n      },\n    },\n  };\n\n  $.each([1, 2, 3, 4, 6, 23], function (i, el) {\n    info.anime[info.anime[el].title] = info.anime[el];\n    info.manga[info.manga[el].title] = info.manga[el];\n  });\n\n  if (status && info[type][status]) {\n    const tempInfo = info[type][status];\n    return ` <a href=\"https://myanimelist.net/ownlist/${type}/${id}/edit?hideLayout=1\" title=\"${tempInfo.title}\" class=\"Lightbox_AddEdit button_edit ${tempInfo.class}\">${tempInfo.text}</a>`;\n  }\n  return false;\n}\n\nexport function getStatusText(type: 'anime' | 'manga', state) {\n  switch (state) {\n    case 1:\n      return api.storage.lang(`UI_Status_watching_${type}`);\n    case 2:\n      return api.storage.lang('UI_Status_Completed');\n    case 3:\n      return api.storage.lang('UI_Status_OnHold');\n    case 4:\n      return api.storage.lang('UI_Status_Dropped');\n    case 6:\n      return api.storage.lang(`UI_Status_planTo_${type}`);\n    case 7:\n      return api.storage.lang(`UI_Status_All`);\n    case 23:\n      return api.storage.lang(`UI_Status_Rewatching_${type}`);\n    default:\n      return '';\n  }\n}\n\n// eslint-disable-next-line consistent-return\nexport function notifications(url: string, title: string, message: string, iconUrl = '') {\n  const messageObj: chrome.notifications.NotificationOptions<true> = {\n    type: 'basic',\n    title,\n    message,\n    iconUrl,\n  };\n\n  con.log('Notification', url, messageObj);\n\n  api.storage.get('notificationHistory').then(history => {\n    if (history === undefined) {\n      history = [];\n    }\n\n    if (typeof history !== 'object') return;\n\n    if (history.length >= 10) {\n      history.shift();\n    }\n    history.push({\n      url,\n      title: messageObj.title,\n      message: messageObj.message,\n      iconUrl: messageObj.iconUrl,\n      timestamp: Date.now(),\n    });\n    api.storage.set('notificationHistory', history);\n  });\n\n  try {\n    return chrome.notifications.create(url, messageObj);\n  } catch (e) {\n    con.error(e);\n  }\n}\n\nexport async function timeCache(key, dataFunction, ttl) {\n  const value = await api.storage.get(key);\n  if (typeof value === 'object' && new Date().getTime() < value.timestamp) {\n    return value.data;\n  }\n  const result = await dataFunction();\n  return api.storage.set(key, { data: result, timestamp: new Date().getTime() + ttl }).then(() => {\n    return result;\n  });\n}\n\n// flashm\nexport function flashm(\n  text,\n  options?: {\n    error?: boolean;\n    type?: string;\n    permanent?: boolean;\n    hoverInfo?: boolean;\n    position?: 'top' | 'bottom';\n    minimized?: boolean;\n  },\n) {\n  if (!j.$('#flash-div-top').length) {\n    initflashm();\n  }\n  con.log('[Flash] Message:', text);\n\n  let colorF = '#323232';\n  if (typeof options !== 'undefined' && typeof options.error !== 'undefined' && options.error) {\n    colorF = '#3e0808';\n  }\n\n  let flashdiv = '#flash-div-bottom';\n  if (\n    typeof options !== 'undefined' &&\n    typeof options.position !== 'undefined' &&\n    options.position\n  ) {\n    flashdiv = `#flash-div-${options.position}`;\n  }\n\n  let messClass = 'flash';\n  if (typeof options !== 'undefined' && typeof options.type !== 'undefined' && options.type) {\n    const tempClass = `type-${options.type}`;\n    j.$(`${flashdiv} .${tempClass}, #flashinfo-div .${tempClass}`)\n      .removeClass(tempClass)\n      .fadeOut({\n        duration: 1000,\n        queue: false,\n        complete() {\n          j.$(this).remove();\n        },\n      });\n\n    messClass += ` ${tempClass}`;\n  }\n\n  let mess = `<div class=\"${messClass}\" style=\"display:none;\">\\\n        <div style=\"display:table; pointer-events: all; padding: 14px 24px 14px 24px; margin: 0 auto; margin-top: 5px; max-width: 60%; -webkit-border-radius: 20px;-moz-border-radius: 20px;border-radius: 2px;color: white;background:${colorF}; \">\\\n          ${text}\\\n        </div>\\\n      </div>`;\n\n  let flashmEl;\n\n  if (\n    typeof options !== 'undefined' &&\n    typeof options.hoverInfo !== 'undefined' &&\n    options.hoverInfo\n  ) {\n    messClass += ' flashinfo';\n    mess = `<div class=\"${messClass}\" style=\"display:none; max-height: 5000px; overflow: hidden;\"><div style=\"display:table; pointer-events: all; margin: 0 auto; margin-top: -2px; max-width: 60%; -webkit-border-radius: 20px;-moz-border-radius: 20px;border-radius: 2px;color: white;background:${colorF}; position: relative;\"><div style=\"max-height: 60vh; overflow-y: auto; padding: 14px 24px 14px 24px;\">${text}</div></div></div>`;\n    j.$('#flashinfo-div').addClass('hover');\n    // eslint-disable-next-line jquery-unsafe-malsync/no-xss-jquery\n    flashmEl = j.$(j.html(mess)).appendTo('#flashinfo-div');\n    if (\n      typeof options !== 'undefined' &&\n      typeof options.minimized !== 'undefined' &&\n      options.minimized\n    )\n      flashmEl.css('max-height', '8px');\n  } else {\n    // eslint-disable-next-line jquery-unsafe-malsync/no-xss-jquery\n    flashmEl = j.$(j.html(mess)).appendTo(flashdiv);\n  }\n\n  if (\n    typeof options !== 'undefined' &&\n    typeof options.permanent !== 'undefined' &&\n    options.permanent\n  ) {\n    flashmEl.slideDown(800);\n  } else if (\n    typeof options !== 'undefined' &&\n    typeof options.hoverInfo !== 'undefined' &&\n    options.hoverInfo\n  ) {\n    flashmEl\n      .slideDown(800)\n      .delay(4000)\n      .queue(function () {\n        j.$('#flashinfo-div').removeClass('hover');\n        flashmEl.css('max-height', '8px');\n      });\n  } else {\n    flashmEl\n      .slideDown(800)\n      .delay(4000)\n      .slideUp(800, () => {\n        // @ts-ignore\n        j.$(this).remove();\n      });\n  }\n  return flashmEl;\n}\n\nexport async function flashConfirm(\n  message,\n  type,\n  yesCall = () => {\n    /* Placeholder */\n  },\n  cancelCall = () => {\n    /* Placeholder */\n  },\n  yesNo = false,\n): Promise<boolean> {\n  return new Promise(function (resolve, reject) {\n    let yesText = api.storage.lang('Ok');\n    let noText = api.storage.lang('Cancel');\n    if (yesNo) {\n      yesText = api.storage.lang('Yes');\n      noText = api.storage.lang('No');\n    }\n    message = `<div style=\"text-align: center;\">${message}</div><div style=\"display: flex; justify-content: space-around;\"><button class=\"Yes\" style=\"background-color: transparent; border: none; color: rgb(255,64,129);margin-top: 10px; cursor:pointer;\">${yesText}</button><button class=\"Cancel\" style=\"background-color: transparent; border: none; color: rgb(255,64,129);margin-top: 10px; cursor:pointer;\">${noText}</button></div>`;\n    const flasmessage = flashm(message, {\n      permanent: true,\n      position: 'top',\n      type,\n    });\n    flasmessage.find('.Yes').click(function (evt) {\n      resolve(true);\n      j.$(evt.target)\n        .parentsUntil('.flash')\n        .fadeOut(300, function () {\n          // @ts-ignore\n          j.$(this).remove();\n        });\n      yesCall();\n    });\n    flasmessage.find('.Cancel').click(function (evt) {\n      resolve(false);\n      j.$(evt.target)\n        .parentsUntil('.flash')\n        .fadeOut(300, function () {\n          // @ts-ignore\n          j.$(this).remove();\n        });\n      cancelCall();\n    });\n  });\n}\n\nfunction initflashm() {\n  api.storage.addStyle(\n    `.flashinfo{\n                    transition: max-height 2s, opacity 2s 2s;\n                 }\n                 .mini-stealth .flashinfo{\n                    opacity: 0;\n                 }\n                  #flashinfo-div.hover.mini-stealth .flashinfo.type-update{\n                    opacity: 0.7;\n                 }\n                 #flashinfo-div.hover .flashinfo{\n                    opacity: 1;\n                 }\n                 .flashinfo:hover{\n                    max-height:5000px !important;\n                    z-index: 2147483647;\n                    opacity: 1;\n                    transition: max-height 2s;\n                 }\n                 .flashinfo .synopsis{\n                    transition: max-height 2s, max-width 2s ease 2s;\n                 }\n                 .flashinfo:hover .synopsis{\n                    max-height:9999px !important;\n                    max-width: 500px !important;\n                    transition: max-height 2s;\n                 }\n                 #flashinfo-div{\n                  z-index: 2;\n                  transition: 2s;\n                 }\n                 #flashinfo-div:hover, #flashinfo-div.hover{\n                  z-index: 2147483647;\n                 }\n                 #flashinfo-div.player-error {\n                   z-index: 2147483647;\n                 }\n                 #flashinfo-div.player-error .type-update{\n                  overflow: visible !important;\n                  opacity: 1 !important;\n                 }\n                 #flashinfo-div.player-error .player-error{\n                  display: block !important\n                 }\n                 #flashinfo-div.player-error-missing-permissions .player-error-missing-permissions{\n                  display: block !important\n                 }\n                 #flashinfo-div.player-error-missing-permissions .player-error-default{\n                  display: none !important\n                 }\n\n                 #flash-div-top, #flash-div-bottom, #flashinfo-div{\n                    font-family: \"Helvetica\",\"Arial\",sans-serif;\n                    color: white;\n                    font-size: 14px;\n                    font-weight: 400;\n                    line-height: 17px;\n                 }\n                 #flash-div-top h2, #flash-div-bottom h2, #flashinfo-div h2{\n                    font-family: \"Helvetica\",\"Arial\",sans-serif;\n                    color: white;\n                    font-size: 14px;\n                    font-weight: 700;\n                    line-height: 17px;\n                    padding: 0;\n                    margin: 0;\n                 }\n                 #flash-div-top a, #flash-div-bottom a, #flashinfo-div a{\n                    color: #DF6300;\n                 }`,\n  );\n\n  let extraClass = '';\n  if (api.settings.get('floatButtonStealth')) extraClass = 'mini-stealth';\n\n  j.$('body').after(\n    j.html(\n      `<div id=\"flash-div-top\" style=\"text-align: center;pointer-events: none;position: fixed;top:-5px;width:100%;z-index: 2147483647;left: 0;\"></div>\\\n        <div id=\"flash-div-bottom\" style=\"text-align: center;pointer-events: none;position: fixed;bottom:0px;width:100%;z-index: 2147483647;left: 0;\"><div id=\"flash\" style=\"display:none;  background-color: red;padding: 20px; margin: 0 auto;max-width: 60%;          -webkit-border-radius: 20px;-moz-border-radius: 20px;border-radius: 20px;background:rgba(227,0,0,0.6);\"></div></div>\\\n        <div id=\"flashinfo-div\" class=\"${extraClass}\" style=\"text-align: center;pointer-events: none;position: fixed;bottom:0px;width:100%;left: 0;\">`,\n    ),\n  );\n}\n\nlet lazyloaded = false;\nlet lazyimages: any[] = [];\n\nexport function lazyload(doc, scrollElement = '.mdl-layout__content') {\n  /* lazyload.js (c) Lorenzo Giuliani\n   * MIT License (http://www.opensource.org/licenses/mit-license.html)\n   *\n   * expects a list of:\n   * `<img src=\"blank.gif\" data-src=\"my_image.png\" width=\"600\" height=\"400\" class=\"lazy\">`\n   */\n  // eslint-disable-next-line\n  function loadImage(el, fn) {\n    if (!j.$(el).is(':visible')) return false;\n    if (j.$(el).hasClass('lazyBack')) {\n      j.$(el)\n        .css('background-image', `url(${el.getAttribute('data-src')})`)\n        .removeClass('lazyBack');\n    } else {\n      const img = new Image();\n      const src = el.getAttribute('data-src');\n      img.onload = function () {\n        if (el.parent) el.parent.replaceChild(img, el);\n        else el.src = src;\n        // eslint-disable-next-line\n        fn ? fn() : null;\n      };\n      img.src = src;\n    }\n  }\n\n  for (let i = 0; i < lazyimages.length; i++) {\n    $(lazyimages[i]).addClass('init');\n  }\n\n  lazyimages = [];\n  const query = doc.find('img.lazy.init, .lazyBack.init');\n  const processScroll = function () {\n    for (let i = 0; i < lazyimages.length; i++) {\n      if (utils.elementInViewport(lazyimages[i], 600)) {\n        // eslint-disable-next-line\n        loadImage(lazyimages[i], function() {\n          lazyimages.splice(i, i);\n        });\n      }\n      if (!$(lazyimages[i]).length) {\n        lazyimages.splice(i, i);\n      }\n    }\n  };\n  // Array.prototype.slice.call is not callable under our lovely IE8\n  for (let i = 0; i < query.length; i++) {\n    lazyimages.push(query[i]);\n    $(query[i]).removeClass('init');\n  }\n\n  processScroll();\n\n  if (!lazyloaded) {\n    lazyloaded = true;\n    doc.find(scrollElement).scroll(function () {\n      processScroll();\n    });\n  }\n}\n\nexport function elementInViewport(el, horizontalOffset = 0) {\n  const rect = el.getBoundingClientRect();\n\n  return (\n    rect.top >= 0 &&\n    rect.left >= 0 &&\n    // @ts-ignore\n    rect.top - horizontalOffset <= (window.innerHeight || document.documentElement.clientHeight)\n  );\n}\n\nexport function wait(ms: number) {\n  return new Promise(resolve => {\n    setTimeout(resolve, ms);\n  });\n}\n\nexport function pageUrl(\n  page: 'mal' | 'anilist' | 'kitsu' | 'simkl',\n  type: 'anime' | 'manga',\n  id: string | number,\n) {\n  switch (page) {\n    case 'mal':\n      return `https://myanimelist.net/${type}/${id}`;\n    case 'anilist':\n      return `https://anilist.co/${type}/${id}`;\n    case 'kitsu':\n      return `https://kitsu.io/${type}/${id}`;\n    case 'simkl':\n      return `https://simkl.com/${type}/${id}`;\n    default:\n      throw `${page} not a valid page`;\n  }\n}\n\nexport function returnYYYYMMDD(numFromToday = 0) {\n  const d = new Date();\n  d.setDate(d.getDate() + numFromToday);\n  const month = d.getMonth() < 9 ? `0${d.getMonth() + 1}` : d.getMonth() + 1;\n  const day = d.getDate() < 10 ? `0${d.getDate()}` : d.getDate();\n  return `${d.getFullYear()}-${month}-${day}`;\n}\n\nexport function htmlDecode(text) {\n  return $('<textarea/>').html(j.html(text)).text();\n}\n\nexport function isFirefox(): boolean {\n  return Boolean(typeof browser !== 'undefined' && typeof chrome !== 'undefined');\n}\n\nexport function waitForPageToBeVisible() {\n  const condition = () =>\n    Boolean(!document.visibilityState || document.visibilityState === 'visible');\n\n  if (condition()) return Promise.resolve();\n\n  con.log('Page in background');\n\n  const { asyncWaitUntilTrue: awaitUi } = getAsyncWaitUntilTrue(() => condition());\n\n  return awaitUi().then(() => {\n    con.log('Page is visible');\n  });\n}\n\nexport function makeDomainCompatible(domain: string) {\n  // Add '/' to end of origin if it doesn't exist\n  if (domain.split('/').length < 4) {\n    domain += '/';\n  }\n\n  // Remove all after ?\n  domain = domain.replace(/\\?.*/, '?');\n  return domain;\n}\n\nexport async function clearCache() {\n  const cacheArray = await api.storage.list();\n  let deleted = 0;\n\n  j.$.each(cacheArray, function (index, cache) {\n    if (!utils.syncRegex.test(String(index)) && !/(^tagSettings\\/.*)/.test(String(index))) {\n      api.storage.remove(String(index));\n      deleted++;\n    }\n  });\n\n  utils.flashm(`Cache Cleared [${deleted}]`);\n}\n\nexport function sortAlphabetically(a, b) {\n  if (a.toLowerCase() < b.toLowerCase()) return -1;\n  if (a.toLowerCase() > b.toLowerCase()) return 1;\n  return 0;\n}\n\nexport function isDomainMatching(url, domain) {\n  const urlObj = new URL(url);\n  const { host } = urlObj;\n  return host === domain || host.endsWith(`.${domain}`);\n}\n\nexport function upperCaseFirstLetter(string) {\n  if (!string || string.length < 2) return string;\n  return string.charAt(0).toUpperCase() + string.slice(1);\n}\n","import * as DOMPurify from 'dompurify';\n\nexport const $ = jQuery;\n\nexport function html(htmlContent) {\n  return DOMPurify.sanitize(htmlContent, {\n    SAFE_FOR_JQUERY: true,\n    ALLOW_UNKNOWN_PROTOCOLS: true,\n    ADD_ATTR: ['target'],\n  });\n}\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.g = (function() {\n\tif (typeof globalThis === 'object') return globalThis;\n\ttry {\n\t\treturn this || new Function('return this')();\n\t} catch (e) {\n\t\tif (typeof window === 'object') return window;\n\t}\n})();","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","/* eslint-disable no-shadow */\n/* export enum type {\n  Anime = \"anime\",\n  Manga = \"manga\"\n} */\n\nimport { Component } from 'vue';\n\nexport type contentType = 'anime' | 'manga';\n\nexport enum status {\n  NoState = 0,\n  Watching = 1,\n  Completed = 2,\n  Onhold = 3,\n  Dropped = 4,\n  PlanToWatch = 6,\n  All = 7,\n  Rewatching = 23,\n}\n\nexport enum score {\n  NoScore = 0,\n  R1 = 1,\n  R2 = 2,\n  R3 = 3,\n  R4 = 4,\n  R5 = 5,\n  R6 = 6,\n  R7 = 7,\n  R8 = 8,\n  R9 = 9,\n  R10 = 10,\n}\n\n// score range 0 - 100\nexport type score100 = number;\n\nexport type searchResult = {\n  id: number;\n  name: string;\n  altNames: string[];\n  url: string;\n  malUrl: () => Promise<string | null>;\n  image: string;\n  imageLarge: string;\n  imageBanner?: string;\n  media_type: string;\n  isNovel: boolean;\n  score: string;\n  year: string;\n  totalEp?: number;\n  list?: {\n    status: status;\n    score: score;\n    episode: number;\n  };\n};\n\nexport type searchInterface = (\n  keyword: string,\n  type: 'anime' | 'manga',\n  options?: {},\n  sync?: boolean,\n) => Promise<searchResult[]>;\n\nexport interface ConfObj {\n  key: string;\n  title: string | (() => string);\n  system?: 'userscript' | 'webextension';\n  component: Component;\n  condition?: () => boolean;\n  change?: () => void;\n  props?: { [key: string]: any };\n  children?: ConfObj[];\n}\n","let store: Pick<Storage, 'getItem' | 'setItem' | 'clear' | 'removeItem'>;\n\nif (checkLocalStorageIsAvailable()) {\n  store = localStorage;\n} else {\n  let storage = {};\n  store = {\n    getItem(key) {\n      return key in storage ? storage[key] : null;\n    },\n    setItem(key, value) {\n      storage[key] = value;\n    },\n    removeItem(key) {\n      if (key in storage) delete storage[key];\n    },\n    clear() {\n      storage = {};\n    },\n  };\n}\n\nexport const localStore = store;\n\nfunction checkLocalStorageIsAvailable() {\n  try {\n    localStorage.getItem('x');\n    return true;\n  } catch (e) {\n    con.info('Local storage is not available', e);\n    return false;\n  }\n}\n","import { localStore } from './localStore';\n\nexport class Cache {\n  constructor(\n    protected key: string,\n    protected ttl: number,\n    protected localStorage: boolean = true,\n    protected refetchTtl: number = 0,\n  ) {\n    return this;\n  }\n\n  protected containsValue(value) {\n    return typeof value !== 'undefined' && value !== null;\n  }\n\n  protected valueValid(value, ttl) {\n    if (!value || !value.timestamp) return false;\n    return new Date().getTime() < value.timestamp + ttl;\n  }\n\n  protected ttlValid(value) {\n    return this.valueValid(value, this.ttl);\n  }\n\n  protected refetchTtlValid(value) {\n    return this.valueValid(value, this.refetchTtl);\n  }\n\n  async hasValue() {\n    const value = await this.getStorage();\n    if (this.containsValue(value) && this.ttlValid(value)) {\n      return true;\n    }\n    return false;\n  }\n\n  async hasValueAndIsNotEmpty() {\n    const value = await this.getStorage();\n    if (\n      this.containsValue(value) &&\n      typeof value.data !== 'undefined' &&\n      value.data !== null &&\n      Object.keys(value.data).length &&\n      this.ttlValid(value)\n    ) {\n      return true;\n    }\n    return false;\n  }\n\n  async fullState() {\n    const value = await this.getStorage();\n    const hasValue = this.containsValue(value) && this.refetchTtlValid(value);\n    const isValid = this.ttlValid(value);\n    return {\n      value,\n      hasValue,\n      isValid,\n      refetch: hasValue && !isValid,\n    };\n  }\n\n  async getValue() {\n    const value = await this.getStorage();\n    return value.data;\n  }\n\n  async setValue(result) {\n    const save = { data: result, timestamp: new Date().getTime() };\n    if (this.localStorage) {\n      return localStore.setItem(this.key, JSON.stringify(save));\n    }\n    return api.storage.set(this.key, save);\n  }\n\n  async clearValue() {\n    if (this.localStorage) {\n      return localStore.removeItem(this.key);\n    }\n    return api.storage.remove(this.key);\n  }\n\n  protected async getStorage() {\n    if (this.localStorage) {\n      return JSON.parse(localStore.getItem(this.key)!);\n    }\n    return api.storage.get(this.key);\n  }\n}\n","import { EventEmitter2 } from 'eventemitter2';\n\nconst scriptId = Math.floor(Math.random() * 1000000000);\n\nexport const emitter = new EventEmitter2({\n  wildcard: true,\n});\n\nexport function globalEmit(eventName: string, ...params) {\n  con\n    .m('Global')\n    .m('Emit')\n    .debug(eventName, ...params);\n\n  emitter.emit(`${eventName}`, ...params);\n\n  if (typeof api !== 'undefined' && api && api.type === 'webextension') {\n    chrome.runtime.sendMessage({\n      name: 'emitter',\n      item: { event: eventName, params, id: scriptId },\n    });\n  }\n}\n\nif (typeof api !== 'undefined' && api && api.type === 'webextension') {\n  chrome.runtime.onMessage.addListener((message, sender, sendResponse) => {\n    if (message.name && message.name === 'emitter') {\n      con.m('Global').m('Event').debug(message.item.id, message.item.event, message.item.params);\n\n      if (message.item.id !== scriptId) {\n        emitter.emit(message.item.event, ...message.item.params);\n      }\n    }\n  });\n}\n","/* eslint-disable max-classes-per-file */\nexport class NotAutenticatedError extends Error {\n  constructor(message: string) {\n    super(message);\n    this.name = 'NotAutenticatedError';\n  }\n}\n\nexport class UrlNotSupportedError extends Error {\n  constructor(message: string) {\n    super(message);\n    this.name = 'UrlNotSupportedError';\n  }\n}\n\nexport class ServerOfflineError extends Error {\n  constructor(message: string) {\n    super(message);\n    this.name = 'ServerOfflineError';\n  }\n}\n\nexport class NotFoundError extends Error {\n  constructor(message: string) {\n    super(message);\n    this.name = 'NotFoundError';\n  }\n}\n\nexport class UnexpectedResponseError extends Error {\n  constructor(message: string) {\n    super(message);\n    this.name = 'UnexpectedResponseError';\n  }\n}\n\nexport function parseJson(json) {\n  try {\n    return JSON.parse(json);\n  } catch (e) {\n    throw new UnexpectedResponseError(e.message);\n  }\n}\n\nexport function errorMessage(error, authenticationUrl: string) {\n  if (error instanceof NotAutenticatedError) {\n    return api.storage.lang('Error_Authenticate', [authenticationUrl]);\n  }\n  if (error instanceof ServerOfflineError) {\n    return `Server Offline`;\n  }\n  if (error instanceof UrlNotSupportedError) {\n    return `Incorrect url provided [${error.message}]`;\n  }\n  if (error instanceof NotFoundError) {\n    return `Could not find this entry`;\n  }\n  return error.message;\n}\n","import { Cache } from '../utils/Cache';\nimport { Progress } from '../utils/progress';\nimport { emitter } from '../utils/emitter';\nimport { errorMessage as _errorMessage } from './Errors';\n\nObject.seal(emitter);\n\nexport interface listElement {\n  uid: number;\n  malId: number;\n  apiCacheKey: number | string;\n  cacheKey: any;\n  type: 'anime' | 'manga';\n  title: string;\n  url: string;\n  watchedEp: number;\n  totalEp: number;\n  status: number;\n  score: number;\n  image: string;\n  imageLarge: string;\n  imageBanner?: string;\n  tags: string;\n  airingState: number;\n  fn: {\n    continueUrl: () => string;\n    initProgress: () => void;\n    progress: false | Progress;\n  };\n  options?: {\n    u: string;\n    r: any;\n    c: any;\n    p: any;\n  };\n}\n\nexport abstract class ListAbstract {\n  protected done = false;\n\n  protected loading = false;\n\n  protected firstLoaded = false;\n\n  protected abstract authenticationUrl: string;\n\n  abstract readonly name;\n\n  protected logger;\n\n  public seperateRewatching = false;\n\n  // Modes\n  modes = {\n    frontend: false,\n    sortAiring: false,\n    initProgress: false,\n    cached: false,\n  };\n\n  protected username = '';\n\n  protected offset = 0;\n\n  protected templist: listElement[] = [];\n\n  constructor(\n    protected status: number = 1,\n    protected listType: 'anime' | 'manga' = 'anime',\n    protected sort: string = 'default',\n  ) {\n    this.status = Number(this.status);\n    this.logger = con.m('[S]', '#348fff');\n    return this;\n  }\n\n  public api = api;\n\n  public setTemplist(list) {\n    this.templist = list;\n    return this;\n  }\n\n  public getTemplist() {\n    return this.templist;\n  }\n\n  public setSort(sort) {\n    if (this.firstLoaded || this.loading) throw 'To late to change sort';\n    this.sort = sort;\n  }\n\n  isDone() {\n    return this.done;\n  }\n\n  isLoading() {\n    return this.loading;\n  }\n\n  isFirstLoaded() {\n    return this.firstLoaded;\n  }\n\n  async getCompleteList(): Promise<listElement[]> {\n    do {\n      // eslint-disable-next-line no-await-in-loop\n      await this.getNext();\n    } while (!this.done);\n\n    if (this.modes.sortAiring) await this.sortAiringList();\n\n    if (this.modes.cached) this.getCache().setValue(this.templist.slice(0, 18));\n\n    this.firstLoaded = true;\n\n    return this.templist;\n  }\n\n  async getNextPage(): Promise<listElement[]> {\n    if (this.done) return this.templist;\n\n    if (\n      this.modes.frontend &&\n      this.status === 1 &&\n      (this.sort === 'default' || this.sort === 'unread')\n    ) {\n      this.modes.sortAiring = true;\n      return this.getCompleteList();\n    }\n\n    await this.getNext();\n\n    if (this.modes.cached) this.getCache().setValue(this.templist.slice(0, 24));\n\n    this.firstLoaded = true;\n\n    return this.templist;\n  }\n\n  private async getNext() {\n    this.loading = true;\n    const retList = await this.getPart();\n    this.templist = this.templist.concat(retList);\n    this.loading = false;\n  }\n\n  async getCached(): Promise<listElement[]> {\n    if (await this.getCache().hasValue()) {\n      const cachelist = await this.getCache().getValue();\n      cachelist.forEach(item => {\n        item = this.fn(item);\n        item.watchedEp = '';\n        item.score = '';\n      });\n      return cachelist;\n    }\n    return [];\n  }\n\n  protected updateListener;\n\n  public initFrontendMode() {\n    this.modes.frontend = true;\n    this.updateListener = emitter.on(\n      'update.*',\n      data => {\n        con.log('update', data);\n        if (data.cacheKey) {\n          const item = this.templist.find(el => el.cacheKey === data.cacheKey);\n          con.log(item);\n          if (item && data.state) {\n            item.watchedEp = data.state.episode;\n            item.score = data.state.score;\n            item.status = data.state.status;\n          }\n        }\n      },\n      { objectify: true },\n    );\n  }\n\n  public destroy() {\n    if (this.updateListener) {\n      this.updateListener.off();\n    }\n  }\n\n  public getUsername() {\n    return this.getUserObject().then(user => user.username);\n  }\n\n  abstract getUserObject(): Promise<{ username: string; picture: string; href: string }>;\n\n  abstract _getSortingOptions(): { icon: string; title: string; value: string; asc?: boolean }[];\n\n  getSortingOptions(\n    simple = false,\n  ): { icon: string; title: string; value: string; asc?: boolean }[] {\n    const res = [\n      {\n        icon: 'filter_list',\n        title: api.storage.lang('settings_progress_default'),\n        value: 'default',\n      },\n    ];\n\n    if (this.status === 1 && this.listType === 'manga') {\n      res.push({\n        icon: 'adjust',\n        title: api.storage.lang('list_sorting_unread'),\n        value: 'unread',\n      });\n    }\n\n    const options = this._getSortingOptions();\n    options.forEach(el => {\n      if (!simple) {\n        if (el.asc) {\n          const asc = { ...el };\n          delete asc.asc;\n          asc.value += '_asc';\n          asc.title += ' Ascending';\n          res.push(asc);\n        }\n        delete el.asc;\n      }\n      res.push(el);\n    });\n    return res;\n  }\n\n  abstract getPart(): Promise<listElement[]>;\n\n  flashmError(error) {\n    utils.flashm(this.errorMessage(error), { error: true, type: 'error' });\n  }\n\n  errorMessage(error) {\n    return _errorMessage(error, this.authenticationUrl);\n  }\n\n  // itemFunctions;\n  async fn(item, streamurl = '') {\n    let continueUrlTemp: any = null;\n    item.fn = {\n      continueUrl: () => {\n        if (continueUrlTemp !== null) return continueUrlTemp;\n        return utils.getContinueWaching(item.type, item.cacheKey).then(obj => {\n          const curEp = parseInt(item.watchedEp.toString());\n\n          if (obj === undefined || obj.ep !== curEp + 1) return '';\n\n          continueUrlTemp = obj.url;\n\n          return continueUrlTemp;\n        });\n      },\n      initProgress: () => {\n        return new Progress(item.cacheKey, item.type).init().then(progress => {\n          item.fn.progress = progress;\n        });\n      },\n      progress: false,\n    };\n    item.options = await utils.getEntrySettings(item.type, item.cacheKey, item.tags);\n    if (streamurl) item.options.u = streamurl;\n    if (this.modes.sortAiring || this.modes.initProgress) await item.fn.initProgress();\n\n    return item;\n  }\n\n  // Modes\n  async initProgress() {\n    const listP: any = [];\n    this.templist.forEach(item => {\n      listP.push(item.fn.initProgress());\n    });\n\n    await Promise.all(listP);\n  }\n\n  async sortAiringList() {\n    if (this.sort === 'unread') {\n      this.sortUnread();\n      return;\n    }\n\n    const normalItems: listElement[] = [];\n    let preItems: listElement[] = [];\n    let watchedItems: listElement[] = [];\n    this.templist.forEach(item => {\n      const prediction = item.fn.progress;\n      if (this.listType === 'anime') {\n        if (prediction && prediction.isAiring() && prediction.getPredictionTimestamp()) {\n          if (item.watchedEp < prediction.getCurrentEpisode()) {\n            preItems.push(item);\n          } else {\n            watchedItems.push(item);\n          }\n        } else {\n          normalItems.push(item);\n        }\n      } else if (\n        // Manga only if less than 5 chapters to read\n        prediction &&\n        prediction.isAiring() &&\n        prediction.getCurrentEpisode() &&\n        item.watchedEp &&\n        item.watchedEp < prediction.getCurrentEpisode() &&\n        item.watchedEp + 6 > prediction.getCurrentEpisode()\n      ) {\n        preItems.push(item);\n      } else {\n        normalItems.push(item);\n      }\n    });\n\n    preItems = preItems.sort(sortItems).reverse();\n    watchedItems = watchedItems.sort(sortItems);\n\n    this.templist = preItems.concat(watchedItems, normalItems);\n\n    function sortItems(a, b) {\n      let valA = a.fn.progress.getPredictionTimestamp();\n      let valB = b.fn.progress.getPredictionTimestamp();\n\n      if (!valA) valA = 999999999999;\n      if (!valB) valB = valA;\n\n      return valA - valB;\n    }\n  }\n\n  sortUnread() {\n    this.templist = this.templist.sort(function (a, b) {\n      let valA = 10000;\n      let valB = 10000;\n\n      if (a.fn.progress && a.fn.progress.getCurrentEpisode()) {\n        const tempA = a.fn.progress.getCurrentEpisode() - a.watchedEp;\n        if (tempA > 0) valA = tempA;\n      }\n      if (b.fn.progress && b.fn.progress.getCurrentEpisode()) {\n        const tempB = b.fn.progress.getCurrentEpisode() - b.watchedEp;\n        if (tempB > 0) valB = tempB;\n      }\n\n      return valA - valB;\n    });\n  }\n\n  cacheObj: any = undefined;\n\n  getCache() {\n    if (this.cacheObj) return this.cacheObj;\n    this.cacheObj = new Cache(\n      `list/${this.name}/${this.listType}/${this.status}/${this.sort}`,\n      48 * 60 * 60 * 1000,\n    );\n    return this.cacheObj;\n  }\n}\n","/* eslint-disable no-shadow */\nimport { status } from '../definitions';\nimport { clientId } from '../../utils/oauth';\nimport { NotAutenticatedError, NotFoundError, parseJson, ServerOfflineError } from '../Errors';\n\nexport const apiDomain = 'https://api.myanimelist.net/v2/';\n\nexport const authenticationUrl = 'https://malsync.moe/mal/oauth';\n\nexport async function apiCall(options: {\n  type: 'GET' | 'PUT' | 'DELETE' | 'POST';\n  path: string;\n  fields?: string[];\n  dataObj?: { [key: string]: string };\n}) {\n  let url = apiDomain + options.path;\n  if (options.fields && options.fields.length) {\n    url += url.includes('?') ? '&' : '?';\n    url += `fields=${options.fields.join(',')}`;\n  }\n  const headers: any = {\n    Authorization: `Bearer ${api.settings.get('malToken')}`,\n    'Content-Type': 'application/x-www-form-urlencoded',\n  };\n  let data = '';\n  if (options.dataObj) {\n    const formBody: string[] = [];\n    for (const property in options.dataObj) {\n      const encodedKey = encodeURIComponent(property);\n      const encodedValue = encodeURIComponent(options.dataObj[property]);\n      formBody.push(`${encodedKey}=${encodedValue}`);\n    }\n    data = formBody.join('&');\n  }\n  return api.request\n    .xhr(options.type, {\n      url,\n      headers,\n      data,\n    })\n    .then(async response => {\n      if ((response.status > 499 && response.status < 600) || response.status === 0) {\n        throw new ServerOfflineError(`Server Offline status: ${response.status}`);\n      }\n\n      let res;\n      try {\n        res = JSON.parse(response.responseText);\n      } catch (e) {\n        if (checkIfBanned(response.responseText)) {\n          throw new Error(api.storage.lang('Error_Blocked', ['MyAnimeList']));\n        }\n        throw e;\n      }\n\n      if (res && res.error) {\n        switch (res.error) {\n          case 'forbidden':\n          case 'invalid_token':\n            if (await refreshToken(this.logger)) {\n              return this.apiCall(options);\n            }\n            throw new NotAutenticatedError(res.message ?? res.error);\n          case 'not_found':\n            throw new NotFoundError(res.message ?? res.error);\n          case 'invalid_content':\n            throw new Error(\n              `This Entry is currently pending approval. It can´t be saved to mal for now`,\n            );\n          default:\n            throw new Error(res.message ?? res.error);\n        }\n      }\n\n      switch (response.status) {\n        case 400:\n          throw new Error('Invalid Parameters');\n        case 403:\n        default:\n      }\n\n      return res;\n    });\n}\n\nasync function refreshToken(logger) {\n  const l = logger.m('Refresh');\n  l.log('Refresh Access Token');\n  const rToken = api.settings.get('malRefresh');\n  if (!rToken) return false;\n  return api.request\n    .xhr('POST', {\n      url: 'https://myanimelist.net/v1/oauth2/token',\n      headers: {\n        'Content-Type': 'application/x-www-form-urlencoded',\n      },\n      data: `client_id=${clientId}&grant_type=refresh_token&refresh_token=${rToken}`,\n    })\n    .then(res => {\n      try {\n        return parseJson(res.responseText);\n      } catch (e) {\n        if (checkIfBanned(res.responseText)) {\n          throw new Error(api.storage.lang('Error_Blocked', ['MyAnimeList']));\n        }\n        throw e;\n      }\n    })\n    .then(json => {\n      if (json && json.refresh_token && json.access_token) {\n        api.settings.set('malToken', json.access_token);\n        api.settings.set('malRefresh', json.refresh_token);\n        return true;\n      }\n      if (json && json.error) {\n        l.error(json.error, '|', json.message);\n        api.settings.set('malRefresh', '');\n        return false;\n      }\n      l.error('Something went wrong');\n      return false;\n    });\n}\n\nfunction checkIfBanned(text: string) {\n  return Boolean(text.includes('Request blocked') || text.includes('your IP has been banned'));\n}\n\nexport enum animeStatus {\n  'watching' = status.Watching,\n  'completed' = status.Completed,\n  'on_hold' = status.Onhold,\n  'dropped' = status.Dropped,\n  'plan_to_watch' = status.PlanToWatch,\n}\n\nexport enum mangaStatus {\n  'reading' = status.Watching,\n  'completed' = status.Completed,\n  'on_hold' = status.Onhold,\n  'dropped' = status.Dropped,\n  'plan_to_read' = status.PlanToWatch,\n}\n","import { UserList as temp } from '../MyAnimeList_api/list';\n\nexport const UserList = temp;\n","import { ListAbstract, listElement } from '../listAbstract';\nimport * as helper from './helper';\n\nexport class UserList extends ListAbstract {\n  name = 'MyAnimeList';\n\n  authenticationUrl = helper.authenticationUrl;\n\n  async getUserObject() {\n    return this.apiCall({\n      type: 'GET',\n      path: 'users/@me',\n    }).then(json => {\n      return {\n        username: json.name,\n        picture: json.picture,\n        href: `https://myanimelist.net/profile/${json.name}`,\n      };\n    });\n  }\n\n  deauth() {\n    return api.settings.set('malToken', '').then(() => api.settings.set('malRefresh', ''));\n  }\n\n  _getSortingOptions() {\n    return [\n      {\n        icon: 'sort_by_alpha',\n        title: api.storage.lang('list_sorting_alpha'),\n        value: 'alpha',\n      },\n      {\n        icon: 'history',\n        title: api.storage.lang('list_sorting_history'),\n        value: 'updated',\n      },\n      {\n        icon: 'score',\n        title: api.storage.lang('list_sorting_score'),\n        value: 'score',\n      },\n      {\n        icon: 'calendar_month',\n        title: api.storage.lang('list_sorting_airing_date'),\n        value: 'airing_date',\n      },\n    ];\n  }\n\n  getOrder(sort) {\n    switch (sort) {\n      case 'alpha':\n        return `${this.listType}_title`;\n      case 'updated':\n        return 'list_updated_at';\n      case 'score':\n        return 'list_score';\n      case 'airing_date':\n        return `${this.listType}_start_date`;\n      default:\n        if (this.status === 1) return this.getOrder('updated');\n        if (this.status === 6) return this.getOrder('updated');\n        return this.getOrder('alpha');\n    }\n  }\n\n  private limit = 100;\n\n  async getPart() {\n    this.limit = 100;\n    if (this.modes.frontend) {\n      this.limit = 24;\n    }\n\n    const order = this.getOrder(this.sort);\n    let sorting = '';\n    if (order) {\n      sorting = `&sort=${order}`;\n    }\n\n    con.log(\n      '[UserList][MAL]',\n      `username: ${this.username}`,\n      `status: ${this.status}`,\n      `offset: ${this.offset}`,\n      `sorting: ${sorting}`,\n    );\n\n    let curSt = '';\n    if (this.status !== 7) {\n      if (this.listType === 'manga') {\n        curSt = `&status=${helper.mangaStatus[this.status]}`;\n      } else {\n        curSt = `&status=${helper.animeStatus[this.status]}`;\n      }\n    }\n\n    return this.apiCall({\n      type: 'GET',\n      path: `users/@me/${this.listType}list?nsfw=true&limit=${this.limit}&offset=${this.offset}${curSt}${sorting}`,\n      fields: [\n        'list_status{tags,is_rewatching,is_rereading,start_date,finish_date}',\n        'num_episodes',\n        'num_chapters',\n        'num_volumes',\n      ],\n    }).then(json => {\n      if (json.paging && json.paging.next) {\n        this.offset += this.limit;\n      } else {\n        this.done = true;\n      }\n\n      return this.prepareData(json.data);\n    });\n  }\n\n  public async prepareData(data): Promise<listElement[]> {\n    const newData = [] as listElement[];\n    for (let i = 0; i < data.length; i++) {\n      const el = data[i];\n      if (this.listType === 'anime') {\n        newData.push(\n          await this.fn({\n            uid: el.node.id,\n            malId: el.node.id,\n            apiCacheKey: el.node.id,\n            cacheKey: el.node.id,\n            type: this.listType,\n            title: el.node.title,\n            url: `https://myanimelist.net/${this.listType}/${el.node.id}`,\n            watchedEp: el.list_status.num_episodes_watched,\n            totalEp: el.node.num_episodes,\n            status: parseInt(helper.animeStatus[el.list_status.status]),\n            score: el.list_status.score,\n            image: el.node.main_picture?.medium ?? '',\n            imageLarge: el.node.main_picture?.large || el.node.main_picture?.medium || '',\n            tags: el.list_status.tags.length ? el.list_status.tags.join(',') : '',\n            airingState: el.anime_airing_status,\n          }),\n        );\n      } else {\n        newData.push(\n          await this.fn({\n            uid: el.node.id,\n            malId: el.node.id,\n            apiCacheKey: el.node.id,\n            cacheKey: el.node.id,\n            type: this.listType,\n            title: el.node.title,\n            url: `https://myanimelist.net/${this.listType}/${el.node.id}`,\n            watchedEp: el.list_status.num_chapters_read,\n            totalEp: el.node.num_chapters,\n            status: parseInt(helper.mangaStatus[el.list_status.status]),\n            score: el.list_status.score,\n            image: el.node.main_picture?.medium ?? '',\n            imageLarge: el.node.main_picture?.large || el.node.main_picture?.medium || '',\n            tags: el.list_status.tags.length ? el.list_status.tags.join(',') : '',\n            airingState: el.anime_airing_status,\n          }),\n        );\n      }\n    }\n    console.log(newData);\n    return newData;\n  }\n\n  apiCall = helper.apiCall;\n}\n","/* eslint-disable no-shadow */\nimport { status } from '../definitions';\nimport { NotAutenticatedError, NotFoundError, parseJson, ServerOfflineError } from '../Errors';\n\nconst logger = con.m('anilist', '#3db4f2');\n\nexport function translateList(aniStatus, malStatus: null | number = null) {\n  const list = {\n    CURRENT: 1,\n    PLANNING: 6,\n    COMPLETED: 2,\n    DROPPED: 4,\n    PAUSED: 3,\n    REPEATING: 1,\n  };\n  if (malStatus !== null) {\n    return Object.keys(list).find(key => list[key] === malStatus);\n  }\n  return list[aniStatus];\n}\n\nexport enum statusTranslate {\n  'CURRENT' = status.Watching,\n  'PLANNING' = status.PlanToWatch,\n  'COMPLETED' = status.Completed,\n  'DROPPED' = status.Dropped,\n  'PAUSED' = status.Onhold,\n  'REPEATING' = status.Rewatching,\n}\n\nexport function aniListToMal(anilistId: number, type: 'anime' | 'manga') {\n  const query = `\n  query ($id: Int, $type: MediaType) {\n    Media (id: $id, type: $type) {\n      id\n      idMal\n    }\n  }\n  `;\n\n  const variables = {\n    id: anilistId,\n    type: type.toUpperCase(),\n  };\n\n  return api.request\n    .xhr('POST', {\n      url: 'https://graphql.anilist.co',\n      headers: {\n        'Content-Type': 'application/json',\n        Accept: 'application/json',\n      },\n      data: JSON.stringify({\n        query,\n        variables,\n      }),\n    })\n    .then(response => {\n      const res = parseJson(response.responseText);\n      con.log(res);\n      return res.data.Media.idMal;\n    });\n}\n\nexport function malToAnilist(malId: number, type: 'anime' | 'manga') {\n  const query = `\n  query ($id: Int, $type: MediaType) {\n    Media (idMal: $id, type: $type) {\n      id\n      idMal\n    }\n  }\n  `;\n\n  const variables = {\n    id: malId,\n    type: type.toUpperCase(),\n  };\n\n  return api.request\n    .xhr('POST', {\n      url: 'https://graphql.anilist.co',\n      headers: {\n        'Content-Type': 'application/json',\n        Accept: 'application/json',\n      },\n      data: JSON.stringify({\n        query,\n        variables,\n      }),\n    })\n    .then(response => {\n      if (response.status === 404) return NaN;\n      const res = parseJson(response.responseText);\n      con.log(res);\n      return res.data.Media.id;\n    });\n}\n\nexport function getCacheKey(id, kitsuId) {\n  if (Number.isNaN(id) || !id) {\n    return `anilist:${kitsuId}`;\n  }\n  return id;\n}\n\nexport async function apiCall(query, variables, requiresAuthentication = true) {\n  if (requiresAuthentication && !api.settings.get('anilistToken')) {\n    throw new NotAutenticatedError('No token found');\n  }\n\n  const headers: any = {\n    'Content-Type': 'application/json',\n    Accept: 'application/json',\n  };\n\n  if (api.settings.get('anilistToken'))\n    headers.Authorization = `Bearer ${api.settings.get('anilistToken')}`;\n\n  return api.request\n    .xhr('POST', {\n      url: 'https://graphql.anilist.co',\n      headers,\n      data: JSON.stringify({\n        query,\n        variables,\n      }),\n    })\n    .then(response => {\n      if ((response.status > 499 && response.status < 600) || response.status === 0) {\n        throw new ServerOfflineError(`Server Offline status: ${response.status}`);\n      }\n      if (response.status === 403) {\n        throw new Error(api.storage.lang('Error_Blocked', ['AniList']));\n      }\n\n      const res = parseJson(response.responseText);\n\n      if (typeof res.errors !== 'undefined' && res.errors.length) {\n        logger.error('[SINGLE]', 'Error', res.errors);\n        const error = res.errors[0];\n        switch (error.status) {\n          case 400:\n            if (error.message === 'Invalid token' && !requiresAuthentication) {\n              api.settings.set('anilistToken', null);\n              return apiCall(query, variables, requiresAuthentication);\n            }\n            if (error.message === 'validation') throw new Error('Wrong request format');\n            if (error.message.includes('invalid')) throw new Error('Wrong request format');\n            throw new NotAutenticatedError(error.message);\n          case 404:\n            throw new NotFoundError(error.message);\n          default:\n            throw new Error(error.message);\n        }\n      }\n\n      return res;\n    });\n}\n\nexport function imgCheck(url: string) {\n  if (!url || url.endsWith('/default.jpg')) return '';\n  return url;\n}\n","import { NotAutenticatedError, NotFoundError, ServerOfflineError } from '../Errors';\nimport { status } from '../definitions';\nimport { Cache } from '../../utils/Cache';\n\nconst clientId = 'z3NJ84kK9iy5NU6SnhdCDB38rr4-jFIJ67bMIUDzdoo';\n\nexport const authUrl = `https://shikimori.me/oauth/authorize?client_id=${clientId}&redirect_uri=https%3A%2F%2Fmalsync.moe%2Fshikimori%2Foauth&response_type=code&scope=user_rates`;\n\nconst apiDomain = 'https://shikimori.me/api/';\n\nexport const domain = 'https://shikimori.me';\n\nexport async function apiCall(options: {\n  type: 'GET' | 'PUT' | 'DELETE' | 'POST';\n  path: string;\n  parameter?: { [key: string]: string | number };\n  dataObj?: { [key: string]: any };\n  auth?: boolean;\n}) {\n  const type = options.type || 'GET';\n  const token = api.settings.get('shikiToken');\n\n  if (!token && !token.access_token && !options.auth) {\n    throw new NotAutenticatedError('No token set');\n  }\n\n  let url = apiDomain + options.path;\n  if (options.parameter && Object.keys(options.parameter).length) {\n    url += url.includes('?') ? '&' : '?';\n    const params = [] as string[];\n    for (const key in options.parameter) {\n      params.push(`${key}=${options.parameter[key]}`);\n    }\n    url += params.join('&');\n  }\n\n  const headers: any = {\n    Authorization: `Bearer ${token.access_token}`,\n    'User-Agent': 'MAL-Sync',\n    'Content-Type': 'application/json',\n  };\n\n  let data = '';\n  if (options.dataObj) {\n    data = JSON.stringify(options.dataObj);\n  }\n\n  if (options.auth) {\n    delete headers.Authorization;\n    url = 'https://shikimori.me/oauth/token';\n  }\n\n  return api.request\n    .xhr(type, {\n      url,\n      headers,\n      data,\n    })\n    .then(async response => {\n      if ((response.status > 499 && response.status < 600) || response.status === 0) {\n        throw new ServerOfflineError(`Server Offline status: ${response.status}`);\n      }\n\n      let res: any = null;\n      if (response.responseText) {\n        res = JSON.parse(response.responseText);\n      }\n\n      if (response.status === 401) {\n        if (options.auth) throw new NotAutenticatedError(res.message ?? res.error);\n        await refreshToken(token.refresh_token);\n        return apiCall(options);\n      }\n\n      if (res && res.error) {\n        switch (res.error) {\n          case 'forbidden':\n          case 'invalid_token':\n            if (options.auth) throw new NotAutenticatedError(res.message ?? res.error);\n            await refreshToken(token.refresh_token);\n            return apiCall(options);\n          case 'not_found':\n            throw new NotFoundError(res.message ?? res.error);\n          default:\n            throw new Error(res.message ?? res.error);\n        }\n      }\n\n      switch (response.status) {\n        case 400:\n          throw new Error('Invalid Parameters');\n        case 403:\n        default:\n      }\n\n      return res;\n    });\n}\n\nexport function authRequest(data: { code: string } | { refresh_token: string }) {\n  const dataObj: any = {\n    client_id: clientId,\n    client_secret: '6vkFaJN_wxQHmBoq23ac1z6tZKiAD7xqsXGudkkOqTg',\n    redirect_uri: 'https://malsync.moe/shikimori/oauth',\n  };\n\n  if ('code' in data) {\n    dataObj.code = data.code;\n    dataObj.grant_type = 'authorization_code';\n  }\n\n  if ('refresh_token' in data) {\n    dataObj.refresh_token = data.refresh_token;\n    dataObj.grant_type = 'refresh_token';\n  }\n\n  return apiCall({\n    type: 'POST',\n    path: 'oauth/token',\n    auth: true,\n    dataObj,\n  });\n}\n\nasync function refreshToken(refresh_token: string) {\n  const res = await authRequest({ refresh_token }).catch(err => {\n    if (err.message === 'invalid_request') {\n      api.settings.set('shikiToken', '');\n    }\n    throw err;\n  });\n  await api.settings.set('shikiToken', {\n    access_token: res.access_token,\n    refresh_token: res.refresh_token,\n  });\n}\n\nexport function userRequest(): Promise<userRequest> {\n  return apiCall({\n    type: 'GET',\n    path: 'users/whoami',\n  }).then(res => {\n    if (res.locale) {\n      api.settings.set('shikiOptions', {\n        locale: res.locale,\n      });\n    }\n    return res;\n  });\n}\n\nexport async function userId() {\n  const cacheObj = new Cache(`shiki/userId`, 4 * 60 * 60 * 1000);\n\n  if (await cacheObj.hasValue()) {\n    return cacheObj.getValue();\n  }\n\n  const res = await userRequest();\n  if (res.id) {\n    cacheObj.setValue(res.id);\n  }\n  return res.id;\n}\n\nexport function title(rus: string, eng: string, headline = false) {\n  const options = api.settings.get('shikiOptions');\n  const locale = options && options.locale ? options.locale : 'ru';\n  if (locale === 'ru') return rus || eng;\n  if (headline && eng && rus) return `${eng} / ${rus}`;\n  return eng || rus;\n}\n\nexport type StatusType =\n  | 'planned'\n  | 'watching'\n  | 'rewatching'\n  | 'completed'\n  | 'on_hold'\n  | 'dropped';\n\n// eslint-disable-next-line no-shadow\nexport enum statusTranslate {\n  'watching' = status.Watching,\n  'planned' = status.PlanToWatch,\n  'completed' = status.Completed,\n  'dropped' = status.Dropped,\n  'on_hold' = status.Onhold,\n  'rewatching' = status.Rewatching,\n}\n\nexport interface StatusRequest {\n  id?: number;\n  user_id: number;\n  target_id: number;\n  target_type: 'Anime' | 'Manga';\n  score: number;\n  status: StatusType;\n  rewatches: number;\n  episodes: number;\n  volumes: number;\n  chapters: number;\n  text: string;\n  text_html?: string;\n  created_at?: Date;\n  updated_at?: Date;\n}\n\nexport interface Image {\n  original: string;\n  preview: string;\n  x96: string;\n  x48: string;\n}\n\nexport interface MetaRequest {\n  id: number;\n  name: string;\n  russian: string;\n  image: Image;\n  url: string;\n  kind: string;\n  score: string;\n  status: string;\n  volumes: number;\n  chapters: number;\n  episodes: number;\n  aired_on: string;\n  released_on: string;\n}\n\nexport interface userRequest {\n  id: number;\n  nickname: string;\n  avatar: string;\n  image: {\n    x80: string;\n  };\n  url: string;\n  locale: string;\n}\n","import { NotAutenticatedError, NotFoundError, parseJson, ServerOfflineError } from '../Errors';\n\nconst logger = con.m('kitsu', '#d65e43');\n\nexport function translateList(aniStatus, malStatus: null | number = null) {\n  const list = {\n    current: 1,\n    planned: 6,\n    completed: 2,\n    dropped: 4,\n    on_hold: 3,\n  };\n  if (malStatus !== null) {\n    return Object.keys(list).find(key => list[key] === malStatus);\n  }\n  return list[aniStatus];\n}\n\nexport function getTitle(titles, canonicalTitle) {\n  let title: string;\n  switch (api.settings.get('kitsuOptions').titleLanguagePreference) {\n    case 'english':\n      title = titles.en;\n      break;\n    case 'romanized':\n      title = titles.en_jp;\n      break;\n    case 'canonical':\n    default:\n      title = canonicalTitle;\n  }\n\n  if (typeof title === 'undefined' || !title) title = titles.en;\n  if (typeof title === 'undefined' || !title) title = titles.en_jp;\n  if (typeof title === 'undefined' || !title) title = titles.ja_jp;\n  if (typeof title === 'undefined' || !title) {\n    const keys = Object.keys(titles);\n    if (!keys.length) {\n      return 'No Title';\n    }\n    title = titles[keys[0]];\n  }\n\n  return title;\n}\n\nexport function getCacheKey(id, kitsuId) {\n  if (Number.isNaN(id) || !id) {\n    return `kitsu:${kitsuId}`;\n  }\n  return id;\n}\n\nexport function malToKitsu(malid: number, type: 'anime' | 'manga') {\n  return apiCall(\n    'GET',\n    `https://kitsu.io/api/edge/mappings?filter[externalSite]=myanimelist/${type}&filter[externalId]=${malid}&include=item&fields[item]=id`,\n    {},\n    false,\n  );\n}\n\nexport function kitsuToMal(kitsuId: number, type: 'anime' | 'manga') {\n  return api.request\n    .xhr('GET', {\n      url: `https://kitsu.io/api/edge/${type}/${kitsuId}/mappings?filter[externalSite]=myanimelist/${type}`,\n      headers: {\n        'Content-Type': 'application/vnd.api+json',\n        Accept: 'application/vnd.api+json',\n      },\n    })\n    .then(response => {\n      const res = JSON.parse(response.responseText);\n      con.log('[KtoM]', res);\n      if (typeof res.data === 'undefined' || !res.data.length) return null;\n      return Number(res.data[0].attributes.externalId);\n    });\n}\n\nexport function apiCall(mode, url, variables = {}, authentication = true) {\n  const headers: any = {\n    'Content-Type': 'application/vnd.api+json',\n    Accept: 'application/vnd.api+json',\n  };\n  if (authentication) headers.Authorization = `Bearer ${api.settings.get('kitsuToken')}`;\n  return api.request\n    .xhr(mode, {\n      url,\n      headers,\n      data: JSON.stringify(variables),\n    })\n    .then(response => {\n      if ((response.status > 499 && response.status < 600) || response.status === 0) {\n        throw new ServerOfflineError(`Server Offline status: ${response.status}`);\n      }\n\n      if (response.status === 204) {\n        return {};\n      }\n\n      const res = parseJson(response.responseText);\n\n      if (typeof res.errors !== 'undefined' && res.errors.length) {\n        logger.error('[SINGLE]', 'Error', res.errors);\n        const error = res.errors[0];\n        switch (parseInt(error.status)) {\n          case 401:\n          case 403:\n            throw new NotAutenticatedError(error.detail);\n          case 404:\n            throw new NotFoundError(error.detail);\n          default:\n            throw new Error(error.detail);\n        }\n      }\n\n      return res;\n    });\n}\n","import { Cache } from '../utils/Cache';\nimport { getList } from '../_provider/listFactory';\nimport { listElement } from '../_provider/listAbstract';\nimport { xhrResponseI } from '../api/messageInterface';\n\nexport interface releaseItemInterface {\n  timestamp: number;\n  value: any;\n  finished: boolean;\n  mode: string;\n}\n\nexport function initProgressScheduler() {\n  chrome.alarms.get('progressSync', async a => {\n    const progressInterval = parseInt(await api.settings.getAsync('progressInterval'));\n    const progressSyncLast = await api.storage.get('progressSyncLast');\n    if (!progressInterval) {\n      con.log('progressSync disabled', progressInterval);\n      if (a) chrome.alarms.clear('progressSync');\n      return;\n    }\n\n    if (typeof a !== 'undefined' && Date.now() - progressSyncLast < progressInterval * 60 * 1000) {\n      con.log('progressSync already set and on time', progressSyncLast, a);\n      return;\n    }\n\n    if (a) chrome.alarms.clear('progressSync');\n\n    con.log('Create progressSync Alarm', progressInterval, progressSyncLast);\n    chrome.alarms.create('progressSync', {\n      periodInMinutes: progressInterval,\n      when: Date.now() + 1000,\n    });\n  });\n\n  chrome.alarms.onAlarm.addListener(alarm => {\n    if (alarm.name === 'progressSync') {\n      api.storage.set('progressSyncLast', Date.now());\n      api.settings.init().then(async () => {\n        console.groupCollapsed('Progress');\n        await main();\n        console.groupEnd();\n      });\n    }\n  });\n}\n\nexport async function initUserProgressScheduler() {\n  setTimeout(async () => {\n    const progressInterval = await api.settings.getAsync('progressInterval');\n    const progressSyncLast = await api.storage.get('progressSyncLast');\n    if (Date.now() - progressSyncLast < progressInterval * 60 * 1000) {\n      con.log('Progress on time');\n      return;\n    }\n    if (await main()) {\n      api.storage.set('progressSyncLast', Date.now());\n    }\n  }, 30 * 1000);\n}\n\nexport async function main() {\n  try {\n    setBadgeText('⌛');\n    await api.settings.init();\n    if (!api.settings.get('epPredictions')) {\n      throw 'epPredictions disabled';\n    }\n    await listUpdateWithPOST(1, 'anime');\n    await listUpdateWithPOST(1, 'manga');\n    if (api.settings.get('loadPTWForProgress')) {\n      await listUpdateWithPOST(6, 'anime');\n      await listUpdateWithPOST(6, 'manga');\n    }\n    con.log('Progress done');\n    setBadgeText('');\n    return true;\n  } catch (e) {\n    con.log('Progress Failed', e);\n  }\n  setBadgeText('');\n  return false;\n}\n\n/*\nexport async function listUpdate(state, type) {\n  const logger = con.m('release').m(type);\n  logger.log('Start', type, state);\n  const listProvider = await getList(state, type);\n  return listProvider\n    .get()\n    .then(async list => {\n      for (let i = 0; i < list.length; i++) {\n        try {\n          if (list[i].options) {\n            await single(list[i], type, list[i].options!.p, logger);\n          }\n        } catch (e) {\n          logger.error(e);\n        }\n      }\n    })\n    .catch(e => {\n      logger.error(e);\n    });\n}\n*/\n\nexport async function listUpdateWithPOST(state, type) {\n  const logger = con.m('release').m(type);\n  logger.log('Start', type, state);\n  const listProvider = await getList(state, type);\n  return listProvider\n    .getCompleteList()\n    .then(async list => {\n      if (list.length > 0) {\n        try {\n          await multiple(list, type, logger);\n        } catch (e) {\n          logger.error(e);\n        }\n      }\n    })\n    .catch(e => {\n      logger.error(e);\n    });\n}\n\nexport async function predictionXhrGET(type: string, apiCacheKey: number | string | null) {\n  if (!apiCacheKey) return {};\n  const response = await api.request.xhr(\n    'GET',\n    `https://api.malsync.moe/nc/mal/${type}/${apiCacheKey}/pr`,\n  );\n  return JSON.parse(response.responseText);\n}\n\nexport async function predictionXhrPOST(type: string, malDATA: listElement[] | null) {\n  if (malDATA === null) return [];\n  if (malDATA.length <= 0) return [];\n  const malDATAID = malDATA.map(el => el.apiCacheKey);\n  const returnArray: xhrResponseI[] = [];\n  for (let i = 0; i <= malDATAID.length; ) {\n    const tempArray = malDATAID.slice(i, i + 49);\n    const Request = {\n      url: `https://api.malsync.moe/nc/mal/${type}/POST/pr`,\n      data: JSON.stringify({ malids: tempArray }),\n      headers: { 'Content-Type': 'application/json' },\n    };\n    await utils.wait(5000);\n    const response = await api.request.xhr('POST', Request);\n    returnArray.push(JSON.parse(response.responseText));\n    i += 50;\n  }\n\n  return returnArray.reduce((acc: xhrResponseI[], val) => acc.concat(val), []);\n}\n\nexport async function multiple(Array: listElement[], type, logger = con.m('release')) {\n  if (!Array) {\n    logger.log('No MAL Id List');\n  } else {\n    Array.forEach(el => {\n      let mode = el.options!.p;\n      if (!mode) mode = 'default';\n      logger.m(el.apiCacheKey).log(el.title, el.cacheKey, el.apiCacheKey, `Mode: ${mode}`);\n    });\n  }\n\n  if (!api.settings.get('epPredictions')) {\n    logger.log('epPredictions disabled');\n    return;\n  }\n\n  async function asyncForEach(array, callback) {\n    for (let index = 0; index < array.length; index++) {\n      await callback(array[index], index, array);\n    }\n  }\n\n  const remoteUpdateList: listElement[] = [];\n  await asyncForEach(Array, async el => {\n    if (!el.apiCacheKey) return;\n\n    const releaseItem: undefined | releaseItemInterface = await api.storage.get(\n      `release/${type}/${el.cacheKey}`,\n    );\n\n    if (releaseItem && releaseItem.value) {\n      el.fn.progress = releaseItem.value;\n    }\n\n    let mode = el.options!.p;\n    if (!mode) mode = 'default';\n    logger.m(el.apiCacheKey).m('Load').log(releaseItem);\n\n    if (releaseItem && releaseItem.mode && releaseItem.mode !== mode) {\n      remoteUpdateList.push(el);\n    } else if (\n      releaseItem &&\n      releaseItem.timestamp &&\n      Date.now() - releaseItem.timestamp < 2 * 60 * 1000\n    ) {\n      logger.m(el.apiCacheKey).log('Up to date');\n    } else if (\n      releaseItem &&\n      releaseItem.finished &&\n      releaseItem.timestamp &&\n      Date.now() - releaseItem.timestamp < 7 * 24 * 60 * 60 * 1000\n    ) {\n      logger.m(el.apiCacheKey).log('Fininshed');\n    } else if (\n      releaseItem &&\n      !releaseItem.value &&\n      releaseItem.timestamp &&\n      Date.now() - releaseItem.timestamp < 1 * 24 * 60 * 60 * 1000\n    ) {\n      logger.m(el.apiCacheKey).log('Nulled');\n    } else {\n      remoteUpdateList.push(el);\n    }\n  });\n\n  let xhrArray: any = [];\n  if (remoteUpdateList.length > 0) {\n    xhrArray = await predictionXhrPOST(type, remoteUpdateList);\n    await utils.wait(500);\n  }\n\n  xhrArray.forEach(async xhr => {\n    const elRef = remoteUpdateList.find(el => xhr.malid === el.apiCacheKey);\n    if (!elRef) {\n      return;\n    }\n    logger.m(elRef.malId).log(xhr.data);\n    let mode = elRef.options!.p;\n    if (!mode) mode = 'default';\n    const progressValue = getProgress(xhr.data, mode, type);\n\n    if (!progressValue) {\n      logger.m(elRef.malId).log('No value for the selected mode');\n    }\n    let finished = false;\n\n    if (progressValue && progressValue.state && progressValue.state === 'complete') finished = true;\n\n    logger.m(elRef.malId).m('Save').log(progressValue);\n    if (elRef.cacheKey) {\n      if (elRef && elRef.fn && elRef.fn.progress) {\n        notificationCheck(elRef, elRef.fn.progress, progressValue, type);\n      }\n      await api.storage.set(`release/${type}/${elRef.cacheKey}`, {\n        timestamp: Date.now(),\n        value: progressValue,\n        mode,\n        finished,\n      } as releaseItemInterface);\n    }\n  });\n}\n\nexport async function single(\n  el: {\n    uid: number;\n    apiCacheKey: number | string | null;\n    title: string;\n    cacheKey: string;\n    watchedEp: number;\n    single: any;\n    xhr?: object;\n  },\n  type,\n  mode = 'default',\n  logger = con.m('release'),\n) {\n  if (!mode) mode = 'default';\n  logger = logger.m(el.uid.toString());\n  logger.log(el.title, el.cacheKey, el.apiCacheKey, `Mode: ${mode}`);\n  if (!el.apiCacheKey) {\n    logger.log('No Api Cache Id');\n    return;\n  }\n  if (!api.settings.get('epPredictions')) {\n    logger.log('epPredictions disabled');\n    return;\n  }\n  const releaseItem: undefined | releaseItemInterface = await api.storage.get(\n    `release/${type}/${el.cacheKey}`,\n  );\n\n  logger.m('Load').log(releaseItem);\n\n  let force = false;\n\n  if (releaseItem && releaseItem.mode && releaseItem.mode !== mode) force = true;\n\n  if (\n    releaseItem &&\n    releaseItem.timestamp &&\n    Date.now() - releaseItem.timestamp < 2 * 60 * 1000 &&\n    !force\n  ) {\n    logger.log('Up to date');\n    return;\n  }\n\n  if (\n    releaseItem &&\n    releaseItem.finished &&\n    releaseItem.timestamp &&\n    Date.now() - releaseItem.timestamp < 7 * 24 * 60 * 60 * 1000 &&\n    !force\n  ) {\n    logger.log('Fininshed');\n    return;\n  }\n\n  if (\n    releaseItem &&\n    !releaseItem.value &&\n    releaseItem.timestamp &&\n    Date.now() - releaseItem.timestamp < 1 * 24 * 60 * 60 * 1000 &&\n    !force\n  ) {\n    logger.log('Nulled');\n    return;\n  }\n\n  if (force) logger.log('Update forced');\n\n  if (mode === 'off') {\n    logger.log('Disabled');\n    el.xhr = [];\n  }\n\n  let xhr;\n  if (typeof el.xhr !== 'undefined') {\n    xhr = el.xhr;\n  } else {\n    xhr = await predictionXhrGET(type, el.apiCacheKey);\n    await utils.wait(500);\n  }\n  logger.log(xhr);\n\n  const progressValue = getProgress(xhr, mode, type);\n\n  if (!progressValue) {\n    logger.log('No value for the selected mode');\n  }\n\n  let finished = false;\n\n  if (progressValue && progressValue.state && progressValue.state === 'complete') finished = true;\n\n  logger.m('Save').log(progressValue);\n  if (releaseItem && releaseItem.value) {\n    notificationCheck(el, releaseItem.value, progressValue, type);\n  }\n\n  await api.storage.set(`release/${type}/${el.cacheKey}`, {\n    timestamp: Date.now(),\n    value: progressValue,\n    mode,\n    finished,\n  } as releaseItemInterface);\n}\n\nexport function progressIsOld(releaseItem: releaseItemInterface) {\n  if (releaseItem && releaseItem.timestamp) {\n    const diff = new Date().getTime() - releaseItem.timestamp;\n\n    if (releaseItem.finished && diff < 7 * 24 * 60 * 60 * 1000) {\n      // logger.log('Fininshed');\n      return false;\n    }\n\n    if (!releaseItem.value && diff < 1 * 24 * 60 * 60 * 1000) {\n      // logger.log('Nulled');\n      return false;\n    }\n\n    if (diff < 1 * 24 * 60 * 60 * 1000) {\n      // logger.log('not old');\n      return false;\n    }\n  }\n\n  return true;\n}\n\nexport function getProgress(res, mode, type) {\n  const config: {\n    mainId?: string;\n    fallbackPrediction?: string;\n    fallback?: string;\n  } = {};\n\n  if (!res.length) return null;\n\n  if (mode === 'default') {\n    if (type === 'anime') {\n      config.mainId = api.settings.get('progressIntervalDefaultAnime');\n    } else {\n      config.mainId = api.settings.get('progressIntervalDefaultManga');\n    }\n    config.fallback = 'en/sub';\n  } else {\n    config.mainId = mode;\n  }\n\n  config.fallbackPrediction = 'jp/dub';\n\n  let top;\n\n  if (config.mainId) {\n    const mainTemp = res.find(el => el.id === config.mainId);\n    if (mainTemp) top = mainTemp;\n  }\n\n  if (config.fallback && !top) {\n    const mainTemp = res.find(el => el.id === config.fallback);\n    if (mainTemp) top = mainTemp;\n  }\n\n  if (config.fallbackPrediction && top && !top.predicition && top.lastEp && top.lastEp.timestamp) {\n    const predTemp = res.find(el => el.id === config.fallbackPrediction);\n    const predTime = top.lastEp.timestamp + 7 * 24 * 60 * 60 * 1000;\n    if (predTime && predTemp && predTemp.predicition) {\n      if (top.lastEp.total === predTemp.lastEp.total) {\n        if (Math.abs(predTime - predTemp.predicition.timestamp) < 30 * 60 * 60 * 1000) {\n          top.predicition = {\n            timestamp: predTime,\n            probability: 'medium',\n          };\n        }\n      } else if (predTemp.lastEp.total && top.lastEp.total === predTemp.lastEp.total - 1) {\n        if (\n          Math.abs(predTime - (predTemp.predicition.timestamp - 7 * 24 * 60 * 60 * 1000)) <\n          30 * 60 * 60 * 1000\n        ) {\n          top.predicition = {\n            timestamp: predTime,\n            probability: 'medium',\n          };\n        }\n      }\n    }\n  }\n\n  // Fallback to jp if no other language found and episode 0 -> Before release\n  if (config.fallbackPrediction && !top) {\n    const predSoon = res.find(el => el.id === config.fallbackPrediction);\n    if (predSoon && predSoon.lastEp && predSoon.predicition && predSoon.lastEp.total === 0) {\n      top = predSoon;\n      top.predicition.probability = 'medium';\n    }\n  }\n\n  if (!top) return null;\n\n  return top;\n}\n\nexport async function getProgressTypeList(\n  type: 'anime' | 'manga',\n): Promise<{ key: string; label: string }[]> {\n  const cacheObj = new Cache(`ProgressTypeList${type}`, 24 * 60 * 60 * 1000, false);\n  if (!(await cacheObj.hasValueAndIsNotEmpty())) {\n    con.log('Getting new ProgressTypeList Cache');\n    const url = `https://api.malsync.moe/general/progress/${type}`;\n    const request = await api.request.xhr('GET', url).then(async response => {\n      if (response.status === 200 && response.responseText) {\n        return JSON.parse(response.responseText);\n      }\n      return [];\n    });\n    await cacheObj.setValue(request);\n    return request;\n  }\n  con.log('PageSearch Cached');\n  return cacheObj.getValue();\n}\n\nasync function notificationCheck(el, cProgress, nProgress, type) {\n  try {\n    if (\n      (type === 'anime' && !api.settings.get('progressNotificationsAnime')) ||\n      (type === 'manga' && !api.settings.get('progressNotificationsManga'))\n    ) {\n      return;\n    }\n    if (el && nProgress && nProgress) {\n      if (\n        cProgress.lastEp &&\n        typeof cProgress.lastEp.total !== 'undefined' &&\n        nProgress.lastEp &&\n        nProgress.lastEp.total &&\n        cProgress.lang === nProgress.lang &&\n        cProgress.type === nProgress.type\n      ) {\n        if (cProgress.lastEp.total < nProgress.lastEp.total) {\n          // Check if new ep is one higher than the watched one\n          if (el.watchedEp + 1 === nProgress.lastEp.total) {\n            let noti;\n            if (el.single) {\n              noti = {\n                title: el.title,\n                text: api.storage.lang(`syncPage_malObj_nextEp_${type}`, [nProgress.lastEp.total]),\n                sticky: true,\n                image: await el.single.getImage(),\n                url: el.single.getStreamingUrl() ? el.single.getStreamingUrl() : el.single.getUrl(),\n              };\n            } else {\n              noti = {\n                title: el.title,\n                text: api.storage.lang(`syncPage_malObj_nextEp_${type}`, [nProgress.lastEp.total]),\n                sticky: true,\n                image: el.image,\n                url: el.options && el.options.u ? el.options.u : el.url,\n              };\n            }\n            api.request.notification(noti);\n          }\n        }\n      }\n    }\n  } catch (e) {\n    con.error('Could not check notification Progress', e);\n  }\n}\n\nfunction setBadgeText(text: string) {\n  // @ts-ignore\n  if (api.type === 'userscript') return;\n  try {\n    chrome.browserAction.setBadgeText({ text });\n  } catch (e) {\n    con.error(e);\n  }\n}\n","/* eslint-disable operator-assignment */\n\nexport interface timeElement {\n  y: number;\n  d: number;\n  h: number;\n  m: number;\n  s: number;\n}\n\nexport function msToTime(milliseconds: number): timeElement {\n  let day;\n  let hour;\n  let minute;\n  let seconds;\n  seconds = Math.floor(milliseconds / 1000);\n  minute = Math.floor(seconds / 60);\n  seconds = seconds % 60;\n  hour = Math.floor(minute / 60);\n  minute = minute % 60;\n  day = Math.floor(hour / 24);\n  hour = hour % 24;\n  const year = Math.floor(day / 365);\n  day = day % 365;\n  return {\n    y: year,\n    d: day,\n    h: hour,\n    m: minute,\n    s: seconds,\n  };\n}\n\nexport function shortTime(el: timeElement): timeElement {\n  if (el.y > 1) {\n    if (el.d > 182) {\n      return {\n        y: el.y + 1,\n        d: 0,\n        h: 0,\n        m: 0,\n        s: 0,\n      };\n    }\n    return {\n      y: el.y,\n      d: 0,\n      h: 0,\n      m: 0,\n      s: 0,\n    };\n  }\n  if (el.y) {\n    return {\n      y: el.y,\n      d: el.d,\n      h: 0,\n      m: 0,\n      s: 0,\n    };\n  }\n  if (el.d > 3) {\n    if (el.h > 11) {\n      return {\n        y: 0,\n        d: el.d + 1,\n        h: 0,\n        m: 0,\n        s: 0,\n      };\n    }\n    return {\n      y: 0,\n      d: el.d,\n      h: 0,\n      m: 0,\n      s: 0,\n    };\n  }\n  if (el.d) {\n    return {\n      y: 0,\n      d: el.d,\n      h: el.h,\n      m: 0,\n      s: 0,\n    };\n  }\n  if (el.h > 5) {\n    if (el.m > 29) {\n      return {\n        y: 0,\n        d: 0,\n        h: el.h + 1,\n        m: 0,\n        s: 0,\n      };\n    }\n    return {\n      y: 0,\n      d: 0,\n      h: el.h,\n      m: 0,\n      s: 0,\n    };\n  }\n  if (el.h) {\n    return {\n      y: 0,\n      d: 0,\n      h: el.h,\n      m: el.m,\n      s: 0,\n    };\n  }\n  if (el.m > 14) {\n    return {\n      y: 0,\n      d: 0,\n      h: 0,\n      m: el.m,\n      s: 0,\n    };\n  }\n  return {\n    y: 0,\n    d: 0,\n    h: 0,\n    m: el.m,\n    s: el.s,\n  };\n}\n\nexport function timeToString(el: timeElement): string {\n  let output = '';\n\n  if (el.y === 1) {\n    output += ` ${el.y} ${api.storage.lang('bookmarksItem_Year')}`;\n  } else if (el.y > 1) {\n    output += ` ${el.y} ${api.storage.lang('bookmarksItem_Years')}`;\n  }\n\n  if (el.d === 1) {\n    output += ` ${el.d} ${api.storage.lang('bookmarksItem_Day')}`;\n  } else if (el.d > 1) {\n    output += ` ${el.d} ${api.storage.lang('bookmarksItem_Days')}`;\n  }\n\n  if (el.h === 1) {\n    output += ` ${el.h} ${api.storage.lang('bookmarksItem_Hour')}`;\n  } else if (el.h > 1) {\n    output += ` ${el.h} ${api.storage.lang('bookmarksItem_Hours')}`;\n  }\n\n  if (el.m === 1) {\n    output += ` ${el.m} ${api.storage.lang('bookmarksItem_min')}`;\n  } else if (el.m > 1) {\n    output += ` ${el.m} ${api.storage.lang('bookmarksItem_mins')}`;\n  }\n\n  if (el.s === 1) {\n    output += ` ${el.s} ${api.storage.lang('bookmarksItem_sec')}`;\n  } else if (el.s > 1) {\n    output += ` ${el.s} ${api.storage.lang('bookmarksItem_secs')}`;\n  }\n\n  return output.trim();\n}\n\nexport function msDiffToShortTimeString(ms: number): string {\n  return timeToString(shortTime(msToTime(ms)));\n}\n\nexport function timestampToShortTime(tm: number, ago = true): string {\n  if (!tm) return '';\n  const curTime = Date.now();\n  let diff;\n  let future;\n  if (curTime > tm) {\n    future = false;\n    diff = curTime - tm;\n  } else {\n    future = true;\n    diff = tm - curTime;\n  }\n\n  if (diff < 30 * 1000) return api.storage.lang('bookmarksItem_now');\n\n  let short = msDiffToShortTimeString(diff);\n\n  if (!future && ago) short = api.storage.lang('bookmarksItem_ago', [short]);\n\n  return short;\n}\n\nexport function timestampToShortDate(ts: number): string {\n  const date = new Date(ts);\n\n  const monthAbbreviation = date.toLocaleString('default', { month: 'short' });\n  const dayOfMonth = date.getDate();\n  const year = date.getFullYear();\n\n  return `${monthAbbreviation} ${dayOfMonth}, ${year}`;\n}\n","import {\n  releaseItemInterface,\n  progressIsOld,\n  single as updateProgress,\n} from '../background/releaseProgress';\nimport { timestampToShortTime } from './time';\n\nexport class Progress {\n  protected logger;\n\n  protected releaseItem: undefined | releaseItemInterface = undefined;\n\n  constructor(protected cacheKey: string, protected type: 'anime' | 'manga') {\n    this.logger = con.m('progress').m(cacheKey.toString());\n    return this;\n  }\n\n  // Progress\n  protected async initReleaseProgress(liveData) {\n    if (liveData) await updateProgress(liveData, this.type, liveData.progressMode);\n\n    const releaseItem: undefined | releaseItemInterface = await api.storage.get(\n      `release/${this.type}/${this.cacheKey}`,\n    );\n\n    this.logger.m('Init Release').log(releaseItem);\n    if (!releaseItem) return;\n    if (progressIsOld(releaseItem)) {\n      this.logger.log('Too old');\n      return;\n    }\n\n    this.releaseItem = releaseItem;\n  }\n\n  protected getProgressCurrentEpisode() {\n    const re = this.releaseItem;\n    if (re && re.value && re.value.lastEp && re.value.lastEp.total) return re.value.lastEp.total;\n    return null;\n  }\n\n  protected isProgressFinished() {\n    const re = this.releaseItem;\n    if (re && re.finished) return true;\n    return false;\n  }\n\n  protected getProgressPrediction() {\n    const re = this.releaseItem;\n    if (re && re.value && re.value.predicition && re.value.predicition.timestamp)\n      return re.value.predicition.timestamp;\n    return null;\n  }\n\n  protected getProgressLastTimestamp() {\n    const re = this.releaseItem;\n    if (re && re.value && re.value.lastEp && re.value.lastEp.timestamp)\n      return re.value.lastEp.timestamp;\n    return null;\n  }\n\n  // General\n  async init(\n    live:\n      | {\n          uid: number;\n          apiCacheKey: number | string | null;\n          title: string;\n          cacheKey: string;\n          progressMode: string;\n          watchedEp: number;\n          single: any;\n          xhr?: object;\n        }\n      | false = false,\n  ) {\n    await Promise.all([this.initReleaseProgress(live)]);\n\n    return this;\n  }\n\n  getCurrentEpisode(): number {\n    // @ts-ignore\n    if (!api.settings.get('epPredictions')) return null;\n    return this.getProgressCurrentEpisode();\n  }\n\n  isFinished(): boolean {\n    return this.isProgressFinished();\n  }\n\n  isAiring(): boolean {\n    return !this.isFinished();\n  }\n\n  getPredictionTimestamp(): number {\n    if (!this.getProgressPrediction() || new Date().getTime() > this.getProgressPrediction())\n      return NaN;\n    return this.getProgressPrediction();\n  }\n\n  getPrediction(): string {\n    return timestampToShortTime(this.getPredictionTimestamp());\n  }\n\n  getPredictionText(): string {\n    const pre = this.getPrediction();\n    if (pre) return api.storage.lang(`prediction_Episode_${this.type}`, [pre]);\n    return '';\n  }\n\n  getLastTimestamp(): number {\n    return this.getProgressLastTimestamp();\n  }\n\n  getLast(ago = true): string {\n    return timestampToShortTime(this.getLastTimestamp(), ago);\n  }\n\n  getLastText(): string {\n    const last = this.getLast(false);\n    if (last) return api.storage.lang(`prediction_Last_${this.type}`, [last]);\n    return '';\n  }\n\n  getAuto(): string {\n    const preT = this.getPrediction();\n    if (preT) return preT;\n    const lastT = this.getLast();\n    if (lastT) return lastT;\n    return '';\n  }\n\n  getAutoText(): string {\n    const preT = this.getPredictionText();\n    if (preT) return preT;\n    const lastT = this.getLastText();\n    if (lastT) return lastT;\n    return '';\n  }\n\n  getColor(): string {\n    return '#f57c00';\n  }\n\n  getBars(curEp, totalEp): { totalWidth: number; epWidth: number; predWidth: number } {\n    const predEp = this.getCurrentEpisode();\n    const res = {\n      totalWidth: 100,\n      epWidth: 0,\n      predWidth: 0,\n    };\n    if (!totalEp) {\n      res.totalWidth = 0;\n      if (curEp && (!predEp || curEp >= predEp)) {\n        totalEp = Math.ceil(curEp * 1.2);\n      } else if (predEp && (!curEp || curEp < predEp)) {\n        totalEp = Math.ceil(predEp * 1.2);\n      } else {\n        return res;\n      }\n    }\n    if (curEp) {\n      res.epWidth = (curEp / totalEp) * 100;\n      if (res.epWidth > 100) res.epWidth = 100;\n    }\n    if (predEp) {\n      res.predWidth = (predEp / totalEp) * 100;\n      if (res.predWidth > 100) res.predWidth = 100;\n    }\n    return res;\n  }\n}\n","/* eslint-disable max-classes-per-file */\nexport class MissingPlayerError extends Error {\n  public url;\n\n  constructor(url: string) {\n    const parts = url.split('/');\n    let domain = url;\n    if (parts.length > 2) domain = parts[2];\n    super(domain);\n    this.url = url;\n    this.name = 'MissingPlayerError';\n  }\n}\n\nexport class SafeError extends Error {\n  constructor(message: string) {\n    super(message);\n    this.name = 'SafeError';\n  }\n}\n\nexport class MissingDataError extends Error {\n  constructor(message: string) {\n    super(message);\n    this.name = 'MissingDataError';\n  }\n}\n\nexport class CustomDomainError extends Error {\n  constructor(message: string) {\n    super(message);\n    this.name = 'CustomDomainError';\n  }\n}\n","import { ScoreModeStrategy } from './ScoreModeStrategy';\n\nexport const point10: ScoreModeStrategy = {\n  ui: {\n    module: 'dropdown',\n  },\n  getOptions() {\n    return [\n      { value: 0, label: api.storage.lang('UI_Score_Not_Rated') },\n      { value: 100, label: api.storage.lang('UI_Score_Masterpiece') },\n      { value: 90, label: api.storage.lang('UI_Score_Great') },\n      { value: 80, label: api.storage.lang('UI_Score_VeryGood') },\n      { value: 70, label: api.storage.lang('UI_Score_Good') },\n      { value: 60, label: api.storage.lang('UI_Score_Fine') },\n      { value: 50, label: api.storage.lang('UI_Score_Average') },\n      { value: 40, label: api.storage.lang('UI_Score_Bad') },\n      { value: 30, label: api.storage.lang('UI_Score_VeryBad') },\n      { value: 20, label: api.storage.lang('UI_Score_Horrible') },\n      { value: 10, label: api.storage.lang('UI_Score_Appalling') },\n    ];\n  },\n  valueToOptionValue(value) {\n    if (!value) return 0;\n    if (value < 10) return 10;\n    return Math.round(value / 10) * 10;\n  },\n  optionValueToValue(optionValue) {\n    if (!optionValue) return 0;\n    return Number(optionValue);\n  },\n};\n","import * as definitions from './definitions';\n\nimport { Progress } from '../utils/progress';\nimport { predictionXhrGET } from '../background/releaseProgress';\n\nimport { emitter, globalEmit } from '../utils/emitter';\nimport { SafeError } from '../utils/errors';\nimport { errorMessage as _errorMessage } from './Errors';\nimport { point10 } from './ScoreMode/point10';\nimport { SyncTypes } from './helper';\n\nObject.seal(emitter);\n\nexport abstract class SingleAbstract {\n  constructor(protected url: string) {\n    this.handleUrl(url);\n    this.logger = con.m('[S]', '#348fff');\n    return this;\n  }\n\n  protected logger;\n\n  protected type: definitions.contentType | null = null;\n\n  protected persistanceState;\n\n  protected undoState;\n\n  protected lastError;\n\n  public abstract shortName: string;\n\n  protected abstract authenticationUrl: string;\n\n  protected rewatchingSupport = true;\n\n  protected ids = {\n    mal: NaN,\n    ani: NaN,\n    kitsu: {\n      id: NaN,\n      slug: '',\n    },\n    simkl: NaN,\n  };\n\n  protected options: {\n    u: string;\n    c: any;\n    r: any;\n    p: any;\n  } | null = null;\n\n  protected abstract handleUrl(url: string);\n\n  public getType() {\n    return this.type;\n  }\n\n  public getUrl() {\n    return this.url;\n  }\n\n  public supportsRewatching() {\n    return this.rewatchingSupport;\n  }\n\n  public abstract getCacheKey();\n\n  public abstract getPageId();\n\n  public getApiCacheKey(): string | number {\n    return this.getKey(['ANILIST']);\n  }\n\n  public getRulesCacheKey(): string | number {\n    return this.getKey(['ANILIST', 'KITSU'], false);\n  }\n\n  abstract _setStatus(status: definitions.status): void;\n\n  public setStatus(status: definitions.status): SingleAbstract {\n    status = Number(status);\n    this._setStatus(status);\n    return this;\n  }\n\n  abstract _getStatus(): definitions.status | number;\n\n  public getStatus(): definitions.status {\n    if (!this.isOnList()) return definitions.status.NoState;\n    return this._getStatus();\n  }\n\n  public getScoreMode() {\n    return point10;\n  }\n\n  abstract _setScore(score: definitions.score): void;\n\n  /**\n   * @deprecated Use setAbsoluteScore instead\n   */\n  public setScore(score: definitions.score): SingleAbstract {\n    score = parseInt(`${score}`);\n    if (!score) score = 0;\n    this._setScore(score);\n    return this;\n  }\n\n  abstract _getScore(): definitions.score;\n\n  /**\n   * @deprecated Use getAbsoluteScore instead\n   */\n  public getScore(): definitions.score {\n    const score = this._getScore();\n    if (!score) return 0;\n    return score;\n  }\n\n  abstract _setAbsoluteScore(score: definitions.score100): void;\n\n  public setAbsoluteScore(score: definitions.score100): SingleAbstract {\n    score = parseInt(`${score}`);\n    this._setAbsoluteScore(score);\n    return this;\n  }\n\n  abstract _getAbsoluteScore(): definitions.score100;\n\n  public getAbsoluteScore(): definitions.score100 {\n    const score = this._getAbsoluteScore();\n    if (!score) return 0;\n    return score;\n  }\n\n  abstract _setEpisode(episode: number): void;\n\n  public setEpisode(episode: number): SingleAbstract {\n    episode = parseInt(`${episode}`);\n    if (this.getTotalEpisodes() && episode > this.getTotalEpisodes())\n      episode = this.getTotalEpisodes();\n    this._setEpisode(episode);\n    return this;\n  }\n\n  abstract _getEpisode(): number;\n\n  public getEpisode(): number {\n    return this._getEpisode();\n  }\n\n  abstract _setVolume(volume: number): void;\n\n  public setVolume(volume: number): SingleAbstract {\n    this._setVolume(volume);\n    return this;\n  }\n\n  abstract _getVolume(): number;\n\n  public getVolume(): number {\n    return this._getVolume();\n  }\n\n  abstract _setTags(tags: string): void;\n\n  abstract _getTags(): string;\n\n  public setStreamingUrl(streamingUrl: string): SingleAbstract {\n    if (this.options) {\n      this.options.u = streamingUrl;\n    }\n    return this;\n  }\n\n  public getStreamingUrl(): string | undefined {\n    if (this.options && this.options.u) {\n      return this.options.u;\n    }\n\n    return undefined;\n  }\n\n  public cleanTags() {\n    this.options = null;\n  }\n\n  protected progress: false | Progress = false;\n\n  protected progressXhr;\n\n  public async initProgress() {\n    const xhr = await predictionXhrGET(this.getType()!, this.getApiCacheKey());\n    return new Progress(this.getCacheKey(), this.getType()!)\n      .init({\n        uid: this.getCacheKey(),\n        apiCacheKey: this.getApiCacheKey(),\n        title: this.getTitle(),\n        cacheKey: this.getCacheKey(),\n        progressMode: this.getProgressMode(),\n        watchedEp: this.getEpisode(),\n        single: this,\n        xhr,\n      })\n      .then(progress => {\n        this.updateProgress = false;\n        this.progress = progress;\n        this.progressXhr = xhr;\n      });\n  }\n\n  public getProgress() {\n    if (!this.progress) return false;\n    return this.progress;\n  }\n\n  public getProgressFormated() {\n    const op: {\n      label: string;\n      key: string;\n      state: 'complete' | 'ongoing' | 'dropped' | 'discontinued';\n      type: 'dub' | 'sub';\n      dropped: boolean;\n      episode: Number;\n      lastEp?: {\n        total: number;\n        timestamp?: number;\n      };\n      predicition?: {\n        timestamp: number;\n        probability: 'low' | 'medium' | 'high';\n      };\n    }[] = [];\n    const languageNames = new Intl.DisplayNames('en', { type: 'language' });\n    con.log(this.progressXhr);\n    if (this.progressXhr && Object.keys(this.progressXhr).length) {\n      this.progressXhr.forEach(el => {\n        op.push({\n          type: el.type,\n          key: el.id,\n          state: el.state,\n          label: languageNames.of(el.lang.replace(/^jp$/, 'ja')) || el.lang,\n          dropped: el.state === 'dropped' || el.state === 'discontinued',\n          episode: el.lastEp && el.lastEp.total ? el.lastEp.total : 0,\n          lastEp: el.lastEp,\n          predicition: el.prediction,\n        });\n      });\n    }\n    return op;\n  }\n\n  public getProgressOptions() {\n    return this.getProgressFormated().filter(el => el.state !== 'complete');\n  }\n\n  public getProgressCompleted() {\n    return this.getProgressFormated().filter(el => el.state === 'complete');\n  }\n\n  private updateProgress = false;\n\n  public getProgressMode(): string {\n    if (this.options && this.options.p) {\n      return this.options.p;\n    }\n\n    return '';\n  }\n\n  public setProgressMode(mode: string): void {\n    if (this.options) {\n      this.options.p = mode;\n      this.updateProgress = true;\n    }\n    if (!api.settings.get('malTags')) {\n      utils\n        .setEntrySettings(this.type, this.getCacheKey(), this.options, this._getTags())\n        .then(() => this.initProgress());\n    }\n  }\n\n  public getProgressKey() {\n    let mode = this.getProgressMode();\n\n    if (!mode) {\n      if (this.getType() === 'anime') {\n        mode = api.settings.get('progressIntervalDefaultAnime');\n      } else {\n        mode = api.settings.get('progressIntervalDefaultManga');\n      }\n    }\n\n    if (!mode) return null;\n\n    const res = /^([^/]*)\\/(.*)$/.exec(mode);\n\n    if (!res) return null;\n\n    return {\n      key: mode,\n      lang: res[1],\n      type: res[2],\n    };\n  }\n\n  public getPageRelations(): { name: string; icon: string; link: string }[] {\n    const name = this.shortName;\n    const res: { name: string; icon: string; link: string }[] = [];\n\n    if (this.ids.mal && name !== 'MAL') {\n      res.push({\n        name: 'MAL',\n        icon: 'https://cdn.myanimelist.net/images/favicon.ico',\n        link: `https://myanimelist.net/${this.type}/${this.ids.mal}`,\n      });\n    }\n\n    if (this.ids.ani && name !== 'AniList') {\n      res.push({\n        name: 'AniList',\n        icon: 'https://anilist.co/img/icons/favicon-32x32.png',\n        link: `https://anilist.co/${this.type}/${this.ids.ani}`,\n      });\n    }\n\n    if (this.ids.kitsu.id && name !== 'Kitsu') {\n      res.push({\n        name: 'Kitsu',\n        icon: 'https://kitsu.io/favicon-32x32-3e0ecb6fc5a6ae681e65dcbc2bdf1f17.png',\n        link: `https://kitsu.io/${this.type}/${this.ids.kitsu.id}`,\n      });\n    }\n\n    if (this.ids.simkl && name !== 'Simkl') {\n      res.push({\n        name: 'Simkl',\n        icon: 'https://eu.simkl.in/img_favicon/v2/favicon-32x32.png',\n        link: `https://simkl.com/${this.type}/${this.ids.simkl}`,\n      });\n    }\n\n    return res;\n  }\n\n  public fillRelations(): Promise<void> {\n    return Promise.resolve();\n  }\n\n  abstract _update(): Promise<void>;\n\n  public update(): Promise<void> {\n    this.logger.log('[SINGLE]', 'Update info', this.ids);\n    this.lastError = null;\n    return this._update()\n      .catch(e => {\n        this.lastError = e;\n        throw e;\n      })\n      .then(() => {\n        this.persistanceState = this.getStateEl();\n\n        return utils.getEntrySettings(this.type, this.getCacheKey(), this._getTags());\n      })\n      .then(options => {\n        this.options = options;\n        this.registerEvent();\n        this.emitUpdate('state');\n      });\n  }\n\n  abstract _sync(): Promise<void>;\n\n  public async sync(): Promise<void> {\n    this.logger.log('[SINGLE]', 'Sync', this.ids);\n    this.lastError = null;\n    this._setTags(\n      await utils.setEntrySettings(this.type, this.getCacheKey(), this.options, this._getTags()),\n    );\n    return this._sync()\n      .catch(e => {\n        this.lastError = e;\n        throw e;\n      })\n      .then(() => {\n        this.undoState = this.persistanceState;\n        if (this.updateProgress) this.initProgress();\n        this._onList = true;\n        this.emitUpdate();\n      });\n  }\n\n  public emitUpdate(action: 'update' | 'state' = 'update') {\n    globalEmit(`${action}.${this.getCacheKey()}`, {\n      id: this.getPageId(),\n      type: this.getType(),\n      cacheKey: this.getCacheKey(),\n      state: this.getStateEl(),\n      meta: {\n        title: this.getTitle(),\n        image: this.getImage(),\n        malId: this.getMalId(),\n        totalEp: this.getTotalEpisodes(),\n        url: this.getUrl(),\n      },\n    });\n  }\n\n  abstract _delete(): Promise<void>;\n\n  public async delete(): Promise<void> {\n    return this._delete().then(() => {\n      this._onList = false;\n      globalEmit(`delete.${this.getCacheKey()}`, {\n        id: this.getPageId(),\n        type: this.getType(),\n        cacheKey: this.getCacheKey(),\n      });\n    });\n  }\n\n  protected globalUpdateEvent;\n\n  protected registerEvent() {\n    if (!this.globalUpdateEvent) {\n      this.globalUpdateEvent = emitter.on(`update.${this.getCacheKey()}`, data =>\n        this.updateEvent(data),\n      );\n    }\n  }\n\n  protected updateEvent(data) {\n    if (this.isDirty()) {\n      this.logger.log('Ignore event');\n      return;\n    }\n\n    if (data && data.state) {\n      this.setStateEl(data.state);\n      this.persistanceState = this.getStateEl();\n      emitter.emit('syncPage_fillUi');\n    }\n  }\n\n  public isDirty(): boolean {\n    return (\n      JSON.stringify(this.persistanceState) !== JSON.stringify(this.getStateEl()) ||\n      this.updateProgress\n    );\n  }\n\n  public undo(): Promise<void> {\n    this.logger.log('[SINGLE]', 'Undo', this.undoState);\n    if (!this.undoState) throw new SafeError('No undo state found');\n    if (!this.undoState.onList) {\n      // @ts-ignore\n      if (typeof this.delete === 'undefined') throw new Error('Deleting an entry is not supported');\n      // @ts-ignore\n      return this.delete().then(() => {\n        this.setStateEl(this.undoState);\n        this.undoState = null;\n      });\n    }\n    this.setStateEl(this.undoState);\n    return this.sync().then(() => {\n      this.undoState = null;\n    });\n  }\n\n  abstract _getTitle(raw: boolean): string;\n\n  public getTitle(raw = false) {\n    return this._getTitle(raw);\n  }\n\n  abstract _getTotalEpisodes(): number;\n\n  public getTotalEpisodes() {\n    let eps = this._getTotalEpisodes();\n    if (!eps) eps = 0;\n    return eps;\n  }\n\n  abstract _getTotalVolumes(): number;\n\n  public getTotalVolumes() {\n    return this._getTotalVolumes();\n  }\n\n  protected _onList = false;\n\n  public isOnList() {\n    return this._onList;\n  }\n\n  protected _authenticated = false;\n\n  public isAuthenticated() {\n    return this._authenticated;\n  }\n\n  abstract _getDisplayUrl(): string;\n\n  public getDisplayUrl(): string {\n    return this._getDisplayUrl();\n  }\n\n  public getMalUrl(): string | null {\n    if (!Number.isNaN(this.ids.mal)) {\n      return `https://myanimelist.net/${this.getType()}/${this.ids.mal}`;\n    }\n    return null;\n  }\n\n  public getMalId(): number | null {\n    if (!Number.isNaN(this.ids.mal)) {\n      return this.ids.mal;\n    }\n    return null;\n  }\n\n  public getIds() {\n    return this.ids;\n  }\n\n  abstract _getImage(): string;\n\n  public getImage(): string {\n    return this._getImage();\n  }\n\n  public setImage?(url: string): void;\n\n  abstract _getRating(): Promise<string>;\n\n  public getRating(): Promise<string> {\n    return this._getRating().then(rating => {\n      if (!rating) return 'N/A';\n      return rating;\n    });\n  }\n\n  public setResumeWatching(url: string, ep: number) {\n    return utils.setResumeWaching(url, ep, this.type, this.getCacheKey());\n  }\n\n  public getResumeWatching(): { url: string; ep: number } | null {\n    if (this.options && this.options.r) return this.options.r;\n    return null;\n  }\n\n  public setContinueWatching(url: string, ep: number) {\n    return utils.setContinueWaching(url, ep, this.type, this.getCacheKey());\n  }\n\n  public getContinueWatching(): { url: string; ep: number } | null {\n    if (this.options && this.options.c) return this.options.c;\n    return null;\n  }\n\n  public increaseRewatchCount(): void {\n    //  do nothing\n  }\n\n  getStateEl() {\n    return {\n      onList: this.isOnList(),\n      episode: this.getEpisode(),\n      volume: this.getVolume(),\n      status: this.getStatus(),\n      score: this.getScore(),\n      absoluteScore: this.getAbsoluteScore(),\n    };\n  }\n\n  setStateEl(state) {\n    this._onList = state.onList;\n    this.setEpisode(state.episode);\n    this.setVolume(state.volume);\n    this.setStatus(state.status);\n    this.setScore(state.score);\n    if (state.absoluteScore) this.setAbsoluteScore(state.absoluteScore);\n  }\n\n  getStateDiff() {\n    const persistance = this.getStateEl();\n    if (persistance && this.undoState) {\n      const diff: any = {};\n      for (const key in persistance) {\n        if (persistance[key] !== this.undoState[key]) {\n          diff[key] = persistance[key];\n        }\n      }\n      return diff;\n    }\n    return undefined;\n  }\n\n  public async checkSync(episode: number, volume?: number): Promise<boolean> {\n    const curEpisode = this.getEpisode();\n    const curStatus = this.getStatus();\n    const curVolume = this.getVolume();\n\n    if (curStatus === definitions.status.Completed) {\n      if (episode === 1) {\n        return this.startRewatchingMessage();\n      }\n      return false;\n    }\n\n    if (\n      curEpisode >= episode &&\n      // Novel Volume\n      !(\n        typeof volume !== 'undefined' &&\n        (curVolume || volume > 1 || !episode) &&\n        volume > curVolume\n      )\n    ) {\n      return false;\n    }\n\n    if (episode && episode === this.getTotalEpisodes()) {\n      if (curStatus === definitions.status.Rewatching) {\n        await this.finishRewatchingMessage();\n      } else {\n        await this.finishWatchingMessage();\n      }\n      return true;\n    }\n\n    if (curStatus !== definitions.status.Watching && curStatus !== definitions.status.Rewatching) {\n      return this.startWatchingMessage();\n    }\n\n    return true;\n  }\n\n  public async startWatchingMessage() {\n    return utils\n      .flashConfirm(api.storage.lang(`syncPage_flashConfirm_start_${this.getType()}`), 'add')\n      .then(res => {\n        if (res) this.setStatus(definitions.status.Watching);\n        return res;\n      });\n  }\n\n  public async finishWatchingMessage(): Promise<boolean> {\n    const currentScore = this.getScoreCheckboxValue();\n\n    let checkHtml =\n      '<div><select id=\"finish_score\" style=\"margin-top:5px; color:white; background-color:#4e4e4e; border: none;\">';\n    this.getScoreCheckbox().forEach(el => {\n      checkHtml += `<option value=\"${el.value}\" ${currentScore === el.value ? 'selected' : ''}>${\n        el.label\n      }</option>`;\n    });\n    checkHtml += '</select></div>';\n\n    return utils\n      .flashConfirm(api.storage.lang('syncPage_flashConfirm_complete') + checkHtml, 'complete')\n      .then(res => {\n        if (res) {\n          this.setStatus(definitions.status.Completed);\n          const finishScore = Number(j.$('#finish_score').val());\n          if (finishScore > 0) {\n            this.logger.log(`finish_score: ${j.$('#finish_score :selected').val()}`);\n            this.handleScoreCheckbox(j.$('#finish_score :selected').val());\n          }\n        }\n\n        return res;\n      });\n  }\n\n  public async startRewatchingMessage(): Promise<boolean> {\n    return utils\n      .flashConfirm(\n        api.storage.lang(`syncPage_flashConfirm_rewatch_start_${this.getType()}`),\n        'add',\n      )\n      .then(res => {\n        if (res) this.setStatus(definitions.status.Rewatching);\n        return res;\n      });\n  }\n\n  public async finishRewatchingMessage(): Promise<boolean> {\n    return utils\n      .flashConfirm(\n        api.storage.lang(`syncPage_flashConfirm_rewatch_finish_${this.getType()}`),\n        'complete',\n      )\n      .then(res => {\n        if (res) {\n          this.setStatus(definitions.status.Completed);\n          this.increaseRewatchCount();\n        }\n        return res;\n      });\n  }\n\n  public getScoreCheckbox() {\n    return this.getScoreMode().getOptions();\n  }\n\n  public getScoreCheckboxValue() {\n    return this.getScoreMode().valueToOptionValue(this.getAbsoluteScore());\n  }\n\n  public handleScoreCheckbox(value) {\n    this.setAbsoluteScore(this.getScoreMode().optionValueToValue(value));\n  }\n\n  public getDisplayScoreCheckbox() {\n    const curScore = this.getScoreCheckboxValue();\n    const labelEl = this.getScoreCheckbox().filter(el => el.value === curScore);\n    if (labelEl.length) return labelEl[0].label;\n    return '';\n  }\n\n  public getStatusCheckbox() {\n    const statusEs = [\n      {\n        value: '1',\n        label: api.storage.lang(`UI_Status_watching_${this.getType()}`),\n      },\n      { value: '2', label: api.storage.lang('UI_Status_Completed') },\n      { value: '3', label: api.storage.lang('UI_Status_OnHold') },\n      { value: '4', label: api.storage.lang('UI_Status_Dropped') },\n      {\n        value: '6',\n        label: api.storage.lang(`UI_Status_planTo_${this.getType()}`),\n      },\n    ];\n\n    if (this.rewatchingSupport) {\n      statusEs.push({\n        value: '23',\n        label: api.storage.lang(`UI_Status_Rewatching_${this.getType()}`),\n      });\n    }\n\n    return statusEs;\n  }\n\n  public handleStatusCheckbox(value) {\n    this.setStatus(value);\n  }\n\n  public getStatusCheckboxValue() {\n    return this.getStatus();\n  }\n\n  public getKey(allowed: SyncTypes[], forceMal = true) {\n    if (forceMal && this.ids.mal) return this.ids.mal;\n    if (this.ids.ani && allowed.includes('ANILIST')) return `anilist:${this.ids.ani}`;\n    if (this.ids.kitsu.id && allowed.includes('KITSU')) return `kitsu:${this.ids.kitsu.id}`;\n    if (this.ids.simkl && allowed.includes('SIMKL')) return `simkl:${this.ids.simkl}`;\n    return this.ids.mal;\n  }\n\n  public getLastError() {\n    return this.lastError;\n  }\n\n  public getLastErrorMessage() {\n    return this.errorMessage(this.getLastError());\n  }\n\n  flashmError(error) {\n    utils.flashm(this.errorMessage(error), { error: true, type: 'error' });\n  }\n\n  errorMessage(error) {\n    return _errorMessage(error, this.authenticationUrl);\n  }\n}\n","import { Single as temp } from '../MyAnimeList_api/single';\n\nexport const Single = temp;\n","import { SingleAbstract } from '../singleAbstract';\nimport { NotAutenticatedError, UrlNotSupportedError } from '../Errors';\nimport * as helper from './helper';\nimport { malToAnilist } from '../AniList/helper';\nimport { Cache } from '../../utils/Cache';\nimport { returnYYYYMMDD } from '../../utils/general';\n\nexport class Single extends SingleAbstract {\n  constructor(protected url: string) {\n    super(url);\n    this.logger = con.m(this.shortName, '#2e51a2');\n    return this;\n  }\n\n  private animeInfo: any;\n\n  private displayUrl = '';\n\n  private pending = false;\n\n  shortName = 'MAL';\n\n  authenticationUrl = helper.authenticationUrl;\n\n  protected handleUrl(url) {\n    if (url.match(/myanimelist\\.net\\/(anime|manga)\\/\\d*/i)) {\n      this.type = utils.urlPart(url, 3) === 'anime' ? 'anime' : 'manga';\n      this.ids.mal = Number(utils.urlPart(url, 4));\n      return;\n    }\n    throw new UrlNotSupportedError(url);\n  }\n\n  getCacheKey() {\n    return this.ids.mal;\n  }\n\n  getPageId() {\n    return this.ids.mal;\n  }\n\n  _getStatus() {\n    let curSt;\n    if (this.type === 'manga') {\n      curSt = parseInt(helper.mangaStatus[this.animeInfo.my_list_status.status]);\n    } else {\n      curSt = parseInt(helper.animeStatus[this.animeInfo.my_list_status.status]);\n    }\n    if (this.getRewatching() && curSt === 2) return 23;\n    return curSt;\n  }\n\n  _setStatus(status) {\n    if (status === 23) {\n      status = 2;\n      this.setRewatching(true);\n    } else {\n      this.setRewatching(false);\n    }\n    if (this.type === 'manga') {\n      this.animeInfo.my_list_status.status = helper.mangaStatus[status];\n      return;\n    }\n    this.animeInfo.my_list_status.status = helper.animeStatus[status];\n  }\n\n  increaseRewatchCount(): void {\n    if (this.type === 'manga') {\n      this.animeInfo.my_list_status.num_times_reread++;\n    } else {\n      this.animeInfo.my_list_status.num_times_rewatched++;\n    }\n  }\n\n  _getScore() {\n    return this.animeInfo.my_list_status.score;\n  }\n\n  _setScore(score) {\n    this.animeInfo.my_list_status.score = score;\n  }\n\n  _getAbsoluteScore() {\n    return this.getScore() * 10;\n  }\n\n  _setAbsoluteScore(score) {\n    if (!score) {\n      this.setScore(0);\n      return;\n    }\n    if (score < 10) {\n      this.setScore(1);\n      return;\n    }\n\n    this.setScore(Math.round(score / 10));\n  }\n\n  _getEpisode() {\n    if (this.type === 'manga') {\n      return this.animeInfo.my_list_status.num_chapters_read;\n    }\n    return this.animeInfo.my_list_status.num_watched_episodes;\n  }\n\n  _setEpisode(episode) {\n    if (!episode) episode = 0;\n    if (this.type === 'manga') {\n      this.animeInfo.my_list_status.num_chapters_read = episode;\n      return;\n    }\n    this.animeInfo.my_list_status.num_watched_episodes = episode;\n  }\n\n  _getVolume() {\n    if (this.type === 'manga') {\n      return this.animeInfo.my_list_status.num_volumes_read;\n    }\n    return 0;\n  }\n\n  _setVolume(volume) {\n    if (this.type === 'manga') {\n      this.animeInfo.my_list_status.num_volumes_read = volume;\n    }\n  }\n\n  _getTags() {\n    if (!this.animeInfo.my_list_status.tags.length) {\n      return '';\n    }\n    return this.animeInfo.my_list_status.tags.join(',');\n  }\n\n  _setTags(tags) {\n    if (!tags || tags.trim() === ',') {\n      this.animeInfo.my_list_status.tags = [];\n      return;\n    }\n    this.animeInfo.my_list_status.tags = tags.split(',');\n  }\n\n  private getRewatching(): boolean {\n    if (this.type === 'manga') {\n      return this.animeInfo.my_list_status.is_rereading;\n    }\n    return this.animeInfo.my_list_status.is_rewatching;\n  }\n\n  private setRewatching(state: boolean) {\n    if (this.type === 'manga') {\n      this.animeInfo.my_list_status.is_rereading = state;\n      return;\n    }\n    this.animeInfo.my_list_status.is_rewatching = state;\n  }\n\n  _getTitle() {\n    return this.animeInfo.title;\n  }\n\n  _getTotalEpisodes() {\n    if (this.type === 'manga') {\n      return this.animeInfo.num_chapters;\n    }\n    return this.animeInfo.num_episodes;\n  }\n\n  _getTotalVolumes() {\n    if (this.type === 'manga') {\n      return this.animeInfo.num_volumes;\n    }\n    return 0;\n  }\n\n  _getDisplayUrl() {\n    return this.url;\n  }\n\n  _getImage() {\n    return this.animeInfo.main_picture?.medium ?? '';\n  }\n\n  _getRating() {\n    return Promise.resolve(this.animeInfo.mean);\n  }\n\n  async _update() {\n    return this.apiCall({\n      type: 'GET',\n      path: `${this.type}/${this.ids.mal}`,\n      fields: [\n        'my_list_status{tags,is_rewatching,is_rereading,num_times_rewatched,num_times_reread,start_date,finish_date}',\n        'num_episodes',\n        'mean',\n        // Manga\n        'num_chapters',\n        'num_volumes',\n      ],\n    })\n      .catch(e => {\n        if (e instanceof NotAutenticatedError) {\n          this._authenticated = false;\n        }\n        throw e;\n      })\n      .then(res => {\n        this.logger.m('Api').log(res);\n        this._authenticated = true;\n        this.animeInfo = res;\n        this._onList = true;\n        if (!this.animeInfo.my_list_status) {\n          this._onList = false;\n          if (this.type === 'manga') {\n            this.animeInfo.my_list_status = {\n              is_rereading: false,\n              num_chapters_read: 0,\n              num_volumes_read: 0,\n              score: 0,\n              status: 'plan_to_read',\n              tags: [],\n            };\n          } else {\n            this.animeInfo.my_list_status = {\n              is_rewatching: false,\n              num_watched_episodes: 0,\n              score: 0,\n              status: 'plan_to_watch',\n              tags: [],\n            };\n          }\n        }\n\n        // Handle api bug\n        if (\n          this.animeInfo.my_list_status &&\n          typeof this.animeInfo.my_list_status.num_episodes_watched !== 'undefined'\n        ) {\n          this.animeInfo.my_list_status.num_watched_episodes =\n            this.animeInfo.my_list_status.num_episodes_watched;\n          delete this.animeInfo.my_list_status.num_episodes_watched;\n        }\n      });\n  }\n\n  async _sync() {\n    if (\n      typeof this.animeInfo.my_list_status.start_date === 'undefined' &&\n      this._getStatus() === 1 &&\n      this._getEpisode() > 0\n    ) {\n      this.animeInfo.my_list_status.start_date = returnYYYYMMDD();\n    }\n\n    if (\n      typeof this.animeInfo.my_list_status.finish_date === 'undefined' &&\n      this._getStatus() === 2\n    ) {\n      this.animeInfo.my_list_status.finish_date = returnYYYYMMDD();\n\n      if (typeof this.animeInfo.my_list_status.start_date === 'undefined') {\n        this.animeInfo.my_list_status.start_date = returnYYYYMMDD();\n      }\n    }\n\n    const sentData = {};\n    for (const property in this.animeInfo.my_list_status) {\n      switch (property) {\n        case 'priority':\n        case 'num_watched_episodes':\n        case 'num_volumes_read':\n        case 'num_chapters_read':\n        case 'score':\n        case 'is_rewatching':\n        case 'is_rereading':\n        case 'num_times_rewatched':\n        case 'num_times_reread':\n        case 'rewatch_value':\n        case 'reread_value':\n        case 'tags':\n        case 'comments':\n        case 'status':\n        case 'start_date':\n        case 'finish_date':\n          sentData[property] = this.animeInfo.my_list_status[property];\n          break;\n        default:\n      }\n    }\n    this.logger.m('Sync').log(this.ids.mal, sentData);\n    return this.apiCall({\n      type: 'PUT',\n      path: `${this.type}/${this.ids.mal}/my_list_status`,\n      dataObj: sentData,\n    }).then(res => {\n      this.logger.m('Sync').log('res', res);\n    });\n  }\n\n  _delete() {\n    return this.apiCall({\n      type: 'DELETE',\n      path: `${this.type}/${this.ids.mal}/my_list_status`,\n    });\n  }\n\n  public async fillRelations(): Promise<void> {\n    const cacheObj = new Cache(\n      `fillRelations/${this.ids.mal}/${this.getType()}`,\n      7 * 24 * 60 * 60 * 1000,\n    );\n\n    return cacheObj.hasValueAndIsNotEmpty().then(exists => {\n      if (!exists) {\n        return malToAnilist(this.ids.mal, this.getType()!).then(el => {\n          if (el && parseInt(el)) {\n            this.ids.ani = parseInt(el);\n          }\n          return cacheObj.setValue({ da: el });\n        });\n      }\n      return cacheObj.getValue().then(res => {\n        if (res && res.da && parseInt(res.da)) {\n          this.ids.ani = parseInt(res.da);\n        }\n      });\n    });\n  }\n\n  apiCall = helper.apiCall;\n}\n","import { ListAbstract, listElement } from '../listAbstract';\n\nexport class UserList extends ListAbstract {\n  name = 'MyAnimeList';\n\n  authenticationUrl = 'https://myanimelist.net/login.php';\n\n  async getUserObject() {\n    throw 'no';\n    return Promise.resolve({ username: '', picture: '', href: '' });\n    /*\n    const url = 'https://myanimelist.net/panel.php?go=export&hideLayout';\n    const response = await api.request.xhr('GET', url);\n    const usernameMatches = response.responseText.match(/USER_NAME = \"(.*?)\"/);\n    if (!usernameMatches || usernameMatches.length < 2 || !usernameMatches[1])\n      throw {\n        code: 400,\n        message: 'Not Authenticated',\n      };\n\n    return usernameMatches[1];\n    */\n  }\n\n  _getSortingOptions() {\n    return [\n      {\n        icon: 'sort_by_alpha',\n        title: 'Alphabetic',\n        value: api.storage.lang('list_sorting_alpha'),\n        asc: true,\n      },\n      {\n        icon: 'history',\n        title: api.storage.lang('list_sorting_history'),\n        value: 'updated',\n        asc: true,\n      },\n      {\n        icon: 'score',\n        title: api.storage.lang('list_sorting_score'),\n        value: 'score',\n        asc: true,\n      },\n    ];\n  }\n\n  getOrder(sort) {\n    let pre = '';\n\n    if (sort.endsWith('_asc')) pre = '-';\n\n    const sortString = sort.replace('_asc', '');\n    switch (sortString) {\n      case 'alpha':\n        return pre + 1;\n      case 'updated':\n        return pre + 5;\n      case 'score':\n        return pre + 4;\n      default:\n        if (this.status === 1) return this.getOrder('updated');\n        if (this.status === 6) return this.getOrder('updated');\n        return this.getOrder('alpha');\n    }\n  }\n\n  async getPart() {\n    throw 'no';\n    return [];\n    /*\n    if (!this.username) {\n      this.username = await this.getUsername();\n    }\n\n    const order = this.getOrder(this.sort);\n    let sorting = '';\n    if (order) {\n      sorting = `&order=${order}`;\n    }\n    con.log(\n      '[UserList][MAL]',\n      `username: ${this.username}`,\n      `status: ${this.status}`,\n      `offset: ${this.offset}`,\n      `sorting: ${sorting}`,\n    );\n    const url = `https://myanimelist.net/${this.listType}list/${this.username}/load.json?offset=${this.offset}&status=${this.status}${sorting}`;\n    return api.request.xhr('GET', url).then(async response => {\n      const res = this.jsonParse(response);\n      const data = await this.prepareData(res);\n      if (data.length > 299) {\n        this.offset += 300;\n      } else {\n        this.done = true;\n      }\n      return data;\n    });\n    */\n  }\n\n  public async prepareData(data): Promise<listElement[]> {\n    const newData = [] as listElement[];\n    for (let i = 0; i < data.length; i++) {\n      const el = data[i];\n      if (this.listType === 'anime') {\n        newData.push(\n          await this.fn({\n            uid: el.anime_id,\n            malId: el.anime_id,\n            apiCacheKey: el.anime_id,\n            cacheKey: el.anime_id,\n            type: this.listType,\n            title: el.anime_title,\n            url: `https://myanimelist.net${el.anime_url}`,\n            watchedEp: el.num_watched_episodes,\n            totalEp: el.anime_num_episodes,\n            status: el.status,\n            score: el.score,\n            image: el.anime_image_path,\n            tags: el.tags,\n            airingState: el.anime_airing_status,\n          }),\n        );\n      } else {\n        newData.push(\n          await this.fn({\n            uid: el.manga_id,\n            malId: el.manga_id,\n            apiCacheKey: el.manga_id,\n            cacheKey: el.manga_id,\n            type: this.listType,\n            title: el.manga_title,\n            url: `https://myanimelist.net${el.manga_url}`,\n            watchedEp: el.num_read_chapters,\n            totalEp: el.manga_num_chapters,\n            status: el.status,\n            score: el.score,\n            image: el.manga_image_path,\n            tags: el.tags,\n            airingState: el.anime_airing_status,\n          }),\n        );\n      }\n    }\n    return newData;\n  }\n}\n","// eslint-disable-next-line import/no-unresolved\nexport const quicklinks = require('./quicklinks.json');\n\ntype QuicklinkGroup = 'home' | 'search' | 'link';\n\ninterface Links {\n  name: string;\n  url: string;\n  fn?: (searchTerm: string) => string;\n}\n\nexport interface Quicklink {\n  name: string;\n  domain: string;\n  group: QuicklinkGroup;\n  links: Links[];\n}\n\n/*\n  {searchterm} => 'no%20game%20no%20life'\n  {searchtermPlus} => 'no+game+no+life'\n  {searchtermMinus} => 'no-game-no-life'\n  {searchtermUnderscore} => 'no_game_no_life'\n  {searchtermRaw} => 'no game no life'\n  {cacheId} => '143'\n*/\n\nexport function titleSearch(url, title, id) {\n  return searchSyntax(\n    url\n      .replace('{searchtermPlus}', '{searchterm(+)}')\n      .replace('{searchtermMinus}', '{searchterm(-)}')\n      .replace('{searchtermUnderscore}', '{searchterm(_)}')\n      .replace('{searchtermRaw}', '{searchterm[noEncode,noLowercase]}')\n      .replace('{cacheId}', id),\n    title,\n  );\n}\n\n/*\n  {searchterm(<whitespaceReplacement>)[<options>]}\n  Options:\n    noEncode -> Dont encode characters\n    noSpecial -> Remove special characters\n    specialReplace -> Replace special characters with a <whitespaceReplacement>\n    noLowercase -> Dont lowercase everything\n*/\n\ntype option = 'noEncode' | 'noSpecial' | 'noLowercase' | 'specialReplace';\n\nexport function searchSyntax(url, title) {\n  let resTitle = title.trim();\n  let options: option[] = [];\n\n  const found = url.match(/{searchterm(\\(.\\))?(\\[[^[\\]]*\\])?}/);\n\n  if (!found) return url;\n\n  const [res, space, tempOptions] = found;\n\n  if (tempOptions) {\n    options = tempOptions.substring(1, tempOptions.length - 1).split(',');\n  }\n\n  if (!options.includes('noLowercase')) {\n    resTitle = resTitle.toLowerCase();\n  }\n\n  if (options.includes('noSpecial')) {\n    resTitle = resTitle\n      .replace(/[^a-zA-Z\\d ]/g, '')\n      .replace(/ +/g, ' ')\n      .trim();\n  } else if (options.includes('specialReplace')) {\n    resTitle = resTitle\n      .replace(/[^a-zA-Z\\d ]/g, ' ')\n      .replace(/ +/g, ' ')\n      .trim();\n  }\n\n  if (!options.includes('noEncode')) {\n    resTitle = encodeURIComponent(resTitle);\n  } else {\n    resTitle = resTitle.replace(/\\//g, ' ');\n  }\n\n  if (space) {\n    resTitle = resTitle.replace(/(%20| )/g, space[1]);\n  }\n\n  return url.replace(res, resTitle);\n}\n\nasync function fillFromApi(combined, type, id) {\n  const mal = await getMalToKissApi(type, id);\n\n  return combined.map(el => {\n    if (el.database && mal[el.database]) {\n      el.databaseLinks = mal[el.database];\n    }\n    return el;\n  });\n}\n\nfunction simplifyObject(combined, type, title, id): Quicklink[] {\n  return combined\n    .filter(el => el.search && el.search[type])\n    .map(el => {\n      const links: Links[] = [];\n      let quickGroup: QuicklinkGroup;\n\n      if (el.databaseLinks) {\n        quickGroup = 'link';\n        Object.values(el.databaseLinks).forEach((db: any) => {\n          links.push({\n            name: db.title,\n            url: db.url,\n          });\n        });\n      } else if (el.search[type] === 'home') {\n        quickGroup = 'home';\n        links.push({\n          name: 'Homepage',\n          url: el.domain,\n        });\n      } else {\n        quickGroup = 'search';\n        links.push({\n          name: 'Quicksearch',\n          url: titleSearch(el.search[type], title, id),\n          fn: searchTerm => titleSearch(el.search[type], searchTerm, id),\n        });\n      }\n\n      return {\n        name: el.name,\n        domain: el.domain,\n        group: quickGroup,\n        links,\n      };\n    });\n}\n\nexport async function getMalToKissApi(type, id) {\n  const url = `https://api.malsync.moe/mal/${type}/${id}`;\n  return api.request.xhr('GET', url).then(async response => {\n    con.log('malSync response', response);\n    if (response.status === 400) {\n      return {};\n    }\n    if (response.status === 200) {\n      const data = JSON.parse(response.responseText);\n      if (data && data.Sites) return data.Sites;\n      return {};\n    }\n    throw new Error('malsync offline');\n  });\n}\n\nexport function combinedLinks() {\n  const links = api.settings.get('quicklinks');\n  const comb = links.map(el => optionToCombined(el)).filter(el => el);\n  return JSON.parse(JSON.stringify(comb));\n}\n\nexport function optionToCombined(link) {\n  if (!link) return null;\n  if (link.custom) return link;\n  return quicklinks.find(el => el.name === link);\n}\n\nexport async function activeLinks(\n  type: 'anime' | 'manga',\n  id: any,\n  searchterm: string,\n): Promise<Quicklink[]> {\n  let combined = combinedLinks();\n\n  if (id) {\n    try {\n      combined = await fillFromApi(combined, type, id);\n    } catch (e) {\n      con.m('API Problem').error(e);\n    }\n  }\n\n  return simplifyObject(combined, type, searchterm, id);\n}\n\nexport function removeOptionKey(options, key) {\n  if (!key) return options;\n  return options.filter(el => {\n    if (!el || el === key || (typeof el === 'object' && el.name === key)) return false;\n    return true;\n  });\n}\n\nexport function removeFromOptions(key) {\n  const options = api.settings.get('quicklinks');\n  api.settings.set('quicklinks', removeOptionKey(options, key));\n}\n\nexport function getPages() {\n  return quicklinks;\n}\n","import { Single as ApiSingle } from '../_provider/MyAnimeList_hybrid/single';\nimport { UserList as LegacyList } from '../_provider/MyAnimeList_legacy/list';\n\nimport { UserList as ApiList } from '../_provider/MyAnimeList_hybrid/list';\nimport { activeLinks, removeFromOptions } from '../utils/quicklinksBuilder';\nimport { waitForPageToBeVisible } from '../utils/general';\n\nexport class MyAnimeListClass {\n  page: 'detail' | 'bookmarks' | 'modern' | 'classic' | 'character' | 'people' | 'search' | null =\n    null;\n\n  // detail\n  readonly id: number | null = null;\n\n  readonly type: 'anime' | 'manga' | null = null;\n\n  // bookmarks\n  readonly username: any = null;\n\n  constructor(public url: string) {\n    let urlTemp;\n    if (url.indexOf('myanimelist.net/anime.php') > -1) {\n      urlTemp = `/anime/${utils.urlParam(this.url, 'id')}`;\n      // @ts-ignore\n      window.history.replaceState(null, null, urlTemp);\n      this.url = utils.absoluteLink(urlTemp, 'https://myanimelist.net');\n    }\n    if (url.indexOf('myanimelist.net/manga.php') > -1) {\n      urlTemp = `/manga/${utils.urlParam(this.url, 'id')}`;\n      // @ts-ignore\n      window.history.replaceState(null, null, urlTemp);\n      this.url = utils.absoluteLink(urlTemp, 'https://myanimelist.net');\n    }\n\n    const urlpart = utils.urlPart(this.url, 3);\n    if (urlpart === 'anime' || urlpart === 'manga') {\n      this.page = 'detail';\n      this.id = Number(utils.urlPart(this.url, 4));\n      this.type = urlpart;\n    }\n    if (urlpart === 'animelist' || urlpart === 'mangalist') {\n      this.page = 'bookmarks';\n      this.username = utils.urlPart(this.url, 4);\n      this.type = urlpart === 'animelist' ? 'anime' : 'manga';\n    }\n    if (urlpart === 'character') {\n      this.page = 'character';\n    }\n    if (urlpart === 'people') {\n      this.page = 'people';\n    }\n    if (urlpart === 'search') {\n      this.page = 'search';\n    }\n  }\n\n  async init() {\n    await waitForPageToBeVisible();\n\n    con.log(this);\n    switch (this.page) {\n      case 'detail':\n        this.thumbnails();\n        this.streamingUI();\n        this.malToKiss();\n        this.related();\n        this.friendScore();\n        this.relatedTag();\n        break;\n      case 'bookmarks':\n        $(document).ready(() => {\n          if ($('#mal_cs_powered').length) {\n            this.page = 'classic';\n          } else {\n            this.page = 'modern';\n          }\n          this.init();\n        });\n        break;\n      case 'modern':\n        this.bookmarks();\n        break;\n      case 'classic':\n        this.bookmarks();\n        break;\n      case 'character':\n        this.relatedTag();\n      case 'people':\n      case 'search':\n        this.thumbnails();\n        break;\n      default:\n        con.log('This page has no scipt');\n    }\n  }\n\n  thumbnails() {\n    con.log('Lazyloaded Images');\n    if (this.url.indexOf('/pics') > -1) {\n      return;\n    }\n    if (this.url.indexOf('/pictures') > -1) {\n      return;\n    }\n    if (api.settings.get('malThumbnail') === '0') {\n      return;\n    }\n    const height = parseInt(api.settings.get('malThumbnail'));\n    const width = Math.floor((height / 144) * 100);\n\n    const surHeight = height + 4;\n    const surWidth = width + 4;\n    api.storage.addStyle(\n      `.picSurround img:not(.noKal){height: ${height}px !important; width: ${width}px !important;}`,\n    );\n    api.storage.addStyle('.picSurround img.lazyloaded.kal{width: auto !important;}');\n    api.storage.addStyle(\n      `.picSurround:not(.noKal) a{height: ${surHeight}px; width: ${surWidth}px; overflow: hidden; display: flex; justify-content: center;}`,\n    );\n    api.storage.addStyle(`.picSurround img[src*=\"userimages\"]{max-width: ${width}px !important}`);\n\n    let loaded = 0;\n    try {\n      // @ts-ignore\n      $(window).load(function () {\n        overrideLazyload();\n      });\n    } catch (e) {\n      con.info(e);\n    }\n    try {\n      window.onload = function () {\n        overrideLazyload();\n      };\n    } catch (e) {\n      con.info(e);\n    }\n    try {\n      document.onload = function () {\n        overrideLazyload();\n      };\n    } catch (e) {\n      con.info(e);\n    }\n    try {\n      $(document).ready(function () {\n        overrideLazyload();\n      });\n    } catch (e) {\n      con.info(e);\n    }\n\n    function overrideLazyload() {\n      if (loaded) return;\n      loaded = 1;\n      const tags = document.querySelectorAll('.picSurround img:not(.kal)');\n      let url = '';\n      for (let i = 0; i < tags.length; i++) {\n        const regexDimensions = /\\/r\\/\\d*x\\d*/g;\n        if (tags[i].hasAttribute('data-src')) {\n          url = tags[i].getAttribute('data-src')!;\n        } else {\n          url = tags[i].getAttribute('src')!;\n        }\n\n        if (\n          regexDimensions.test(url) ||\n          /voiceactors.*v.jpg$/g.test(url) ||\n          url.indexOf('questionmark') !== -1\n        ) {\n          url = utils.handleMalImages(url);\n          if (!(url.indexOf('100x140') > -1)) {\n            tags[i].setAttribute('data-src', url);\n            url = url.replace(/v.jpg$/g, '.jpg');\n            tags[i].setAttribute('data-srcset', url.replace(regexDimensions, ''));\n            tags[i].classList.add('lazyload');\n          }\n          tags[i].classList.add('kal');\n        } else {\n          tags[i].closest('.picSurround')!.classList.add('noKal');\n          tags[i].classList.add('kal');\n          tags[i].classList.add('noKal');\n        }\n      }\n    }\n  }\n\n  bookmarksHDimages() {\n    const tags = document.querySelectorAll('img[src*=\"/96x136/\"]');\n    for (let i = 0; i < tags.length; i++) {\n      const regexDimensions = /\\/r\\/\\d*x\\d*/g;\n      const url = tags[i].getAttribute('src')!;\n      tags[i].setAttribute('src', url.replace(regexDimensions, ''));\n    }\n  }\n\n  setEpPrediction(progress) {\n    if (progress && progress.isAiring() && progress.getCurrentEpisode()) {\n      $('.mal-sync-pre-remove, .mal-sync-ep-pre').remove();\n      $('#addtolist')\n        .prev()\n        .before(j.html(`<div class=\"mal-sync-pre-remove\">${progress.getAutoText()}</div>`));\n      $('[id=\"curEps\"], [id=\"totalChaps\"]').before(\n        j.html(\n          `<span class=\"mal-sync-ep-pre\" title=\"${progress.getAutoText()}\">[<span style=\"border-bottom: 1px dotted ${progress.getColor()};\">${progress.getCurrentEpisode()}</span>]</span> `,\n        ),\n      );\n    }\n  }\n\n  getImage() {\n    return $('.leftside img').first().attr('src') || '';\n  }\n\n  getTitle() {\n    const title = $('meta[property=\"og:title\"]').first().attr('content')!.trim() || '';\n    return title.replace(/(^watch|episode \\d*$)/gi, '').trim();\n  }\n\n  async malToKiss() {\n    $(document).ready(() => {\n      con.log('malToKiss');\n\n      const title = this.getTitle();\n\n      activeLinks(this.type!, this.id, title).then(links => {\n        let html = '';\n\n        links.forEach(page => {\n          let tempHtml = '';\n\n          page.links.forEach(stream => {\n            tempHtml += `<div class=\"mal_links\" style=\"word-break: break-all;\"><a target=\"_blank\" href=\"${stream.url}\">${stream.name}</a></div>`;\n          });\n\n          html += `<h2 id=\"${page.name}Links\" class=\"mal_links\"><img src=\"${utils.favicon(\n            page.domain,\n          )}\"> ${page.name}<span title=\"${\n            page.name\n          }\" class=\"remove-mal-sync\" style=\"float: right; font-weight: 100; line-height: 2; cursor: pointer; color: grey;\">x</span></h2>`;\n          html += tempHtml;\n          html += '<br class=\"mal_links\" />';\n        });\n        if (api.settings.get('quicklinksPosition') === 'below') {\n          if ($('h2:contains(\"External Links\")').length) {\n            $('h2:contains(\"External Links\")').before(j.html(html));\n          } else {\n            $('h2:contains(\"Information\")').parent().find('div.mt16').last().before(j.html(html));\n          }\n        } else {\n          $('h2:contains(\"Information\")').before(j.html(html));\n        }\n        $('.remove-mal-sync').click(function () {\n          const key = $(this).attr('title');\n          removeFromOptions(String(key));\n          window.location.reload();\n        });\n      });\n    });\n  }\n\n  async streamingUI() {\n    con.log('Streaming UI');\n    const malObj = new ApiSingle(this.url);\n\n    try {\n      await malObj.update();\n    } catch (e) {\n      con.error('Could not get Single', e);\n      return;\n    }\n\n    this.pageRelation(malObj);\n\n    const streamUrl = malObj.getStreamingUrl();\n    if (streamUrl) {\n      $(document).ready(async function () {\n        $('.breadcrumb')\n          .first()\n          .append(\n            j.html(`\n        <div class=\"data title progress\" id=\"mal-sync-stream-div\" style=\"padding-left: 5px; display: inline-block; position: relative; top: -12px; height: 0px;\">\n          <a class=\"mal-sync-stream\" title=\"${\n            streamUrl ? streamUrl.split('/')[2] : ''\n          }\" target=\"_blank\" style=\"margin: 0 0; display: inline-block; height: 0;\" href=\"${streamUrl}\">\n            <img style=\"display: block;\" src=\"${utils.favicon(\n              streamUrl ? streamUrl.split('/')[2] : '',\n            )}\">\n          </a>\n        </div>`),\n          );\n\n        const resumeUrlObj = malObj.getResumeWatching();\n        const continueUrlObj = malObj.getContinueWatching();\n        con.log('Resume', resumeUrlObj, 'Continue', continueUrlObj);\n        if (continueUrlObj && continueUrlObj.ep === malObj.getEpisode() + 1) {\n          $('#mal-sync-stream-div').append(\n            j.html(\n              `<a class=\"nextStream\" title=\"${api.storage.lang(\n                `overview_Continue_${malObj.getType()}`,\n              )}\" target=\"_blank\" style=\"margin: 0 5px 0 0; color: #BABABA; display: inline-block; height: 0;\" href=\"${\n                continueUrlObj.url\n              }\">\n              <img style=\"display: block;\" src=\"${api.storage.assetUrl(\n                'double-arrow-16px.png',\n              )}\" width=\"16\" height=\"16\">\n            </a>`,\n            ),\n          );\n        } else if (resumeUrlObj && resumeUrlObj.ep === malObj.getEpisode()) {\n          $('#mal-sync-stream-div').append(\n            j.html(\n              `<a class=\"resumeStream\" title=\"${api.storage.lang(\n                `overview_Resume_Episode_${malObj.getType()}`,\n              )}\" target=\"_blank\" style=\"margin: 0 5px 0 0; color: #BABABA; display: inline-block; height: 0;\" href=\"${\n                resumeUrlObj.url\n              }\">\n              <img style=\"display: block;\" src=\"${api.storage.assetUrl(\n                'arrow-16px.png',\n              )}\" width=\"16\" height=\"16\">\n            </a>`,\n            ),\n          );\n        }\n      });\n    }\n\n    await malObj.initProgress();\n\n    this.setEpPrediction(malObj.getProgress());\n\n    setInterval(() => {\n      this.setEpPrediction(malObj.getProgress());\n    }, 1000 * 60);\n  }\n\n  async pageRelation(malObj) {\n    await malObj.fillRelations();\n\n    malObj.getPageRelations().forEach(page => {\n      $('#horiznav_nav > ul').append(\n        j.html(`\n          <li style=\"position: relative; height: 12px; display: inline-block;\">\n            <a href=\"${page.link}\" target=\"_blank\" title=\"${page.name}\" class=\"link\" style=\"position: absolute; bottom: -5px; width: 16px; text-align: center;\">\n              <img src=\"${page.icon}\" width=\"16\" width=\"16\">\n            </a>\n          </li>\n        `),\n      );\n    });\n  }\n\n  bookmarks() {\n    con.log(`Bookmarks [${this.username}][${this.page}]`);\n    const This = this;\n\n    const listProvider = new ApiList(7, this.type!);\n    const dataProvider = new LegacyList(7, this.type!);\n\n    let book;\n    if (this.page === 'modern') {\n      book = {\n        bookReady(callback) {\n          utils.waitUntilTrue(\n            function () {\n              return $('#loading-spinner').css('display') === 'none';\n            },\n            async function () {\n              callback(\n                await dataProvider.prepareData($.parseJSON($('.list-table').attr('data-items')!)),\n              );\n\n              utils.changeDetect(\n                () => {\n                  $('.tags span a').each(function (index) {\n                    if (typeof utils.getUrlFromTags($(this).text()) !== 'undefined') {\n                      const par = $(this).parent().parent().parent().parent();\n                      $(this).parent().remove();\n                      streamUI(\n                        This.type,\n                        par.find('.title .link').first().attr('href'),\n                        $(this).text(),\n                        parseInt(par.find('.progress .link').first().text()),\n                        par.find('.title .link').first().attr('href')!.split('/')[1],\n                      );\n                    }\n                  });\n                },\n                () => {\n                  return $('.list-table > *').length;\n                },\n              );\n            },\n          );\n        },\n        getElement(malUrl) {\n          return $(`.list-item a[href^=\"${malUrl}\"]`).parent().parent('.list-table-data');\n        },\n        streamingSelector: '.data.title .link',\n        cleanTags() {\n          $('.tags span a').each(function (index) {\n            if (typeof utils.getUrlFromTags($(this).text()) !== 'undefined') {\n              $(this).parent().remove();\n            }\n          });\n        },\n        predictionPos(element, tag) {\n          element.find('.data.progress span, .data.chapter span').first().after(j.html(tag));\n        },\n      };\n    } else if (this.page === 'classic') {\n      book = {\n        bookReady(callback) {\n          listProvider\n            .getCompleteList()\n            .then(list => {\n              callback(list);\n            })\n            .catch(e => {\n              con.error(e);\n              listProvider.flashmError(e);\n            });\n        },\n        getElement(malUrl) {\n          return $(`a[href^=\"${malUrl}\"]`);\n        },\n        streamingSelector: 'span',\n        cleanTags() {\n          $('span[id^=\"tagLinks\"] a').each(function (index) {\n            if (typeof utils.getUrlFromTags($(this).text()) !== 'undefined') {\n              $(this).remove();\n            }\n          });\n        },\n        predictionPos(element, tag) {\n          element\n            .parent()\n            .parent()\n            .find('span[id^=\"epText\"] a span, span[id^=\"chap\"]')\n            .first()\n            .after(j.html(tag));\n        },\n      };\n    } else {\n      con.error('Bookmark type unknown');\n      return;\n    }\n\n    book.bookReady(function (data) {\n      This.bookmarksHDimages();\n      $.each(data, async function (index, el) {\n        const malUrl = el.url.replace('https://myanimelist.net', '');\n        const { type } = el;\n\n        streamUI(type, malUrl, el.tags, parseInt(el.watchedEp), el.cacheKey);\n\n        await el.fn.initProgress();\n\n        if (el.fn.progress && el.fn.progress.isAiring() && el.fn.progress.getCurrentEpisode()) {\n          const element = book.getElement(malUrl);\n          book.predictionPos(\n            element,\n            `<span class=\"mal-sync-ep-pre\" title=\"${el.fn.progress.getAutoText()}\">[<span style=\"border-bottom: 1px dotted ${el.fn.progress.getColor()};\">${el.fn.progress.getCurrentEpisode()}</span>]</span>`,\n          );\n        }\n      });\n      book.cleanTags();\n    });\n\n    async function streamUI(type, malUrl, tags, curEp, cacheKey) {\n      const options = await utils.getEntrySettings(type, cacheKey, tags);\n      if (options && options.u) {\n        const element = book.getElement(malUrl);\n        element.find(book.streamingSelector).after(\n          j.html(`\n          <a class=\"mal-sync-stream\" title=\"${\n            options.u.split('/')[2]\n          }\" target=\"_blank\" style=\"margin: 0 0;\" href=\"${options.u}\">\n            <img src=\"${utils.favicon(options.u.split('/')[2])}\">\n          </a>`),\n        );\n\n        const resumeUrlObj = options.r;\n        const continueUrlObj = options.c;\n\n        con.log('Resume', resumeUrlObj, 'Continue', continueUrlObj);\n        if (continueUrlObj && continueUrlObj.ep === curEp + 1) {\n          element.find('.mal-sync-stream').after(\n            j.html(\n              `<a class=\"nextStream\" title=\"Continue watching\" target=\"_blank\" style=\"margin: 0 5px 0 0; color: #BABABA;\" href=\"${\n                continueUrlObj.url\n              }\">\n              <img src=\"${api.storage.assetUrl('double-arrow-16px.png')}\" width=\"16\" height=\"16\">\n            </a>`,\n            ),\n          );\n        } else if (resumeUrlObj && resumeUrlObj.ep === curEp) {\n          element.find('.mal-sync-stream').after(\n            j.html(\n              `<a class=\"resumeStream\" title=\"Resume watching\" target=\"_blank\" style=\"margin: 0 5px 0 0; color: #BABABA;\" href=\"${\n                resumeUrlObj.url\n              }\">\n              <img src=\"${api.storage.assetUrl('arrow-16px.png')}\" width=\"16\" height=\"16\">\n            </a>`,\n            ),\n          );\n        }\n      }\n    }\n  }\n\n  related() {\n    $(document).ready(function () {\n      $('.anime_detail_related_anime a').each(function () {\n        const el = $(this);\n        const url = utils.absoluteLink(el.attr('href'), 'https://myanimelist.net');\n        if (typeof url !== 'undefined') {\n          api.request\n            .database('entry', { id: Number(utils.urlPart(url, 4)), type: utils.urlPart(url, 3) })\n            .then(dbEntry => {\n              if (dbEntry) {\n                const tag = utils.statusTag(dbEntry.status, dbEntry.type, dbEntry.uid);\n                if (tag) el.append(j.html(tag));\n              }\n            });\n        }\n      });\n    });\n  }\n\n  relatedTag() {\n    const This = this;\n    $(document).ready(function () {\n      $('a.button_edit').each(function () {\n        const el = $(this);\n        const href = $(this).attr('href') || '';\n        const type = utils.urlPart(href, 4);\n        const id = utils.urlPart(href, 5);\n        const state = el.attr('title');\n        if (typeof state !== 'undefined' && state) {\n          const tag = String(utils.statusTag(state, type, id));\n          if (This.page === 'detail') {\n            el.parent().find('> a').first().after(j.html(tag));\n          } else {\n            el.parent().parent().find('> a').after(j.html(tag));\n          }\n          el.remove();\n        }\n      });\n    });\n  }\n\n  friendScore() {\n    if (!api.settings.get('friendScore')) return;\n    $(document).ready(function () {\n      const position = $('h2:contains(Reviews)').prev();\n      if (!position.length) return;\n\n      const overview = $('#horiznav_nav li a').first();\n      if (!overview.is('#horiznav_nav li a.horiznav_active')) return;\n\n      let url = overview.attr('href');\n      if (typeof url === 'undefined' || !url) return;\n      url = utils.absoluteLink(url, 'https://myanimelist.net');\n\n      api.request.xhr('GET', `${url}/stats`).then(response => {\n        const friendHead = $('a[name=members]', $(response.responseText).children());\n        if (!friendHead) return;\n        const friendBody = friendHead.nextAll();\n\n        let bodyHtml = '';\n\n        friendBody.each((i, val) => {\n          bodyHtml += val.outerHTML;\n        });\n        if (friendBody.length > 1 && friendBody.find('a:contains(\"All Members\")').length) {\n          position\n            .before(j.html(friendHead.html()))\n            .before(j.html(bodyHtml))\n            .before(j.html('<br>'));\n\n          $('a:contains(\"All Members\")').after(\n            j.html(\n              ' | <span id=\"mal-sync-removeFriends\" title=\"remove\" style=\"cursor: pointer; color: #1d439b;\">X</span>',\n            ),\n          );\n          $('#mal-sync-removeFriends').click(function () {\n            api.settings.set('friendScore', false);\n            window.location.reload();\n          });\n        }\n      });\n    });\n  }\n}\n","export async function firebaseNotification() {\n  const schedule = await api.storage.get('timestampUpdate/firebaseNotification');\n  if (typeof schedule === 'undefined' || j.$.now() - schedule > 10 * 60 * 1000) {\n    await checkNotifications();\n    api.storage.set('timestampUpdate/firebaseNotification', j.$.now());\n  }\n}\n\nasync function checkNotifications() {\n  con.log('checkNotifications');\n  const url = 'https://kissanimelist.firebaseio.com/Data2/Notification/Current.json';\n  const response = await api.request.xhr('GET', url);\n  const current = parseInt(JSON.parse(response.responseText));\n  if (Number.isNaN(current)) con.error('Could not read current Notification number');\n\n  con.log('Current Notification', current);\n  const last = parseInt(await api.storage.get('firebaseNotification'));\n  const next = last + 1;\n\n  if (typeof last === 'undefined' || Number.isNaN(last)) {\n    api.storage.set('firebaseNotification', current);\n    return;\n  }\n\n  if (current < next) {\n    con.log('No new notifications');\n\n    return;\n  }\n\n  const notificationUrl = `https://kissanimelist.firebaseio.com/Data2/Notification/list/N${next}.json`;\n  const resNotification = await api.request.xhr('GET', notificationUrl);\n\n  if (!resNotification) return;\n\n  const message = JSON.parse(resNotification.responseText);\n  if (!message) {\n    con.info('Notification empty', resNotification.responseText);\n    api.storage.set('firebaseNotification', next).then(function () {\n      checkNotifications();\n    });\n\n    return;\n  }\n\n  j.$(document).ready(function () {\n    const flashm = utils.flashm(\n      `<div style=\"text-align: left;\">${message}</div><button class=\"okChangelog\" style=\"background-color: transparent; border: none; color: rgb(255,64,129);margin-top: 10px;cursor: pointer;\">Close</button>`,\n      { permanent: true, position: 'top' },\n    );\n    flashm.find('.okChangelog').click(function () {\n      flashm.remove();\n      api.storage.set('firebaseNotification', next).then(function () {\n        checkNotifications();\n      });\n    });\n  });\n}\n","import { MyAnimeListClass } from '../myanimelist/myanimelistClass';\nimport { firebaseNotification } from '../utils/firebaseNotification';\n\nlet lastFocus;\n\nfunction main() {\n  if (api.settings.get('userscriptModeButton')) throw 'Userscript mode';\n  const mal = new MyAnimeListClass(window.location.href);\n  messageMalListener(mal);\n  mal.init();\n  firebaseNotification();\n\n  $(window).blur(function () {\n    lastFocus = Date.now();\n  });\n}\n\nconst css =\n  'font-size: 40px; padding-bottom: 3px; color: white; text-shadow: -1px -1px #2e51a2, 1px -1px #2e51a2, -1px 1px #2e51a2, 1px 1px #2e51a2, 2px 2px #2e51a2, 3px 3px #2e51a2;';\nconsole.log('%cMAL-Sync', css, `Version: ${api.storage.version()}`);\n\napi.settings.init().then(() => {\n  main();\n});\n\nfunction messageMalListener(mal: MyAnimeListClass) {\n  const logger = con.m('TabMalUrl');\n  // @ts-ignore\n  chrome.runtime.onMessage.addListener(function (msg, sender, sendResponse) {\n    if (Date.now() - lastFocus < 3 * 1000) {\n      if (msg.action === 'TabMalUrl') {\n        logger.log('Response', mal.url);\n        sendResponse({\n          url: mal.url,\n          title: mal.getTitle(),\n          image: mal.getImage(),\n        });\n      }\n      return;\n    }\n    logger.log('Focus timeout');\n  });\n}\n"],"names":["createDep","effects","dep","Set","w","n","wasTracked","trackOpBit","newTracked","targetMap","WeakMap","effectTrackDepth","maxMarkerBits","activeEffect","ITERATE_KEY","Symbol","MAP_KEY_ITERATE_KEY","shouldTrack","trackStack","track","target","type","key","depsMap","get","set","Map","trackEffects","debuggerEventExtraInfo","shouldTrack2","has","add","deps","push","trigger","newValue","oldValue","oldTarget","values","newLength","Number","forEach","key2","length","triggerEffects","effect2","computed","triggerEffect","allowRecurse","scheduler","run","isNonTrackableKeys","builtInSymbols","Object","getOwnPropertyNames","filter","map","get$1","createGetter","readonlyGet","arrayInstrumentations","createArrayInstrumentations","instrumentations","args","arr","toRaw","this","i","l","res","apply","last","pop","resetTracking","hasOwnProperty","obj","isReadonly2","shallow","receiver","shallowReadonlyMap","readonlyMap","shallowReactiveMap","reactiveMap","targetIsArray","Reflect","isRef","value","readonly","reactive","createSetter","isReadonly","isShallow","hadKey","result","mutableHandlers","deleteProperty","ownKeys","readonlyHandlers","toShallow","getProto","v","getPrototypeOf","rawTarget","rawKey","has2","wrap","toReadonly","toReactive","call","size","get2","deleteEntry","delete","clear","hadItems","createForEach","callback","thisArg","observed","createIterableMethod","method","targetIsMap","isPair","iterator","isKeyOnly","innerIterator","next","done","createReadonlyMethod","createInstrumentations","mutableInstrumentations2","shallowInstrumentations2","readonlyInstrumentations2","shallowReadonlyInstrumentations2","mutableInstrumentations","readonlyInstrumentations","shallowInstrumentations","shallowReadonlyInstrumentations","createInstrumentationGetter","mutableCollectionHandlers","readonlyCollectionHandlers","createReactiveObject","baseHandlers","collectionHandlers","proxyMap","existingProxy","targetType","isExtensible","rawType","targetTypeMap","getTargetType","proxy","Proxy","raw","r","__v_isRef","ref","rawValue","RefImpl","constructor","__v_isShallow","_rawValue","_value","ref2","newVal","useDirectValue","triggerRefValue","makeMap","str","expectsLowerCase","create","list","split","val","toLowerCase","extend","assign","prototype","hasOwn","isArray","Array","isMap","toTypeString","isSymbol","isObject","objectToString","toString","toRawType","slice","isIntegerKey","parseInt","cacheStringFunction","fn","cache","camelizeRE","hyphenateRE","replace","_","c","toUpperCase","capitalize","charAt","hasChanged","is","module","exports","entries","setPrototypeOf","isFrozen","getOwnPropertyDescriptor","freeze","seal","construct","fun","thisValue","x","Func","arrayForEach","unapply","arrayPop","arrayPush","stringToLowerCase","String","stringToString","stringMatch","match","stringReplace","stringIndexOf","indexOf","stringTrim","trim","regExpTest","RegExp","test","typeErrorCreate","func","TypeError","_len2","arguments","_key2","_len","_key","addToSet","array","transformCaseFunc","_transformCaseFunc","element","lcElement","clone","object","newObject","property","lookupGetter","prop","desc","console","warn","html$1","svg$1","svgFilters","svgDisallowed","mathMl$1","mathMlDisallowed","text","html","svg","mathMl","xml","MUSTACHE_EXPR","ERB_EXPR","TMPLIT_EXPR","DATA_ATTR","ARIA_ATTR","IS_ALLOWED_URI","IS_SCRIPT_OR_DATA","ATTR_WHITESPACE","DOCTYPE_NAME","EXPRESSIONS","__proto__","getGlobal","window","createDOMPurify","undefined","DOMPurify","root","version","removed","document","nodeType","isSupported","originalDocument","currentScript","DocumentFragment","HTMLTemplateElement","Node","Element","NodeFilter","NamedNodeMap","MozNamedAttrMap","HTMLFormElement","DOMParser","trustedTypes","ElementPrototype","cloneNode","getNextSibling","getChildNodes","getParentNode","template","createElement","content","ownerDocument","trustedTypesPolicy","emptyHTML","implementation","createNodeIterator","createDocumentFragment","getElementsByTagName","importNode","hooks","createHTMLDocument","IS_ALLOWED_URI$1","ALLOWED_TAGS","DEFAULT_ALLOWED_TAGS","ALLOWED_ATTR","DEFAULT_ALLOWED_ATTR","CUSTOM_ELEMENT_HANDLING","tagNameCheck","writable","configurable","enumerable","attributeNameCheck","allowCustomizedBuiltInElements","FORBID_TAGS","FORBID_ATTR","ALLOW_ARIA_ATTR","ALLOW_DATA_ATTR","ALLOW_UNKNOWN_PROTOCOLS","ALLOW_SELF_CLOSE_IN_ATTR","SAFE_FOR_TEMPLATES","WHOLE_DOCUMENT","SET_CONFIG","FORCE_BODY","RETURN_DOM","RETURN_DOM_FRAGMENT","RETURN_TRUSTED_TYPE","SANITIZE_DOM","SANITIZE_NAMED_PROPS","KEEP_CONTENT","IN_PLACE","USE_PROFILES","FORBID_CONTENTS","DEFAULT_FORBID_CONTENTS","DATA_URI_TAGS","DEFAULT_DATA_URI_TAGS","URI_SAFE_ATTRIBUTES","DEFAULT_URI_SAFE_ATTRIBUTES","MATHML_NAMESPACE","SVG_NAMESPACE","HTML_NAMESPACE","NAMESPACE","IS_EMPTY_INPUT","ALLOWED_NAMESPACES","DEFAULT_ALLOWED_NAMESPACES","PARSER_MEDIA_TYPE","SUPPORTED_PARSER_MEDIA_TYPES","CONFIG","formElement","isRegexOrFunction","testValue","Function","_parseConfig","cfg","ADD_URI_SAFE_ATTR","ADD_DATA_URI_TAGS","ALLOWED_URI_REGEXP","ADD_TAGS","ADD_ATTR","table","tbody","TRUSTED_TYPES_POLICY","createHTML","createScriptURL","purifyHostElement","createPolicy","suffix","ATTR_NAME","hasAttribute","getAttribute","policyName","scriptUrl","_createTrustedTypesPolicy","MATHML_TEXT_INTEGRATION_POINTS","HTML_INTEGRATION_POINTS","COMMON_SVG_AND_HTML_ELEMENTS","ALL_SVG_TAGS","ALL_MATHML_TAGS","_forceRemove","node","parentNode","removeChild","remove","_removeAttribute","name","attribute","getAttributeNode","from","removeAttribute","setAttribute","_initDocument","dirty","doc","leadingWhitespace","matches","dirtyPayload","parseFromString","documentElement","createDocument","innerHTML","body","insertBefore","createTextNode","childNodes","_createIterator","SHOW_ELEMENT","SHOW_COMMENT","SHOW_TEXT","_isNode","nodeName","_executeHook","entryPoint","currentNode","data","hook","_sanitizeElements","elm","textContent","attributes","namespaceURI","hasChildNodes","tagName","allowedTags","firstElementChild","_basicCustomElementTest","parent","parentTagName","Boolean","_checkValidNamespace","_isValidAttribute","lcTag","lcName","_sanitizeAttributes","attr","hookEvent","attrName","attrValue","keepAttr","allowedAttributes","forceKeepAttr","getAttributeType","setAttributeNS","_sanitizeShadowDOM","fragment","shadowNode","shadowIterator","nextNode","sanitize","importedNode","returnNode","appendChild","firstChild","nodeIterator","shadowroot","shadowrootmod","serializedHTML","outerHTML","doctype","setConfig","clearConfig","isValidAttribute","tag","addHook","hookFunction","removeHook","removeHooks","removeAllHooks","factory","nextTickSupported","process","nextTick","symbolsSupported","reflectSupported","_setImmediate","setImmediate","setTimeout","getOwnPropertySymbols","keys","init","_events","_conf","configure","conf","delimiter","maxListeners","_maxListeners","wildcard","newListener","_newListener","removeListener","_removeListener","verboseMemoryLeak","ignoreErrors","listenerTree","logPossibleMemoryLeak","count","eventName","errorMsg","emitWarning","e","Error","emitter","error","trace","toArray","a","b","toObject","len","valuesCount","TargetObserver","options","on","off","_emitter","_target","_listeners","_listenersCount","addEventListener","removeEventListener","addListener","_on","_off","_observers","resolveOptions","schema","reducers","allowUnknown","computedOptions","option","reducer","reject","reason","constructorReducer","makeTypeReducer","types","message","join","firstType","secondType","kind","subscribe","event","localEvent","observer","listeners","handler","eventObj","original","emit","concat","_onNewListener","_event","_onRemoveListener","hasListeners","unsubscribe","events","clearRefs","index","findTargetIndex","splice","functionReducer","objectFunctionReducer","makeCancelablePromise","Promise","executor","isCancelable","callbacks","subscriptionClosed","timer","promise","resolve","onCancel","cleanup","clearTimeout","timeout","overload","isFinite","cancel","_resolve","_reject","err","cb","code","observers","searchListenerTree","handlers","tree","typeLength","ns","j","dl","branch","xTree","xxTree","isolatedBranch","endReached","branches","currentType","nextType","growListenerTree","listener","prepend","unshift","warned","collectTreeEvents","asArray","branchName","path","isArrayPath","recursivelyGarbageCollect","flag","Listener","setupListener","promisify","async","objectify","_listener","_origin","context","then","_async","EventEmitter","EventEmitter2","listenTo","listen","isSingleReducer","stopListeningTo","matched","setMaxListeners","getMaxListeners","once","_once","prependOnceListener","_many","many","ttl","prependMany","self","_all","containsSymbol","al","emitAsync","promises","all","prependListener","onAny","_onAny","prependAny","temp","returnValue","leafs","iLeaf","leaf","position","offAny","fns","removeAllListeners","allListeners","eventNames","nsAsArray","listenerCount","listenersAny","waitFor","handleError","defineProperties","defaultMaxListeners","isNaN","errorListener","eventListener","webextension","getStorage","chrome","runtime","lastError","results","storage","local","sync","addStyle","css","style","head","log","getManifest","lang","selector","api","settings","i18n","argIndex","getMessage","assetUrl","filename","extension","getURL","injectCssResource","alert","injectjsResource","s","src","onload","updateDom","storageOnChanged","onChanged","utils","syncRegex","requestApi","xhr","url","sendMessage","status","response","notification","database","param","settingsObj","autoTrackingModeanime","readerTracking","autoTrackingModemanga","enablePages","forceEn","rpc","presenceLargeImage","presenceShowButtons","presenceShowMalsync","userscriptModeButton","syncMode","syncModeSimkl","localSync","delay","videoDuration","malTags","malContinue","malResume","usedPage","epPredictions","theme","themeSidebars","themeColor","themeOpacity","themeImage","minimalWindow","posLeft","miniMALonMal","floatButtonStealth","minimizeBigPopup","floatButtonCorrection","floatButtonHide","autoCloseMinimal","outWay","miniMalWidth","miniMalHeight","malThumbnail","friendScore","loadPTWForProgress","quicklinks","quicklinksPosition","autofull","autoresume","autoNextEp","highlightAllEp","checkForFiller","crashReport","introSkip","introSkipFwd","introSkipBwd","nextEpShort","correctionShort","syncShort","progressInterval","progressIntervalDefaultAnime","progressIntervalDefaultManga","progressNotificationsAnime","progressNotificationsManga","bookMarksList","customDomains","anilistUpdateUi","anilistToken","anilistOptions","displayAdultContent","scoreFormat","kitsuToken","kitsuOptions","titleLanguagePreference","sfwFilter","ratingSystem","simklToken","malToken","malRefresh","shikiToken","shikiOptions","locale","debounceArray","isInit","tempSettings","store","rateDebounce","con","changes","namespace","storageChange","info","rateLimit","$","flashm","permanent","setDebounce","getAsync","request","bind","debug","m","color","blocks","fontColor","hash","charCodeAt","colour","substr","stringToColour","name2","color2","moduleText","reduce","sum","el","moduleStyle","urlPart","part","urlParts","urlStrip","urlParam","exec","decodeURI","getBaseText","children","each","generateUniqueID","arraySize","Uint32Array","crypto","getRandomValues","favicon","domain","watching","planTo","episode","rateLimitExclude","getselect","absoluteLink","startsWith","parseHtml","urlChangeDetect","currentPage","location","href","setInterval","fullUrlChangeDetect","strip","intervalId","changeDetect","immediate","waitUntilTrue","condition","interval","clearInterval","getAsyncWaitUntilTrue","rejectThis","reset","asyncWaitUntilTrue","doubleId","Math","random","checkDoubleExecution","after","getUrlFromTags","tags","atobURL","encoded","atob","setUrlInTags","addition","btoa","setResumeWaching","ep","id","getResumeWaching","setContinueWaching","getContinueWaching","setEntrySettings","tempOptions","JSON","stringify","find","getEntrySettings","u","p","tagString","parse","continueUrlObj","resumeUrlObj","handleMalImages","getTooltip","direction","rNumber","floor","timeDiffToText","delta","diffYears","diffDays","diffHours","diffMinutes","canHideTabs","browser","tabs","hide","statusTag","anime","class","title","manga","tempInfo","getStatusText","state","notifications","iconUrl","messageObj","history","shift","timestamp","Date","now","timeCache","dataFunction","getTime","extraClass","initflashm","colorF","flashdiv","messClass","tempClass","removeClass","fadeOut","duration","queue","complete","flashmEl","mess","hoverInfo","addClass","appendTo","minimized","slideDown","slideUp","flashConfirm","yesCall","cancelCall","yesNo","yesText","noText","flasmessage","click","evt","parentsUntil","lazyloaded","lazyimages","lazyload","scrollElement","loadImage","hasClass","img","Image","replaceChild","query","processScroll","elementInViewport","scroll","horizontalOffset","rect","getBoundingClientRect","top","left","innerHeight","clientHeight","wait","ms","pageUrl","page","returnYYYYMMDD","numFromToday","d","setDate","getDate","month","getMonth","day","getFullYear","htmlDecode","isFirefox","waitForPageToBeVisible","visibilityState","awaitUi","makeDomainCompatible","clearCache","cacheArray","deleted","sortAlphabetically","isDomainMatching","urlObj","URL","host","endsWith","upperCaseFirstLetter","string","jQuery","htmlContent","SAFE_FOR_JQUERY","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","__webpack_modules__","getter","__esModule","definition","o","defineProperty","g","globalThis","toStringTag","score","localStorage","getItem","checkLocalStorageIsAvailable","setItem","removeItem","localStore","refetchTtl","containsValue","valueValid","ttlValid","refetchTtlValid","hasValue","hasValueAndIsNotEmpty","fullState","isValid","refetch","getValue","setValue","save","clearValue","scriptId","globalEmit","params","item","onMessage","sender","sendResponse","super","UrlNotSupportedError","UnexpectedResponseError","json","errorMessage","authenticationUrl","listType","sort","loading","firstLoaded","seperateRewatching","modes","frontend","sortAiring","initProgress","cached","username","offset","templist","cacheObj","logger","setTemplist","getTemplist","setSort","isDone","isLoading","isFirstLoaded","getCompleteList","getNext","sortAiringList","getCache","getNextPage","retList","getPart","getCached","cachelist","watchedEp","initFrontendMode","updateListener","cacheKey","destroy","getUsername","getUserObject","user","getSortingOptions","simple","icon","_getSortingOptions","asc","flashmError","streamurl","continueUrlTemp","continueUrl","curEp","Progress","progress","listP","sortUnread","normalItems","preItems","watchedItems","sortItems","valA","getPredictionTimestamp","valB","prediction","isAiring","getCurrentEpisode","reverse","tempA","tempB","apiCall","fields","includes","headers","Authorization","dataObj","formBody","encodedKey","encodeURIComponent","encodedValue","responseText","checkIfBanned","rToken","refresh_token","access_token","refreshToken","animeStatus","mangaStatus","Watching","Completed","Onhold","Dropped","PlanToWatch","limit","picture","deauth","getOrder","order","sorting","curSt","paging","prepareData","newData","uid","malId","apiCacheKey","list_status","num_episodes_watched","totalEp","num_episodes","image","main_picture","medium","imageLarge","large","airingState","anime_airing_status","num_chapters_read","num_chapters","statusTranslate","Rewatching","predictionXhrGET","timestampToShortTime","tm","ago","curTime","diff","future","short","output","y","h","timeToString","milliseconds","hour","minute","seconds","year","msToTime","releaseItem","initReleaseProgress","liveData","mode","force","finished","progressValue","config","mainId","fallback","fallbackPrediction","mainTemp","predicition","lastEp","predTemp","predTime","total","abs","probability","predSoon","getProgress","cProgress","nProgress","noti","single","sticky","getImage","getStreamingUrl","getUrl","notificationCheck","progressMode","progressIsOld","getProgressCurrentEpisode","re","isProgressFinished","getProgressPrediction","getProgressLastTimestamp","live","isFinished","NaN","getPrediction","getPredictionText","pre","getLastTimestamp","getLast","getLastText","getAuto","preT","getAutoText","getColor","getBars","predEp","totalWidth","epWidth","predWidth","ceil","SafeError","point10","ui","getOptions","label","valueToOptionValue","round","optionValueToValue","optionValue","SingleAbstract","rewatchingSupport","ids","mal","ani","kitsu","slug","simkl","updateProgress","_onList","_authenticated","handleUrl","getType","supportsRewatching","getApiCacheKey","getKey","getRulesCacheKey","setStatus","_setStatus","getStatus","isOnList","_getStatus","NoState","getScoreMode","setScore","_setScore","getScore","_getScore","setAbsoluteScore","_setAbsoluteScore","getAbsoluteScore","_getAbsoluteScore","setEpisode","getTotalEpisodes","_setEpisode","getEpisode","_getEpisode","setVolume","volume","_setVolume","getVolume","_getVolume","setStreamingUrl","streamingUrl","cleanTags","getCacheKey","getTitle","getProgressMode","progressXhr","getProgressFormated","op","languageNames","Intl","DisplayNames","of","dropped","getProgressOptions","getProgressCompleted","setProgressMode","_getTags","getProgressKey","getPageRelations","shortName","link","fillRelations","update","_update","catch","persistanceState","getStateEl","registerEvent","emitUpdate","_setTags","_sync","undoState","action","getPageId","meta","getMalId","_delete","globalUpdateEvent","updateEvent","isDirty","setStateEl","undo","onList","_getTitle","eps","_getTotalEpisodes","getTotalVolumes","_getTotalVolumes","isAuthenticated","getDisplayUrl","_getDisplayUrl","getMalUrl","getIds","_getImage","getRating","_getRating","rating","setResumeWatching","getResumeWatching","setContinueWatching","getContinueWatching","increaseRewatchCount","absoluteScore","getStateDiff","persistance","checkSync","curEpisode","curStatus","curVolume","startRewatchingMessage","finishRewatchingMessage","finishWatchingMessage","startWatchingMessage","currentScore","getScoreCheckboxValue","checkHtml","getScoreCheckbox","handleScoreCheckbox","getDisplayScoreCheckbox","curScore","labelEl","getStatusCheckbox","statusEs","handleStatusCheckbox","getStatusCheckboxValue","allowed","forceMal","getLastError","getLastErrorMessage","displayUrl","pending","animeInfo","my_list_status","getRewatching","setRewatching","num_times_reread","num_times_rewatched","num_watched_episodes","num_volumes_read","is_rereading","is_rewatching","num_volumes","mean","start_date","finish_date","sentData","exists","da","variables","Accept","Media","malToAnilist","anime_id","anime_title","anime_url","anime_num_episodes","anime_image_path","manga_id","manga_title","manga_url","num_read_chapters","manga_num_chapters","manga_image_path","titleSearch","resTitle","found","space","substring","searchSyntax","activeLinks","searchterm","combined","comb","optionToCombined","custom","combinedLinks","Sites","getMalToKissApi","databaseLinks","fillFromApi","search","links","quickGroup","db","searchTerm","group","simplifyObject","MyAnimeListClass","urlTemp","replaceState","urlpart","thumbnails","streamingUI","malToKiss","related","relatedTag","ready","bookmarks","height","width","surHeight","surWidth","loaded","load","overrideLazyload","querySelectorAll","regexDimensions","classList","closest","bookmarksHDimages","setEpPrediction","prev","before","first","tempHtml","stream","removeOptionKey","removeFromOptions","reload","malObj","pageRelation","streamUrl","append","This","listProvider","dataProvider","book","bookReady","parseJSON","par","streamUI","getElement","malUrl","streamingSelector","predictionPos","dbEntry","overview","friendHead","friendBody","nextAll","bodyHtml","firebaseNotification","schedule","checkNotifications","current","notificationUrl","resNotification","lastFocus","msg","messageMalListener","blur"],"sourceRoot":""}